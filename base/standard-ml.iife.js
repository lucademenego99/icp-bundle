(function(){"use strict";
globalThis.process = globalThis.process;
function tt(){}function zn(l){return l()}function _s(){return Object.create(null)}function ml(l){l.forEach(zn)}function $s(l){return typeof l=="function"}function fe(l,t){return l!=l?t==t:l!==t||l&&typeof l=="object"||typeof l=="function"}function _u(l){return Object.keys(l).length===0}function $u(l,...t){if(l==null)return tt;const e=l.subscribe(...t);return e.unsubscribe?()=>e.unsubscribe():e}function Bl(l,t,e){l.$$.on_destroy.push($u(t,e))}function Tn(l,t,e){return l.set(e),t}function z(l,t){l.appendChild(t)}function et(l,t,e){l.insertBefore(t,e||null)}function Zt(l){l.parentNode.removeChild(l)}function Q(l){return document.createElement(l)}function Rt(l){return document.createElementNS("http://www.w3.org/2000/svg",l)}function Ii(l){return document.createTextNode(l)}function Ct(){return Ii(" ")}function $t(l,t,e,i){return l.addEventListener(t,e,i),()=>l.removeEventListener(t,e,i)}function X(l,t,e){e==null?l.removeAttribute(t):l.getAttribute(t)!==e&&l.setAttribute(t,e)}function L(l,t,e){t in l?l[t]=typeof l[t]=="boolean"&&e===""?!0:e:X(l,t,e)}function tm(l){return Array.from(l.childNodes)}function Mn(l,t){t=""+t,l.wholeText!==t&&(l.data=t)}function H(l,t,e,i){e===null?l.style.removeProperty(t):l.style.setProperty(t,e,i?"important":"")}function Je(l){const t={};for(const e of l)t[e.name]=e.value;return t}let kl;function xl(l){kl=l}function em(){if(!kl)throw new Error("Function called outside component initialization");return kl}function wl(l){em().$$.on_mount.push(l)}const vl=[],Vt=[],Vi=[],td=[],lm=Promise.resolve();let Pn=!1;function im(){Pn||(Pn=!0,lm.then(v))}function En(l){Vi.push(l)}const jn=new Set;let yi=0;function v(){const l=kl;do{for(;yi<vl.length;){const t=vl[yi];yi++,xl(t),nm(t.$$)}for(xl(null),vl.length=0,yi=0;Vt.length;)Vt.pop()();for(let t=0;t<Vi.length;t+=1){const e=Vi[t];jn.has(e)||(jn.add(e),e())}Vi.length=0}while(vl.length);for(;td.length;)td.pop()();Pn=!1,jn.clear(),xl(l)}function nm(l){if(l.fragment!==null){l.update(),ml(l.before_update);const t=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,t),l.after_update.forEach(En)}}const cm=new Set;function sm(l,t){l&&l.i&&(cm.delete(l),l.i(t))}function dm(l,t,e,i){const{fragment:n,on_mount:c,on_destroy:s,after_update:d}=l.$$;n&&n.m(t,e),i||En(()=>{const o=c.map(zn).filter($s);s?s.push(...o):ml(o),l.$$.on_mount=[]}),d.forEach(En)}function om(l,t){const e=l.$$;e.fragment!==null&&(ml(e.on_destroy),e.fragment&&e.fragment.d(t),e.on_destroy=e.fragment=null,e.ctx=[])}function am(l,t){l.$$.dirty[0]===-1&&(vl.push(l),im(),l.$$.dirty.fill(0)),l.$$.dirty[t/31|0]|=1<<t%31}function Fe(l,t,e,i,n,c,s,d=[-1]){const o=kl;xl(l);const a=l.$$={fragment:null,ctx:null,props:c,update:tt,not_equal:n,bound:_s(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(o?o.$$.context:[])),callbacks:_s(),dirty:d,skip_bound:!1,root:t.target||o.$$.root};s&&s(a.root);let h=!1;if(a.ctx=e?e(l,t.props||{},(u,m,...r)=>{const b=r.length?r[0]:m;return a.ctx&&n(a.ctx[u],a.ctx[u]=b)&&(!a.skip_bound&&a.bound[u]&&a.bound[u](b),h&&am(l,u)),m}):[],a.update(),h=!0,ml(a.before_update),a.fragment=i?i(a.ctx):!1,t.target){if(t.hydrate){const u=tm(t.target);a.fragment&&a.fragment.l(u),u.forEach(Zt)}else a.fragment&&a.fragment.c();t.intro&&sm(l.$$.fragment),dm(l,t.target,t.anchor,t.customElement),v()}xl(o)}let Ce;typeof HTMLElement=="function"&&(Ce=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:l}=this.$$;this.$$.on_disconnect=l.map(zn).filter($s);for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(l,t,e){this[l]=e}disconnectedCallback(){ml(this.$$.on_disconnect)}$destroy(){om(this,1),this.$destroy=tt}$on(l,t){const e=this.$$.callbacks[l]||(this.$$.callbacks[l]=[]);return e.push(t),()=>{const i=e.indexOf(t);i!==-1&&e.splice(i,1)}}$set(l){this.$$set&&!_u(l)&&(this.$$.skip_bound=!0,this.$$set(l),this.$$.skip_bound=!1)}});const rl=[];function Qn(l,t=tt){let e;const i=new Set;function n(d){if(fe(l,d)&&(l=d,e)){const o=!rl.length;for(const a of i)a[1](),rl.push(a,l);if(o){for(let a=0;a<rl.length;a+=2)rl[a][0](rl[a+1]);rl.length=0}}}function c(d){n(d(l))}function s(d,o=tt){const a=[d,o];return i.add(a),i.size===1&&(e=t(n)||tt),d(l),()=>{i.delete(a),i.size===0&&(e(),e=null)}}return{set:n,update:c,subscribe:s}}const Ri=Qn(!1),Dn=Qn(null),ed=Qn(localStorage.getItem("icpDefaultTheme")||null);function hm(l){let t,e;return{c(){t=Rt("svg"),e=Rt("path"),X(e,"d","M8,5.14V19.14L19,12.14L8,5.14Z"),H(t,"width","70%"),H(t,"height","70%"),H(t,"fill","white"),X(t,"viewBox","0 0 24 24")},m(i,n){et(i,t,n),z(t,e)},d(i){i&&Zt(t)}}}function um(l){let t,e;return{c(){t=Rt("svg"),e=Rt("path"),X(e,"d","M8.59 0L5 3.59L1.41 0L0 1.41L3.59 5L0 8.59L1.41 10L5 6.41L8.59 10L10 8.59L6.41 5L10 1.41L8.59 0Z"),X(e,"fill","white"),H(t,"width","30%"),H(t,"height","30%"),H(t,"fill","white"),X(t,"viewBox","0 0 10 10"),X(t,"fill","none"),X(t,"xmlns","http://www.w3.org/2000/svg")},m(i,n){et(i,t,n),z(t,e)},d(i){i&&Zt(t)}}}function mm(l){let t,e,i,n,c,s,d,o;function a(m,r){return m[4]?um:hm}let h=a(l),u=h(l);return{c(){t=Q("div"),e=Q("main"),i=Ct(),n=Q("button"),u.c(),this.c=tt,n.disabled=c=l[0]==null&&l[2]!="p5"&&l[2]!="processing",X(n,"id","run-button"),H(n,"background-color",l[0]!=null||l[2]=="p5"||l[2]=="processing"?l[4]?"#ff4133":"#00CC3D":"#5f5f5f"),X(t,"id","play-container"),X(t,"style",s=l[1]=="vertical"?"right: calc(var(--output-height) + min(0.7vw, 1.4vh) + 1px); bottom: min(0.3vw, 0.6vh)":"right: min(0.4vw, 0.8vh); bottom: calc(var(--output-height) + min(0.5vw, 1vh))")},m(m,r){et(m,t,r),z(t,e),z(t,i),z(t,n),u.m(n,null),l[15](t),d||(o=$t(n,"click",l[5]),d=!0)},p(m,[r]){h!==(h=a(m))&&(u.d(1),u=h(m),u&&(u.c(),u.m(n,null))),r&5&&c!==(c=m[0]==null&&m[2]!="p5"&&m[2]!="processing")&&(n.disabled=c),r&21&&H(n,"background-color",m[0]!=null||m[2]=="p5"||m[2]=="processing"?m[4]?"#ff4133":"#00CC3D":"#5f5f5f"),r&2&&s!==(s=m[1]=="vertical"?"right: calc(var(--output-height) + min(0.7vw, 1.4vh) + 1px); bottom: min(0.3vw, 0.6vh)":"right: min(0.4vw, 0.8vh); bottom: calc(var(--output-height) + min(0.5vw, 1vh))")&&X(t,"style",s)},i:tt,o:tt,d(m){m&&Zt(t),u.d(),l[15](null),d=!1,o()}}}function rm(l,t,e){let i,n;Bl(l,Ri,f=>e(13,i=f)),Bl(l,Dn,f=>e(14,n=f));let{type:c="normal"}=t,{language:s}=t,{editor:d}=t,{offline:o=!1}=t,{webworker:a}=t,{modules:h={}}=t,u,m=!0,r,b,Z=!1,g;const p=new IntersectionObserver(f=>{f[0].isIntersecting?e(9,m=!0):e(9,m=!1)});function R(f,S){const T=new CustomEvent("changedout",{detail:{output:f,outputError:S},bubbles:!0,cancelable:!0,composed:!0});u==null||u.dispatchEvent(T)}function V(f){if(e(4,Z=!1),f.data.error)e(11,b=!0),e(10,r=s=="python"?"[line "+f.data.line+"] "+f.data.error:s=="ml"?f.data.error.message:f.data.error),console.log(f.data);else if(e(11,b=!1),s=="sql")if(f.data.result&&Array.isArray(f.data.result)&&f.data.result.length>0){const S=f.data.result.map(T=>h.createHTMLTable(T).outerHTML);e(10,r=S.join("<br>"))}else e(10,r="");else{let S="";f.data.debug&&(S+=f.data.debug+`

`),f.data.result&&(S+="'"+f.data.result+"'"),e(10,r=S)}R(r,b)}function W(){console.warn("Interrupting Code Execution"),s=="python"||s=="java"||s=="cpp"?a.port.close():s=="p5"||s=="processing"?g.remove():a.terminate();const f=new CustomEvent("recreateworker",{bubbles:!0,cancelable:!0,composed:!0});u==null||u.dispatchEvent(f),e(4,Z=!1)}async function G(f){if(Z){W();return}if(e(4,Z=!0),s=="p5"){let k=d.state.doc.toString(),E=d.dom.getBoundingClientRect().width,j=d.dom.getBoundingClientRect().height;const D=/createCanvas\(([^,]+),\s*([^)]+)\)/,it=D.exec(k);let _,J;if(it)_=parseInt(it[1]),J=parseInt(it[2]);else{R("Runtime error: createCanvas() function not found",!0),e(4,Z=!1);return}_<E&&(E=_),J<j&&(j=J),k=k.replace(D,`createCanvas(${E}, ${j})`),console.log(k);const ht=[];let ot=console.log;console.log=function(C,...pt){ht.push(C+" "+pt.join(" "))},window.onerror=function(C,pt,ce,vt,Oe){R(`Runtime error: ${C}`,!0),e(4,Z=!1)},window.onunhandledrejection=function(C){throw C.preventDefault(),C.reason};try{await window.eval(k)}catch(C){R(`Runtime error: ${C.message}`,!0),e(4,Z=!1);return}e(12,g=new h.p5);const ut=g.canvas;ut.style.width=E+"px",ut.style.height=j+"px";const Ft=new CustomEvent("canvasout",{detail:{canvas:ut},bubbles:!0,cancelable:!0,composed:!0});u==null||u.dispatchEvent(Ft),R(ht.join(`
`),!1),console.log=ot;return}if(s=="processing"){let k=d.state.doc.toString();try{k=h.transformProcessing(k)}catch(C){const pt=/line: (\d+)/,ce=/column: (\d+)/,vt=/--> (.*?) <(?:--)/,Oe=/but found --> '([^']*)' <--/;if(pt&&ce&&vt&&Oe&&C.message.match(pt)&&C.message.match(ce)&&C.message.match(vt)&&C.message.match(Oe)){const Os=C.message.match(pt)[1],qs=C.message.match(ce)[1],x=C.message.match(vt)[1],Y=C.message.match(Oe)[1];R(`Error at line ${Os}, column ${qs}: expecting  "${x}" but found  "${Y}"`,!0)}else R(`Unknown error - ${C.message}`,!0);e(4,Z=!1);return}let E=d.dom.getBoundingClientRect().width,j=d.dom.getBoundingClientRect().height*.7;const D=/createCanvas\(([^,]+),\s*([^)]+)\)/,it=D.exec(k);if(it){const C=parseInt(it[1]),pt=parseInt(it[2]);C<E&&(E=C),pt<j&&(j=pt),k=k.replace(D,`createCanvas(${E}, ${j})`)}else if(k.includes("setup ( ) {"))console.log("setup function found"),k=k.replace("setup ( ) {",`setup() { createCanvas(${E}, ${j});`);else{R("Error: setup() function not found",!0),e(4,Z=!1);return}k=`
let width = ${Math.round(E)};
let height = ${Math.round(j)};
${k}
`,console.log(k);let _=[],J=console.log;console.log=function(C,...pt){_.push(C+" "+pt.join(" "))},typeof setup<"u"&&(setup=void 0),typeof draw<"u"&&(draw=void 0);const ht=C=>{throw new Error("ATTENZIONE: il tuo codice contiene un ciclo infinito!")},ot=100;h.babel.registerPlugin("loopProtection",h.protect(ot,ht)),k=h.babel.transform(k,{plugins:["loopProtection"]}).code,window.onerror=function(C,pt,ce,vt,Oe){if(C.toString().includes("ATTENZIONE: il tuo codice contiene un ciclo infinito!")){e(4,Z=!1);return}R(`Runtime error: ${C}`,!0),e(4,Z=!1)},window.onunhandledrejection=function(C){throw C.preventDefault(),C.reason};try{await window.eval(k)}catch(C){R(`Runtime error: ${C.message}`,!0),e(4,Z=!1);return}e(12,g=new h.p5);const ut=g.canvas;ut.style.width=E+"px",ut.style.height=j+"px";const Ft=new CustomEvent("canvasout",{detail:{canvas:ut},bubbles:!0,cancelable:!0,composed:!0});u==null||u.dispatchEvent(Ft),R(_.join(`
`),!1),console.log=J,k.includes("draw()")||W();return}let S="";o&&(S=document.location.protocol+"//"+document.location.host+document.location.pathname,S=S.substring(0,S.lastIndexOf("/")),S+=s=="python"?"/utils/python/pyodide/":"/utils/java/");const T={offline:o,language:s,script:d.state.doc.toString(),input:"",baseUrl:S};s=="python"||s=="java"||s=="cpp"?a.port.postMessage(T):a.postMessage(T)}wl(()=>{p.observe(u)});function K(f){Vt[f?"unshift":"push"](()=>{u=f,e(3,u)})}return l.$$set=f=>{"type"in f&&e(1,c=f.type),"language"in f&&e(2,s=f.language),"editor"in f&&e(6,d=f.editor),"offline"in f&&e(7,o=f.offline),"webworker"in f&&e(0,a=f.webworker),"modules"in f&&e(8,h=f.modules)},l.$$.update=()=>{l.$$.dirty&3072&&R(r,b),l.$$.dirty&4612&&!m&&(s=="p5"||s=="processing")&&g&&W(),l.$$.dirty&24640&&i&&d&&d.dom.isEqualNode(n)&&(G(),Tn(Ri,i=!1,i)),l.$$.dirty&5&&a&&(console.log(a),s=="python"||s=="java"||s=="cpp"?e(0,a.port.onmessage=V,a):(console.log("Initialized worker for language "+s),e(0,a.onmessage=V,a)))},[a,c,s,u,Z,G,d,o,h,m,r,b,g,i,n,K]}class bm extends Ce{constructor(t){super(),this.shadowRoot.innerHTML="<style>#play-container{width:min(2vw, 4vh);height:min(2vw, 4vh);position:absolute;z-index:10}#run-button{width:100%;height:100%;padding:0 !important;margin:0 !important;border-radius:50%;transition:all ease-in 150ms;display:flex;align-items:center;justify-content:center;border:none;cursor:pointer;box-shadow:2px -7px 17px -5px rgba(0, 0, 0, 0.35)}#run-button:hover{background-color:var(--run-button-bg-color-hover);transform:scale(1.1, 1.1)}#run-button:disabled{cursor:not-allowed}#run-button:focus{outline:0}</style>",Fe(this,{target:this.shadowRoot,props:Je(this.attributes),customElement:!0},rm,mm,fe,{type:1,language:2,editor:6,offline:7,webworker:0,modules:8},null),t&&(t.target&&et(t.target,this,t.anchor),t.props&&(this.$set(t.props),v()))}static get observedAttributes(){return["type","language","editor","offline","webworker","modules"]}get type(){return this.$$.ctx[1]}set type(t){this.$$set({type:t}),v()}get language(){return this.$$.ctx[2]}set language(t){this.$$set({language:t}),v()}get editor(){return this.$$.ctx[6]}set editor(t){this.$$set({editor:t}),v()}get offline(){return this.$$.ctx[7]}set offline(t){this.$$set({offline:t}),v()}get webworker(){return this.$$.ctx[0]}set webworker(t){this.$$set({webworker:t}),v()}get modules(){return this.$$.ctx[8]}set modules(t){this.$$set({modules:t}),v()}}customElements.define("run-button",bm);class ${constructor(){}lineAt(t){if(t<0||t>this.length)throw new RangeError(`Invalid position ${t} in document of length ${this.length}`);return this.lineInner(t,!1,1,0)}line(t){if(t<1||t>this.lines)throw new RangeError(`Invalid line number ${t} in ${this.lines}-line document`);return this.lineInner(t,!0,1,0)}replace(t,e,i){let n=[];return this.decompose(0,t,n,2),i.length&&i.decompose(0,i.length,n,3),this.decompose(e,this.length,n,1),me.from(n,this.length-(e-t)+i.length)}append(t){return this.replace(this.length,this.length,t)}slice(t,e=this.length){let i=[];return this.decompose(t,e,i,0),me.from(i,e-t)}eq(t){if(t==this)return!0;if(t.length!=this.length||t.lines!=this.lines)return!1;let e=this.scanIdentical(t,1),i=this.length-this.scanIdentical(t,-1),n=new Ul(this),c=new Ul(t);for(let s=e,d=e;;){if(n.next(s),c.next(s),s=0,n.lineBreak!=c.lineBreak||n.done!=c.done||n.value!=c.value)return!1;if(d+=n.value.length,n.done||d>=i)return!0}}iter(t=1){return new Ul(this,t)}iterRange(t,e=this.length){return new id(this,t,e)}iterLines(t,e){let i;if(t==null)i=this.iter();else{e==null&&(e=this.lines+1);let n=this.line(t).from;i=this.iterRange(n,Math.max(n,e==this.lines+1?this.length:e<=1?0:this.line(e-1).to))}return new nd(i)}toString(){return this.sliceString(0)}toJSON(){let t=[];return this.flatten(t),t}static of(t){if(t.length==0)throw new RangeError("A document must have at least one line");return t.length==1&&!t[0]?$.empty:t.length<=32?new gt(t):me.from(gt.split(t,[]))}}class gt extends ${constructor(t,e=Zm(t)){super(),this.text=t,this.length=e}get lines(){return this.text.length}get children(){return null}lineInner(t,e,i,n){for(let c=0;;c++){let s=this.text[c],d=n+s.length;if((e?i:d)>=t)return new gm(n,d,i,s);n=d+1,i++}}decompose(t,e,i,n){let c=t<=0&&e>=this.length?this:new gt(ld(this.text,t,e),Math.min(e,this.length)-Math.max(0,t));if(n&1){let s=i.pop(),d=fi(c.text,s.text.slice(),0,c.length);if(d.length<=32)i.push(new gt(d,s.length+c.length));else{let o=d.length>>1;i.push(new gt(d.slice(0,o)),new gt(d.slice(o)))}}else i.push(c)}replace(t,e,i){if(!(i instanceof gt))return super.replace(t,e,i);let n=fi(this.text,fi(i.text,ld(this.text,0,t)),e),c=this.length+i.length-(e-t);return n.length<=32?new gt(n,c):me.from(gt.split(n,[]),c)}sliceString(t,e=this.length,i=`
`){let n="";for(let c=0,s=0;c<=e&&s<this.text.length;s++){let d=this.text[s],o=c+d.length;c>t&&s&&(n+=i),t<o&&e>c&&(n+=d.slice(Math.max(0,t-c),e-c)),c=o+1}return n}flatten(t){for(let e of this.text)t.push(e)}scanIdentical(){return 0}static split(t,e){let i=[],n=-1;for(let c of t)i.push(c),n+=c.length+1,i.length==32&&(e.push(new gt(i,n)),i=[],n=-1);return n>-1&&e.push(new gt(i,n)),e}}class me extends ${constructor(t,e){super(),this.children=t,this.length=e,this.lines=0;for(let i of t)this.lines+=i.lines}lineInner(t,e,i,n){for(let c=0;;c++){let s=this.children[c],d=n+s.length,o=i+s.lines-1;if((e?o:d)>=t)return s.lineInner(t,e,i,n);n=d+1,i=o+1}}decompose(t,e,i,n){for(let c=0,s=0;s<=e&&c<this.children.length;c++){let d=this.children[c],o=s+d.length;if(t<=o&&e>=s){let a=n&((s<=t?1:0)|(o>=e?2:0));s>=t&&o<=e&&!a?i.push(d):d.decompose(t-s,e-s,i,a)}s=o+1}}replace(t,e,i){if(i.lines<this.lines)for(let n=0,c=0;n<this.children.length;n++){let s=this.children[n],d=c+s.length;if(t>=c&&e<=d){let o=s.replace(t-c,e-c,i),a=this.lines-s.lines+o.lines;if(o.lines<a>>5-1&&o.lines>a>>5+1){let h=this.children.slice();return h[n]=o,new me(h,this.length-(e-t)+i.length)}return super.replace(c,d,o)}c=d+1}return super.replace(t,e,i)}sliceString(t,e=this.length,i=`
`){let n="";for(let c=0,s=0;c<this.children.length&&s<=e;c++){let d=this.children[c],o=s+d.length;s>t&&c&&(n+=i),t<o&&e>s&&(n+=d.sliceString(t-s,e-s,i)),s=o+1}return n}flatten(t){for(let e of this.children)e.flatten(t)}scanIdentical(t,e){if(!(t instanceof me))return 0;let i=0,[n,c,s,d]=e>0?[0,0,this.children.length,t.children.length]:[this.children.length-1,t.children.length-1,-1,-1];for(;;n+=e,c+=e){if(n==s||c==d)return i;let o=this.children[n],a=t.children[c];if(o!=a)return i+o.scanIdentical(a,e);i+=o.length+1}}static from(t,e=t.reduce((i,n)=>i+n.length+1,-1)){let i=0;for(let r of t)i+=r.lines;if(i<32){let r=[];for(let b of t)b.flatten(r);return new gt(r,e)}let n=Math.max(32,i>>5),c=n<<1,s=n>>1,d=[],o=0,a=-1,h=[];function u(r){let b;if(r.lines>c&&r instanceof me)for(let Z of r.children)u(Z);else r.lines>s&&(o>s||!o)?(m(),d.push(r)):r instanceof gt&&o&&(b=h[h.length-1])instanceof gt&&r.lines+b.lines<=32?(o+=r.lines,a+=r.length+1,h[h.length-1]=new gt(b.text.concat(r.text),b.length+1+r.length)):(o+r.lines>n&&m(),o+=r.lines,a+=r.length+1,h.push(r))}function m(){o!=0&&(d.push(h.length==1?h[0]:me.from(h,a)),a=-1,o=h.length=0)}for(let r of t)u(r);return m(),d.length==1?d[0]:new me(d,e)}}$.empty=new gt([""],0);function Zm(l){let t=-1;for(let e of l)t+=e.length+1;return t}function fi(l,t,e=0,i=1e9){for(let n=0,c=0,s=!0;c<l.length&&n<=i;c++){let d=l[c],o=n+d.length;o>=e&&(o>i&&(d=d.slice(0,i-n)),n<e&&(d=d.slice(e-n)),s?(t[t.length-1]+=d,s=!1):t.push(d)),n=o+1}return t}function ld(l,t,e){return fi(l,[""],t,e)}class Ul{constructor(t,e=1){this.dir=e,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[t],this.offsets=[e>0?1:(t instanceof gt?t.text.length:t.children.length)<<1]}nextInner(t,e){for(this.done=this.lineBreak=!1;;){let i=this.nodes.length-1,n=this.nodes[i],c=this.offsets[i],s=c>>1,d=n instanceof gt?n.text.length:n.children.length;if(s==(e>0?d:0)){if(i==0)return this.done=!0,this.value="",this;e>0&&this.offsets[i-1]++,this.nodes.pop(),this.offsets.pop()}else if((c&1)==(e>0?0:1)){if(this.offsets[i]+=e,t==0)return this.lineBreak=!0,this.value=`
`,this;t--}else if(n instanceof gt){let o=n.text[s+(e<0?-1:0)];if(this.offsets[i]+=e,o.length>Math.max(0,t))return this.value=t==0?o:e>0?o.slice(t):o.slice(0,o.length-t),this;t-=o.length}else{let o=n.children[s+(e<0?-1:0)];t>o.length?(t-=o.length,this.offsets[i]+=e):(e<0&&this.offsets[i]--,this.nodes.push(o),this.offsets.push(e>0?1:(o instanceof gt?o.text.length:o.children.length)<<1))}}}next(t=0){return t<0&&(this.nextInner(-t,-this.dir),t=this.value.length),this.nextInner(t,this.dir)}}class id{constructor(t,e,i){this.value="",this.done=!1,this.cursor=new Ul(t,e>i?-1:1),this.pos=e>i?t.length:0,this.from=Math.min(e,i),this.to=Math.max(e,i)}nextInner(t,e){if(e<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;t+=Math.max(0,e<0?this.pos-this.to:this.from-this.pos);let i=e<0?this.pos-this.from:this.to-this.pos;t>i&&(t=i),i-=t;let{value:n}=this.cursor.next(t);return this.pos+=(n.length+t)*e,this.value=n.length<=i?n:e<0?n.slice(n.length-i):n.slice(0,i),this.done=!this.value,this}next(t=0){return t<0?t=Math.max(t,this.from-this.pos):t>0&&(t=Math.min(t,this.to-this.pos)),this.nextInner(t,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class nd{constructor(t){this.inner=t,this.afterBreak=!0,this.value="",this.done=!1}next(t=0){let{done:e,lineBreak:i,value:n}=this.inner.next(t);return e?(this.done=!0,this.value=""):i?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=n,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&($.prototype[Symbol.iterator]=function(){return this.iter()},Ul.prototype[Symbol.iterator]=id.prototype[Symbol.iterator]=nd.prototype[Symbol.iterator]=function(){return this});class gm{constructor(t,e,i,n){this.from=t,this.to=e,this.number=i,this.text=n}get length(){return this.to-this.from}}let bl="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(l=>l?parseInt(l,36):1);for(let l=1;l<bl.length;l++)bl[l]+=bl[l-1];function pm(l){for(let t=1;t<bl.length;t+=2)if(bl[t]>l)return bl[t-1]<=l;return!1}function cd(l){return l>=127462&&l<=127487}const sd=8205;function Ut(l,t,e=!0,i=!0){return(e?dd:Gm)(l,t,i)}function dd(l,t,e){if(t==l.length)return t;t&&od(l.charCodeAt(t))&&ad(l.charCodeAt(t-1))&&t--;let i=Yt(l,t);for(t+=Et(i);t<l.length;){let n=Yt(l,t);if(i==sd||n==sd||e&&pm(n))t+=Et(n),i=n;else if(cd(n)){let c=0,s=t-2;for(;s>=0&&cd(Yt(l,s));)c++,s-=2;if(c%2==0)break;t+=2}else break}return t}function Gm(l,t,e){for(;t>0;){let i=dd(l,t-2,e);if(i<t)return i;t--}return 0}function od(l){return l>=56320&&l<57344}function ad(l){return l>=55296&&l<56320}function Yt(l,t){let e=l.charCodeAt(t);if(!ad(e)||t+1==l.length)return e;let i=l.charCodeAt(t+1);return od(i)?(e-55296<<10)+(i-56320)+65536:e}function On(l){return l<=65535?String.fromCharCode(l):(l-=65536,String.fromCharCode((l>>10)+55296,(l&1023)+56320))}function Et(l){return l<65536?1:2}const qn=/\r\n?|\n/;var At=function(l){return l[l.Simple=0]="Simple",l[l.TrackDel=1]="TrackDel",l[l.TrackBefore=2]="TrackBefore",l[l.TrackAfter=3]="TrackAfter",l}(At||(At={}));class re{constructor(t){this.sections=t}get length(){let t=0;for(let e=0;e<this.sections.length;e+=2)t+=this.sections[e];return t}get newLength(){let t=0;for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e+1];t+=i<0?this.sections[e]:i}return t}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(t){for(let e=0,i=0,n=0;e<this.sections.length;){let c=this.sections[e++],s=this.sections[e++];s<0?(t(i,n,c),n+=c):n+=s,i+=c}}iterChangedRanges(t,e=!1){_n(this,t,e)}get invertedDesc(){let t=[];for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];n<0?t.push(i,n):t.push(n,i)}return new re(t)}composeDesc(t){return this.empty?t:t.empty?this:hd(this,t)}mapDesc(t,e=!1){return t.empty?this:$n(this,t,e)}mapPos(t,e=-1,i=At.Simple){let n=0,c=0;for(let s=0;s<this.sections.length;){let d=this.sections[s++],o=this.sections[s++],a=n+d;if(o<0){if(a>t)return c+(t-n);c+=d}else{if(i!=At.Simple&&a>=t&&(i==At.TrackDel&&n<t&&a>t||i==At.TrackBefore&&n<t||i==At.TrackAfter&&a>t))return null;if(a>t||a==t&&e<0&&!d)return t==n||e<0?c:c+o;c+=o}n=a}if(t>n)throw new RangeError(`Position ${t} is out of range for changeset of length ${n}`);return c}touchesRange(t,e=t){for(let i=0,n=0;i<this.sections.length&&n<=e;){let c=this.sections[i++],s=this.sections[i++],d=n+c;if(s>=0&&n<=e&&d>=t)return n<t&&d>e?"cover":!0;n=d}return!1}toString(){let t="";for(let e=0;e<this.sections.length;){let i=this.sections[e++],n=this.sections[e++];t+=(t?" ":"")+i+(n>=0?":"+n:"")}return t}toJSON(){return this.sections}static fromJSON(t){if(!Array.isArray(t)||t.length%2||t.some(e=>typeof e!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new re(t)}static create(t){return new re(t)}}class yt extends re{constructor(t,e){super(t),this.inserted=e}apply(t){if(this.length!=t.length)throw new RangeError("Applying change set to a document with the wrong length");return _n(this,(e,i,n,c,s)=>t=t.replace(n,n+(i-e),s),!1),t}mapDesc(t,e=!1){return $n(this,t,e,!0)}invert(t){let e=this.sections.slice(),i=[];for(let n=0,c=0;n<e.length;n+=2){let s=e[n],d=e[n+1];if(d>=0){e[n]=d,e[n+1]=s;let o=n>>1;for(;i.length<o;)i.push($.empty);i.push(s?t.slice(c,c+s):$.empty)}c+=s}return new yt(e,i)}compose(t){return this.empty?t:t.empty?this:hd(this,t,!0)}map(t,e=!1){return t.empty?this:$n(this,t,e,!0)}iterChanges(t,e=!1){_n(this,t,e)}get desc(){return re.create(this.sections)}filter(t){let e=[],i=[],n=[],c=new Al(this);t:for(let s=0,d=0;;){let o=s==t.length?1e9:t[s++];for(;d<o||d==o&&c.len==0;){if(c.done)break t;let h=Math.min(c.len,o-d);Ht(n,h,-1);let u=c.ins==-1?-1:c.off==0?c.ins:0;Ht(e,h,u),u>0&&Ke(i,e,c.text),c.forward(h),d+=h}let a=t[s++];for(;d<a;){if(c.done)break t;let h=Math.min(c.len,a-d);Ht(e,h,-1),Ht(n,h,c.ins==-1?-1:c.off==0?c.ins:0),c.forward(h),d+=h}}return{changes:new yt(e,i),filtered:re.create(n)}}toJSON(){let t=[];for(let e=0;e<this.sections.length;e+=2){let i=this.sections[e],n=this.sections[e+1];n<0?t.push(i):n==0?t.push([i]):t.push([i].concat(this.inserted[e>>1].toJSON()))}return t}static of(t,e,i){let n=[],c=[],s=0,d=null;function o(h=!1){if(!h&&!n.length)return;s<e&&Ht(n,e-s,-1);let u=new yt(n,c);d=d?d.compose(u.map(d)):u,n=[],c=[],s=0}function a(h){if(Array.isArray(h))for(let u of h)a(u);else if(h instanceof yt){if(h.length!=e)throw new RangeError(`Mismatched change set length (got ${h.length}, expected ${e})`);o(),d=d?d.compose(h.map(d)):h}else{let{from:u,to:m=u,insert:r}=h;if(u>m||u<0||m>e)throw new RangeError(`Invalid change range ${u} to ${m} (in doc of length ${e})`);let b=r?typeof r=="string"?$.of(r.split(i||qn)):r:$.empty,Z=b.length;if(u==m&&Z==0)return;u<s&&o(),u>s&&Ht(n,u-s,-1),Ht(n,m-u,Z),Ke(c,n,b),s=m}}return a(t),o(!d),d}static empty(t){return new yt(t?[t,-1]:[],[])}static fromJSON(t){if(!Array.isArray(t))throw new RangeError("Invalid JSON representation of ChangeSet");let e=[],i=[];for(let n=0;n<t.length;n++){let c=t[n];if(typeof c=="number")e.push(c,-1);else{if(!Array.isArray(c)||typeof c[0]!="number"||c.some((s,d)=>d&&typeof s!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(c.length==1)e.push(c[0],0);else{for(;i.length<n;)i.push($.empty);i[n]=$.of(c.slice(1)),e.push(c[0],i[n].length)}}}return new yt(e,i)}static createSet(t,e){return new yt(t,e)}}function Ht(l,t,e,i=!1){if(t==0&&e<=0)return;let n=l.length-2;n>=0&&e<=0&&e==l[n+1]?l[n]+=t:t==0&&l[n]==0?l[n+1]+=e:i?(l[n]+=t,l[n+1]+=e):l.push(t,e)}function Ke(l,t,e){if(e.length==0)return;let i=t.length-2>>1;if(i<l.length)l[l.length-1]=l[l.length-1].append(e);else{for(;l.length<i;)l.push($.empty);l.push(e)}}function _n(l,t,e){let i=l.inserted;for(let n=0,c=0,s=0;s<l.sections.length;){let d=l.sections[s++],o=l.sections[s++];if(o<0)n+=d,c+=d;else{let a=n,h=c,u=$.empty;for(;a+=d,h+=o,o&&i&&(u=u.append(i[s-2>>1])),!(e||s==l.sections.length||l.sections[s+1]<0);)d=l.sections[s++],o=l.sections[s++];t(n,a,c,h,u),n=a,c=h}}}function $n(l,t,e,i=!1){let n=[],c=i?[]:null,s=new Al(l),d=new Al(t);for(let o=-1;;)if(s.ins==-1&&d.ins==-1){let a=Math.min(s.len,d.len);Ht(n,a,-1),s.forward(a),d.forward(a)}else if(d.ins>=0&&(s.ins<0||o==s.i||s.off==0&&(d.len<s.len||d.len==s.len&&!e))){let a=d.len;for(Ht(n,d.ins,-1);a;){let h=Math.min(s.len,a);s.ins>=0&&o<s.i&&s.len<=h&&(Ht(n,0,s.ins),c&&Ke(c,n,s.text),o=s.i),s.forward(h),a-=h}d.next()}else if(s.ins>=0){let a=0,h=s.len;for(;h;)if(d.ins==-1){let u=Math.min(h,d.len);a+=u,h-=u,d.forward(u)}else if(d.ins==0&&d.len<h)h-=d.len,d.next();else break;Ht(n,a,o<s.i?s.ins:0),c&&o<s.i&&Ke(c,n,s.text),o=s.i,s.forward(s.len-h)}else{if(s.done&&d.done)return c?yt.createSet(n,c):re.create(n);throw new Error("Mismatched change set lengths")}}function hd(l,t,e=!1){let i=[],n=e?[]:null,c=new Al(l),s=new Al(t);for(let d=!1;;){if(c.done&&s.done)return n?yt.createSet(i,n):re.create(i);if(c.ins==0)Ht(i,c.len,0,d),c.next();else if(s.len==0&&!s.done)Ht(i,0,s.ins,d),n&&Ke(n,i,s.text),s.next();else{if(c.done||s.done)throw new Error("Mismatched change set lengths");{let o=Math.min(c.len2,s.len),a=i.length;if(c.ins==-1){let h=s.ins==-1?-1:s.off?0:s.ins;Ht(i,o,h,d),n&&h&&Ke(n,i,s.text)}else s.ins==-1?(Ht(i,c.off?0:c.len,o,d),n&&Ke(n,i,c.textBit(o))):(Ht(i,c.off?0:c.len,s.off?0:s.ins,d),n&&!s.off&&Ke(n,i,s.text));d=(c.ins>o||s.ins>=0&&s.len>o)&&(d||i.length>a),c.forward2(o),s.forward(o)}}}}class Al{constructor(t){this.set=t,this.i=0,this.next()}next(){let{sections:t}=this.set;this.i<t.length?(this.len=t[this.i++],this.ins=t[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:t}=this.set,e=this.i-2>>1;return e>=t.length?$.empty:t[e]}textBit(t){let{inserted:e}=this.set,i=this.i-2>>1;return i>=e.length&&!t?$.empty:e[i].slice(this.off,t==null?void 0:this.off+t)}forward(t){t==this.len?this.next():(this.len-=t,this.off+=t)}forward2(t){this.ins==-1?this.forward(t):t==this.ins?this.next():(this.ins-=t,this.off+=t)}}class qe{constructor(t,e,i){this.from=t,this.to=e,this.flags=i}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let t=this.flags&3;return t==3?null:t}get goalColumn(){let t=this.flags>>5;return t==33554431?void 0:t}map(t,e=-1){let i,n;return this.empty?i=n=t.mapPos(this.from,e):(i=t.mapPos(this.from,1),n=t.mapPos(this.to,-1)),i==this.from&&n==this.to?this:new qe(i,n,this.flags)}extend(t,e=t){if(t<=this.anchor&&e>=this.anchor)return y.range(t,e);let i=Math.abs(t-this.anchor)>Math.abs(e-this.anchor)?t:e;return y.range(this.anchor,i)}eq(t){return this.anchor==t.anchor&&this.head==t.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(t){if(!t||typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return y.range(t.anchor,t.head)}static create(t,e,i){return new qe(t,e,i)}}class y{constructor(t,e){this.ranges=t,this.mainIndex=e}map(t,e=-1){return t.empty?this:y.create(this.ranges.map(i=>i.map(t,e)),this.mainIndex)}eq(t){if(this.ranges.length!=t.ranges.length||this.mainIndex!=t.mainIndex)return!1;for(let e=0;e<this.ranges.length;e++)if(!this.ranges[e].eq(t.ranges[e]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new y([this.main],0)}addRange(t,e=!0){return y.create([t].concat(this.ranges),e?0:this.mainIndex+1)}replaceRange(t,e=this.mainIndex){let i=this.ranges.slice();return i[e]=t,y.create(i,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(t=>t.toJSON()),main:this.mainIndex}}static fromJSON(t){if(!t||!Array.isArray(t.ranges)||typeof t.main!="number"||t.main>=t.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new y(t.ranges.map(e=>qe.fromJSON(e)),t.main)}static single(t,e=t){return new y([y.range(t,e)],0)}static create(t,e=0){if(t.length==0)throw new RangeError("A selection needs at least one range");for(let i=0,n=0;n<t.length;n++){let c=t[n];if(c.empty?c.from<=i:c.from<i)return y.normalized(t.slice(),e);i=c.to}return new y(t,e)}static cursor(t,e=0,i,n){return qe.create(t,t,(e==0?0:e<0?4:8)|(i==null?3:Math.min(2,i))|(n!=null?n:33554431)<<5)}static range(t,e,i){let n=(i!=null?i:33554431)<<5;return e<t?qe.create(e,t,16|n|8):qe.create(t,e,n|(e>t?4:0))}static normalized(t,e=0){let i=t[e];t.sort((n,c)=>n.from-c.from),e=t.indexOf(i);for(let n=1;n<t.length;n++){let c=t[n],s=t[n-1];if(c.empty?c.from<=s.to:c.from<s.to){let d=s.from,o=Math.max(c.to,s.to);n<=e&&e--,t.splice(--n,2,c.anchor>c.head?y.range(o,d):y.range(d,o))}}return new y(t,e)}}function ud(l,t){for(let e of l.ranges)if(e.to>t)throw new RangeError("Selection points outside of document")}let tc=0;class U{constructor(t,e,i,n,c){this.combine=t,this.compareInput=e,this.compare=i,this.isStatic=n,this.id=tc++,this.default=t([]),this.extensions=typeof c=="function"?c(this):c}static define(t={}){return new U(t.combine||(e=>e),t.compareInput||((e,i)=>e===i),t.compare||(t.combine?(e,i)=>e===i:ec),!!t.static,t.enables)}of(t){return new Ci([],this,0,t)}compute(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ci(t,this,1,e)}computeN(t,e){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ci(t,this,2,e)}from(t,e){return e||(e=i=>i),this.compute([t],i=>e(i.field(t)))}}function ec(l,t){return l==t||l.length==t.length&&l.every((e,i)=>e===t[i])}class Ci{constructor(t,e,i,n){this.dependencies=t,this.facet=e,this.type=i,this.value=n,this.id=tc++}dynamicSlot(t){var e;let i=this.value,n=this.facet.compareInput,c=this.id,s=t[c]>>1,d=this.type==2,o=!1,a=!1,h=[];for(let u of this.dependencies)u=="doc"?o=!0:u=="selection"?a=!0:(((e=t[u.id])!==null&&e!==void 0?e:1)&1)==0&&h.push(t[u.id]);return{create(u){return u.values[s]=i(u),1},update(u,m){if(o&&m.docChanged||a&&(m.docChanged||m.selection)||lc(u,h)){let r=i(u);if(d?!md(r,u.values[s],n):!n(r,u.values[s]))return u.values[s]=r,1}return 0},reconfigure:(u,m)=>{let r,b=m.config.address[c];if(b!=null){let Z=Si(m,b);if(this.dependencies.every(g=>g instanceof U?m.facet(g)===u.facet(g):g instanceof Gt?m.field(g,!1)==u.field(g,!1):!0)||(d?md(r=i(u),Z,n):n(r=i(u),Z)))return u.values[s]=Z,0}else r=i(u);return u.values[s]=r,1}}}}function md(l,t,e){if(l.length!=t.length)return!1;for(let i=0;i<l.length;i++)if(!e(l[i],t[i]))return!1;return!0}function lc(l,t){let e=!1;for(let i of t)zl(l,i)&1&&(e=!0);return e}function Wm(l,t,e){let i=e.map(o=>l[o.id]),n=e.map(o=>o.type),c=i.filter(o=>!(o&1)),s=l[t.id]>>1;function d(o){let a=[];for(let h=0;h<i.length;h++){let u=Si(o,i[h]);if(n[h]==2)for(let m of u)a.push(m);else a.push(u)}return t.combine(a)}return{create(o){for(let a of i)zl(o,a);return o.values[s]=d(o),1},update(o,a){if(!lc(o,c))return 0;let h=d(o);return t.compare(h,o.values[s])?0:(o.values[s]=h,1)},reconfigure(o,a){let h=lc(o,i),u=a.config.facets[t.id],m=a.facet(t);if(u&&!h&&ec(e,u))return o.values[s]=m,0;let r=d(o);return t.compare(r,m)?(o.values[s]=m,0):(o.values[s]=r,1)}}}const rd=U.define({static:!0});class Gt{constructor(t,e,i,n,c){this.id=t,this.createF=e,this.updateF=i,this.compareF=n,this.spec=c,this.provides=void 0}static define(t){let e=new Gt(tc++,t.create,t.update,t.compare||((i,n)=>i===n),t);return t.provide&&(e.provides=t.provide(e)),e}create(t){let e=t.facet(rd).find(i=>i.field==this);return((e==null?void 0:e.create)||this.createF)(t)}slot(t){let e=t[this.id]>>1;return{create:i=>(i.values[e]=this.create(i),1),update:(i,n)=>{let c=i.values[e],s=this.updateF(c,n);return this.compareF(c,s)?0:(i.values[e]=s,1)},reconfigure:(i,n)=>n.config.address[this.id]!=null?(i.values[e]=n.field(this),0):(i.values[e]=this.create(i),1)}}init(t){return[this,rd.of({field:this,create:t})]}get extension(){return this}}const _e={lowest:4,low:3,default:2,high:1,highest:0};function Nl(l){return t=>new bd(t,l)}const $e={highest:Nl(_e.highest),high:Nl(_e.high),default:Nl(_e.default),low:Nl(_e.low),lowest:Nl(_e.lowest)};class bd{constructor(t,e){this.inner=t,this.prec=e}}class tl{of(t){return new ic(this,t)}reconfigure(t){return tl.reconfigure.of({compartment:this,extension:t})}get(t){return t.config.compartments.get(this)}}class ic{constructor(t,e){this.compartment=t,this.inner=e}}class Yi{constructor(t,e,i,n,c,s){for(this.base=t,this.compartments=e,this.dynamicSlots=i,this.address=n,this.staticValues=c,this.facets=s,this.statusTemplate=[];this.statusTemplate.length<i.length;)this.statusTemplate.push(0)}staticFacet(t){let e=this.address[t.id];return e==null?t.default:this.staticValues[e>>1]}static resolve(t,e,i){let n=[],c=Object.create(null),s=new Map;for(let m of Xm(t,e,s))m instanceof Gt?n.push(m):(c[m.facet.id]||(c[m.facet.id]=[])).push(m);let d=Object.create(null),o=[],a=[];for(let m of n)d[m.id]=a.length<<1,a.push(r=>m.slot(r));let h=i==null?void 0:i.config.facets;for(let m in c){let r=c[m],b=r[0].facet,Z=h&&h[m]||[];if(r.every(g=>g.type==0))if(d[b.id]=o.length<<1|1,ec(Z,r))o.push(i.facet(b));else{let g=b.combine(r.map(p=>p.value));o.push(i&&b.compare(g,i.facet(b))?i.facet(b):g)}else{for(let g of r)g.type==0?(d[g.id]=o.length<<1|1,o.push(g.value)):(d[g.id]=a.length<<1,a.push(p=>g.dynamicSlot(p)));d[b.id]=a.length<<1,a.push(g=>Wm(g,b,r))}}let u=a.map(m=>m(d));return new Yi(t,s,u,d,o,c)}}function Xm(l,t,e){let i=[[],[],[],[],[]],n=new Map;function c(s,d){let o=n.get(s);if(o!=null){if(o<=d)return;let a=i[o].indexOf(s);a>-1&&i[o].splice(a,1),s instanceof ic&&e.delete(s.compartment)}if(n.set(s,d),Array.isArray(s))for(let a of s)c(a,d);else if(s instanceof ic){if(e.has(s.compartment))throw new RangeError("Duplicate use of compartment in extensions");let a=t.get(s.compartment)||s.inner;e.set(s.compartment,a),c(a,d)}else if(s instanceof bd)c(s.inner,s.prec);else if(s instanceof Gt)i[d].push(s),s.provides&&c(s.provides,d);else if(s instanceof Ci)i[d].push(s),s.facet.extensions&&c(s.facet.extensions,_e.default);else{let a=s.extension;if(!a)throw new Error(`Unrecognized extension value in extension set (${s}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);c(a,d)}}return c(l,_e.default),i.reduce((s,d)=>s.concat(d))}function zl(l,t){if(t&1)return 2;let e=t>>1,i=l.status[e];if(i==4)throw new Error("Cyclic dependency between fields and/or facets");if(i&2)return i;l.status[e]=4;let n=l.computeSlot(l,l.config.dynamicSlots[e]);return l.status[e]=2|n}function Si(l,t){return t&1?l.config.staticValues[t>>1]:l.values[t>>1]}const Zd=U.define(),gd=U.define({combine:l=>l.some(t=>t),static:!0}),pd=U.define({combine:l=>l.length?l[0]:void 0,static:!0}),Gd=U.define(),Wd=U.define(),Xd=U.define(),Id=U.define({combine:l=>l.length?l[0]:!1});class He{constructor(t,e){this.type=t,this.value=e}static define(){return new Im}}class Im{of(t){return new He(this,t)}}class Vm{constructor(t){this.map=t}of(t){return new P(this,t)}}class P{constructor(t,e){this.type=t,this.value=e}map(t){let e=this.type.map(this.value,t);return e===void 0?void 0:e==this.value?this:new P(this.type,e)}is(t){return this.type==t}static define(t={}){return new Vm(t.map||(e=>e))}static mapEffects(t,e){if(!t.length)return t;let i=[];for(let n of t){let c=n.map(e);c&&i.push(c)}return i}}P.reconfigure=P.define(),P.appendConfig=P.define();class Wt{constructor(t,e,i,n,c,s){this.startState=t,this.changes=e,this.selection=i,this.effects=n,this.annotations=c,this.scrollIntoView=s,this._doc=null,this._state=null,i&&ud(i,e.newLength),c.some(d=>d.type==Wt.time)||(this.annotations=c.concat(Wt.time.of(Date.now())))}static create(t,e,i,n,c,s){return new Wt(t,e,i,n,c,s)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(t){for(let e of this.annotations)if(e.type==t)return e.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(t){let e=this.annotation(Wt.userEvent);return!!(e&&(e==t||e.length>t.length&&e.slice(0,t.length)==t&&e[t.length]=="."))}}Wt.time=He.define(),Wt.userEvent=He.define(),Wt.addToHistory=He.define(),Wt.remote=He.define();function ym(l,t){let e=[];for(let i=0,n=0;;){let c,s;if(i<l.length&&(n==t.length||t[n]>=l[i]))c=l[i++],s=l[i++];else if(n<t.length)c=t[n++],s=t[n++];else return e;!e.length||e[e.length-1]<c?e.push(c,s):e[e.length-1]<s&&(e[e.length-1]=s)}}function Vd(l,t,e){var i;let n,c,s;return e?(n=t.changes,c=yt.empty(t.changes.length),s=l.changes.compose(t.changes)):(n=t.changes.map(l.changes),c=l.changes.mapDesc(t.changes,!0),s=l.changes.compose(n)),{changes:s,selection:t.selection?t.selection.map(c):(i=l.selection)===null||i===void 0?void 0:i.map(n),effects:P.mapEffects(l.effects,n).concat(P.mapEffects(t.effects,c)),annotations:l.annotations.length?l.annotations.concat(t.annotations):t.annotations,scrollIntoView:l.scrollIntoView||t.scrollIntoView}}function nc(l,t,e){let i=t.selection,n=Zl(t.annotations);return t.userEvent&&(n=n.concat(Wt.userEvent.of(t.userEvent))),{changes:t.changes instanceof yt?t.changes:yt.of(t.changes||[],e,l.facet(pd)),selection:i&&(i instanceof y?i:y.single(i.anchor,i.head)),effects:Zl(t.effects),annotations:n,scrollIntoView:!!t.scrollIntoView}}function yd(l,t,e){let i=nc(l,t.length?t[0]:{},l.doc.length);t.length&&t[0].filter===!1&&(e=!1);for(let c=1;c<t.length;c++){t[c].filter===!1&&(e=!1);let s=!!t[c].sequential;i=Vd(i,nc(l,t[c],s?i.changes.newLength:l.doc.length),s)}let n=Wt.create(l,i.changes,i.selection,i.effects,i.annotations,i.scrollIntoView);return fm(e?Rm(n):n)}function Rm(l){let t=l.startState,e=!0;for(let n of t.facet(Gd)){let c=n(l);if(c===!1){e=!1;break}Array.isArray(c)&&(e=e===!0?c:ym(e,c))}if(e!==!0){let n,c;if(e===!1)c=l.changes.invertedDesc,n=yt.empty(t.doc.length);else{let s=l.changes.filter(e);n=s.changes,c=s.filtered.mapDesc(s.changes).invertedDesc}l=Wt.create(t,n,l.selection&&l.selection.map(c),P.mapEffects(l.effects,c),l.annotations,l.scrollIntoView)}let i=t.facet(Wd);for(let n=i.length-1;n>=0;n--){let c=i[n](l);c instanceof Wt?l=c:Array.isArray(c)&&c.length==1&&c[0]instanceof Wt?l=c[0]:l=yd(t,Zl(c),!1)}return l}function fm(l){let t=l.startState,e=t.facet(Xd),i=l;for(let n=e.length-1;n>=0;n--){let c=e[n](l);c&&Object.keys(c).length&&(i=Vd(i,nc(t,c,l.changes.newLength),!0))}return i==l?l:Wt.create(t,l.changes,l.selection,i.effects,i.annotations,i.scrollIntoView)}const Cm=[];function Zl(l){return l==null?Cm:Array.isArray(l)?l:[l]}var at=function(l){return l[l.Word=0]="Word",l[l.Space=1]="Space",l[l.Other=2]="Other",l}(at||(at={}));const Ym=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let cc;try{cc=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Sm(l){if(cc)return cc.test(l);for(let t=0;t<l.length;t++){let e=l[t];if(/\w/.test(e)||e>"\x80"&&(e.toUpperCase()!=e.toLowerCase()||Ym.test(e)))return!0}return!1}function Lm(l){return t=>{if(!/\S/.test(t))return at.Space;if(Sm(t))return at.Word;for(let e=0;e<l.length;e++)if(t.indexOf(l[e])>-1)return at.Word;return at.Other}}class O{constructor(t,e,i,n,c,s){this.config=t,this.doc=e,this.selection=i,this.values=n,this.status=t.statusTemplate.slice(),this.computeSlot=c,s&&(s._state=this);for(let d=0;d<this.config.dynamicSlots.length;d++)zl(this,d<<1);this.computeSlot=null}field(t,e=!0){let i=this.config.address[t.id];if(i==null){if(e)throw new RangeError("Field is not present in this state");return}return zl(this,i),Si(this,i)}update(...t){return yd(this,t,!0)}applyTransaction(t){let e=this.config,{base:i,compartments:n}=e;for(let s of t.effects)s.is(tl.reconfigure)?(e&&(n=new Map,e.compartments.forEach((d,o)=>n.set(o,d)),e=null),n.set(s.value.compartment,s.value.extension)):s.is(P.reconfigure)?(e=null,i=s.value):s.is(P.appendConfig)&&(e=null,i=Zl(i).concat(s.value));let c;e?c=t.startState.values.slice():(e=Yi.resolve(i,n,this),c=new O(e,this.doc,this.selection,e.dynamicSlots.map(()=>null),(d,o)=>o.reconfigure(d,this),null).values),new O(e,t.newDoc,t.newSelection,c,(s,d)=>d.update(s,t),t)}replaceSelection(t){return typeof t=="string"&&(t=this.toText(t)),this.changeByRange(e=>({changes:{from:e.from,to:e.to,insert:t},range:y.cursor(e.from+t.length)}))}changeByRange(t){let e=this.selection,i=t(e.ranges[0]),n=this.changes(i.changes),c=[i.range],s=Zl(i.effects);for(let d=1;d<e.ranges.length;d++){let o=t(e.ranges[d]),a=this.changes(o.changes),h=a.map(n);for(let m=0;m<d;m++)c[m]=c[m].map(h);let u=n.mapDesc(a,!0);c.push(o.range.map(u)),n=n.compose(h),s=P.mapEffects(s,h).concat(P.mapEffects(Zl(o.effects),u))}return{changes:n,selection:y.create(c,e.mainIndex),effects:s}}changes(t=[]){return t instanceof yt?t:yt.of(t,this.doc.length,this.facet(O.lineSeparator))}toText(t){return $.of(t.split(this.facet(O.lineSeparator)||qn))}sliceDoc(t=0,e=this.doc.length){return this.doc.sliceString(t,e,this.lineBreak)}facet(t){let e=this.config.address[t.id];return e==null?t.default:(zl(this,e),Si(this,e))}toJSON(t){let e={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(t)for(let i in t){let n=t[i];n instanceof Gt&&this.config.address[n.id]!=null&&(e[i]=n.spec.toJSON(this.field(t[i]),this))}return e}static fromJSON(t,e={},i){if(!t||typeof t.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let n=[];if(i){for(let c in i)if(Object.prototype.hasOwnProperty.call(t,c)){let s=i[c],d=t[c];n.push(s.init(o=>s.spec.fromJSON(d,o)))}}return O.create({doc:t.doc,selection:y.fromJSON(t.selection),extensions:e.extensions?n.concat([e.extensions]):n})}static create(t={}){let e=Yi.resolve(t.extensions||[],new Map),i=t.doc instanceof $?t.doc:$.of((t.doc||"").split(e.staticFacet(O.lineSeparator)||qn)),n=t.selection?t.selection instanceof y?t.selection:y.single(t.selection.anchor,t.selection.head):y.single(0);return ud(n,i.length),e.staticFacet(gd)||(n=n.asSingle()),new O(e,i,n,e.dynamicSlots.map(()=>null),(c,s)=>s.create(c),null)}get tabSize(){return this.facet(O.tabSize)}get lineBreak(){return this.facet(O.lineSeparator)||`
`}get readOnly(){return this.facet(Id)}phrase(t,...e){for(let i of this.facet(O.phrases))if(Object.prototype.hasOwnProperty.call(i,t)){t=i[t];break}return e.length&&(t=t.replace(/\$(\$|\d*)/g,(i,n)=>{if(n=="$")return"$";let c=+(n||1);return!c||c>e.length?i:e[c-1]})),t}languageDataAt(t,e,i=-1){let n=[];for(let c of this.facet(Zd))for(let s of c(this,e,i))Object.prototype.hasOwnProperty.call(s,t)&&n.push(s[t]);return n}charCategorizer(t){return Lm(this.languageDataAt("wordChars",t).join(""))}wordAt(t){let{text:e,from:i,length:n}=this.doc.lineAt(t),c=this.charCategorizer(t),s=t-i,d=t-i;for(;s>0;){let o=Ut(e,s,!1);if(c(e.slice(o,s))!=at.Word)break;s=o}for(;d<n;){let o=Ut(e,d);if(c(e.slice(d,o))!=at.Word)break;d=o}return s==d?null:y.range(s+i,d+i)}}O.allowMultipleSelections=gd,O.tabSize=U.define({combine:l=>l.length?l[0]:4}),O.lineSeparator=pd,O.readOnly=Id,O.phrases=U.define({compare(l,t){let e=Object.keys(l),i=Object.keys(t);return e.length==i.length&&e.every(n=>l[n]==t[n])}}),O.languageData=Zd,O.changeFilter=Gd,O.transactionFilter=Wd,O.transactionExtender=Xd,tl.reconfigure=P.define();function be(l,t,e={}){let i={};for(let n of l)for(let c of Object.keys(n)){let s=n[c],d=i[c];if(d===void 0)i[c]=s;else if(!(d===s||s===void 0))if(Object.hasOwnProperty.call(e,c))i[c]=e[c](d,s);else throw new Error("Config merge conflict for field "+c)}for(let n in t)i[n]===void 0&&(i[n]=t[n]);return i}class el{eq(t){return this==t}range(t,e=t){return Tl.create(t,e,this)}}el.prototype.startSide=el.prototype.endSide=0,el.prototype.point=!1,el.prototype.mapMode=At.TrackDel;class Tl{constructor(t,e,i){this.from=t,this.to=e,this.value=i}static create(t,e,i){return new Tl(t,e,i)}}function sc(l,t){return l.from-t.from||l.value.startSide-t.value.startSide}class dc{constructor(t,e,i,n){this.from=t,this.to=e,this.value=i,this.maxPoint=n}get length(){return this.to[this.to.length-1]}findIndex(t,e,i,n=0){let c=i?this.to:this.from;for(let s=n,d=c.length;;){if(s==d)return s;let o=s+d>>1,a=c[o]-t||(i?this.value[o].endSide:this.value[o].startSide)-e;if(o==s)return a>=0?s:d;a>=0?d=o:s=o+1}}between(t,e,i,n){for(let c=this.findIndex(e,-1e9,!0),s=this.findIndex(i,1e9,!1,c);c<s;c++)if(n(this.from[c]+t,this.to[c]+t,this.value[c])===!1)return!1}map(t,e){let i=[],n=[],c=[],s=-1,d=-1;for(let o=0;o<this.value.length;o++){let a=this.value[o],h=this.from[o]+t,u=this.to[o]+t,m,r;if(h==u){let b=e.mapPos(h,a.startSide,a.mapMode);if(b==null||(m=r=b,a.startSide!=a.endSide&&(r=e.mapPos(h,a.endSide),r<m)))continue}else if(m=e.mapPos(h,a.startSide),r=e.mapPos(u,a.endSide),m>r||m==r&&a.startSide>0&&a.endSide<=0)continue;(r-m||a.endSide-a.startSide)<0||(s<0&&(s=m),a.point&&(d=Math.max(d,r-m)),i.push(a),n.push(m-s),c.push(r-s))}return{mapped:i.length?new dc(n,c,i,d):null,pos:s}}}class lt{constructor(t,e,i,n){this.chunkPos=t,this.chunk=e,this.nextLayer=i,this.maxPoint=n}static create(t,e,i,n){return new lt(t,e,i,n)}get length(){let t=this.chunk.length-1;return t<0?0:Math.max(this.chunkEnd(t),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let t=this.nextLayer.size;for(let e of this.chunk)t+=e.value.length;return t}chunkEnd(t){return this.chunkPos[t]+this.chunk[t].length}update(t){let{add:e=[],sort:i=!1,filterFrom:n=0,filterTo:c=this.length}=t,s=t.filter;if(e.length==0&&!s)return this;if(i&&(e=e.slice().sort(sc)),this.isEmpty)return e.length?lt.of(e):this;let d=new fd(this,null,-1).goto(0),o=0,a=[],h=new Be;for(;d.value||o<e.length;)if(o<e.length&&(d.from-e[o].from||d.startSide-e[o].value.startSide)>=0){let u=e[o++];h.addInner(u.from,u.to,u.value)||a.push(u)}else d.rangeIndex==1&&d.chunkIndex<this.chunk.length&&(o==e.length||this.chunkEnd(d.chunkIndex)<e[o].from)&&(!s||n>this.chunkEnd(d.chunkIndex)||c<this.chunkPos[d.chunkIndex])&&h.addChunk(this.chunkPos[d.chunkIndex],this.chunk[d.chunkIndex])?d.nextChunk():((!s||n>d.to||c<d.from||s(d.from,d.to,d.value))&&(h.addInner(d.from,d.to,d.value)||a.push(Tl.create(d.from,d.to,d.value))),d.next());return h.finishInner(this.nextLayer.isEmpty&&!a.length?lt.empty:this.nextLayer.update({add:a,filter:s,filterFrom:n,filterTo:c}))}map(t){if(t.empty||this.isEmpty)return this;let e=[],i=[],n=-1;for(let s=0;s<this.chunk.length;s++){let d=this.chunkPos[s],o=this.chunk[s],a=t.touchesRange(d,d+o.length);if(a===!1)n=Math.max(n,o.maxPoint),e.push(o),i.push(t.mapPos(d));else if(a===!0){let{mapped:h,pos:u}=o.map(d,t);h&&(n=Math.max(n,h.maxPoint),e.push(h),i.push(u))}}let c=this.nextLayer.map(t);return e.length==0?c:new lt(i,e,c||lt.empty,n)}between(t,e,i){if(!this.isEmpty){for(let n=0;n<this.chunk.length;n++){let c=this.chunkPos[n],s=this.chunk[n];if(e>=c&&t<=c+s.length&&s.between(c,t-c,e-c,i)===!1)return}this.nextLayer.between(t,e,i)}}iter(t=0){return Ml.from([this]).goto(t)}get isEmpty(){return this.nextLayer==this}static iter(t,e=0){return Ml.from(t).goto(e)}static compare(t,e,i,n,c=-1){let s=t.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=c),d=e.filter(u=>u.maxPoint>0||!u.isEmpty&&u.maxPoint>=c),o=Rd(s,d,i),a=new Pl(s,o,c),h=new Pl(d,o,c);i.iterGaps((u,m,r)=>Cd(a,u,h,m,r,n)),i.empty&&i.length==0&&Cd(a,0,h,0,0,n)}static eq(t,e,i=0,n){n==null&&(n=1e9-1);let c=t.filter(h=>!h.isEmpty&&e.indexOf(h)<0),s=e.filter(h=>!h.isEmpty&&t.indexOf(h)<0);if(c.length!=s.length)return!1;if(!c.length)return!0;let d=Rd(c,s),o=new Pl(c,d,0).goto(i),a=new Pl(s,d,0).goto(i);for(;;){if(o.to!=a.to||!ac(o.active,a.active)||o.point&&(!a.point||!o.point.eq(a.point)))return!1;if(o.to>n)return!0;o.next(),a.next()}}static spans(t,e,i,n,c=-1){let s=new Pl(t,null,c).goto(e),d=e,o=s.openStart;for(;;){let a=Math.min(s.to,i);if(s.point){let h=s.activeForPoint(s.to),u=s.pointFrom<e?h.length+1:Math.min(h.length,o);n.point(d,a,s.point,h,u,s.pointRank),o=Math.min(s.openEnd(a),h.length)}else a>d&&(n.span(d,a,s.active,o),o=s.openEnd(a));if(s.to>i)return o+(s.point&&s.to>i?1:0);d=s.to,s.next()}}static of(t,e=!1){let i=new Be;for(let n of t instanceof Tl?[t]:e?Jm(t):t)i.add(n.from,n.to,n.value);return i.finish()}}lt.empty=new lt([],[],null,-1);function Jm(l){if(l.length>1)for(let t=l[0],e=1;e<l.length;e++){let i=l[e];if(sc(t,i)>0)return l.slice().sort(sc);t=i}return l}lt.empty.nextLayer=lt.empty;class Be{constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}finishChunk(t){this.chunks.push(new dc(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,t&&(this.from=[],this.to=[],this.value=[])}add(t,e,i){this.addInner(t,e,i)||(this.nextLayer||(this.nextLayer=new Be)).add(t,e,i)}addInner(t,e,i){let n=t-this.lastTo||i.startSide-this.last.endSide;if(n<=0&&(t-this.lastFrom||i.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return n<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=t),this.from.push(t-this.chunkStart),this.to.push(e-this.chunkStart),this.last=i,this.lastFrom=t,this.lastTo=e,this.value.push(i),i.point&&(this.maxPoint=Math.max(this.maxPoint,e-t)),!0)}addChunk(t,e){if((t-this.lastTo||e.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,e.maxPoint),this.chunks.push(e),this.chunkPos.push(t);let i=e.value.length-1;return this.last=e.value[i],this.lastFrom=e.from[i]+t,this.lastTo=e.to[i]+t,!0}finish(){return this.finishInner(lt.empty)}finishInner(t){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return t;let e=lt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(t):t,this.setMaxPoint);return this.from=null,e}}function Rd(l,t,e){let i=new Map;for(let c of l)for(let s=0;s<c.chunk.length;s++)c.chunk[s].maxPoint<=0&&i.set(c.chunk[s],c.chunkPos[s]);let n=new Set;for(let c of t)for(let s=0;s<c.chunk.length;s++){let d=i.get(c.chunk[s]);d!=null&&(e?e.mapPos(d):d)==c.chunkPos[s]&&!(e!=null&&e.touchesRange(d,d+c.chunk[s].length))&&n.add(c.chunk[s])}return n}class fd{constructor(t,e,i,n=0){this.layer=t,this.skip=e,this.minPoint=i,this.rank=n}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(t,e=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(t,e,!1),this}gotoInner(t,e,i){for(;this.chunkIndex<this.layer.chunk.length;){let n=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(n)||this.layer.chunkEnd(this.chunkIndex)<t||n.maxPoint<this.minPoint))break;this.chunkIndex++,i=!1}if(this.chunkIndex<this.layer.chunk.length){let n=this.layer.chunk[this.chunkIndex].findIndex(t-this.layer.chunkPos[this.chunkIndex],e,!0);(!i||this.rangeIndex<n)&&this.setRangeIndex(n)}this.next()}forward(t,e){(this.to-t||this.endSide-e)<0&&this.gotoInner(t,e,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let t=this.layer.chunkPos[this.chunkIndex],e=this.layer.chunk[this.chunkIndex],i=t+e.from[this.rangeIndex];if(this.from=i,this.to=t+e.to[this.rangeIndex],this.value=e.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(t){if(t==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=t}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(t){return this.from-t.from||this.startSide-t.startSide||this.rank-t.rank||this.to-t.to||this.endSide-t.endSide}}class Ml{constructor(t){this.heap=t}static from(t,e=null,i=-1){let n=[];for(let c=0;c<t.length;c++)for(let s=t[c];!s.isEmpty;s=s.nextLayer)s.maxPoint>=i&&n.push(new fd(s,e,i,c));return n.length==1?n[0]:new Ml(n)}get startSide(){return this.value?this.value.startSide:0}goto(t,e=-1e9){for(let i of this.heap)i.goto(t,e);for(let i=this.heap.length>>1;i>=0;i--)oc(this.heap,i);return this.next(),this}forward(t,e){for(let i of this.heap)i.forward(t,e);for(let i=this.heap.length>>1;i>=0;i--)oc(this.heap,i);(this.to-t||this.value.endSide-e)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let t=this.heap[0];this.from=t.from,this.to=t.to,this.value=t.value,this.rank=t.rank,t.value&&t.next(),oc(this.heap,0)}}}function oc(l,t){for(let e=l[t];;){let i=(t<<1)+1;if(i>=l.length)break;let n=l[i];if(i+1<l.length&&n.compare(l[i+1])>=0&&(n=l[i+1],i++),e.compare(n)<0)break;l[i]=e,l[t]=n,t=i}}class Pl{constructor(t,e,i){this.minPoint=i,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Ml.from(t,e,i)}goto(t,e=-1e9){return this.cursor.goto(t,e),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=t,this.endSide=e,this.openStart=-1,this.next(),this}forward(t,e){for(;this.minActive>-1&&(this.activeTo[this.minActive]-t||this.active[this.minActive].endSide-e)<0;)this.removeActive(this.minActive);this.cursor.forward(t,e)}removeActive(t){Li(this.active,t),Li(this.activeTo,t),Li(this.activeRank,t),this.minActive=Yd(this.active,this.activeTo)}addActive(t){let e=0,{value:i,to:n,rank:c}=this.cursor;for(;e<this.activeRank.length&&this.activeRank[e]<=c;)e++;Ji(this.active,e,i),Ji(this.activeTo,e,n),Ji(this.activeRank,e,c),t&&Ji(t,e,this.cursor.from),this.minActive=Yd(this.active,this.activeTo)}next(){let t=this.to,e=this.point;this.point=null;let i=this.openStart<0?[]:null;for(;;){let n=this.minActive;if(n>-1&&(this.activeTo[n]-this.cursor.from||this.active[n].endSide-this.cursor.startSide)<0){if(this.activeTo[n]>t){this.to=this.activeTo[n],this.endSide=this.active[n].endSide;break}this.removeActive(n),i&&Li(i,n)}else if(this.cursor.value)if(this.cursor.from>t){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let c=this.cursor.value;if(!c.point)this.addActive(i),this.cursor.next();else if(e&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=c,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=c.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(i){this.openStart=0;for(let n=i.length-1;n>=0&&i[n]<t;n--)this.openStart++}}activeForPoint(t){if(!this.active.length)return this.active;let e=[];for(let i=this.active.length-1;i>=0&&!(this.activeRank[i]<this.pointRank);i--)(this.activeTo[i]>t||this.activeTo[i]==t&&this.active[i].endSide>=this.point.endSide)&&e.push(this.active[i]);return e.reverse()}openEnd(t){let e=0;for(let i=this.activeTo.length-1;i>=0&&this.activeTo[i]>t;i--)e++;return e}}function Cd(l,t,e,i,n,c){l.goto(t),e.goto(i);let s=i+n,d=i,o=i-t;for(;;){let a=l.to+o-e.to||l.endSide-e.endSide,h=a<0?l.to+o:e.to,u=Math.min(h,s);if(l.point||e.point?l.point&&e.point&&(l.point==e.point||l.point.eq(e.point))&&ac(l.activeForPoint(l.to+o),e.activeForPoint(e.to))||c.comparePoint(d,u,l.point,e.point):u>d&&!ac(l.active,e.active)&&c.compareRange(d,u,l.active,e.active),h>s)break;d=h,a<=0&&l.next(),a>=0&&e.next()}}function ac(l,t){if(l.length!=t.length)return!1;for(let e=0;e<l.length;e++)if(l[e]!=t[e]&&!l[e].eq(t[e]))return!1;return!0}function Li(l,t){for(let e=t,i=l.length-1;e<i;e++)l[e]=l[e+1];l.pop()}function Ji(l,t,e){for(let i=l.length-1;i>=t;i--)l[i+1]=l[i];l[t]=e}function Yd(l,t){let e=-1,i=1e9;for(let n=0;n<t.length;n++)(t[n]-i||l[n].endSide-l[e].endSide)<0&&(e=n,i=t[n]);return e}function El(l,t,e=l.length){let i=0;for(let n=0;n<e;)l.charCodeAt(n)==9?(i+=t-i%t,n++):(i++,n=Ut(l,n));return i}function hc(l,t,e,i){for(let n=0,c=0;;){if(c>=t)return n;if(n==l.length)break;c+=l.charCodeAt(n)==9?e-c%e:1,n=Ut(l,n)}return i===!0?-1:l.length}const uc="\u037C",Sd=typeof Symbol>"u"?"__"+uc:Symbol.for(uc),mc=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),Ld=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class ke{constructor(t,e){this.rules=[];let{finish:i}=e||{};function n(s){return/^@/.test(s)?[s]:s.split(/,\s*/)}function c(s,d,o,a){let h=[],u=/^@(\w+)\b/.exec(s[0]),m=u&&u[1]=="keyframes";if(u&&d==null)return o.push(s[0]+";");for(let r in d){let b=d[r];if(/&/.test(r))c(r.split(/,\s*/).map(Z=>s.map(g=>Z.replace(/&/,g))).reduce((Z,g)=>Z.concat(g)),b,o);else if(b&&typeof b=="object"){if(!u)throw new RangeError("The value of a property ("+r+") should be a primitive value.");c(n(r),b,h,m)}else b!=null&&h.push(r.replace(/_.*/,"").replace(/[A-Z]/g,Z=>"-"+Z.toLowerCase())+": "+b+";")}(h.length||m)&&o.push((i&&!u&&!a?s.map(i):s).join(", ")+" {"+h.join(" ")+"}")}for(let s in t)c(n(s),t[s],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let t=Ld[Sd]||1;return Ld[Sd]=t+1,uc+t.toString(36)}static mount(t,e){(t[mc]||new Fm(t)).mount(Array.isArray(e)?e:[e])}}let Fi=null;class Fm{constructor(t){if(!t.head&&t.adoptedStyleSheets&&typeof CSSStyleSheet<"u"){if(Fi)return t.adoptedStyleSheets=[Fi.sheet].concat(t.adoptedStyleSheets),t[mc]=Fi;this.sheet=new CSSStyleSheet,t.adoptedStyleSheets=[this.sheet].concat(t.adoptedStyleSheets),Fi=this}else{this.styleTag=(t.ownerDocument||t).createElement("style");let e=t.head||t;e.insertBefore(this.styleTag,e.firstChild)}this.modules=[],t[mc]=this}mount(t){let e=this.sheet,i=0,n=0;for(let c=0;c<t.length;c++){let s=t[c],d=this.modules.indexOf(s);if(d<n&&d>-1&&(this.modules.splice(d,1),n--,d=-1),d==-1){if(this.modules.splice(n++,0,s),e)for(let o=0;o<s.rules.length;o++)e.insertRule(s.rules[o],i++)}else{for(;n<d;)i+=this.modules[n++].rules.length;i+=s.rules.length,n++}}if(!e){let c="";for(let s=0;s<this.modules.length;s++)c+=this.modules[s].getRules()+`
`;this.styleTag.textContent=c}}}var xe={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},jl={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Jd=typeof navigator<"u"&&/Chrome\/(\d+)/.exec(navigator.userAgent);typeof navigator<"u"&&/Gecko\/\d+/.test(navigator.userAgent);for(var Km=typeof navigator<"u"&&/Mac/.test(navigator.platform),Hm=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Bm=Km||Jd&&+Jd[1]<57,St=0;St<10;St++)xe[48+St]=xe[96+St]=String(St);for(var St=1;St<=24;St++)xe[St+111]="F"+St;for(var St=65;St<=90;St++)xe[St]=String.fromCharCode(St+32),jl[St]=String.fromCharCode(St);for(var rc in xe)jl.hasOwnProperty(rc)||(jl[rc]=xe[rc]);function km(l){var t=Bm&&(l.ctrlKey||l.altKey||l.metaKey)||Hm&&l.shiftKey&&l.key&&l.key.length==1||l.key=="Unidentified",e=!t&&l.key||(l.shiftKey?jl:xe)[l.keyCode]||l.key||"Unidentified";return e=="Esc"&&(e="Escape"),e=="Del"&&(e="Delete"),e=="Left"&&(e="ArrowLeft"),e=="Up"&&(e="ArrowUp"),e=="Right"&&(e="ArrowRight"),e=="Down"&&(e="ArrowDown"),e}function Ki(l){let t;return l.nodeType==11?t=l.getSelection?l:l.ownerDocument:t=l,t.getSelection()}function gl(l,t){return t?l==t||l.contains(t.nodeType!=1?t.parentNode:t):!1}function xm(l){let t=l.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}function Hi(l,t){if(!t.anchorNode)return!1;try{return gl(l,t.anchorNode)}catch{return!1}}function Ql(l){return l.nodeType==3?Gl(l,0,l.nodeValue.length).getClientRects():l.nodeType==1?l.getClientRects():[]}function Bi(l,t,e,i){return e?Fd(l,t,e,i,-1)||Fd(l,t,e,i,1):!1}function ki(l){for(var t=0;;t++)if(l=l.previousSibling,!l)return t}function Fd(l,t,e,i,n){for(;;){if(l==e&&t==i)return!0;if(t==(n<0?0:Dl(l))){if(l.nodeName=="DIV")return!1;let c=l.parentNode;if(!c||c.nodeType!=1)return!1;t=ki(l)+(n<0?0:1),l=c}else if(l.nodeType==1){if(l=l.childNodes[t+(n<0?-1:0)],l.nodeType==1&&l.contentEditable=="false")return!1;t=n<0?Dl(l):0}else return!1}}function Dl(l){return l.nodeType==3?l.nodeValue.length:l.childNodes.length}const Kd={left:0,right:0,top:0,bottom:0};function bc(l,t){let e=t?l.left:l.right;return{left:e,right:e,top:l.top,bottom:l.bottom}}function wm(l){return{left:0,right:l.innerWidth,top:0,bottom:l.innerHeight}}function vm(l,t,e,i,n,c,s,d){let o=l.ownerDocument,a=o.defaultView||window;for(let h=l;h;)if(h.nodeType==1){let u,m=h==o.body;if(m)u=wm(a);else{if(h.scrollHeight<=h.clientHeight&&h.scrollWidth<=h.clientWidth){h=h.assignedSlot||h.parentNode;continue}let Z=h.getBoundingClientRect();u={left:Z.left,right:Z.left+h.clientWidth,top:Z.top,bottom:Z.top+h.clientHeight}}let r=0,b=0;if(n=="nearest")t.top<u.top?(b=-(u.top-t.top+s),e>0&&t.bottom>u.bottom+b&&(b=t.bottom-u.bottom+b+s)):t.bottom>u.bottom&&(b=t.bottom-u.bottom+s,e<0&&t.top-b<u.top&&(b=-(u.top+b-t.top+s)));else{let Z=t.bottom-t.top,g=u.bottom-u.top;b=(n=="center"&&Z<=g?t.top+Z/2-g/2:n=="start"||n=="center"&&e<0?t.top-s:t.bottom-g+s)-u.top}if(i=="nearest"?t.left<u.left?(r=-(u.left-t.left+c),e>0&&t.right>u.right+r&&(r=t.right-u.right+r+c)):t.right>u.right&&(r=t.right-u.right+c,e<0&&t.left<u.left+r&&(r=-(u.left+r-t.left+c))):r=(i=="center"?t.left+(t.right-t.left)/2-(u.right-u.left)/2:i=="start"==d?t.left-c:t.right-(u.right-u.left)+c)-u.left,r||b)if(m)a.scrollBy(r,b);else{let Z=0,g=0;if(b){let p=h.scrollTop;h.scrollTop+=b,g=h.scrollTop-p}if(r){let p=h.scrollLeft;h.scrollLeft+=r,Z=h.scrollLeft-p}t={left:t.left-Z,top:t.top-g,right:t.right-Z,bottom:t.bottom-g},Z&&Math.abs(Z-r)<1&&(i="nearest"),g&&Math.abs(g-b)<1&&(n="nearest")}if(m)break;h=h.assignedSlot||h.parentNode}else if(h.nodeType==11)h=h.host;else break}class Um{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){this.set(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset)}set(t,e,i,n){this.anchorNode=t,this.anchorOffset=e,this.focusNode=i,this.focusOffset=n}}let pl=null;function Hd(l){if(l.setActive)return l.setActive();if(pl)return l.focus(pl);let t=[];for(let e=l;e&&(t.push(e,e.scrollTop,e.scrollLeft),e!=e.ownerDocument);e=e.parentNode);if(l.focus(pl==null?{get preventScroll(){return pl={preventScroll:!0},!0}}:void 0),!pl){pl=!1;for(let e=0;e<t.length;){let i=t[e++],n=t[e++],c=t[e++];i.scrollTop!=n&&(i.scrollTop=n),i.scrollLeft!=c&&(i.scrollLeft=c)}}}let Bd;function Gl(l,t,e=t){let i=Bd||(Bd=document.createRange());return i.setEnd(l,e),i.setStart(l,t),i}function Wl(l,t,e){let i={key:t,code:t,keyCode:e,which:e,cancelable:!0},n=new KeyboardEvent("keydown",i);n.synthetic=!0,l.dispatchEvent(n);let c=new KeyboardEvent("keyup",i);return c.synthetic=!0,l.dispatchEvent(c),n.defaultPrevented||c.defaultPrevented}function Am(l){for(;l;){if(l&&(l.nodeType==9||l.nodeType==11&&l.host))return l;l=l.assignedSlot||l.parentNode}return null}function kd(l){for(;l.attributes.length;)l.removeAttributeNode(l.attributes[0])}function Nm(l,t){let e=t.focusNode,i=t.focusOffset;if(!e||t.anchorNode!=e||t.anchorOffset!=i)return!1;for(;;)if(i){if(e.nodeType!=1)return!1;let n=e.childNodes[i-1];n.contentEditable=="false"?i--:(e=n,i=Dl(e))}else{if(e==l)return!0;i=ki(e),e=e.parentNode}}class Bt{constructor(t,e,i=!0){this.node=t,this.offset=e,this.precise=i}static before(t,e){return new Bt(t.parentNode,ki(t),e)}static after(t,e){return new Bt(t.parentNode,ki(t)+1,e)}}const Zc=[];class st{constructor(){this.parent=null,this.dom=null,this.dirty=2}get editorView(){if(!this.parent)throw new Error("Accessing view in orphan content view");return this.parent.editorView}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let e=this.posAtStart;for(let i of this.children){if(i==t)return e;e+=i.length+i.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}coordsAt(t,e){return null}sync(t){if(this.dirty&2){let e=this.dom,i=null,n;for(let c of this.children){if(c.dirty){if(!c.dom&&(n=i?i.nextSibling:e.firstChild)){let s=st.get(n);(!s||!s.parent&&s.canReuseDOM(c))&&c.reuseDOM(n)}c.sync(t),c.dirty=0}if(n=i?i.nextSibling:e.firstChild,t&&!t.written&&t.node==e&&n!=c.dom&&(t.written=!0),c.dom.parentNode==e)for(;n&&n!=c.dom;)n=xd(n);else e.insertBefore(c.dom,n);i=c.dom}for(n=i?i.nextSibling:e.firstChild,n&&t&&t.node==e&&(t.written=!0);n;)n=xd(n)}else if(this.dirty&1)for(let e of this.children)e.dirty&&(e.sync(t),e.dirty=0)}reuseDOM(t){}localPosFromDOM(t,e){let i;if(t==this.dom)i=this.dom.childNodes[e];else{let n=Dl(t)==0?0:e==0?-1:1;for(;;){let c=t.parentNode;if(c==this.dom)break;n==0&&c.firstChild!=c.lastChild&&(t==c.firstChild?n=-1:n=1),t=c}n<0?i=t:i=t.nextSibling}if(i==this.dom.firstChild)return 0;for(;i&&!st.get(i);)i=i.nextSibling;if(!i)return this.length;for(let n=0,c=0;;n++){let s=this.children[n];if(s.dom==i)return c;c+=s.length+s.breakAfter}}domBoundsAround(t,e,i=0){let n=-1,c=-1,s=-1,d=-1;for(let o=0,a=i,h=i;o<this.children.length;o++){let u=this.children[o],m=a+u.length;if(a<t&&m>e)return u.domBoundsAround(t,e,a);if(m>=t&&n==-1&&(n=o,c=a),a>e&&u.dom.parentNode==this.dom){s=o,d=h;break}h=m,a=m+u.breakAfter}return{from:c,to:d<0?i+this.length:d,startDOM:(n?this.children[n-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:s<this.children.length&&s>=0?this.children[s].dom:null}}markDirty(t=!1){this.dirty|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let e=this.parent;e;e=e.parent){if(t&&(e.dirty|=2),e.dirty&1)return;e.dirty|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.dirty&&this.markParentsDirty(!0))}setDOM(t){this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this}get rootView(){for(let t=this;;){let e=t.parent;if(!e)return t;t=e}}replaceChildren(t,e,i=Zc){this.markDirty();for(let n=t;n<e;n++){let c=this.children[n];c.parent==this&&c.destroy()}this.children.splice(t,e-t,...i);for(let n=0;n<i.length;n++)i[n].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new wd(this.children,t,this.children.length)}childPos(t,e=1){return this.childCursor().findPos(t,e)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}merge(t,e,i,n,c,s){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor}getSide(){return 0}destroy(){this.parent=null}}st.prototype.breakAfter=0;function xd(l){let t=l.nextSibling;return l.parentNode.removeChild(l),t}class wd{constructor(t,e,i){this.children=t,this.pos=e,this.i=i,this.off=0}findPos(t,e=1){for(;;){if(t>this.pos||t==this.pos&&(e>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let i=this.children[--this.i];this.pos-=i.length+i.breakAfter}}}function vd(l,t,e,i,n,c,s,d,o){let{children:a}=l,h=a.length?a[t]:null,u=c.length?c[c.length-1]:null,m=u?u.breakAfter:s;if(!(t==i&&h&&!s&&!m&&c.length<2&&h.merge(e,n,c.length?u:null,e==0,d,o))){if(i<a.length){let r=a[i];r&&n<r.length?(t==i&&(r=r.split(n),n=0),!m&&u&&r.merge(0,n,u,!0,0,o)?c[c.length-1]=r:(n&&r.merge(0,n,null,!1,0,o),c.push(r))):r!=null&&r.breakAfter&&(u?u.breakAfter=1:s=1),i++}for(h&&(h.breakAfter=s,e>0&&(!s&&c.length&&h.merge(e,h.length,c[0],!1,d,0)?h.breakAfter=c.shift().breakAfter:(e<h.length||h.children.length&&h.children[h.children.length-1].length==0)&&h.merge(e,h.length,null,!1,d,0),t++));t<i&&c.length;)if(a[i-1].become(c[c.length-1]))i--,c.pop(),o=c.length?0:d;else if(a[t].become(c[0]))t++,c.shift(),d=c.length?0:o;else break;!c.length&&t&&i<a.length&&!a[t-1].breakAfter&&a[i].merge(0,0,a[t-1],!1,d,o)&&t--,(t<i||c.length)&&l.replaceChildren(t,i,c)}}function Ud(l,t,e,i,n,c){let s=l.childCursor(),{i:d,off:o}=s.findPos(e,1),{i:a,off:h}=s.findPos(t,-1),u=t-e;for(let m of i)u+=m.length;l.length+=u,vd(l,a,h,d,o,i,0,n,c)}let jt=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},gc=typeof document<"u"?document:{documentElement:{style:{}}};const pc=/Edge\/(\d+)/.exec(jt.userAgent),Ad=/MSIE \d/.test(jt.userAgent),Gc=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(jt.userAgent),xi=!!(Ad||Gc||pc),Nd=!xi&&/gecko\/(\d+)/i.test(jt.userAgent),Wc=!xi&&/Chrome\/(\d+)/.exec(jt.userAgent),zd="webkitFontSmoothing"in gc.documentElement.style,Td=!xi&&/Apple Computer/.test(jt.vendor),Md=Td&&(/Mobile\/\w+/.test(jt.userAgent)||jt.maxTouchPoints>2);var A={mac:Md||/Mac/.test(jt.platform),windows:/Win/.test(jt.platform),linux:/Linux|X11/.test(jt.platform),ie:xi,ie_version:Ad?gc.documentMode||6:Gc?+Gc[1]:pc?+pc[1]:0,gecko:Nd,gecko_version:Nd?+(/Firefox\/(\d+)/.exec(jt.userAgent)||[0,0])[1]:0,chrome:!!Wc,chrome_version:Wc?+Wc[1]:0,ios:Md,android:/Android\b/.test(jt.userAgent),webkit:zd,safari:Td,webkit_version:zd?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:gc.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const zm=256;class we extends st{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,e,i){return i&&(!(i instanceof we)||this.length-(e-t)+i.length>zm)?!1:(this.text=this.text.slice(0,t)+(i?i.text:"")+this.text.slice(e),this.markDirty(),!0)}split(t){let e=new we(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),e}localPosFromDOM(t,e){return t==this.dom?e:e?this.text.length:0}domAtPos(t){return new Bt(this.dom,t)}domBoundsAround(t,e,i){return{from:i,to:i+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,e){return Xc(this.dom,t,e)}}class Ze extends st{constructor(t,e=[],i=0){super(),this.mark=t,this.children=e,this.length=i;for(let n of e)n.setParent(this)}setAttrs(t){if(kd(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let e in this.mark.attrs)t.setAttribute(e,this.mark.attrs[e]);return t}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.dirty|=6)}sync(t){this.dom?this.dirty&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t)}merge(t,e,i,n,c,s){return i&&(!(i instanceof Ze&&i.mark.eq(this.mark))||t&&c<=0||e<this.length&&s<=0)?!1:(Ud(this,t,e,i?i.children:[],c-1,s-1),this.markDirty(),!0)}split(t){let e=[],i=0,n=-1,c=0;for(let d of this.children){let o=i+d.length;o>t&&e.push(i<t?d.split(t-i):d),n<0&&i>=t&&(n=c),i=o,c++}let s=this.length-t;return this.length=t,n>-1&&(this.children.length=n,this.markDirty()),new Ze(this.mark,e,s)}domAtPos(t){return jd(this,t)}coordsAt(t,e){return Dd(this,t,e)}}function Xc(l,t,e){let i=l.nodeValue.length;t>i&&(t=i);let n=t,c=t,s=0;t==0&&e<0||t==i&&e>=0?A.chrome||A.gecko||(t?(n--,s=1):c<i&&(c++,s=-1)):e<0?n--:c<i&&c++;let d=Gl(l,n,c).getClientRects();if(!d.length)return Kd;let o=d[(s?s<0:e>=0)?0:d.length-1];return A.safari&&!s&&o.width==0&&(o=Array.prototype.find.call(d,a=>a.width)||o),s?bc(o,s<0):o||null}class ve extends st{constructor(t,e,i){super(),this.widget=t,this.length=e,this.side=i,this.prevWidget=null}static create(t,e,i){return new(t.customView||ve)(t,e,i)}split(t){let e=ve.create(this.widget,this.length-t,this.side);return this.length-=t,e}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}getSide(){return this.side}merge(t,e,i,n,c,s){return i&&(!(i instanceof ve)||!this.widget.compare(i.widget)||t>0&&c<=0||e<this.length&&s<=0)?!1:(this.length=t+(i?i.length:0)+(this.length-e),!0)}become(t){return t.length==this.length&&t instanceof ve&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.eq(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return $.empty;let t=this;for(;t.parent;)t=t.parent;let e=t.editorView,i=e&&e.state.doc,n=this.posAtStart;return i?i.slice(n,n+this.length):$.empty}domAtPos(t){return t==0?Bt.before(this.dom):Bt.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,e){let i=this.dom.getClientRects(),n=null;if(!i.length)return Kd;for(let c=t>0?i.length-1:0;n=i[c],!(t>0?c==0:c==i.length-1||n.top<n.bottom);c+=t>0?-1:1);return this.length?n:bc(n,this.side>0)}get isEditable(){return!1}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Pd extends ve{domAtPos(t){let{topView:e,text:i}=this.widget;return e?Ic(t,0,e,i,(n,c)=>n.domAtPos(c),n=>new Bt(i,Math.min(n,i.nodeValue.length))):new Bt(i,Math.min(t,i.nodeValue.length))}sync(){this.setDOM(this.widget.toDOM())}localPosFromDOM(t,e){let{topView:i,text:n}=this.widget;return i?Ed(t,e,i,n):Math.min(e,this.length)}ignoreMutation(){return!1}get overrideDOMText(){return null}coordsAt(t,e){let{topView:i,text:n}=this.widget;return i?Ic(t,e,i,n,(c,s,d)=>c.coordsAt(s,d),(c,s)=>Xc(n,c,s)):Xc(n,t,e)}destroy(){var t;super.destroy(),(t=this.widget.topView)===null||t===void 0||t.destroy()}get isEditable(){return!0}canReuseDOM(){return!0}}function Ic(l,t,e,i,n,c){if(e instanceof Ze){for(let s=e.dom.firstChild;s;s=s.nextSibling){let d=st.get(s);if(!d)return c(l,t);let o=gl(s,i),a=d.length+(o?i.nodeValue.length:0);if(l<a||l==a&&d.getSide()<=0)return o?Ic(l,t,d,i,n,c):n(d,l,t);l-=a}return n(e,e.length,-1)}else return e.dom==i?c(l,t):n(e,l,t)}function Ed(l,t,e,i){if(e instanceof Ze)for(let n of e.children){let c=0,s=gl(n.dom,i);if(gl(n.dom,l))return c+(s?Ed(l,t,n,i):n.localPosFromDOM(l,t));c+=s?i.nodeValue.length:n.length}else if(e.dom==i)return Math.min(t,i.nodeValue.length);return e.localPosFromDOM(l,t)}class Xl extends st{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof Xl&&t.side==this.side}split(){return new Xl(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return Bt.before(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){let e=this.dom.getBoundingClientRect(),i=Tm(this,this.side>0?-1:1);return i&&i.top<e.bottom&&i.bottom>e.top?{left:e.left,right:e.right,top:i.top,bottom:i.bottom}:e}get overrideDOMText(){return $.empty}}we.prototype.children=ve.prototype.children=Xl.prototype.children=Zc;function Tm(l,t){let e=l.parent,i=e?e.children.indexOf(l):-1;for(;e&&i>=0;)if(t<0?i>0:i<e.children.length){let n=e.children[i+t];if(n instanceof we){let c=n.coordsAt(t<0?n.length:0,t);if(c)return c}i+=t}else if(e instanceof Ze&&e.parent)i=e.parent.children.indexOf(e)+(t<0?0:1),e=e.parent;else{let n=e.dom.lastChild;if(n&&n.nodeName=="BR")return n.getClientRects()[0];break}}function jd(l,t){let e=l.dom,{children:i}=l,n=0;for(let c=0;n<i.length;n++){let s=i[n],d=c+s.length;if(!(d==c&&s.getSide()<=0)){if(t>c&&t<d&&s.dom.parentNode==e)return s.domAtPos(t-c);if(t<=c)break;c=d}}for(let c=n;c>0;c--){let s=i[c-1];if(s.dom.parentNode==e)return s.domAtPos(s.length)}for(let c=n;c<i.length;c++){let s=i[c];if(s.dom.parentNode==e)return s.domAtPos(0)}return new Bt(e,0)}function Qd(l,t,e){let i,{children:n}=l;e>0&&t instanceof Ze&&n.length&&(i=n[n.length-1])instanceof Ze&&i.mark.eq(t.mark)?Qd(i,t.children[0],e-1):(n.push(t),t.setParent(l)),l.length+=t.length}function Dd(l,t,e){let i=null,n=-1,c=null,s=-1;function d(a,h){for(let u=0,m=0;u<a.children.length&&m<=h;u++){let r=a.children[u],b=m+r.length;b>=h&&(r.children.length?d(r,h-m):!c&&(b>h||m==b&&r.getSide()>0)?(c=r,s=h-m):(m<h||m==b&&r.getSide()<0)&&(i=r,n=h-m)),m=b}}d(l,t);let o=(e<0?i:c)||i||c;return o?o.coordsAt(Math.max(0,o==i?n:s),e):Mm(l)}function Mm(l){let t=l.dom.lastChild;if(!t)return l.dom.getBoundingClientRect();let e=Ql(t);return e[e.length-1]||null}function Vc(l,t){for(let e in l)e=="class"&&t.class?t.class+=" "+l.class:e=="style"&&t.style?t.style+=";"+l.style:t[e]=l[e];return t}function yc(l,t){if(l==t)return!0;if(!l||!t)return!1;let e=Object.keys(l),i=Object.keys(t);if(e.length!=i.length)return!1;for(let n of e)if(i.indexOf(n)==-1||l[n]!==t[n])return!1;return!0}function Rc(l,t,e){let i=null;if(t)for(let n in t)e&&n in e||l.removeAttribute(i=n);if(e)for(let n in e)t&&t[n]==e[n]||l.setAttribute(i=n,e[n]);return!!i}class Ue{eq(t){return!1}updateDOM(t){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}ignoreEvent(t){return!0}get customView(){return null}destroy(t){}}var nt=function(l){return l[l.Text=0]="Text",l[l.WidgetBefore=1]="WidgetBefore",l[l.WidgetAfter=2]="WidgetAfter",l[l.WidgetRange=3]="WidgetRange",l}(nt||(nt={}));class N extends el{constructor(t,e,i,n){super(),this.startSide=t,this.endSide=e,this.widget=i,this.spec=n}get heightRelevant(){return!1}static mark(t){return new wi(t)}static widget(t){let e=t.side||0,i=!!t.block;return e+=i?e>0?3e8:-4e8:e>0?1e8:-1e8,new ll(t,e,e,i,t.widget||null,!1)}static replace(t){let e=!!t.block,i,n;if(t.isBlockGap)i=-5e8,n=4e8;else{let{start:c,end:s}=Od(t,e);i=(c?e?-3e8:-1:5e8)-1,n=(s?e?2e8:1:-6e8)+1}return new ll(t,i,n,e,t.widget||null,!0)}static line(t){return new Ol(t)}static set(t,e=!1){return lt.of(t,e)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}N.none=lt.empty;class wi extends N{constructor(t){let{start:e,end:i}=Od(t);super(e?-1:5e8,i?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){return this==t||t instanceof wi&&this.tagName==t.tagName&&this.class==t.class&&yc(this.attrs,t.attrs)}range(t,e=t){if(t>=e)throw new RangeError("Mark decorations may not be empty");return super.range(t,e)}}wi.prototype.point=!1;class Ol extends N{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof Ol&&yc(this.spec.attributes,t.spec.attributes)}range(t,e=t){if(e!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,e)}}Ol.prototype.mapMode=At.TrackBefore,Ol.prototype.point=!0;class ll extends N{constructor(t,e,i,n,c,s){super(e,i,c,t),this.block=n,this.isReplace=s,this.mapMode=n?e<=0?At.TrackBefore:At.TrackAfter:At.TrackDel}get type(){return this.startSide<this.endSide?nt.WidgetRange:this.startSide<=0?nt.WidgetBefore:nt.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&this.widget.estimatedHeight>=5}eq(t){return t instanceof ll&&Pm(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,e=t){if(this.isReplace&&(t>e||t==e&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&e!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,e)}}ll.prototype.point=!0;function Od(l,t=!1){let{inclusiveStart:e,inclusiveEnd:i}=l;return e==null&&(e=l.inclusive),i==null&&(i=l.inclusive),{start:e!=null?e:t,end:i!=null?i:t}}function Pm(l,t){return l==t||!!(l&&t&&l.compare(t))}function fc(l,t,e,i=0){let n=e.length-1;n>=0&&e[n]+i>=l?e[n]=Math.max(e[n],t):e.push(l,t)}class Nt extends st{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,e,i,n,c,s){if(i){if(!(i instanceof Nt))return!1;this.dom||i.transferDOM(this)}return n&&this.setDeco(i?i.attrs:null),Ud(this,t,e,i?i.children:[],c,s),!0}split(t){let e=new Nt;if(e.breakAfter=this.breakAfter,this.length==0)return e;let{i,off:n}=this.childPos(t);n&&(e.append(this.children[i].split(n),0),this.children[i].merge(n,this.children[i].length,null,!1,0,0),i++);for(let c=i;c<this.children.length;c++)e.append(this.children[c],0);for(;i>0&&this.children[i-1].length==0;)this.children[--i].destroy();return this.children.length=i,this.markDirty(),this.length=t,e}transferDOM(t){!this.dom||(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){yc(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,e){Qd(this,t,e)}addLineDeco(t){let e=t.spec.attributes,i=t.spec.class;e&&(this.attrs=Vc(e,this.attrs||{})),i&&(this.attrs=Vc({class:i},this.attrs||{}))}domAtPos(t){return jd(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.dirty|=6)}sync(t){var e;this.dom?this.dirty&4&&(kd(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Rc(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t);let i=this.dom.lastChild;for(;i&&st.get(i)instanceof Ze;)i=i.lastChild;if(!i||!this.length||i.nodeName!="BR"&&((e=st.get(i))===null||e===void 0?void 0:e.isEditable)==!1&&(!A.ios||!this.children.some(n=>n instanceof we))){let n=document.createElement("BR");n.cmIgnore=!0,this.dom.appendChild(n)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0;for(let e of this.children){if(!(e instanceof we)||/[^ -~]/.test(e.text))return null;let i=Ql(e.dom);if(i.length!=1)return null;t+=i[0].width}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length}:null}coordsAt(t,e){return Dd(this,t,e)}become(t){return!1}get type(){return nt.Text}static find(t,e){for(let i=0,n=0;i<t.children.length;i++){let c=t.children[i],s=n+c.length;if(s>=e){if(c instanceof Nt)return c;if(s>e)break}n=s+c.breakAfter}return null}}class il extends st{constructor(t,e,i){super(),this.widget=t,this.length=e,this.type=i,this.breakAfter=0,this.prevWidget=null}merge(t,e,i,n,c,s){return i&&(!(i instanceof il)||!this.widget.compare(i.widget)||t>0&&c<=0||e<this.length&&s<=0)?!1:(this.length=t+(i?i.length:0)+(this.length-e),!0)}domAtPos(t){return t==0?Bt.before(this.dom):Bt.after(this.dom,t==this.length)}split(t){let e=this.length-t;this.length=t;let i=new il(this.widget,e,this.type);return i.breakAfter=this.breakAfter,i}get children(){return Zc}sync(){(!this.dom||!this.widget.updateDOM(this.dom))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(this.editorView)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):$.empty}domBoundsAround(){return null}become(t){return t instanceof il&&t.type==this.type&&t.widget.constructor==this.widget.constructor?(t.widget.eq(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Cc{constructor(t,e,i,n){this.doc=t,this.pos=e,this.end=i,this.disallowBlockEffectsFor=n,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=e}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!t.breakAfter&&!(t instanceof il&&t.type==nt.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new Nt),this.atCursorPos=!0),this.curLine}flushBuffer(t){this.pendingBuffer&&(this.curLine.append(vi(new Xl(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer([]),this.curLine=null,this.content.push(t)}finish(t){t?this.pendingBuffer=0:this.flushBuffer([]),this.posCovered()||this.getLine()}buildText(t,e,i){for(;t>0;){if(this.textOff==this.text.length){let{value:c,lineBreak:s,done:d}=this.cursor.next(this.skip);if(this.skip=0,d)throw new Error("Ran out of text content when drawing inline views");if(s){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer([]),this.curLine=null,t--;continue}else this.text=c,this.textOff=0}let n=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(e.slice(e.length-i)),this.getLine().append(vi(new we(this.text.slice(this.textOff,this.textOff+n)),e),i),this.atCursorPos=!0,this.textOff+=n,t-=n,i=0}}span(t,e,i,n){this.buildText(e-t,i,n),this.pos=e,this.openStart<0&&(this.openStart=n)}point(t,e,i,n,c,s){if(this.disallowBlockEffectsFor[s]&&i instanceof ll){if(i.block)throw new RangeError("Block decorations may not be specified via plugins");if(e>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let d=e-t;if(i instanceof ll)if(i.block){let{type:o}=i;o==nt.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new il(i.widget||new qd("div"),d,o))}else{let o=ve.create(i.widget||new qd("span"),d,d?0:i.startSide),a=this.atCursorPos&&!o.isEditable&&c<=n.length&&(t<e||i.startSide>0),h=!o.isEditable&&(t<e||i.startSide<=0),u=this.getLine();this.pendingBuffer==2&&!a&&(this.pendingBuffer=0),this.flushBuffer(n),a&&(u.append(vi(new Xl(1),n),c),c=n.length+Math.max(0,c-n.length)),u.append(vi(o,n),c),this.atCursorPos=h,this.pendingBuffer=h?t<e?1:2:0}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(i);d&&(this.textOff+d<=this.text.length?this.textOff+=d:(this.skip+=d-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=e),this.openStart<0&&(this.openStart=c)}static build(t,e,i,n,c){let s=new Cc(t,e,i,c);return s.openEnd=lt.spans(n,e,i,s),s.openStart<0&&(s.openStart=s.openEnd),s.finish(s.openEnd),s}}function vi(l,t){for(let e of t)l=new Ze(e,[l],l.length);return l}class qd extends Ue{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}}const _d=U.define(),$d=U.define(),to=U.define(),eo=U.define(),Yc=U.define(),lo=U.define(),io=U.define({combine:l=>l.some(t=>t)}),no=U.define({combine:l=>l.some(t=>t)});class Ui{constructor(t,e="nearest",i="nearest",n=5,c=5){this.range=t,this.y=e,this.x=i,this.yMargin=n,this.xMargin=c}map(t){return t.empty?this:new Ui(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin)}}const co=P.define({map:(l,t)=>l.map(t)});function Qt(l,t,e){let i=l.facet(eo);i.length?i[0](t):window.onerror?window.onerror(String(t),e,void 0,void 0,t):e?console.error(e+":",t):console.error(t)}const Ai=U.define({combine:l=>l.length?l[0]:!0});let Em=0;const ql=U.define();class Xt{constructor(t,e,i,n){this.id=t,this.create=e,this.domEventHandlers=i,this.extension=n(this)}static define(t,e){const{eventHandlers:i,provide:n,decorations:c}=e||{};return new Xt(Em++,t,i,s=>{let d=[ql.of(s)];return c&&d.push(_l.of(o=>{let a=o.plugin(s);return a?c(a):N.none})),n&&d.push(n(s)),d})}static fromClass(t,e){return Xt.define(i=>new t(i),e)}}class Sc{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}update(t){if(this.value){if(this.mustUpdate){let e=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(e)}catch(i){if(Qt(e.state,i,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(t)}catch(e){Qt(t.state,e,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var e;if(!((e=this.value)===null||e===void 0)&&e.destroy)try{this.value.destroy()}catch(i){Qt(t.state,i,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const so=U.define(),Lc=U.define(),_l=U.define(),oo=U.define(),ao=U.define(),$l=U.define();class ge{constructor(t,e,i,n){this.fromA=t,this.toA=e,this.fromB=i,this.toB=n}join(t){return new ge(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let e=t.length,i=this;for(;e>0;e--){let n=t[e-1];if(!(n.fromA>i.toA)){if(n.toA<i.fromA)break;i=i.join(n),t.splice(e-1,1)}}return t.splice(e,0,i),t}static extendWithRanges(t,e){if(e.length==0)return t;let i=[];for(let n=0,c=0,s=0,d=0;;n++){let o=n==t.length?null:t[n],a=s-d,h=o?o.fromB:1e9;for(;c<e.length&&e[c]<h;){let u=e[c],m=e[c+1],r=Math.max(d,u),b=Math.min(h,m);if(r<=b&&new ge(r+a,b+a,r,b).addToSet(i),m>h)break;c+=2}if(!o)return i;new ge(o.fromA,o.toA,o.fromB,o.toB).addToSet(i),s=o.toA,d=o.toB}}}class Ni{constructor(t,e,i){this.view=t,this.state=e,this.transactions=i,this.flags=0,this.startState=t.state,this.changes=yt.empty(this.startState.doc.length);for(let s of i)this.changes=this.changes.compose(s.changes);let n=[];this.changes.iterChangedRanges((s,d,o,a)=>n.push(new ge(s,d,o,a))),this.changedRanges=n;let c=t.hasFocus;c!=t.inputState.notifiedFocused&&(t.inputState.notifiedFocused=c,this.flags|=1)}static create(t,e,i){return new Ni(t,e,i)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var mt=function(l){return l[l.LTR=0]="LTR",l[l.RTL=1]="RTL",l}(mt||(mt={}));const Jc=mt.LTR,jm=mt.RTL;function ho(l){let t=[];for(let e=0;e<l.length;e++)t.push(1<<+l[e]);return t}const Qm=ho("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Dm=ho("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Fc=Object.create(null),pe=[];for(let l of["()","[]","{}"]){let t=l.charCodeAt(0),e=l.charCodeAt(1);Fc[t]=e,Fc[e]=-t}function Om(l){return l<=247?Qm[l]:1424<=l&&l<=1524?2:1536<=l&&l<=1785?Dm[l-1536]:1774<=l&&l<=2220?4:8192<=l&&l<=8203?256:64336<=l&&l<=65023?4:l==8204?256:1}const qm=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Il{constructor(t,e,i){this.from=t,this.to=e,this.level=i}get dir(){return this.level%2?jm:Jc}side(t,e){return this.dir==e==t?this.to:this.from}static find(t,e,i,n){let c=-1;for(let s=0;s<t.length;s++){let d=t[s];if(d.from<=e&&d.to>=e){if(d.level==i)return s;(c<0||(n!=0?n<0?d.from<e:d.to>e:t[c].level>d.level))&&(c=s)}}if(c<0)throw new RangeError("Index out of range");return c}}const rt=[];function _m(l,t){let e=l.length,i=t==Jc?1:2,n=t==Jc?2:1;if(!l||i==1&&!qm.test(l))return uo(e);for(let s=0,d=i,o=i;s<e;s++){let a=Om(l.charCodeAt(s));a==512?a=d:a==8&&o==4&&(a=16),rt[s]=a==4?2:a,a&7&&(o=a),d=a}for(let s=0,d=i,o=i;s<e;s++){let a=rt[s];if(a==128)s<e-1&&d==rt[s+1]&&d&24?a=rt[s]=d:rt[s]=256;else if(a==64){let h=s+1;for(;h<e&&rt[h]==64;)h++;let u=s&&d==8||h<e&&rt[h]==8?o==1?1:8:256;for(let m=s;m<h;m++)rt[m]=u;s=h-1}else a==8&&o==1&&(rt[s]=1);d=a,a&7&&(o=a)}for(let s=0,d=0,o=0,a,h,u;s<e;s++)if(h=Fc[a=l.charCodeAt(s)])if(h<0){for(let m=d-3;m>=0;m-=3)if(pe[m+1]==-h){let r=pe[m+2],b=r&2?i:r&4?r&1?n:i:0;b&&(rt[s]=rt[pe[m]]=b),d=m;break}}else{if(pe.length==189)break;pe[d++]=s,pe[d++]=a,pe[d++]=o}else if((u=rt[s])==2||u==1){let m=u==i;o=m?0:1;for(let r=d-3;r>=0;r-=3){let b=pe[r+2];if(b&2)break;if(m)pe[r+2]|=2;else{if(b&4)break;pe[r+2]|=4}}}for(let s=0;s<e;s++)if(rt[s]==256){let d=s+1;for(;d<e&&rt[d]==256;)d++;let o=(s?rt[s-1]:i)==1,a=(d<e?rt[d]:i)==1,h=o==a?o?1:2:i;for(let u=s;u<d;u++)rt[u]=h;s=d-1}let c=[];if(i==1)for(let s=0;s<e;){let d=s,o=rt[s++]!=1;for(;s<e&&o==(rt[s]!=1);)s++;if(o)for(let a=s;a>d;){let h=a,u=rt[--a]!=2;for(;a>d&&u==(rt[a-1]!=2);)a--;c.push(new Il(a,h,u?2:1))}else c.push(new Il(d,s,0))}else for(let s=0;s<e;){let d=s,o=rt[s++]==2;for(;s<e&&o==(rt[s]==2);)s++;c.push(new Il(d,s,o?1:2))}return c}function uo(l){return[new Il(0,l,0)]}let mo="";function $m(l,t,e,i,n){var c;let s=i.head-l.from,d=-1;if(s==0){if(!n||!l.length)return null;t[0].level!=e&&(s=t[0].side(!1,e),d=0)}else if(s==l.length){if(n)return null;let m=t[t.length-1];m.level!=e&&(s=m.side(!0,e),d=t.length-1)}d<0&&(d=Il.find(t,s,(c=i.bidiLevel)!==null&&c!==void 0?c:-1,i.assoc));let o=t[d];s==o.side(n,e)&&(o=t[d+=n?1:-1],s=o.side(!n,e));let a=n==(o.dir==e),h=Ut(l.text,s,a);if(mo=l.text.slice(Math.min(s,h),Math.max(s,h)),h!=o.side(n,e))return y.cursor(h+l.from,a?-1:1,o.level);let u=d==(n?t.length-1:0)?null:t[d+(n?1:-1)];return!u&&o.level!=e?y.cursor(n?l.to:l.from,n?-1:1,e):u&&u.level<o.level?y.cursor(u.side(!n,e)+l.from,n?1:-1,u.level):y.cursor(h+l.from,n?-1:1,o.level)}const Ae="\uFFFF";class ro{constructor(t,e){this.points=t,this.text="",this.lineSeparator=e.facet(O.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Ae}readRange(t,e){if(!t)return this;let i=t.parentNode;for(let n=t;;){this.findPointBefore(i,n),this.readNode(n);let c=n.nextSibling;if(c==e)break;let s=st.get(n),d=st.get(c);(s&&d?s.breakAfter:(s?s.breakAfter:bo(n))||bo(c)&&(n.nodeName!="BR"||n.cmIgnore))&&this.lineBreak(),n=c}return this.findPointBefore(i,e),this}readTextNode(t){let e=t.nodeValue;for(let i of this.points)i.node==t&&(i.pos=this.text.length+Math.min(i.offset,e.length));for(let i=0,n=this.lineSeparator?null:/\r\n?|\n/g;;){let c=-1,s=1,d;if(this.lineSeparator?(c=e.indexOf(this.lineSeparator,i),s=this.lineSeparator.length):(d=n.exec(e))&&(c=d.index,s=d[0].length),this.append(e.slice(i,c<0?e.length:c)),c<0)break;if(this.lineBreak(),s>1)for(let o of this.points)o.node==t&&o.pos>this.text.length&&(o.pos-=s-1);i=c+s}}readNode(t){if(t.cmIgnore)return;let e=st.get(t),i=e&&e.overrideDOMText;if(i!=null){this.findPointInside(t,i.length);for(let n=i.iter();!n.next().done;)n.lineBreak?this.lineBreak():this.append(n.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,e){for(let i of this.points)i.node==t&&t.childNodes[i.offset]==e&&(i.pos=this.text.length)}findPointInside(t,e){for(let i of this.points)(t.nodeType==3?i.node==t:t.contains(i.node))&&(i.pos=this.text.length+Math.min(e,i.offset))}}function bo(l){return l.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(l.nodeName)}class Zo{constructor(t,e){this.node=t,this.offset=e,this.pos=-1}}class go extends st{constructor(t){super(),this.view=t,this.compositionDeco=N.none,this.decorations=[],this.dynamicDecorationMap=[],this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new Nt],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new ge(0,0,0,t.state.doc.length)],0)}get editorView(){return this.view}get length(){return this.view.state.doc.length}update(t){let e=t.changedRanges;this.minWidth>0&&e.length&&(e.every(({fromA:s,toA:d})=>d<this.minWidthFrom||s>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.view.inputState.composing<0?this.compositionDeco=N.none:(t.transactions.length||this.dirty)&&(this.compositionDeco=er(this.view,t.changes)),(A.ie||A.chrome)&&!this.compositionDeco.size&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let i=this.decorations,n=this.updateDeco(),c=cr(i,n,t.changes);return e=ge.extendWithRanges(e,c),this.dirty==0&&e.length==0?!1:(this.updateInner(e,t.startState.doc.length),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,e){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,e);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let c=A.chrome||A.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(c),this.dirty=0,c&&(c.written||i.selectionRange.focusNode!=c.node)&&(this.forceSelection=!0),this.dom.style.height=""});let n=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let c of this.children)c instanceof il&&c.widget instanceof po&&n.push(c.dom);i.updateGaps(n)}updateChildren(t,e){let i=this.childCursor(e);for(let n=t.length-1;;n--){let c=n>=0?t[n]:null;if(!c)break;let{fromA:s,toA:d,fromB:o,toB:a}=c,{content:h,breakAtStart:u,openStart:m,openEnd:r}=Cc.build(this.view.state.doc,o,a,this.decorations,this.dynamicDecorationMap),{i:b,off:Z}=i.findPos(d,1),{i:g,off:p}=i.findPos(s,-1);vd(this,g,p,b,Z,h,u,m,r)}}updateSelection(t=!1,e=!1){if((t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange(),!(e||this.mayControlSelection()))return;let i=this.forceSelection;this.forceSelection=!1;let n=this.view.state.selection.main,c=this.domAtPos(n.anchor),s=n.empty?c:this.domAtPos(n.head);if(A.gecko&&n.empty&&tr(c)){let o=document.createTextNode("");this.view.observer.ignore(()=>c.node.insertBefore(o,c.node.childNodes[c.offset]||null)),c=s=new Bt(o,0),i=!0}let d=this.view.observer.selectionRange;(i||!d.focusNode||!Bi(c.node,c.offset,d.anchorNode,d.anchorOffset)||!Bi(s.node,s.offset,d.focusNode,d.focusOffset))&&(this.view.observer.ignore(()=>{A.android&&A.chrome&&this.dom.contains(d.focusNode)&&sr(d.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let o=Ki(this.view.root);if(o)if(n.empty){if(A.gecko){let a=ir(c.node,c.offset);if(a&&a!=3){let h=Wo(c.node,c.offset,a==1?1:-1);h&&(c=new Bt(h,a==1?0:h.nodeValue.length))}}o.collapse(c.node,c.offset),n.bidiLevel!=null&&d.cursorBidiLevel!=null&&(d.cursorBidiLevel=n.bidiLevel)}else if(o.extend){o.collapse(c.node,c.offset);try{o.extend(s.node,s.offset)}catch{}}else{let a=document.createRange();n.anchor>n.head&&([c,s]=[s,c]),a.setEnd(s.node,s.offset),a.setStart(c.node,c.offset),o.removeAllRanges(),o.addRange(a)}}),this.view.observer.setSelectionRange(c,s)),this.impreciseAnchor=c.precise?null:new Bt(d.anchorNode,d.anchorOffset),this.impreciseHead=s.precise?null:new Bt(d.focusNode,d.focusOffset)}enforceCursorAssoc(){if(this.compositionDeco.size)return;let{view:t}=this,e=t.state.selection.main,i=Ki(t.root),{anchorNode:n,anchorOffset:c}=t.observer.selectionRange;if(!i||!e.empty||!e.assoc||!i.modify)return;let s=Nt.find(this,e.head);if(!s)return;let d=s.posAtStart;if(e.head==d||e.head==d+s.length)return;let o=this.coordsAt(e.head,-1),a=this.coordsAt(e.head,1);if(!o||!a||o.bottom>a.top)return;let h=this.domAtPos(e.head+e.assoc);i.collapse(h.node,h.offset),i.modify("move",e.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let u=t.observer.selectionRange;t.docView.posFromDOM(u.anchorNode,u.anchorOffset)!=e.from&&i.collapse(n,c)}mayControlSelection(){let t=this.view.root.activeElement;return t==this.dom||Hi(this.dom,this.view.observer.selectionRange)&&!(t&&this.dom.contains(t))}nearest(t){for(let e=t;e;){let i=st.get(e);if(i&&i.rootView==this)return i;e=e.parentNode}return null}posFromDOM(t,e){let i=this.nearest(t);if(!i)throw new RangeError("Trying to find position for a DOM position outside of the document");return i.localPosFromDOM(t,e)+i.posAtStart}domAtPos(t){let{i:e,off:i}=this.childCursor().findPos(t,-1);for(;e<this.children.length-1;){let n=this.children[e];if(i<n.length||n instanceof Nt)break;e++,i=0}return this.children[e].domAtPos(i)}coordsAt(t,e){for(let i=this.length,n=this.children.length-1;;n--){let c=this.children[n],s=i-c.breakAfter-c.length;if(t>s||t==s&&c.type!=nt.WidgetBefore&&c.type!=nt.WidgetAfter&&(!n||e==2||this.children[n-1].breakAfter||this.children[n-1].type==nt.WidgetBefore&&e>-2))return c.coordsAt(t-s,e);i=s}}measureVisibleLineHeights(t){let e=[],{from:i,to:n}=t,c=this.view.contentDOM.clientWidth,s=c>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,d=-1,o=this.view.textDirection==mt.LTR;for(let a=0,h=0;h<this.children.length;h++){let u=this.children[h],m=a+u.length;if(m>n)break;if(a>=i){let r=u.dom.getBoundingClientRect();if(e.push(r.height),s){let b=u.dom.lastChild,Z=b?Ql(b):[];if(Z.length){let g=Z[Z.length-1],p=o?g.right-r.left:r.right-g.left;p>d&&(d=p,this.minWidth=c,this.minWidthFrom=a,this.minWidthTo=m)}}}a=m+u.breakAfter}return e}textDirectionAt(t){let{i:e}=this.childPos(t,1);return getComputedStyle(this.children[e].dom).direction=="rtl"?mt.RTL:mt.LTR}measureTextSize(){for(let n of this.children)if(n instanceof Nt){let c=n.measureTextSize();if(c)return c}let t=document.createElement("div"),e,i;return t.className="cm-line",t.style.width="99999px",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let n=Ql(t.firstChild)[0];e=t.getBoundingClientRect().height,i=n?n.width/27:7,t.remove()}),{lineHeight:e,charWidth:i}}childCursor(t=this.length){let e=this.children.length;return e&&(t-=this.children[--e].length),new wd(this.children,t,e)}computeBlockGapDeco(){let t=[],e=this.view.viewState;for(let i=0,n=0;;n++){let c=n==e.viewports.length?null:e.viewports[n],s=c?c.from-1:this.length;if(s>i){let d=e.lineBlockAt(s).bottom-e.lineBlockAt(i).top;t.push(N.replace({widget:new po(d),block:!0,inclusive:!0,isBlockGap:!0}).range(i,s))}if(!c)break;i=c.to+1}return N.set(t)}updateDeco(){let t=this.view.state.facet(_l).map((e,i)=>(this.dynamicDecorationMap[i]=typeof e=="function")?e(this.view):e);for(let e=t.length;e<t.length+3;e++)this.dynamicDecorationMap[e]=!1;return this.decorations=[...t,this.compositionDeco,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(t){let{range:e}=t,i=this.coordsAt(e.head,e.empty?e.assoc:e.head>e.anchor?-1:1),n;if(!i)return;!e.empty&&(n=this.coordsAt(e.anchor,e.anchor>e.head?-1:1))&&(i={left:Math.min(i.left,n.left),top:Math.min(i.top,n.top),right:Math.max(i.right,n.right),bottom:Math.max(i.bottom,n.bottom)});let c=0,s=0,d=0,o=0;for(let h of this.view.state.facet(ao).map(u=>u(this.view)))if(h){let{left:u,right:m,top:r,bottom:b}=h;u!=null&&(c=Math.max(c,u)),m!=null&&(s=Math.max(s,m)),r!=null&&(d=Math.max(d,r)),b!=null&&(o=Math.max(o,b))}let a={left:i.left-c,top:i.top-d,right:i.right+s,bottom:i.bottom+o};vm(this.view.scrollDOM,a,e.head<e.anchor?-1:1,t.x,t.y,t.xMargin,t.yMargin,this.view.textDirection==mt.LTR)}}function tr(l){return l.node.nodeType==1&&l.node.firstChild&&(l.offset==0||l.node.childNodes[l.offset-1].contentEditable=="false")&&(l.offset==l.node.childNodes.length||l.node.childNodes[l.offset].contentEditable=="false")}class po extends Ue{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function Go(l){let t=l.observer.selectionRange,e=t.focusNode&&Wo(t.focusNode,t.focusOffset,0);if(!e)return null;let i=l.docView.nearest(e);if(!i)return null;if(i instanceof Nt){let n=e;for(;n.parentNode!=i.dom;)n=n.parentNode;let c=n.previousSibling;for(;c&&!st.get(c);)c=c.previousSibling;let s=c?st.get(c).posAtEnd:i.posAtStart;return{from:s,to:s,node:n,text:e}}else{for(;;){let{parent:c}=i;if(!c)return null;if(c instanceof Nt)break;i=c}let n=i.posAtStart;return{from:n,to:n+i.length,node:i.dom,text:e}}}function er(l,t){let e=Go(l);if(!e)return N.none;let{from:i,to:n,node:c,text:s}=e,d=t.mapPos(i,1),o=Math.max(d,t.mapPos(n,-1)),{state:a}=l,h=c.nodeType==3?c.nodeValue:new ro([],a).readRange(c.firstChild,null).text;if(o-d<h.length)if(a.doc.sliceString(d,Math.min(a.doc.length,d+h.length),Ae)==h)o=d+h.length;else if(a.doc.sliceString(Math.max(0,o-h.length),o,Ae)==h)d=o-h.length;else return N.none;else if(a.doc.sliceString(d,o,Ae)!=h)return N.none;let u=st.get(c);return u instanceof Pd?u=u.widget.topView:u&&(u.parent=null),N.set(N.replace({widget:new lr(c,s,u),inclusive:!0}).range(d,o))}class lr extends Ue{constructor(t,e,i){super(),this.top=t,this.text=e,this.topView=i}eq(t){return this.top==t.top&&this.text==t.text}toDOM(){return this.top}ignoreEvent(){return!1}get customView(){return Pd}}function Wo(l,t,e){for(;;){if(l.nodeType==3)return l;if(l.nodeType==1&&t>0&&e<=0)l=l.childNodes[t-1],t=Dl(l);else if(l.nodeType==1&&t<l.childNodes.length&&e>=0)l=l.childNodes[t],t=0;else return null}}function ir(l,t){return l.nodeType!=1?0:(t&&l.childNodes[t-1].contentEditable=="false"?1:0)|(t<l.childNodes.length&&l.childNodes[t].contentEditable=="false"?2:0)}class nr{constructor(){this.changes=[]}compareRange(t,e){fc(t,e,this.changes)}comparePoint(t,e){fc(t,e,this.changes)}}function cr(l,t,e){let i=new nr;return lt.compare(l,t,e,i),i.changes}function sr(l,t){for(let e=l;e&&e!=t;e=e.assignedSlot||e.parentNode)if(e.nodeType==1&&e.contentEditable=="false")return!0;return!1}function dr(l,t,e=1){let i=l.charCategorizer(t),n=l.doc.lineAt(t),c=t-n.from;if(n.length==0)return y.cursor(t);c==0?e=1:c==n.length&&(e=-1);let s=c,d=c;e<0?s=Ut(n.text,c,!1):d=Ut(n.text,c);let o=i(n.text.slice(s,d));for(;s>0;){let a=Ut(n.text,s,!1);if(i(n.text.slice(a,s))!=o)break;s=a}for(;d<n.length;){let a=Ut(n.text,d);if(i(n.text.slice(d,a))!=o)break;d=a}return y.range(s+n.from,d+n.from)}function or(l,t){return t.left>l?t.left-l:Math.max(0,l-t.right)}function ar(l,t){return t.top>l?t.top-l:Math.max(0,l-t.bottom)}function Kc(l,t){return l.top<t.bottom-1&&l.bottom>t.top+1}function Xo(l,t){return t<l.top?{top:t,left:l.left,right:l.right,bottom:l.bottom}:l}function Io(l,t){return t>l.bottom?{top:l.top,left:l.left,right:l.right,bottom:t}:l}function Hc(l,t,e){let i,n,c,s,d=!1,o,a,h,u;for(let b=l.firstChild;b;b=b.nextSibling){let Z=Ql(b);for(let g=0;g<Z.length;g++){let p=Z[g];n&&Kc(n,p)&&(p=Xo(Io(p,n.bottom),n.top));let R=or(t,p),V=ar(e,p);if(R==0&&V==0)return b.nodeType==3?Vo(b,t,e):Hc(b,t,e);(!i||s>V||s==V&&c>R)&&(i=b,n=p,c=R,s=V,d=!R||(R>0?g<Z.length-1:g>0)),R==0?e>p.bottom&&(!h||h.bottom<p.bottom)?(o=b,h=p):e<p.top&&(!u||u.top>p.top)&&(a=b,u=p):h&&Kc(h,p)?h=Io(h,p.bottom):u&&Kc(u,p)&&(u=Xo(u,p.top))}}if(h&&h.bottom>=e?(i=o,n=h):u&&u.top<=e&&(i=a,n=u),!i)return{node:l,offset:0};let m=Math.max(n.left,Math.min(n.right,t));if(i.nodeType==3)return Vo(i,m,e);if(d&&i.contentEditable!="false")return Hc(i,m,e);let r=Array.prototype.indexOf.call(l.childNodes,i)+(t>=(n.left+n.right)/2?1:0);return{node:l,offset:r}}function Vo(l,t,e){let i=l.nodeValue.length,n=-1,c=1e9,s=0;for(let d=0;d<i;d++){let o=Gl(l,d,d+1).getClientRects();for(let a=0;a<o.length;a++){let h=o[a];if(h.top==h.bottom)continue;s||(s=t-h.left);let u=(h.top>e?h.top-e:e-h.bottom)-1;if(h.left-1<=t&&h.right+1>=t&&u<c){let m=t>=(h.left+h.right)/2,r=m;if((A.chrome||A.gecko)&&Gl(l,d).getBoundingClientRect().left==h.right&&(r=!m),u<=0)return{node:l,offset:d+(r?1:0)};n=d+(r?1:0),c=u}}}return{node:l,offset:n>-1?n:s>0?l.nodeValue.length:0}}function yo(l,{x:t,y:e},i,n=-1){var c;let s=l.contentDOM.getBoundingClientRect(),d=s.top+l.viewState.paddingTop,o,{docHeight:a}=l.viewState,h=e-d;if(h<0)return 0;if(h>a)return l.state.doc.length;for(let p=l.defaultLineHeight/2,R=!1;o=l.elementAtHeight(h),o.type!=nt.Text;)for(;h=n>0?o.bottom+p:o.top-p,!(h>=0&&h<=a);){if(R)return i?null:0;R=!0,n=-n}e=d+h;let u=o.from;if(u<l.viewport.from)return l.viewport.from==0?0:i?null:Ro(l,s,o,t,e);if(u>l.viewport.to)return l.viewport.to==l.state.doc.length?l.state.doc.length:i?null:Ro(l,s,o,t,e);let m=l.dom.ownerDocument,r=l.root.elementFromPoint?l.root:m,b=r.elementFromPoint(t,e);b&&!l.contentDOM.contains(b)&&(b=null),b||(t=Math.max(s.left+1,Math.min(s.right-1,t)),b=r.elementFromPoint(t,e),b&&!l.contentDOM.contains(b)&&(b=null));let Z,g=-1;if(b&&((c=l.docView.nearest(b))===null||c===void 0?void 0:c.isEditable)!=!1){if(m.caretPositionFromPoint){let p=m.caretPositionFromPoint(t,e);p&&({offsetNode:Z,offset:g}=p)}else if(m.caretRangeFromPoint){let p=m.caretRangeFromPoint(t,e);p&&({startContainer:Z,startOffset:g}=p,(!l.contentDOM.contains(Z)||A.safari&&hr(Z,g,t)||A.chrome&&ur(Z,g,t))&&(Z=void 0))}}if(!Z||!l.docView.dom.contains(Z)){let p=Nt.find(l.docView,u);if(!p)return h>o.top+o.height/2?o.to:o.from;({node:Z,offset:g}=Hc(p.dom,t,e))}return l.docView.posFromDOM(Z,g)}function Ro(l,t,e,i,n){let c=Math.round((i-t.left)*l.defaultCharacterWidth);l.lineWrapping&&e.height>l.defaultLineHeight*1.5&&(c+=Math.floor((n-e.top)/l.defaultLineHeight)*l.viewState.heightOracle.lineLength);let s=l.state.sliceDoc(e.from,e.to);return e.from+hc(s,c,l.state.tabSize)}function hr(l,t,e){let i;if(l.nodeType!=3||t!=(i=l.nodeValue.length))return!1;for(let n=l.nextSibling;n;n=n.nextSibling)if(n.nodeType!=1||n.nodeName!="BR")return!1;return Gl(l,i-1,i).getBoundingClientRect().left>e}function ur(l,t,e){if(t!=0)return!1;for(let n=l;;){let c=n.parentNode;if(!c||c.nodeType!=1||c.firstChild!=n)return!1;if(c.classList.contains("cm-line"))break;n=c}let i=l.nodeType==1?l.getBoundingClientRect():Gl(l,0,Math.max(l.nodeValue.length,1)).getBoundingClientRect();return e-i.left>5}function mr(l,t,e,i){let n=l.state.doc.lineAt(t.head),c=!i||!l.lineWrapping?null:l.coordsAtPos(t.assoc<0&&t.head>n.from?t.head-1:t.head);if(c){let o=l.dom.getBoundingClientRect(),a=l.textDirectionAt(n.from),h=l.posAtCoords({x:e==(a==mt.LTR)?o.right-1:o.left+1,y:(c.top+c.bottom)/2});if(h!=null)return y.cursor(h,e?-1:1)}let s=Nt.find(l.docView,t.head),d=s?e?s.posAtEnd:s.posAtStart:e?n.to:n.from;return y.cursor(d,e?-1:1)}function fo(l,t,e,i){let n=l.state.doc.lineAt(t.head),c=l.bidiSpans(n),s=l.textDirectionAt(n.from);for(let d=t,o=null;;){let a=$m(n,c,s,d,e),h=mo;if(!a){if(n.number==(e?l.state.doc.lines:1))return d;h=`
`,n=l.state.doc.line(n.number+(e?1:-1)),c=l.bidiSpans(n),a=y.cursor(e?n.from:n.to)}if(o){if(!o(h))return d}else{if(!i)return a;o=i(h)}d=a}}function rr(l,t,e){let i=l.state.charCategorizer(t),n=i(e);return c=>{let s=i(c);return n==at.Space&&(n=s),n==s}}function br(l,t,e,i){let n=t.head,c=e?1:-1;if(n==(e?l.state.doc.length:0))return y.cursor(n,t.assoc);let s=t.goalColumn,d,o=l.contentDOM.getBoundingClientRect(),a=l.coordsAtPos(n),h=l.documentTop;if(a)s==null&&(s=a.left-o.left),d=c<0?a.top:a.bottom;else{let r=l.viewState.lineBlockAt(n);s==null&&(s=Math.min(o.right-o.left,l.defaultCharacterWidth*(n-r.from))),d=(c<0?r.top:r.bottom)+h}let u=o.left+s,m=i!=null?i:l.defaultLineHeight>>1;for(let r=0;;r+=10){let b=d+(m+r)*c,Z=yo(l,{x:u,y:b},!1,c);if(b<o.top||b>o.bottom||(c<0?Z<n:Z>n))return y.cursor(Z,t.assoc,void 0,s)}}function Bc(l,t,e){let i=l.state.facet(oo).map(n=>n(l));for(;;){let n=!1;for(let c of i)c.between(e.from-1,e.from+1,(s,d,o)=>{e.from>s&&e.from<d&&(e=t.head>e.from?y.cursor(s,1):y.cursor(d,-1),n=!0)});if(!n)return e}}class Zr{constructor(t){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.mouseSelection=null;for(let e in ft){let i=ft[e];t.contentDOM.addEventListener(e,n=>{!So(t,n)||this.ignoreDuringComposition(n)||e=="keydown"&&this.keydown(t,n)||(this.mustFlushObserver(n)&&t.observer.forceFlush(),this.runCustomHandlers(e,t,n)?n.preventDefault():i(t,n))},kc[e]),this.registeredEvents.push(e)}A.chrome&&A.chrome_version==102&&t.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?t.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,t.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=t.hasFocus,A.safari&&t.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}ensureHandlers(t,e){var i;let n;this.customHandlers=[];for(let c of e)if(n=(i=c.update(t).spec)===null||i===void 0?void 0:i.domEventHandlers){this.customHandlers.push({plugin:c.value,handlers:n});for(let s in n)this.registeredEvents.indexOf(s)<0&&s!="scroll"&&(this.registeredEvents.push(s),t.contentDOM.addEventListener(s,d=>{!So(t,d)||this.runCustomHandlers(s,t,d)&&d.preventDefault()}))}}runCustomHandlers(t,e,i){for(let n of this.customHandlers){let c=n.handlers[t];if(c)try{if(c.call(n.plugin,i,e)||i.defaultPrevented)return!0}catch(s){Qt(e.state,s)}}return!1}runScrollHandlers(t,e){this.lastScrollTop=t.scrollDOM.scrollTop,this.lastScrollLeft=t.scrollDOM.scrollLeft;for(let i of this.customHandlers){let n=i.handlers.scroll;if(n)try{n.call(i.plugin,e,t)}catch(c){Qt(t.state,c)}}}keydown(t,e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(A.android&&A.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return t.observer.delayAndroidKey(e.key,e.keyCode),!0;let i;return A.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((i=Co.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||gr.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=i||e,setTimeout(()=>this.flushIOSKey(t),250),!0):!1}flushIOSKey(t){let e=this.pendingIOSKey;return e?(this.pendingIOSKey=void 0,Wl(t.contentDOM,e.key,e.keyCode)):!1}ignoreDuringComposition(t){return/^key/.test(t.type)?this.composing>0?!0:A.safari&&!A.ios&&Date.now()-this.compositionEndedAt<100?(this.compositionEndedAt=0,!0):!1:!1}mustFlushObserver(t){return t.type=="keydown"&&t.keyCode!=229}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.mouseSelection&&this.mouseSelection.update(t),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const Co=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],gr="dthko",Yo=[16,17,18,20,91,92,224,225];class pr{constructor(t,e,i,n){this.view=t,this.style=i,this.mustSelect=n,this.lastEvent=e;let c=t.contentDOM.ownerDocument;c.addEventListener("mousemove",this.move=this.move.bind(this)),c.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=e.shiftKey,this.multiple=t.state.facet(O.allowMultipleSelections)&&Gr(t,e),this.dragMove=Wr(t,e),this.dragging=Xr(t,e)&&vo(e)==1?null:!1,this.dragging===!1&&(e.preventDefault(),this.select(e))}move(t){if(t.buttons==0)return this.destroy();this.dragging===!1&&this.select(this.lastEvent=t)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}select(t){let e=this.style.get(t,this.extend,this.multiple);(this.mustSelect||!e.eq(this.view.state.selection)||e.main.assoc!=this.view.state.selection.main.assoc)&&this.view.dispatch({selection:e,userEvent:"select.pointer",scrollIntoView:!0}),this.mustSelect=!1}update(t){t.docChanged&&this.dragging&&(this.dragging=this.dragging.map(t.changes)),this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Gr(l,t){let e=l.state.facet(_d);return e.length?e[0](t):A.mac?t.metaKey:t.ctrlKey}function Wr(l,t){let e=l.state.facet($d);return e.length?e[0](t):A.mac?!t.altKey:!t.ctrlKey}function Xr(l,t){let{main:e}=l.state.selection;if(e.empty)return!1;let i=Ki(l.root);if(!i||i.rangeCount==0)return!0;let n=i.getRangeAt(0).getClientRects();for(let c=0;c<n.length;c++){let s=n[c];if(s.left<=t.clientX&&s.right>=t.clientX&&s.top<=t.clientY&&s.bottom>=t.clientY)return!0}return!1}function So(l,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let e=t.target,i;e!=l.contentDOM;e=e.parentNode)if(!e||e.nodeType==11||(i=st.get(e))&&i.ignoreEvent(t))return!1;return!0}const ft=Object.create(null),kc=Object.create(null),Lo=A.ie&&A.ie_version<15||A.ios&&A.webkit_version<604;function Ir(l){let t=l.dom.parentNode;if(!t)return;let e=t.appendChild(document.createElement("textarea"));e.style.cssText="position: fixed; left: -10000px; top: 10px",e.focus(),setTimeout(()=>{l.focus(),e.remove(),Jo(l,e.value)},50)}function Jo(l,t){let{state:e}=l,i,n=1,c=e.toText(t),s=c.lines==e.selection.ranges.length;if(xc!=null&&e.selection.ranges.every(o=>o.empty)&&xc==c.toString()){let o=-1;i=e.changeByRange(a=>{let h=e.doc.lineAt(a.from);if(h.from==o)return{range:a};o=h.from;let u=e.toText((s?c.line(n++).text:t)+e.lineBreak);return{changes:{from:h.from,insert:u},range:y.cursor(a.from+u.length)}})}else s?i=e.changeByRange(o=>{let a=c.line(n++);return{changes:{from:o.from,to:o.to,insert:a.text},range:y.cursor(o.from+a.length)}}):i=e.replaceSelection(c);l.dispatch(i,{userEvent:"input.paste",scrollIntoView:!0})}ft.keydown=(l,t)=>{l.inputState.setSelectionOrigin("select"),t.keyCode==27?l.inputState.lastEscPress=Date.now():Yo.indexOf(t.keyCode)<0&&(l.inputState.lastEscPress=0)},ft.touchstart=(l,t)=>{l.inputState.lastTouchTime=Date.now(),l.inputState.setSelectionOrigin("select.pointer")},ft.touchmove=l=>{l.inputState.setSelectionOrigin("select.pointer")},kc.touchstart=kc.touchmove={passive:!0},ft.mousedown=(l,t)=>{if(l.observer.flush(),l.inputState.lastTouchTime>Date.now()-2e3)return;let e=null;for(let i of l.state.facet(to))if(e=i(l,t),e)break;if(!e&&t.button==0&&(e=Rr(l,t)),e){let i=l.root.activeElement!=l.contentDOM;i&&l.observer.ignore(()=>Hd(l.contentDOM)),l.inputState.startMouseSelection(new pr(l,t,e,i))}};function Fo(l,t,e,i){if(i==1)return y.cursor(t,e);if(i==2)return dr(l.state,t,e);{let n=Nt.find(l.docView,t),c=l.state.doc.lineAt(n?n.posAtEnd:t),s=n?n.posAtStart:c.from,d=n?n.posAtEnd:c.to;return d<l.state.doc.length&&d==c.to&&d++,y.range(s,d)}}let Ko=(l,t)=>l>=t.top&&l<=t.bottom,Ho=(l,t,e)=>Ko(t,e)&&l>=e.left&&l<=e.right;function Vr(l,t,e,i){let n=Nt.find(l.docView,t);if(!n)return 1;let c=t-n.posAtStart;if(c==0)return 1;if(c==n.length)return-1;let s=n.coordsAt(c,-1);if(s&&Ho(e,i,s))return-1;let d=n.coordsAt(c,1);return d&&Ho(e,i,d)?1:s&&Ko(i,s)?-1:1}function Bo(l,t){let e=l.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:e,bias:Vr(l,e,t.clientX,t.clientY)}}const yr=A.ie&&A.ie_version<=11;let ko=null,xo=0,wo=0;function vo(l){if(!yr)return l.detail;let t=ko,e=wo;return ko=l,wo=Date.now(),xo=!t||e>Date.now()-400&&Math.abs(t.clientX-l.clientX)<2&&Math.abs(t.clientY-l.clientY)<2?(xo+1)%3:1}function Rr(l,t){let e=Bo(l,t),i=vo(t),n=l.state.selection,c=e,s=t;return{update(d){d.docChanged&&(e.pos=d.changes.mapPos(e.pos),n=n.map(d.changes),s=null)},get(d,o,a){let h;s&&d.clientX==s.clientX&&d.clientY==s.clientY?h=c:(h=c=Bo(l,d),s=d);let u=Fo(l,h.pos,h.bias,i);if(e.pos!=h.pos&&!o){let m=Fo(l,e.pos,e.bias,i),r=Math.min(m.from,u.from),b=Math.max(m.to,u.to);u=r<u.from?y.range(r,b):y.range(b,r)}return o?n.replaceRange(n.main.extend(u.from,u.to)):a&&n.ranges.length>1&&n.ranges.some(m=>m.eq(u))?fr(n,u):a?n.addRange(u):y.create([u])}}}function fr(l,t){for(let e=0;;e++)if(l.ranges[e].eq(t))return y.create(l.ranges.slice(0,e).concat(l.ranges.slice(e+1)),l.mainIndex==e?0:l.mainIndex-(l.mainIndex>e?1:0))}ft.dragstart=(l,t)=>{let{selection:{main:e}}=l.state,{mouseSelection:i}=l.inputState;i&&(i.dragging=e),t.dataTransfer&&(t.dataTransfer.setData("Text",l.state.sliceDoc(e.from,e.to)),t.dataTransfer.effectAllowed="copyMove")};function Uo(l,t,e,i){if(!e)return;let n=l.posAtCoords({x:t.clientX,y:t.clientY},!1);t.preventDefault();let{mouseSelection:c}=l.inputState,s=i&&c&&c.dragging&&c.dragMove?{from:c.dragging.from,to:c.dragging.to}:null,d={from:n,insert:e},o=l.state.changes(s?[s,d]:d);l.focus(),l.dispatch({changes:o,selection:{anchor:o.mapPos(n,-1),head:o.mapPos(n,1)},userEvent:s?"move.drop":"input.drop"})}ft.drop=(l,t)=>{if(!t.dataTransfer)return;if(l.state.readOnly)return t.preventDefault();let e=t.dataTransfer.files;if(e&&e.length){t.preventDefault();let i=Array(e.length),n=0,c=()=>{++n==e.length&&Uo(l,t,i.filter(s=>s!=null).join(l.state.lineBreak),!1)};for(let s=0;s<e.length;s++){let d=new FileReader;d.onerror=c,d.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(d.result)||(i[s]=d.result),c()},d.readAsText(e[s])}}else Uo(l,t,t.dataTransfer.getData("Text"),!0)},ft.paste=(l,t)=>{if(l.state.readOnly)return t.preventDefault();l.observer.flush();let e=Lo?null:t.clipboardData;e?(Jo(l,e.getData("text/plain")),t.preventDefault()):Ir(l)};function Cr(l,t){let e=l.dom.parentNode;if(!e)return;let i=e.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.value=t,i.focus(),i.selectionEnd=t.length,i.selectionStart=0,setTimeout(()=>{i.remove(),l.focus()},50)}function Yr(l){let t=[],e=[],i=!1;for(let n of l.selection.ranges)n.empty||(t.push(l.sliceDoc(n.from,n.to)),e.push(n));if(!t.length){let n=-1;for(let{from:c}of l.selection.ranges){let s=l.doc.lineAt(c);s.number>n&&(t.push(s.text),e.push({from:s.from,to:Math.min(l.doc.length,s.to+1)})),n=s.number}i=!0}return{text:t.join(l.lineBreak),ranges:e,linewise:i}}let xc=null;ft.copy=ft.cut=(l,t)=>{let{text:e,ranges:i,linewise:n}=Yr(l.state);if(!e&&!n)return;xc=n?e:null;let c=Lo?null:t.clipboardData;c?(t.preventDefault(),c.clearData(),c.setData("text/plain",e)):Cr(l,e),t.type=="cut"&&!l.state.readOnly&&l.dispatch({changes:i,scrollIntoView:!0,userEvent:"delete.cut"})};function Ao(l){setTimeout(()=>{l.hasFocus!=l.inputState.notifiedFocused&&l.update([])},10)}ft.focus=l=>{l.inputState.lastFocusTime=Date.now(),!l.scrollDOM.scrollTop&&(l.inputState.lastScrollTop||l.inputState.lastScrollLeft)&&(l.scrollDOM.scrollTop=l.inputState.lastScrollTop,l.scrollDOM.scrollLeft=l.inputState.lastScrollLeft),Ao(l)},ft.blur=l=>{l.observer.clearSelectionRange(),Ao(l)},ft.compositionstart=ft.compositionupdate=l=>{l.inputState.compositionFirstChange==null&&(l.inputState.compositionFirstChange=!0),l.inputState.composing<0&&(l.inputState.composing=0)},ft.compositionend=l=>{l.inputState.composing=-1,l.inputState.compositionEndedAt=Date.now(),l.inputState.compositionFirstChange=null,A.chrome&&A.android&&l.observer.flushSoon(),setTimeout(()=>{l.inputState.composing<0&&l.docView.compositionDeco.size&&l.update([])},50)},ft.contextmenu=l=>{l.inputState.lastContextMenu=Date.now()},ft.beforeinput=(l,t)=>{var e;let i;if(A.chrome&&A.android&&(i=Co.find(n=>n.inputType==t.inputType))&&(l.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let n=((e=window.visualViewport)===null||e===void 0?void 0:e.height)||0;setTimeout(()=>{var c;(((c=window.visualViewport)===null||c===void 0?void 0:c.height)||0)>n+10&&l.hasFocus&&(l.contentDOM.blur(),l.focus())},100)}};const No=["pre-wrap","normal","pre-line","break-spaces"];class Sr{constructor(t){this.lineWrapping=t,this.doc=$.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.lineLength=30,this.heightChanged=!1}heightForGap(t,e){let i=this.doc.lineAt(e).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(i+=Math.ceil((e-t-i*this.lineLength*.5)/this.lineLength)),this.lineHeight*i}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return No.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let e=!1;for(let i=0;i<t.length;i++){let n=t[i];n<0?i++:this.heightSamples[Math.floor(n*10)]||(e=!0,this.heightSamples[Math.floor(n*10)]=!0)}return e}refresh(t,e,i,n,c){let s=No.indexOf(t)>-1,d=Math.round(e)!=Math.round(this.lineHeight)||this.lineWrapping!=s;if(this.lineWrapping=s,this.lineHeight=e,this.charWidth=i,this.lineLength=n,d){this.heightSamples={};for(let o=0;o<c.length;o++){let a=c[o];a<0?o++:this.heightSamples[Math.floor(a*10)]=!0}}return d}}class Lr{constructor(t,e){this.from=t,this.heights=e,this.index=0}get more(){return this.index<this.heights.length}}class Ne{constructor(t,e,i,n,c){this.from=t,this.length=e,this.top=i,this.height=n,this.type=c}get to(){return this.from+this.length}get bottom(){return this.top+this.height}join(t){let e=(Array.isArray(this.type)?this.type:[this]).concat(Array.isArray(t.type)?t.type:[t]);return new Ne(this.from,this.length+t.length,this.top,this.height+t.height,e)}}var dt=function(l){return l[l.ByPos=0]="ByPos",l[l.ByHeight=1]="ByHeight",l[l.ByPosNoHeight=2]="ByPosNoHeight",l}(dt||(dt={}));const zi=.001;class zt{constructor(t,e,i=2){this.length=t,this.height=e,this.flags=i}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t,e){this.height!=e&&(Math.abs(this.height-e)>zi&&(t.heightChanged=!0),this.height=e)}replace(t,e,i){return zt.of(i)}decomposeLeft(t,e){e.push(this)}decomposeRight(t,e){e.push(this)}applyChanges(t,e,i,n){let c=this;for(let s=n.length-1;s>=0;s--){let{fromA:d,toA:o,fromB:a,toB:h}=n[s],u=c.lineAt(d,dt.ByPosNoHeight,e,0,0),m=u.to>=o?u:c.lineAt(o,dt.ByPosNoHeight,e,0,0);for(h+=m.to-o,o=m.to;s>0&&u.from<=n[s-1].toA;)d=n[s-1].fromA,a=n[s-1].fromB,s--,d<u.from&&(u=c.lineAt(d,dt.ByPosNoHeight,e,0,0));a+=u.from-d,d=u.from;let r=wc.build(i,t,a,h);c=c.replace(d,o,r)}return c.updateHeight(i,0)}static empty(){return new Dt(0,0)}static of(t){if(t.length==1)return t[0];let e=0,i=t.length,n=0,c=0;for(;;)if(e==i)if(n>c*2){let d=t[e-1];d.break?t.splice(--e,1,d.left,null,d.right):t.splice(--e,1,d.left,d.right),i+=1+d.break,n-=d.size}else if(c>n*2){let d=t[i];d.break?t.splice(i,1,d.left,null,d.right):t.splice(i,1,d.left,d.right),i+=2+d.break,c-=d.size}else break;else if(n<c){let d=t[e++];d&&(n+=d.size)}else{let d=t[--i];d&&(c+=d.size)}let s=0;return t[e-1]==null?(s=1,e--):t[e]==null&&(s=1,i++),new Jr(zt.of(t.slice(0,e)),s,zt.of(t.slice(i)))}}zt.prototype.size=1;class zo extends zt{constructor(t,e,i){super(t,e),this.type=i}blockAt(t,e,i,n){return new Ne(n,this.length,i,this.height,this.type)}lineAt(t,e,i,n,c){return this.blockAt(0,i,n,c)}forEachLine(t,e,i,n,c,s){t<=c+this.length&&e>=c&&s(this.blockAt(0,i,n,c))}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more&&this.setHeight(t,n.heights[n.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Dt extends zo{constructor(t,e){super(t,e,nt.Text),this.collapsed=0,this.widgetHeight=0}replace(t,e,i){let n=i[0];return i.length==1&&(n instanceof Dt||n instanceof Lt&&n.flags&4)&&Math.abs(this.length-n.length)<10?(n instanceof Lt?n=new Dt(n.length,this.height):n.height=this.height,this.outdated||(n.outdated=!1),n):zt.of(i)}updateHeight(t,e=0,i=!1,n){return n&&n.from<=e&&n.more?this.setHeight(t,n.heights[n.index++]):(i||this.outdated)&&this.setHeight(t,Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Lt extends zt{constructor(t){super(t,0)}lines(t,e){let i=t.lineAt(e).number,n=t.lineAt(e+this.length).number;return{firstLine:i,lastLine:n,lineHeight:this.height/(n-i+1)}}blockAt(t,e,i,n){let{firstLine:c,lastLine:s,lineHeight:d}=this.lines(e,n),o=Math.max(0,Math.min(s-c,Math.floor((t-i)/d))),{from:a,length:h}=e.line(c+o);return new Ne(a,h,i+d*o,d,nt.Text)}lineAt(t,e,i,n,c){if(e==dt.ByHeight)return this.blockAt(t,i,n,c);if(e==dt.ByPosNoHeight){let{from:u,to:m}=i.lineAt(t);return new Ne(u,m-u,0,0,nt.Text)}let{firstLine:s,lineHeight:d}=this.lines(i,c),{from:o,length:a,number:h}=i.lineAt(t);return new Ne(o,a,n+d*(h-s),d,nt.Text)}forEachLine(t,e,i,n,c,s){let{firstLine:d,lineHeight:o}=this.lines(i,c);for(let a=Math.max(t,c),h=Math.min(c+this.length,e);a<=h;){let u=i.lineAt(a);a==t&&(n+=o*(u.number-d)),s(new Ne(u.from,u.length,n,o,nt.Text)),n+=o,a=u.to+1}}replace(t,e,i){let n=this.length-e;if(n>0){let c=i[i.length-1];c instanceof Lt?i[i.length-1]=new Lt(c.length+n):i.push(null,new Lt(n-1))}if(t>0){let c=i[0];c instanceof Lt?i[0]=new Lt(t+c.length):i.unshift(new Lt(t-1),null)}return zt.of(i)}decomposeLeft(t,e){e.push(new Lt(t-1),null)}decomposeRight(t,e){e.push(null,new Lt(this.length-t-1))}updateHeight(t,e=0,i=!1,n){let c=e+this.length;if(n&&n.from<=e+this.length&&n.more){let s=[],d=Math.max(e,n.from),o=-1,a=t.heightChanged;for(n.from>e&&s.push(new Lt(n.from-e-1).updateHeight(t,e));d<=c&&n.more;){let u=t.doc.lineAt(d).length;s.length&&s.push(null);let m=n.heights[n.index++];o==-1?o=m:Math.abs(m-o)>=zi&&(o=-2);let r=new Dt(u,m);r.outdated=!1,s.push(r),d+=u+1}d<=c&&s.push(null,new Lt(c-d).updateHeight(t,d));let h=zt.of(s);return t.heightChanged=a||o<0||Math.abs(h.height-this.height)>=zi||Math.abs(o-this.lines(t.doc,e).lineHeight)>=zi,h}else(i||this.outdated)&&(this.setHeight(t,t.heightForGap(e,e+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Jr extends zt{constructor(t,e,i){super(t.length+e+i.length,t.height+i.height,e|(t.outdated||i.outdated?2:0)),this.left=t,this.right=i,this.size=t.size+i.size}get break(){return this.flags&1}blockAt(t,e,i,n){let c=i+this.left.height;return t<c?this.left.blockAt(t,e,i,n):this.right.blockAt(t,e,c,n+this.left.length+this.break)}lineAt(t,e,i,n,c){let s=n+this.left.height,d=c+this.left.length+this.break,o=e==dt.ByHeight?t<s:t<d,a=o?this.left.lineAt(t,e,i,n,c):this.right.lineAt(t,e,i,s,d);if(this.break||(o?a.to<d:a.from>d))return a;let h=e==dt.ByPosNoHeight?dt.ByPosNoHeight:dt.ByPos;return o?a.join(this.right.lineAt(d,h,i,s,d)):this.left.lineAt(d,h,i,n,c).join(a)}forEachLine(t,e,i,n,c,s){let d=n+this.left.height,o=c+this.left.length+this.break;if(this.break)t<o&&this.left.forEachLine(t,e,i,n,c,s),e>=o&&this.right.forEachLine(t,e,i,d,o,s);else{let a=this.lineAt(o,dt.ByPos,i,n,c);t<a.from&&this.left.forEachLine(t,a.from-1,i,n,c,s),a.to>=t&&a.from<=e&&s(a),e>a.to&&this.right.forEachLine(a.to+1,e,i,d,o,s)}}replace(t,e,i){let n=this.left.length+this.break;if(e<n)return this.balanced(this.left.replace(t,e,i),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-n,e-n,i));let c=[];t>0&&this.decomposeLeft(t,c);let s=c.length;for(let d of i)c.push(d);if(t>0&&To(c,s-1),e<this.length){let d=c.length;this.decomposeRight(e,c),To(c,d)}return zt.of(c)}decomposeLeft(t,e){let i=this.left.length;if(t<=i)return this.left.decomposeLeft(t,e);e.push(this.left),this.break&&(i++,t>=i&&e.push(null)),t>i&&this.right.decomposeLeft(t-i,e)}decomposeRight(t,e){let i=this.left.length,n=i+this.break;if(t>=n)return this.right.decomposeRight(t-n,e);t<i&&this.left.decomposeRight(t,e),this.break&&t<n&&e.push(null),e.push(this.right)}balanced(t,e){return t.size>2*e.size||e.size>2*t.size?zt.of(this.break?[t,null,e]:[t,e]):(this.left=t,this.right=e,this.height=t.height+e.height,this.outdated=t.outdated||e.outdated,this.size=t.size+e.size,this.length=t.length+this.break+e.length,this)}updateHeight(t,e=0,i=!1,n){let{left:c,right:s}=this,d=e+c.length+this.break,o=null;return n&&n.from<=e+c.length&&n.more?o=c=c.updateHeight(t,e,i,n):c.updateHeight(t,e,i),n&&n.from<=d+s.length&&n.more?o=s=s.updateHeight(t,d,i,n):s.updateHeight(t,d,i),o?this.balanced(c,s):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function To(l,t){let e,i;l[t]==null&&(e=l[t-1])instanceof Lt&&(i=l[t+1])instanceof Lt&&l.splice(t-1,3,new Lt(e.length+1+i.length))}const Fr=5;class wc{constructor(t,e){this.pos=t,this.oracle=e,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,e){if(this.lineStart>-1){let i=Math.min(e,this.lineEnd),n=this.nodes[this.nodes.length-1];n instanceof Dt?n.length+=i-this.pos:(i>this.pos||!this.isCovered)&&this.nodes.push(new Dt(i-this.pos,-1)),this.writtenTo=i,e>i&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=e}point(t,e,i){if(t<e||i.heightRelevant){let n=i.widget?i.widget.estimatedHeight:0;n<0&&(n=this.oracle.lineHeight);let c=e-t;i.block?this.addBlock(new zo(c,n,i.type)):(c||n>=Fr)&&this.addLineDeco(n,c)}else e>t&&this.span(t,e);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:e}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=e,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new Dt(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,e){let i=new Lt(e-t);return this.oracle.doc.lineAt(t).to==e&&(i.flags|=4),i}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof Dt)return t;let e=new Dt(0,-1);return this.nodes.push(e),e}addBlock(t){this.enterLine(),t.type==nt.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,t.type!=nt.WidgetBefore&&(this.covering=t)}addLineDeco(t,e){let i=this.ensureLine();i.length+=e,i.collapsed+=e,i.widgetHeight=Math.max(i.widgetHeight,t),this.writtenTo=this.pos=this.pos+e}finish(t){let e=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(e instanceof Dt)&&!this.isCovered?this.nodes.push(new Dt(0,-1)):(this.writtenTo<this.pos||e==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let i=t;for(let n of this.nodes)n instanceof Dt&&n.updateHeight(this.oracle,i),i+=n?n.length:1;return this.nodes}static build(t,e,i,n){let c=new wc(i,t);return lt.spans(e,i,n,c,0),c.finish(i)}}function Kr(l,t,e){let i=new Hr;return lt.compare(l,t,e,i,0),i.changes}class Hr{constructor(){this.changes=[]}compareRange(){}comparePoint(t,e,i,n){(t<e||i&&i.heightRelevant||n&&n.heightRelevant)&&fc(t,e,this.changes,5)}}function Br(l,t){let e=l.getBoundingClientRect(),i=l.ownerDocument,n=i.defaultView||window,c=Math.max(0,e.left),s=Math.min(n.innerWidth,e.right),d=Math.max(0,e.top),o=Math.min(n.innerHeight,e.bottom);for(let a=l.parentNode;a&&a!=i.body;)if(a.nodeType==1){let h=a,u=window.getComputedStyle(h);if((h.scrollHeight>h.clientHeight||h.scrollWidth>h.clientWidth)&&u.overflow!="visible"){let m=h.getBoundingClientRect();c=Math.max(c,m.left),s=Math.min(s,m.right),d=Math.max(d,m.top),o=a==l.parentNode?m.bottom:Math.min(o,m.bottom)}a=u.position=="absolute"||u.position=="fixed"?h.offsetParent:h.parentNode}else if(a.nodeType==11)a=a.host;else break;return{left:c-e.left,right:Math.max(c,s)-e.left,top:d-(e.top+t),bottom:Math.max(d,o)-(e.top+t)}}function kr(l,t){let e=l.getBoundingClientRect();return{left:0,right:e.right-e.left,top:t,bottom:e.bottom-(e.top+t)}}class vc{constructor(t,e,i){this.from=t,this.to=e,this.size=i}static same(t,e){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++){let n=t[i],c=e[i];if(n.from!=c.from||n.to!=c.to||n.size!=c.size)return!1}return!0}draw(t){return N.replace({widget:new xr(this.size,t)}).range(this.from,this.to)}}class xr extends Ue{constructor(t,e){super(),this.size=t,this.vertical=e}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class Mo{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scaler=Po,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=mt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let e=t.facet(Lc).some(i=>typeof i!="function"&&i.class=="cm-lineWrapping");this.heightOracle=new Sr(e),this.stateDeco=t.facet(_l).filter(i=>typeof i!="function"),this.heightMap=zt.empty().applyChanges(this.stateDeco,$.empty,this.heightOracle.setDoc(t.doc),[new ge(0,0,0,t.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=N.set(this.lineGaps.map(i=>i.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:e}=this.state.selection;for(let i=0;i<=1;i++){let n=i?e.head:e.anchor;if(!t.some(({from:c,to:s})=>n>=c&&n<=s)){let{from:c,to:s}=this.lineBlockAt(n);t.push(new Ti(c,s))}}this.viewports=t.sort((i,n)=>i.from-n.from),this.scaler=this.heightMap.height<=7e6?Po:new Ur(this.heightOracle.doc,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.state.doc,0,0,t=>{this.viewportLines.push(this.scaler.scale==1?t:ti(t,this.scaler))})}update(t,e=null){this.state=t.state;let i=this.stateDeco;this.stateDeco=this.state.facet(_l).filter(a=>typeof a!="function");let n=t.changedRanges,c=ge.extendWithRanges(n,Kr(i,this.stateDeco,t?t.changes:yt.empty(this.state.doc.length))),s=this.heightMap.height;this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),c),this.heightMap.height!=s&&(t.flags|=2);let d=c.length?this.mapViewport(this.viewport,t.changes):this.viewport;(e&&(e.range.head<d.from||e.range.head>d.to)||!this.viewportIsAppropriate(d))&&(d=this.getViewport(0,e));let o=!t.changes.empty||t.flags&2||d.from!=this.viewport.from||d.to!=this.viewport.to;this.viewport=d,this.updateForViewport(),o&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(),e&&(this.scrollTarget=e),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(no)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let e=t.contentDOM,i=window.getComputedStyle(e),n=this.heightOracle,c=i.whiteSpace;this.defaultTextDirection=i.direction=="rtl"?mt.RTL:mt.LTR;let s=this.heightOracle.mustRefreshForWrapping(c),d=s||this.mustMeasureContent||this.contentDOMHeight!=e.clientHeight;this.contentDOMHeight=e.clientHeight,this.mustMeasureContent=!1;let o=0,a=0,h=parseInt(i.paddingTop)||0,u=parseInt(i.paddingBottom)||0;(this.paddingTop!=h||this.paddingBottom!=u)&&(this.paddingTop=h,this.paddingBottom=u,o|=10),this.editorWidth!=t.scrollDOM.clientWidth&&(n.lineWrapping&&(d=!0),this.editorWidth=t.scrollDOM.clientWidth,o|=8);let m=(this.printing?kr:Br)(e,this.paddingTop),r=m.top-this.pixelViewport.top,b=m.bottom-this.pixelViewport.bottom;this.pixelViewport=m;let Z=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(Z!=this.inView&&(this.inView=Z,Z&&(d=!0)),!this.inView&&!this.scrollTarget)return 0;let g=e.clientWidth;if((this.contentDOMWidth!=g||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=g,this.editorHeight=t.scrollDOM.clientHeight,o|=8),d){let R=t.docView.measureVisibleLineHeights(this.viewport);if(n.mustRefreshForHeights(R)&&(s=!0),s||n.lineWrapping&&Math.abs(g-this.contentDOMWidth)>n.charWidth){let{lineHeight:V,charWidth:W}=t.docView.measureTextSize();s=V>0&&n.refresh(c,V,W,g/W,R),s&&(t.docView.minWidth=0,o|=8)}r>0&&b>0?a=Math.max(r,b):r<0&&b<0&&(a=Math.min(r,b)),n.heightChanged=!1;for(let V of this.viewports){let W=V.from==this.viewport.from?R:t.docView.measureVisibleLineHeights(V);this.heightMap=(s?zt.empty().applyChanges(this.stateDeco,$.empty,this.heightOracle,[new ge(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(n,0,s,new Lr(V.from,W))}n.heightChanged&&(o|=2)}let p=!this.viewportIsAppropriate(this.viewport,a)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return p&&(this.viewport=this.getViewport(a,this.scrollTarget)),this.updateForViewport(),(o&2||p)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(s?[]:this.lineGaps,t)),o|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),o}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,e){let i=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),n=this.heightMap,c=this.state.doc,{visibleTop:s,visibleBottom:d}=this,o=new Ti(n.lineAt(s-i*1e3,dt.ByHeight,c,0,0).from,n.lineAt(d+(1-i)*1e3,dt.ByHeight,c,0,0).to);if(e){let{head:a}=e.range;if(a<o.from||a>o.to){let h=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),u=n.lineAt(a,dt.ByPos,c,0,0),m;e.y=="center"?m=(u.top+u.bottom)/2-h/2:e.y=="start"||e.y=="nearest"&&a<o.from?m=u.top:m=u.bottom-h,o=new Ti(n.lineAt(m-1e3/2,dt.ByHeight,c,0,0).from,n.lineAt(m+h+1e3/2,dt.ByHeight,c,0,0).to)}}return o}mapViewport(t,e){let i=e.mapPos(t.from,-1),n=e.mapPos(t.to,1);return new Ti(this.heightMap.lineAt(i,dt.ByPos,this.state.doc,0,0).from,this.heightMap.lineAt(n,dt.ByPos,this.state.doc,0,0).to)}viewportIsAppropriate({from:t,to:e},i=0){if(!this.inView)return!0;let{top:n}=this.heightMap.lineAt(t,dt.ByPos,this.state.doc,0,0),{bottom:c}=this.heightMap.lineAt(e,dt.ByPos,this.state.doc,0,0),{visibleTop:s,visibleBottom:d}=this;return(t==0||n<=s-Math.max(10,Math.min(-i,250)))&&(e==this.state.doc.length||c>=d+Math.max(10,Math.min(i,250)))&&n>s-2*1e3&&c<d+2*1e3}mapLineGaps(t,e){if(!t.length||e.empty)return t;let i=[];for(let n of t)e.touchesRange(n.from,n.to)||i.push(new vc(e.mapPos(n.from),e.mapPos(n.to),n.size));return i}ensureLineGaps(t,e){let i=this.heightOracle.lineWrapping,n=i?1e4:2e3,c=n>>1,s=n<<1;if(this.defaultTextDirection!=mt.LTR&&!i)return[];let d=[],o=(a,h,u,m)=>{if(h-a<c)return;let r=this.state.selection.main,b=[r.from];r.empty||b.push(r.to);for(let g of b)if(g>a&&g<h){o(a,g-10,u,m),o(g+10,h,u,m);return}let Z=vr(t,g=>g.from>=u.from&&g.to<=u.to&&Math.abs(g.from-a)<c&&Math.abs(g.to-h)<c&&!b.some(p=>g.from<p&&g.to>p));if(!Z){if(h<u.to&&e&&i&&e.visibleRanges.some(g=>g.from<=h&&g.to>=h)){let g=e.moveToLineBoundary(y.cursor(h),!1,!0).head;g>a&&(h=g)}Z=new vc(a,h,this.gapSize(u,a,h,m))}d.push(Z)};for(let a of this.viewportLines){if(a.length<s)continue;let h=wr(a.from,a.to,this.stateDeco);if(h.total<s)continue;let u=this.scrollTarget?this.scrollTarget.range.head:null,m,r;if(i){let b=n/this.heightOracle.lineLength*this.heightOracle.lineHeight,Z,g;if(u!=null){let p=Pi(h,u),R=((this.visibleBottom-this.visibleTop)/2+b)/a.height;Z=p-R,g=p+R}else Z=(this.visibleTop-a.top-b)/a.height,g=(this.visibleBottom-a.top+b)/a.height;m=Mi(h,Z),r=Mi(h,g)}else{let b=h.total*this.heightOracle.charWidth,Z=n*this.heightOracle.charWidth,g,p;if(u!=null){let R=Pi(h,u),V=((this.pixelViewport.right-this.pixelViewport.left)/2+Z)/b;g=R-V,p=R+V}else g=(this.pixelViewport.left-Z)/b,p=(this.pixelViewport.right+Z)/b;m=Mi(h,g),r=Mi(h,p)}m>a.from&&o(a.from,m,a,h),r<a.to&&o(r,a.to,a,h)}return d}gapSize(t,e,i,n){let c=Pi(n,i)-Pi(n,e);return this.heightOracle.lineWrapping?t.height*c:n.total*this.heightOracle.charWidth*c}updateLineGaps(t){vc.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=N.set(t.map(e=>e.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let e=[];lt.spans(t,this.viewport.from,this.viewport.to,{span(n,c){e.push({from:n,to:c})},point(){}},20);let i=e.length!=this.visibleRanges.length||this.visibleRanges.some((n,c)=>n.from!=e[c].from||n.to!=e[c].to);return this.visibleRanges=e,i?4:0}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(e=>e.from<=t&&e.to>=t)||ti(this.heightMap.lineAt(t,dt.ByPos,this.state.doc,0,0),this.scaler)}lineBlockAtHeight(t){return ti(this.heightMap.lineAt(this.scaler.fromDOM(t),dt.ByHeight,this.state.doc,0,0),this.scaler)}elementAtHeight(t){return ti(this.heightMap.blockAt(this.scaler.fromDOM(t),this.state.doc,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Ti{constructor(t,e){this.from=t,this.to=e}}function wr(l,t,e){let i=[],n=l,c=0;return lt.spans(e,l,t,{span(){},point(s,d){s>n&&(i.push({from:n,to:s}),c+=s-n),n=d}},20),n<t&&(i.push({from:n,to:t}),c+=t-n),{total:c,ranges:i}}function Mi({total:l,ranges:t},e){if(e<=0)return t[0].from;if(e>=1)return t[t.length-1].to;let i=Math.floor(l*e);for(let n=0;;n++){let{from:c,to:s}=t[n],d=s-c;if(i<=d)return c+i;i-=d}}function Pi(l,t){let e=0;for(let{from:i,to:n}of l.ranges){if(t<=n){e+=t-i;break}e+=n-i}return e/l.total}function vr(l,t){for(let e of l)if(t(e))return e}const Po={toDOM(l){return l},fromDOM(l){return l},scale:1};class Ur{constructor(t,e,i){let n=0,c=0,s=0;this.viewports=i.map(({from:d,to:o})=>{let a=e.lineAt(d,dt.ByPos,t,0,0).top,h=e.lineAt(o,dt.ByPos,t,0,0).bottom;return n+=h-a,{from:d,to:o,top:a,bottom:h,domTop:0,domBottom:0}}),this.scale=(7e6-n)/(e.height-n);for(let d of this.viewports)d.domTop=s+(d.top-c)*this.scale,s=d.domBottom=d.domTop+(d.bottom-d.top),c=d.bottom}toDOM(t){for(let e=0,i=0,n=0;;e++){let c=e<this.viewports.length?this.viewports[e]:null;if(!c||t<c.top)return n+(t-i)*this.scale;if(t<=c.bottom)return c.domTop+(t-c.top);i=c.bottom,n=c.domBottom}}fromDOM(t){for(let e=0,i=0,n=0;;e++){let c=e<this.viewports.length?this.viewports[e]:null;if(!c||t<c.domTop)return i+(t-n)/this.scale;if(t<=c.domBottom)return c.top+(t-c.domTop);i=c.bottom,n=c.domBottom}}}function ti(l,t){if(t.scale==1)return l;let e=t.toDOM(l.top),i=t.toDOM(l.bottom);return new Ne(l.from,l.length,e,i-e,Array.isArray(l.type)?l.type.map(n=>ti(n,t)):l.type)}const Ei=U.define({combine:l=>l.join(" ")}),Uc=U.define({combine:l=>l.indexOf(!0)>-1}),Ac=ke.newName(),Eo=ke.newName(),jo=ke.newName(),Qo={"&light":"."+Eo,"&dark":"."+jo};function Nc(l,t,e){return new ke(t,{finish(i){return/&/.test(i)?i.replace(/&\w*/,n=>{if(n=="&")return l;if(!e||!e[n])throw new RangeError(`Unsupported selector: ${n}`);return e[n]}):l+" "+i}})}const Ar=Nc("."+Ac,{"&.cm-editor":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,minHeight:"100%",display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},"&.cm-focused .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",left:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},Qo);class Nr{constructor(t,e,i,n){this.typeOver=n,this.bounds=null,this.text="";let{impreciseHead:c,impreciseAnchor:s}=t.docView;if(t.state.readOnly&&e>-1)this.newSel=null;else if(e>-1&&(this.bounds=t.docView.domBoundsAround(e,i,0))){let d=c||s?[]:Tr(t),o=new ro(d,t.state);o.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=o.text,this.newSel=Mr(d,this.bounds.from)}else{let d=t.observer.selectionRange,o=c&&c.node==d.focusNode&&c.offset==d.focusOffset||!gl(t.contentDOM,d.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(d.focusNode,d.focusOffset),a=s&&s.node==d.anchorNode&&s.offset==d.anchorOffset||!gl(t.contentDOM,d.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(d.anchorNode,d.anchorOffset);this.newSel=y.single(a,o)}}}function Do(l,t){let e,{newSel:i}=t,n=l.state.selection.main;if(t.bounds){let{from:c,to:s}=t.bounds,d=n.from,o=null;(l.inputState.lastKeyCode===8&&l.inputState.lastKeyTime>Date.now()-100||A.android&&t.text.length<s-c)&&(d=n.to,o="end");let a=zr(l.state.doc.sliceString(c,s,Ae),t.text,d-c,o);a&&(A.chrome&&l.inputState.lastKeyCode==13&&a.toB==a.from+2&&t.text.slice(a.from,a.toB)==Ae+Ae&&a.toB--,e={from:c+a.from,to:c+a.toA,insert:$.of(t.text.slice(a.from,a.toB).split(Ae))})}else i&&(!l.hasFocus||!l.state.facet(Ai)||i.main.eq(n))&&(i=null);if(!e&&!i)return!1;if(!e&&t.typeOver&&!n.empty&&i&&i.main.empty?e={from:n.from,to:n.to,insert:l.state.doc.slice(n.from,n.to)}:e&&e.from>=n.from&&e.to<=n.to&&(e.from!=n.from||e.to!=n.to)&&n.to-n.from-(e.to-e.from)<=4?e={from:n.from,to:n.to,insert:l.state.doc.slice(n.from,e.from).append(e.insert).append(l.state.doc.slice(e.to,n.to))}:(A.mac||A.android)&&e&&e.from==e.to&&e.from==n.head-1&&/^\. ?$/.test(e.insert.toString())?(i&&e.insert.length==2&&(i=y.single(i.main.anchor-1,i.main.head-1)),e={from:n.from,to:n.to,insert:$.of([" "])}):A.chrome&&e&&e.from==e.to&&e.from==n.head&&e.insert.toString()==`
 `&&l.lineWrapping&&(i&&(i=y.single(i.main.anchor-1,i.main.head-1)),e={from:n.from,to:n.to,insert:$.of([" "])}),e){let c=l.state;if(A.ios&&l.inputState.flushIOSKey(l)||A.android&&(e.from==n.from&&e.to==n.to&&e.insert.length==1&&e.insert.lines==2&&Wl(l.contentDOM,"Enter",13)||e.from==n.from-1&&e.to==n.to&&e.insert.length==0&&Wl(l.contentDOM,"Backspace",8)||e.from==n.from&&e.to==n.to+1&&e.insert.length==0&&Wl(l.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();if(l.state.facet(lo).some(a=>a(l,e.from,e.to,s)))return!0;l.inputState.composing>=0&&l.inputState.composing++;let d;if(e.from>=n.from&&e.to<=n.to&&e.to-e.from>=(n.to-n.from)/3&&(!i||i.main.empty&&i.main.from==e.from+e.insert.length)&&l.inputState.composing<0){let a=n.from<e.from?c.sliceDoc(n.from,e.from):"",h=n.to>e.to?c.sliceDoc(e.to,n.to):"";d=c.replaceSelection(l.state.toText(a+e.insert.sliceString(0,void 0,l.state.lineBreak)+h))}else{let a=c.changes(e),h=i&&!c.selection.main.eq(i.main)&&i.main.to<=a.newLength?i.main:void 0;if(c.selection.ranges.length>1&&l.inputState.composing>=0&&e.to<=n.to&&e.to>=n.to-10){let u=l.state.sliceDoc(e.from,e.to),m=Go(l)||l.state.doc.lineAt(n.head),r=n.to-e.to,b=n.to-n.from;d=c.changeByRange(Z=>{if(Z.from==n.from&&Z.to==n.to)return{changes:a,range:h||Z.map(a)};let g=Z.to-r,p=g-u.length;if(Z.to-Z.from!=b||l.state.sliceDoc(p,g)!=u||m&&Z.to>=m.from&&Z.from<=m.to)return{range:Z};let R=c.changes({from:p,to:g,insert:e.insert}),V=Z.to-n.to;return{changes:R,range:h?y.range(Math.max(0,h.anchor+V),Math.max(0,h.head+V)):Z.map(R)}})}else d={changes:a,selection:h&&c.selection.replaceRange(h)}}let o="input.type";return l.composing&&(o+=".compose",l.inputState.compositionFirstChange&&(o+=".start",l.inputState.compositionFirstChange=!1)),l.dispatch(d,{scrollIntoView:!0,userEvent:o}),!0}else if(i&&!i.main.eq(n)){let c=!1,s="select";return l.inputState.lastSelectionTime>Date.now()-50&&(l.inputState.lastSelectionOrigin=="select"&&(c=!0),s=l.inputState.lastSelectionOrigin),l.dispatch({selection:i,scrollIntoView:c,userEvent:s}),!0}else return!1}function zr(l,t,e,i){let n=Math.min(l.length,t.length),c=0;for(;c<n&&l.charCodeAt(c)==t.charCodeAt(c);)c++;if(c==n&&l.length==t.length)return null;let s=l.length,d=t.length;for(;s>0&&d>0&&l.charCodeAt(s-1)==t.charCodeAt(d-1);)s--,d--;if(i=="end"){let o=Math.max(0,c-Math.min(s,d));e-=s+o-c}return s<c&&l.length<t.length?(c-=e<=c&&e>=s?c-e:0,d=c+(d-s),s=c):d<c&&(c-=e<=c&&e>=d?c-e:0,s=c+(s-d),d=c),{from:c,toA:s,toB:d}}function Tr(l){let t=[];if(l.root.activeElement!=l.contentDOM)return t;let{anchorNode:e,anchorOffset:i,focusNode:n,focusOffset:c}=l.observer.selectionRange;return e&&(t.push(new Zo(e,i)),(n!=e||c!=i)&&t.push(new Zo(n,c))),t}function Mr(l,t){if(l.length==0)return null;let e=l[0].pos,i=l.length==2?l[1].pos:e;return e>-1&&i>-1?y.single(e+t,i+t):null}const Pr={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},zc=A.ie&&A.ie_version<=11;class Er{constructor(t){this.view=t,this.active=!1,this.selectionRange=new Um,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resize=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(e=>{for(let i of e)this.queue.push(i);(A.ie&&A.ie_version<=11||A.ios&&t.composing)&&e.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),zc&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resize=new ResizeObserver(()=>{var e;((e=this.view.docView)===null||e===void 0?void 0:e.lastUpdate)<Date.now()-75&&this.onResize()}),this.resize.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(e=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),e.length>0&&e[e.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(e=>{e.length>0&&e[e.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runScrollHandlers(this.view,t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((e,i)=>e!=t[i]))){this.gapIntersection.disconnect();for(let e of t)this.gapIntersection.observe(e);this.gaps=t}}onSelectionChange(t){let e=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:i}=this,n=this.selectionRange;if(i.state.facet(Ai)?i.root.activeElement!=this.dom:!Hi(i.dom,n))return;let c=n.anchorNode&&i.docView.nearest(n.anchorNode);if(c&&c.ignoreEvent(t)){e||(this.selectionChanged=!1);return}(A.ie&&A.ie_version<=11||A.android&&A.chrome)&&!i.state.selection.main.empty&&n.focusNode&&Bi(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,e=A.safari&&t.root.nodeType==11&&xm(this.dom.ownerDocument)==this.dom&&jr(this.view)||Ki(t.root);if(!e||this.selectionRange.eq(e))return!1;let i=Hi(this.dom,e);return i&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&Nm(this.dom,e)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(e),i&&(this.selectionChanged=!0),!0)}setSelectionRange(t,e){this.selectionRange.set(t.node,t.offset,e.node,e.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,e=null;for(let i=this.dom;i;)if(i.nodeType==1)!e&&t<this.scrollTargets.length&&this.scrollTargets[t]==i?t++:e||(e=this.scrollTargets.slice(0,t)),e&&e.push(i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;if(t<this.scrollTargets.length&&!e&&(e=this.scrollTargets.slice(0,t)),e){for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);for(let i of this.scrollTargets=e)i.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Pr),zc&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){!this.active||(this.active=!1,this.observer.disconnect(),zc&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,e){var i;if(!this.delayedAndroidKey){let n=()=>{let c=this.delayedAndroidKey;c&&(this.clearDelayedAndroidKey(),!this.flush()&&c.force&&Wl(this.dom,c.key,c.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(n)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:e,force:this.lastChange<Date.now()-50||!!(!((i=this.delayedAndroidKey)===null||i===void 0)&&i.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}processRecords(){let t=this.queue;for(let c of this.observer.takeRecords())t.push(c);t.length&&(this.queue=[]);let e=-1,i=-1,n=!1;for(let c of t){let s=this.readMutation(c);!s||(s.typeOver&&(n=!0),e==-1?{from:e,to:i}=s:(e=Math.min(s.from,e),i=Math.max(s.to,i)))}return{from:e,to:i,typeOver:n}}readChange(){let{from:t,to:e,typeOver:i}=this.processRecords(),n=this.selectionChanged&&Hi(this.dom,this.selectionRange);return t<0&&!n?null:(t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new Nr(this.view,t,e,i))}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let e=this.readChange();if(!e)return!1;let i=this.view.state,n=Do(this.view,e);return this.view.state==i&&this.view.update([]),n}readMutation(t){let e=this.view.docView.nearest(t.target);if(!e||e.ignoreMutation(t))return null;if(e.markDirty(t.type=="attributes"),t.type=="attributes"&&(e.dirty|=4),t.type=="childList"){let i=Oo(e,t.previousSibling||t.target.previousSibling,-1),n=Oo(e,t.nextSibling||t.target.nextSibling,1);return{from:i?e.posAfter(i):e.posAtStart,to:n?e.posBefore(n):e.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:e.posAtStart,to:e.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var t,e,i;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(e=this.gapIntersection)===null||e===void 0||e.disconnect(),(i=this.resize)===null||i===void 0||i.disconnect();for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function Oo(l,t,e){for(;t;){let i=st.get(t);if(i&&i.parent==l)return i;let n=t.parentNode;t=n!=l.dom?n:e>0?t.nextSibling:t.previousSibling}return null}function jr(l){let t=null;function e(o){o.preventDefault(),o.stopImmediatePropagation(),t=o.getTargetRanges()[0]}if(l.contentDOM.addEventListener("beforeinput",e,!0),l.dom.ownerDocument.execCommand("indent"),l.contentDOM.removeEventListener("beforeinput",e,!0),!t)return null;let i=t.startContainer,n=t.startOffset,c=t.endContainer,s=t.endOffset,d=l.docView.domAtPos(l.state.selection.main.anchor);return Bi(d.node,d.offset,c,s)&&([i,n,c,s]=[c,s,i,n]),{anchorNode:i,anchorOffset:n,focusNode:c,focusOffset:s}}class w{constructor(t={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: absolute; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=t.dispatch||(e=>this.update([e])),this.dispatch=this.dispatch.bind(this),this._root=t.root||Am(t.parent)||document,this.viewState=new Mo(t.state||O.create(t)),this.plugins=this.state.facet(ql).map(e=>new Sc(e));for(let e of this.plugins)e.update(this);this.observer=new Er(this),this.inputState=new Zr(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new go(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),t.parent&&t.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}dispatch(...t){this._dispatch(t.length==1&&t[0]instanceof Wt?t[0]:this.state.update(...t))}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let e=!1,i=!1,n,c=this.state;for(let a of t){if(a.startState!=c)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");c=a.state}if(this.destroyed){this.viewState.state=c;return}let s=this.observer.delayedAndroidKey,d=null;if(s?(this.observer.clearDelayedAndroidKey(),d=this.observer.readChange(),(d&&!this.state.doc.eq(c.doc)||!this.state.selection.eq(c.selection))&&(d=null)):this.observer.clear(),c.facet(O.phrases)!=this.state.facet(O.phrases))return this.setState(c);n=Ni.create(this,c,t);let o=this.viewState.scrollTarget;try{this.updateState=2;for(let a of t){if(o&&(o=o.map(a.changes)),a.scrollIntoView){let{main:h}=a.state.selection;o=new Ui(h.empty?h:y.cursor(h.head,h.head>h.anchor?-1:1))}for(let h of a.effects)h.is(co)&&(o=h.value)}this.viewState.update(n,o),this.bidiCache=ji.update(this.bidiCache,n.changes),n.empty||(this.updatePlugins(n),this.inputState.update(n)),e=this.docView.update(n),this.state.facet($l)!=this.styleModules&&this.mountStyles(),i=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(e,t.some(a=>a.isUserEvent("select.pointer")))}finally{this.updateState=0}if(n.startState.facet(Ei)!=n.state.facet(Ei)&&(this.viewState.mustMeasureContent=!0),(e||i||o||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!n.empty)for(let a of this.state.facet(Yc))a(n);d&&!Do(this,d)&&s.force&&Wl(this.contentDOM,s.key,s.keyCode)}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let e=this.hasFocus;try{for(let i of this.plugins)i.destroy(this);this.viewState=new Mo(t),this.plugins=t.facet(ql).map(i=>new Sc(i)),this.pluginMap.clear();for(let i of this.plugins)i.update(this);this.docView=new go(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}e&&this.focus(),this.requestMeasure()}updatePlugins(t){let e=t.startState.facet(ql),i=t.state.facet(ql);if(e!=i){let n=[];for(let c of i){let s=e.indexOf(c);if(s<0)n.push(new Sc(c));else{let d=this.plugins[s];d.mustUpdate=t,n.push(d)}}for(let c of this.plugins)c.mustUpdate!=t&&c.destroy(this);this.plugins=n,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let n of this.plugins)n.mustUpdate=t;for(let n=0;n<this.plugins.length;n++)this.plugins[n].update(this)}measure(t=!0){if(this.destroyed)return;this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,t&&this.observer.forceFlush();let e=null,{scrollHeight:i,scrollTop:n,clientHeight:c}=this.scrollDOM,s=n>i-c-4?i:n;try{for(let d=0;;d++){this.updateState=1;let o=this.viewport,a=this.viewState.lineBlockAtHeight(s),h=this.viewState.measure(this);if(!h&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(d>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let u=[];h&4||([this.measureRequests,u]=[u,this.measureRequests]);let m=u.map(g=>{try{return g.read(this)}catch(p){return Qt(this.state,p),qo}}),r=Ni.create(this,this.state,[]),b=!1,Z=!1;r.flags|=h,e?e.flags|=h:e=r,this.updateState=2,r.empty||(this.updatePlugins(r),this.inputState.update(r),this.updateAttrs(),b=this.docView.update(r));for(let g=0;g<u.length;g++)if(m[g]!=qo)try{let p=u[g];p.write&&p.write(m[g],this)}catch(p){Qt(this.state,p)}if(this.viewState.editorHeight)if(this.viewState.scrollTarget)this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,Z=!0;else{let g=this.viewState.lineBlockAt(a.from).top-a.top;(g>1||g<-1)&&(this.scrollDOM.scrollTop+=g,Z=!0)}if(b&&this.docView.updateSelection(!0),this.viewport.from==o.from&&this.viewport.to==o.to&&!Z&&this.measureRequests.length==0)break}}finally{this.updateState=0,this.measureScheduled=-1}if(e&&!e.empty)for(let d of this.state.facet(Yc))d(e)}get themeClasses(){return Ac+" "+(this.state.facet(Uc)?jo:Eo)+" "+this.state.facet(Ei)}updateAttrs(){let t=_o(this,so,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),e={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Ai)?"true":"false",class:"cm-content",style:`${A.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(e["aria-readonly"]="true"),_o(this,Lc,e);let i=this.observer.ignore(()=>{let n=Rc(this.contentDOM,this.contentAttrs,e),c=Rc(this.dom,this.editorAttrs,t);return n||c});return this.editorAttrs=t,this.contentAttrs=e,i}showAnnouncements(t){let e=!0;for(let i of t)for(let n of i.effects)if(n.is(w.announce)){e&&(this.announceDOM.textContent=""),e=!1;let c=this.announceDOM.appendChild(document.createElement("div"));c.textContent=n.value}}mountStyles(){this.styleModules=this.state.facet($l),ke.mount(this.root,this.styleModules.concat(Ar).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(t.key!=null){for(let e=0;e<this.measureRequests.length;e++)if(this.measureRequests[e].key===t.key){this.measureRequests[e]=t;return}}this.measureRequests.push(t)}}plugin(t){let e=this.pluginMap.get(t);return(e===void 0||e&&e.spec!=t)&&this.pluginMap.set(t,e=this.plugins.find(i=>i.spec==t)||null),e&&e.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,e,i){return Bc(this,t,fo(this,t,e,i))}moveByGroup(t,e){return Bc(this,t,fo(this,t,e,i=>rr(this,t.head,i)))}moveToLineBoundary(t,e,i=!0){return mr(this,t,e,i)}moveVertically(t,e,i){return Bc(this,t,br(this,t,e,i))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,e=0){return this.docView.posFromDOM(t,e)}posAtCoords(t,e=!0){return this.readMeasured(),yo(this,t,e)}coordsAtPos(t,e=1){this.readMeasured();let i=this.docView.coordsAt(t,e);if(!i||i.left==i.right)return i;let n=this.state.doc.lineAt(t),c=this.bidiSpans(n),s=c[Il.find(c,t-n.from,-1,e)];return bc(i,s.dir==mt.LTR==e>0)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(io)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>Qr)return uo(t.length);let e=this.textDirectionAt(t.from);for(let n of this.bidiCache)if(n.from==t.from&&n.dir==e)return n.order;let i=_m(t.text,e);return this.bidiCache.push(new ji(t.from,t.to,e,i)),i}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||A.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Hd(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,e={}){return co.of(new Ui(typeof t=="number"?y.cursor(t):t,e.y,e.x,e.yMargin,e.xMargin))}static domEventHandlers(t){return Xt.define(()=>({}),{eventHandlers:t})}static theme(t,e){let i=ke.newName(),n=[Ei.of(i),$l.of(Nc(`.${i}`,t))];return e&&e.dark&&n.push(Uc.of(!0)),n}static baseTheme(t){return $e.lowest($l.of(Nc("."+Ac,t,Qo)))}static findFromDOM(t){var e;let i=t.querySelector(".cm-content"),n=i&&st.get(i)||st.get(t);return((e=n==null?void 0:n.rootView)===null||e===void 0?void 0:e.view)||null}}w.styleModule=$l,w.inputHandler=lo,w.perLineTextDirection=io,w.exceptionSink=eo,w.updateListener=Yc,w.editable=Ai,w.mouseSelectionStyle=to,w.dragMovesSelection=$d,w.clickAddsSelectionRange=_d,w.decorations=_l,w.atomicRanges=oo,w.scrollMargins=ao,w.darkTheme=Uc,w.contentAttributes=Lc,w.editorAttributes=so,w.lineWrapping=w.contentAttributes.of({class:"cm-lineWrapping"}),w.announce=P.define();const Qr=4096,qo={};class ji{constructor(t,e,i,n){this.from=t,this.to=e,this.dir=i,this.order=n}static update(t,e){if(e.empty)return t;let i=[],n=t.length?t[t.length-1].dir:mt.LTR;for(let c=Math.max(0,t.length-10);c<t.length;c++){let s=t[c];s.dir==n&&!e.touchesRange(s.from,s.to)&&i.push(new ji(e.mapPos(s.from,1),e.mapPos(s.to,-1),s.dir,s.order))}return i}}function _o(l,t,e){for(let i=l.state.facet(t),n=i.length-1;n>=0;n--){let c=i[n],s=typeof c=="function"?c(l):c;s&&Vc(s,e)}return e}const Dr=A.mac?"mac":A.windows?"win":A.linux?"linux":"key";function Or(l,t){const e=l.split(/-(?!$)/);let i=e[e.length-1];i=="Space"&&(i=" ");let n,c,s,d;for(let o=0;o<e.length-1;++o){const a=e[o];if(/^(cmd|meta|m)$/i.test(a))d=!0;else if(/^a(lt)?$/i.test(a))n=!0;else if(/^(c|ctrl|control)$/i.test(a))c=!0;else if(/^s(hift)?$/i.test(a))s=!0;else if(/^mod$/i.test(a))t=="mac"?d=!0:c=!0;else throw new Error("Unrecognized modifier name: "+a)}return n&&(i="Alt-"+i),c&&(i="Ctrl-"+i),d&&(i="Meta-"+i),s&&(i="Shift-"+i),i}function Qi(l,t,e){return t.altKey&&(l="Alt-"+l),t.ctrlKey&&(l="Ctrl-"+l),t.metaKey&&(l="Meta-"+l),e!==!1&&t.shiftKey&&(l="Shift-"+l),l}const qr=$e.default(w.domEventHandlers({keydown(l,t){return ea(ta(t.state),l,t,"editor")}})),ei=U.define({enables:qr}),$o=new WeakMap;function ta(l){let t=l.facet(ei),e=$o.get(t);return e||$o.set(t,e=tb(t.reduce((i,n)=>i.concat(n),[]))),e}function _r(l,t,e){return ea(ta(l.state),t,l,e)}let ze=null;const $r=4e3;function tb(l,t=Dr){let e=Object.create(null),i=Object.create(null),n=(s,d)=>{let o=i[s];if(o==null)i[s]=d;else if(o!=d)throw new Error("Key binding "+s+" is used both as a regular binding and as a multi-stroke prefix")},c=(s,d,o,a)=>{var h,u;let m=e[s]||(e[s]=Object.create(null)),r=d.split(/ (?!$)/).map(g=>Or(g,t));for(let g=1;g<r.length;g++){let p=r.slice(0,g).join(" ");n(p,!0),m[p]||(m[p]={preventDefault:!0,run:[R=>{let V=ze={view:R,prefix:p,scope:s};return setTimeout(()=>{ze==V&&(ze=null)},$r),!0}]})}let b=r.join(" ");n(b,!1);let Z=m[b]||(m[b]={preventDefault:!1,run:((u=(h=m._any)===null||h===void 0?void 0:h.run)===null||u===void 0?void 0:u.slice())||[]});o&&Z.run.push(o),a&&(Z.preventDefault=!0)};for(let s of l){let d=s.scope?s.scope.split(" "):["editor"];if(s.any)for(let a of d){let h=e[a]||(e[a]=Object.create(null));h._any||(h._any={preventDefault:!1,run:[]});for(let u in h)h[u].run.push(s.any)}let o=s[t]||s.key;if(!!o)for(let a of d)c(a,o,s.run,s.preventDefault),s.shift&&c(a,"Shift-"+o,s.shift,s.preventDefault)}return e}function ea(l,t,e,i){let n=km(t),c=Yt(n,0),s=Et(c)==n.length&&n!=" ",d="",o=!1;ze&&ze.view==e&&ze.scope==i&&(d=ze.prefix+" ",(o=Yo.indexOf(t.keyCode)<0)&&(ze=null));let a=new Set,h=b=>{if(b){for(let Z of b.run)if(!a.has(Z)&&(a.add(Z),Z(e,t)))return!0;b.preventDefault&&(o=!0)}return!1},u=l[i],m,r;if(u){if(h(u[d+Qi(n,t,!s)]))return!0;if(s&&(t.altKey||t.metaKey||t.ctrlKey)&&(m=xe[t.keyCode])&&m!=n){if(h(u[d+Qi(m,t,!0)]))return!0;if(t.shiftKey&&(r=jl[t.keyCode])!=n&&r!=m&&h(u[d+Qi(r,t,!1)]))return!0}else if(s&&t.shiftKey&&h(u[d+Qi(n,t,!0)]))return!0;if(h(u._any))return!0}return o}class la{constructor(t,e,i,n,c){this.className=t,this.left=e,this.top=i,this.width=n,this.height=c}draw(){let t=document.createElement("div");return t.className=this.className,this.adjust(t),t}update(t,e){return e.className!=this.className?!1:(this.adjust(t),!0)}adjust(t){t.style.left=this.left+"px",t.style.top=this.top+"px",this.width>=0&&(t.style.width=this.width+"px"),t.style.height=this.height+"px"}eq(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height&&this.className==t.className}}function eb(l,t){return l.constructor==t.constructor&&l.eq(t)}class lb{constructor(t,e){this.view=t,this.layer=e,this.drawn=[],this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=t.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),e.above&&this.dom.classList.add("cm-layer-above"),e.class&&this.dom.classList.add(e.class),this.dom.setAttribute("aria-hidden","true"),this.setOrder(t.state),t.requestMeasure(this.measureReq),e.mount&&e.mount(this.dom,t)}update(t){t.startState.facet(Di)!=t.state.facet(Di)&&this.setOrder(t.state),(this.layer.update(t,this.dom)||t.geometryChanged)&&t.view.requestMeasure(this.measureReq)}setOrder(t){let e=0,i=t.facet(Di);for(;e<i.length&&i[e]!=this.layer;)e++;this.dom.style.zIndex=String((this.layer.above?150:-1)-e)}measure(){return this.layer.markers(this.view)}draw(t){if(t.length!=this.drawn.length||t.some((e,i)=>!eb(e,this.drawn[i]))){let e=this.dom.firstChild,i=0;for(let n of t)n.update&&e&&n.constructor&&this.drawn[i].constructor&&n.update(e,this.drawn[i])?(e=e.nextSibling,i++):this.dom.insertBefore(n.draw(),e);for(;e;){let n=e.nextSibling;e.remove(),e=n}this.drawn=t}}destroy(){this.dom.remove()}}const Di=U.define();function ia(l){return[Xt.define(t=>new lb(t,l)),Di.of(l)]}const na=!A.ios,li=U.define({combine(l){return be(l,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(t,e)=>Math.min(t,e),drawRangeCursor:(t,e)=>t||e})}});function ib(l={}){return[li.of(l),nb,cb,sb,no.of(!0)]}function ca(l){return l.startState.facet(li)!=l.startState.facet(li)}const nb=ia({above:!0,markers(l){let{state:t}=l,e=t.facet(li),i=[];for(let n of t.selection.ranges){let c=n==t.selection.main;if(n.empty?!c||na:e.drawRangeCursor){let s=ob(l,n,c);s&&i.push(s)}}return i},update(l,t){l.transactions.some(i=>i.scrollIntoView)&&(t.style.animationName=t.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let e=ca(l);return e&&sa(l.state,t),l.docChanged||l.selectionSet||e},mount(l,t){sa(t.state,l)},class:"cm-cursorLayer"});function sa(l,t){t.style.animationDuration=l.facet(li).cursorBlinkRate+"ms"}const cb=ia({above:!1,markers(l){return l.state.selection.ranges.map(t=>t.empty?[]:db(l,t)).reduce((t,e)=>t.concat(e))},update(l,t){return l.docChanged||l.selectionSet||l.viewportChanged||ca(l)},class:"cm-selectionLayer"}),da={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};na&&(da[".cm-line"].caretColor="transparent !important");const sb=$e.highest(w.theme(da));function oa(l){let t=l.scrollDOM.getBoundingClientRect();return{left:(l.textDirection==mt.LTR?t.left:t.right-l.scrollDOM.clientWidth)-l.scrollDOM.scrollLeft,top:t.top-l.scrollDOM.scrollTop}}function aa(l,t,e){let i=y.cursor(t);return{from:Math.max(e.from,l.moveToLineBoundary(i,!1,!0).from),to:Math.min(e.to,l.moveToLineBoundary(i,!0,!0).from),type:nt.Text}}function ha(l,t){let e=l.lineBlockAt(t);if(Array.isArray(e.type)){for(let i of e.type)if(i.to>t||i.to==t&&(i.to==e.to||i.type==nt.Text))return i}return e}function db(l,t){if(t.to<=l.viewport.from||t.from>=l.viewport.to)return[];let e=Math.max(t.from,l.viewport.from),i=Math.min(t.to,l.viewport.to),n=l.textDirection==mt.LTR,c=l.contentDOM,s=c.getBoundingClientRect(),d=oa(l),o=window.getComputedStyle(c.firstChild),a=s.left+parseInt(o.paddingLeft)+Math.min(0,parseInt(o.textIndent)),h=s.right-parseInt(o.paddingRight),u=ha(l,e),m=ha(l,i),r=u.type==nt.Text?u:null,b=m.type==nt.Text?m:null;if(l.lineWrapping&&(r&&(r=aa(l,e,r)),b&&(b=aa(l,i,b))),r&&b&&r.from==b.from)return g(p(t.from,t.to,r));{let V=r?p(t.from,null,r):R(u,!1),W=b?p(null,t.to,b):R(m,!0),G=[];return(r||u).to<(b||m).from-1?G.push(Z(a,V.bottom,h,W.top)):V.bottom<W.top&&l.elementAtHeight((V.bottom+W.top)/2).type==nt.Text&&(V.bottom=W.top=(V.bottom+W.top)/2),g(V).concat(G).concat(g(W))}function Z(V,W,G,K){return new la("cm-selectionBackground",V-d.left,W-d.top-.01,G-V,K-W+.01)}function g({top:V,bottom:W,horizontal:G}){let K=[];for(let f=0;f<G.length;f+=2)K.push(Z(G[f],V,G[f+1],W));return K}function p(V,W,G){let K=1e9,f=-1e9,S=[];function T(j,D,it,_,J){let ht=l.coordsAtPos(j,j==G.to?-2:2),ot=l.coordsAtPos(it,it==G.from?2:-2);K=Math.min(ht.top,ot.top,K),f=Math.max(ht.bottom,ot.bottom,f),J==mt.LTR?S.push(n&&D?a:ht.left,n&&_?h:ot.right):S.push(!n&&_?a:ot.left,!n&&D?h:ht.right)}let k=V!=null?V:G.from,E=W!=null?W:G.to;for(let j of l.visibleRanges)if(j.to>k&&j.from<E)for(let D=Math.max(j.from,k),it=Math.min(j.to,E);;){let _=l.state.doc.lineAt(D);for(let J of l.bidiSpans(_)){let ht=J.from+_.from,ot=J.to+_.from;if(ht>=it)break;ot>D&&T(Math.max(ht,D),V==null&&ht<=k,Math.min(ot,it),W==null&&ot>=E,J.dir)}if(D=_.to+1,D>=it)break}return S.length==0&&T(k,V==null,E,W==null,l.textDirection),{top:K,bottom:f,horizontal:S}}function R(V,W){let G=s.top+(W?V.top:V.bottom);return{top:G,bottom:G,horizontal:[]}}}function ob(l,t,e){let i=l.coordsAtPos(t.head,t.assoc||1);if(!i)return null;let n=oa(l);return new la(e?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",i.left-n.left,i.top-n.top,-1,i.bottom-i.top)}const ua=P.define({map(l,t){return l==null?null:t.mapPos(l)}}),ii=Gt.define({create(){return null},update(l,t){return l!=null&&(l=t.changes.mapPos(l)),t.effects.reduce((e,i)=>i.is(ua)?i.value:e,l)}}),ab=Xt.fromClass(class{constructor(l){this.view=l,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(l){var t;let e=l.state.field(ii);e==null?this.cursor!=null&&((t=this.cursor)===null||t===void 0||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(l.startState.field(ii)!=e||l.docChanged||l.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let l=this.view.state.field(ii),t=l!=null&&this.view.coordsAtPos(l);if(!t)return null;let e=this.view.scrollDOM.getBoundingClientRect();return{left:t.left-e.left+this.view.scrollDOM.scrollLeft,top:t.top-e.top+this.view.scrollDOM.scrollTop,height:t.bottom-t.top}}drawCursor(l){this.cursor&&(l?(this.cursor.style.left=l.left+"px",this.cursor.style.top=l.top+"px",this.cursor.style.height=l.height+"px"):this.cursor.style.left="-100000px")}destroy(){this.cursor&&this.cursor.remove()}setDropPos(l){this.view.state.field(ii)!=l&&this.view.dispatch({effects:ua.of(l)})}},{eventHandlers:{dragover(l){this.setDropPos(this.view.posAtCoords({x:l.clientX,y:l.clientY}))},dragleave(l){(l.target==this.view.contentDOM||!this.view.contentDOM.contains(l.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function hb(){return[ii,ab]}function ma(l,t,e,i,n){t.lastIndex=0;for(let c=l.iterRange(e,i),s=e,d;!c.next().done;s+=c.value.length)if(!c.lineBreak)for(;d=t.exec(c.value);)n(s+d.index,d)}function ub(l,t){let e=l.visibleRanges;if(e.length==1&&e[0].from==l.viewport.from&&e[0].to==l.viewport.to)return e;let i=[];for(let{from:n,to:c}of e)n=Math.max(l.state.doc.lineAt(n).from,n-t),c=Math.min(l.state.doc.lineAt(c).to,c+t),i.length&&i[i.length-1].to>=n?i[i.length-1].to=c:i.push({from:n,to:c});return i}class mb{constructor(t){const{regexp:e,decoration:i,decorate:n,boundary:c,maxLength:s=1e3}=t;if(!e.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=e,n)this.addMatch=(d,o,a,h)=>n(h,a,a+d[0].length,d,o);else if(typeof i=="function")this.addMatch=(d,o,a,h)=>{let u=i(d,o,a);u&&h(a,a+d[0].length,u)};else if(i)this.addMatch=(d,o,a,h)=>h(a,a+d[0].length,i);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=c,this.maxLength=s}createDeco(t){let e=new Be,i=e.add.bind(e);for(let{from:n,to:c}of ub(t,this.maxLength))ma(t.state.doc,this.regexp,n,c,(s,d)=>this.addMatch(d,t,s,i));return e.finish()}updateDeco(t,e){let i=1e9,n=-1;return t.docChanged&&t.changes.iterChanges((c,s,d,o)=>{o>t.view.viewport.from&&d<t.view.viewport.to&&(i=Math.min(d,i),n=Math.max(o,n))}),t.viewportChanged||n-i>1e3?this.createDeco(t.view):n>-1?this.updateRange(t.view,e.map(t.changes),i,n):e}updateRange(t,e,i,n){for(let c of t.visibleRanges){let s=Math.max(c.from,i),d=Math.min(c.to,n);if(d>s){let o=t.state.doc.lineAt(s),a=o.to<d?t.state.doc.lineAt(d):o,h=Math.max(c.from,o.from),u=Math.min(c.to,a.to);if(this.boundary){for(;s>o.from;s--)if(this.boundary.test(o.text[s-1-o.from])){h=s;break}for(;d<a.to;d++)if(this.boundary.test(a.text[d-a.from])){u=d;break}}let m=[],r,b=(Z,g,p)=>m.push(p.range(Z,g));if(o==a)for(this.regexp.lastIndex=h-o.from;(r=this.regexp.exec(o.text))&&r.index<u-o.from;)this.addMatch(r,t,r.index+o.from,b);else ma(t.state.doc,this.regexp,h,u,(Z,g)=>this.addMatch(g,t,Z,b));e=e.update({filterFrom:h,filterTo:u,filter:(Z,g)=>Z<h||g>u,add:m})}}return e}}const Tc=/x/.unicode!=null?"gu":"g",rb=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,Tc),bb={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Mc=null;function Zb(){var l;if(Mc==null&&typeof document<"u"&&document.body){let t=document.body.style;Mc=((l=t.tabSize)!==null&&l!==void 0?l:t.MozTabSize)!=null}return Mc||!1}const Oi=U.define({combine(l){let t=be(l,{render:null,specialChars:rb,addSpecialChars:null});return(t.replaceTabs=!Zb())&&(t.specialChars=new RegExp("	|"+t.specialChars.source,Tc)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,Tc)),t}});function gb(l={}){return[Oi.of(l),pb()]}let ra=null;function pb(){return ra||(ra=Xt.fromClass(class{constructor(l){this.view=l,this.decorations=N.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(l.state.facet(Oi)),this.decorations=this.decorator.createDeco(l)}makeDecorator(l){return new mb({regexp:l.specialChars,decoration:(t,e,i)=>{let{doc:n}=e.state,c=Yt(t[0],0);if(c==9){let s=n.lineAt(i),d=e.state.tabSize,o=El(s.text,d,i-s.from);return N.replace({widget:new Ib((d-o%d)*this.view.defaultCharacterWidth)})}return this.decorationCache[c]||(this.decorationCache[c]=N.replace({widget:new Xb(l,c)}))},boundary:l.replaceTabs?void 0:/[^]/})}update(l){let t=l.state.facet(Oi);l.startState.facet(Oi)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(l.view)):this.decorations=this.decorator.updateDeco(l,this.decorations)}},{decorations:l=>l.decorations}))}const Gb="\u2022";function Wb(l){return l>=32?Gb:l==10?"\u2424":String.fromCharCode(9216+l)}class Xb extends Ue{constructor(t,e){super(),this.options=t,this.code=e}eq(t){return t.code==this.code}toDOM(t){let e=Wb(this.code),i=t.state.phrase("Control character")+" "+(bb[this.code]||"0x"+this.code.toString(16)),n=this.options.render&&this.options.render(this.code,i,e);if(n)return n;let c=document.createElement("span");return c.textContent=e,c.title=i,c.setAttribute("aria-label",i),c.className="cm-specialChar",c}ignoreEvent(){return!1}}class Ib extends Ue{constructor(t){super(),this.width=t}eq(t){return t.width==this.width}toDOM(){let t=document.createElement("span");return t.textContent="	",t.className="cm-tab",t.style.width=this.width+"px",t}ignoreEvent(){return!1}}function Vb(){return Rb}const yb=N.line({class:"cm-activeLine"}),Rb=Xt.fromClass(class{constructor(l){this.decorations=this.getDeco(l)}update(l){(l.docChanged||l.selectionSet)&&(this.decorations=this.getDeco(l.view))}getDeco(l){let t=-1,e=[];for(let i of l.state.selection.ranges){let n=l.lineBlockAt(i.head);n.from>t&&(e.push(yb.range(n.from)),t=n.from)}return N.set(e)}},{decorations:l=>l.decorations}),Pc=2e3;function fb(l,t,e){let i=Math.min(t.line,e.line),n=Math.max(t.line,e.line),c=[];if(t.off>Pc||e.off>Pc||t.col<0||e.col<0){let s=Math.min(t.off,e.off),d=Math.max(t.off,e.off);for(let o=i;o<=n;o++){let a=l.doc.line(o);a.length<=d&&c.push(y.range(a.from+s,a.to+d))}}else{let s=Math.min(t.col,e.col),d=Math.max(t.col,e.col);for(let o=i;o<=n;o++){let a=l.doc.line(o),h=hc(a.text,s,l.tabSize,!0);if(h<0)c.push(y.cursor(a.to));else{let u=hc(a.text,d,l.tabSize);c.push(y.range(a.from+h,a.from+u))}}}return c}function Cb(l,t){let e=l.coordsAtPos(l.viewport.from);return e?Math.round(Math.abs((e.left-t)/l.defaultCharacterWidth)):-1}function ba(l,t){let e=l.posAtCoords({x:t.clientX,y:t.clientY},!1),i=l.state.doc.lineAt(e),n=e-i.from,c=n>Pc?-1:n==i.length?Cb(l,t.clientX):El(i.text,l.state.tabSize,e-i.from);return{line:i.number,col:c,off:n}}function Yb(l,t){let e=ba(l,t),i=l.state.selection;return e?{update(n){if(n.docChanged){let c=n.changes.mapPos(n.startState.doc.line(e.line).from),s=n.state.doc.lineAt(c);e={line:s.number,col:e.col,off:Math.min(e.off,s.length)},i=i.map(n.changes)}},get(n,c,s){let d=ba(l,n);if(!d)return i;let o=fb(l.state,e,d);return o.length?s?y.create(o.concat(i.ranges)):y.create(o):i}}:null}function Sb(l){let t=(l==null?void 0:l.eventFilter)||(e=>e.altKey&&e.button==0);return w.mouseSelectionStyle.of((e,i)=>t(i)?Yb(e,i):null)}const Lb={Alt:[18,l=>l.altKey],Control:[17,l=>l.ctrlKey],Shift:[16,l=>l.shiftKey],Meta:[91,l=>l.metaKey]},Jb={style:"cursor: crosshair"};function Fb(l={}){let[t,e]=Lb[l.key||"Alt"],i=Xt.fromClass(class{constructor(n){this.view=n,this.isDown=!1}set(n){this.isDown!=n&&(this.isDown=n,this.view.update([]))}},{eventHandlers:{keydown(n){this.set(n.keyCode==t||e(n))},keyup(n){(n.keyCode==t||!e(n))&&this.set(!1)},mousemove(n){this.set(e(n))}}});return[i,w.contentAttributes.of(n=>{var c;return!((c=n.plugin(i))===null||c===void 0)&&c.isDown?Jb:null})]}const qi="-10000px";class Za{constructor(t,e,i){this.facet=e,this.createTooltipView=i,this.input=t.state.facet(e),this.tooltips=this.input.filter(n=>n),this.tooltipViews=this.tooltips.map(i)}update(t){var e;let i=t.state.facet(this.facet),n=i.filter(s=>s);if(i===this.input){for(let s of this.tooltipViews)s.update&&s.update(t);return!1}let c=[];for(let s=0;s<n.length;s++){let d=n[s],o=-1;if(!!d){for(let a=0;a<this.tooltips.length;a++){let h=this.tooltips[a];h&&h.create==d.create&&(o=a)}if(o<0)c[s]=this.createTooltipView(d);else{let a=c[s]=this.tooltipViews[o];a.update&&a.update(t)}}}for(let s of this.tooltipViews)c.indexOf(s)<0&&(s.dom.remove(),(e=s.destroy)===null||e===void 0||e.call(s));return this.input=i,this.tooltips=n,this.tooltipViews=c,!0}}function Kb(l){let{win:t}=l;return{top:0,left:0,bottom:t.innerHeight,right:t.innerWidth}}const Ec=U.define({combine:l=>{var t,e,i;return{position:A.ios?"absolute":((t=l.find(n=>n.position))===null||t===void 0?void 0:t.position)||"fixed",parent:((e=l.find(n=>n.parent))===null||e===void 0?void 0:e.parent)||null,tooltipSpace:((i=l.find(n=>n.tooltipSpace))===null||i===void 0?void 0:i.tooltipSpace)||Kb}}}),ga=Xt.fromClass(class{constructor(l){this.view=l,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let t=l.state.facet(Ec);this.position=t.position,this.parent=t.parent,this.classes=l.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new Za(l,jc,e=>this.createTooltip(e)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(e=>{Date.now()>this.lastTransaction-50&&e.length>0&&e[e.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),l.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let l of this.manager.tooltipViews)this.intersectionObserver.observe(l.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(l){l.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(l);t&&this.observeIntersection();let e=t||l.geometryChanged,i=l.state.facet(Ec);if(i.position!=this.position){this.position=i.position;for(let n of this.manager.tooltipViews)n.dom.style.position=this.position;e=!0}if(i.parent!=this.parent){this.parent&&this.container.remove(),this.parent=i.parent,this.createContainer();for(let n of this.manager.tooltipViews)this.container.appendChild(n.dom);e=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);e&&this.maybeMeasure()}createTooltip(l){let t=l.create(this.view);if(t.dom.classList.add("cm-tooltip"),l.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let e=document.createElement("div");e.className="cm-tooltip-arrow",t.dom.appendChild(e)}return t.dom.style.position=this.position,t.dom.style.top=qi,this.container.appendChild(t.dom),t.mount&&t.mount(this.view),t}destroy(){var l,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let e of this.manager.tooltipViews)e.dom.remove(),(l=e.destroy)===null||l===void 0||l.call(e);(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let l=this.view.dom.getBoundingClientRect();return{editor:l,parent:this.parent?this.container.getBoundingClientRect():l,pos:this.manager.tooltips.map((t,e)=>{let i=this.manager.tooltipViews[e];return i.getCoords?i.getCoords(t.pos):this.view.coordsAtPos(t.pos)}),size:this.manager.tooltipViews.map(({dom:t})=>t.getBoundingClientRect()),space:this.view.state.facet(Ec).tooltipSpace(this.view)}}writeMeasure(l){let{editor:t,space:e}=l,i=[];for(let n=0;n<this.manager.tooltips.length;n++){let c=this.manager.tooltips[n],s=this.manager.tooltipViews[n],{dom:d}=s,o=l.pos[n],a=l.size[n];if(!o||o.bottom<=Math.max(t.top,e.top)||o.top>=Math.min(t.bottom,e.bottom)||o.right<Math.max(t.left,e.left)-.1||o.left>Math.min(t.right,e.right)+.1){d.style.top=qi;continue}let h=c.arrow?s.dom.querySelector(".cm-tooltip-arrow"):null,u=h?7:0,m=a.right-a.left,r=a.bottom-a.top,b=s.offset||Bb,Z=this.view.textDirection==mt.LTR,g=a.width>e.right-e.left?Z?e.left:e.right-a.width:Z?Math.min(o.left-(h?14:0)+b.x,e.right-m):Math.max(e.left,o.left-m+(h?14:0)-b.x),p=!!c.above;!c.strictSide&&(p?o.top-(a.bottom-a.top)-b.y<e.top:o.bottom+(a.bottom-a.top)+b.y>e.bottom)&&p==e.bottom-o.bottom>o.top-e.top&&(p=!p);let R=(p?o.top-e.top:e.bottom-o.bottom)-u;if(R<r&&s.resize!==!1){if(R<this.view.defaultLineHeight){d.style.top=qi;continue}d.style.height=(r=R)+"px"}else d.style.height&&(d.style.height="");let V=p?o.top-r-u-b.y:o.bottom+u+b.y,W=g+m;if(s.overlap!==!0)for(let G of i)G.left<W&&G.right>g&&G.top<V+r&&G.bottom>V&&(V=p?G.top-r-2-u:G.bottom+u+2);this.position=="absolute"?(d.style.top=V-l.parent.top+"px",d.style.left=g-l.parent.left+"px"):(d.style.top=V+"px",d.style.left=g+"px"),h&&(h.style.left=`${o.left+(Z?b.x:-b.x)-(g+14-7)}px`),s.overlap!==!0&&i.push({left:g,top:V,right:W,bottom:V+r}),d.classList.toggle("cm-tooltip-above",p),d.classList.toggle("cm-tooltip-below",!p),s.positioned&&s.positioned(l.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let l of this.manager.tooltipViews)l.dom.style.top=qi}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),Hb=w.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:`${7}px`,width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:`${7}px solid transparent`,borderRight:`${7}px solid transparent`},".cm-tooltip-above &":{bottom:`-${7}px`,"&:before":{borderTop:`${7}px solid #bbb`},"&:after":{borderTop:`${7}px solid #f5f5f5`,bottom:"1px"}},".cm-tooltip-below &":{top:`-${7}px`,"&:before":{borderBottom:`${7}px solid #bbb`},"&:after":{borderBottom:`${7}px solid #f5f5f5`,top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Bb={x:0,y:0},jc=U.define({enables:[ga,Hb]}),_i=U.define();class Qc{constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Za(t,_i,e=>this.createHostedView(e))}static create(t){return new Qc(t)}createHostedView(t){let e=t.create(this.view);return e.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(e.dom),this.mounted&&e.mount&&e.mount(this.view),e}mount(t){for(let e of this.manager.tooltipViews)e.mount&&e.mount(t);this.mounted=!0}positioned(t){for(let e of this.manager.tooltipViews)e.positioned&&e.positioned(t)}update(t){this.manager.update(t)}}const kb=jc.compute([_i],l=>{let t=l.facet(_i).filter(e=>e);return t.length===0?null:{pos:Math.min(...t.map(e=>e.pos)),end:Math.max(...t.filter(e=>e.end!=null).map(e=>e.end)),create:Qc.create,above:t[0].above,arrow:t.some(e=>e.arrow)}});class xb{constructor(t,e,i,n,c){this.view=t,this.source=e,this.field=i,this.setHover=n,this.hoverTime=c,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:t}=this,e=this.view.contentDOM.contains(t.target)?this.view.posAtCoords(t):null;if(e==null)return;let i=this.view.coordsAtPos(e);if(i==null||t.y<i.top||t.y>i.bottom||t.x<i.left-this.view.defaultCharacterWidth||t.x>i.right+this.view.defaultCharacterWidth)return;let n=this.view.bidiSpans(this.view.state.doc.lineAt(e)).find(d=>d.from<=e&&d.to>=e),c=n&&n.dir==mt.RTL?-1:1,s=this.source(this.view,e,t.x<i.left?-c:c);if(s!=null&&s.then){let d=this.pending={pos:e};s.then(o=>{this.pending==d&&(this.pending=null,o&&this.view.dispatch({effects:this.setHover.of(o)}))},o=>Qt(this.view.state,o,"hover tooltip"))}else s&&this.view.dispatch({effects:this.setHover.of(s)})}mousemove(t){var e;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let i=this.active;if(i&&!pa(this.lastMove.target)||this.pending){let{pos:n}=i||this.pending,c=(e=i==null?void 0:i.end)!==null&&e!==void 0?e:n;(n==c?this.view.posAtCoords(this.lastMove)!=n:!wb(this.view,n,c,t.clientX,t.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!pa(t.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function pa(l){for(let t=l;t;t=t.parentNode)if(t.nodeType==1&&t.classList.contains("cm-tooltip"))return!0;return!1}function wb(l,t,e,i,n,c){let s=document.createRange(),d=l.domAtPos(t),o=l.domAtPos(e);s.setEnd(o.node,o.offset),s.setStart(d.node,d.offset);let a=s.getClientRects();s.detach();for(let h=0;h<a.length;h++){let u=a[h];if(Math.max(u.top-n,n-u.bottom,u.left-i,i-u.right)<=c)return!0}return!1}function vb(l,t={}){let e=P.define(),i=Gt.define({create(){return null},update(n,c){if(n&&(t.hideOnChange&&(c.docChanged||c.selection)||t.hideOn&&t.hideOn(c,n)))return null;if(n&&c.docChanged){let s=c.changes.mapPos(n.pos,-1,At.TrackDel);if(s==null)return null;let d=Object.assign(Object.create(null),n);d.pos=s,n.end!=null&&(d.end=c.changes.mapPos(n.end)),n=d}for(let s of c.effects)s.is(e)&&(n=s.value),s.is(Ab)&&(n=null);return n},provide:n=>_i.from(n)});return[i,Xt.define(n=>new xb(n,l,i,e,t.hoverTime||300)),kb]}function Ub(l,t){let e=l.plugin(ga);if(!e)return null;let i=e.manager.tooltips.indexOf(t);return i<0?null:e.manager.tooltipViews[i]}const Ab=P.define(),Ga=U.define({combine(l){let t,e;for(let i of l)t=t||i.topContainer,e=e||i.bottomContainer;return{topContainer:t,bottomContainer:e}}});function ni(l,t){let e=l.plugin(Wa),i=e?e.specs.indexOf(t):-1;return i>-1?e.panels[i]:null}const Wa=Xt.fromClass(class{constructor(l){this.input=l.state.facet(ci),this.specs=this.input.filter(e=>e),this.panels=this.specs.map(e=>e(l));let t=l.state.facet(Ga);this.top=new $i(l,!0,t.topContainer),this.bottom=new $i(l,!1,t.bottomContainer),this.top.sync(this.panels.filter(e=>e.top)),this.bottom.sync(this.panels.filter(e=>!e.top));for(let e of this.panels)e.dom.classList.add("cm-panel"),e.mount&&e.mount()}update(l){let t=l.state.facet(Ga);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new $i(l.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new $i(l.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let e=l.state.facet(ci);if(e!=this.input){let i=e.filter(o=>o),n=[],c=[],s=[],d=[];for(let o of i){let a=this.specs.indexOf(o),h;a<0?(h=o(l.view),d.push(h)):(h=this.panels[a],h.update&&h.update(l)),n.push(h),(h.top?c:s).push(h)}this.specs=i,this.panels=n,this.top.sync(c),this.bottom.sync(s);for(let o of d)o.dom.classList.add("cm-panel"),o.mount&&o.mount()}else for(let i of this.panels)i.update&&i.update(l)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:l=>w.scrollMargins.of(t=>{let e=t.plugin(l);return e&&{top:e.top.scrollMargin(),bottom:e.bottom.scrollMargin()}})});class $i{constructor(t,e,i){this.view=t,this.top=e,this.container=i,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let e of this.panels)e.destroy&&t.indexOf(e)<0&&e.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let e=this.container||this.view.dom;e.insertBefore(this.dom,this.top?e.firstChild:null)}let t=this.dom.firstChild;for(let e of this.panels)if(e.dom.parentNode==this.dom){for(;t!=e.dom;)t=Xa(t);t=t.nextSibling}else this.dom.insertBefore(e.dom,t);for(;t;)t=Xa(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function Xa(l){let t=l.nextSibling;return l.remove(),t}const ci=U.define({enables:Wa});class Ye extends el{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}Ye.prototype.elementClass="",Ye.prototype.toDOM=void 0,Ye.prototype.mapMode=At.TrackBefore,Ye.prototype.startSide=Ye.prototype.endSide=-1,Ye.prototype.point=!0;const tn=U.define(),Nb={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>lt.empty,lineMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},si=U.define();function zb(l){return[Ia(),si.of(Object.assign(Object.assign({},Nb),l))]}const Dc=U.define({combine:l=>l.some(t=>t)});function Ia(l){let t=[Tb];return l&&l.fixed===!1&&t.push(Dc.of(!0)),t}const Tb=Xt.fromClass(class{constructor(l){this.view=l,this.prevViewport=l.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=l.state.facet(si).map(t=>new Ra(l,t));for(let t of this.gutters)this.dom.appendChild(t.dom);this.fixed=!l.state.facet(Dc),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),l.scrollDOM.insertBefore(this.dom,l.contentDOM)}update(l){if(this.updateGutters(l)){let t=this.prevViewport,e=l.view.viewport,i=Math.min(t.to,e.to)-Math.max(t.from,e.from);this.syncGutters(i<(e.to-e.from)*.8)}l.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(Dc)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=l.view.viewport}syncGutters(l){let t=this.dom.nextSibling;l&&this.dom.remove();let e=lt.iter(this.view.state.facet(tn),this.view.viewport.from),i=[],n=this.gutters.map(c=>new Mb(c,this.view.viewport,-this.view.documentPadding.top));for(let c of this.view.viewportLineBlocks){let s;if(Array.isArray(c.type)){for(let d of c.type)if(d.type==nt.Text){s=d;break}}else s=c.type==nt.Text?c:void 0;if(!!s){i.length&&(i=[]),ya(e,i,c.from);for(let d of n)d.line(this.view,s,i)}}for(let c of n)c.finish();l&&this.view.scrollDOM.insertBefore(this.dom,t)}updateGutters(l){let t=l.startState.facet(si),e=l.state.facet(si),i=l.docChanged||l.heightChanged||l.viewportChanged||!lt.eq(l.startState.facet(tn),l.state.facet(tn),l.view.viewport.from,l.view.viewport.to);if(t==e)for(let n of this.gutters)n.update(l)&&(i=!0);else{i=!0;let n=[];for(let c of e){let s=t.indexOf(c);s<0?n.push(new Ra(this.view,c)):(this.gutters[s].update(l),n.push(this.gutters[s]))}for(let c of this.gutters)c.dom.remove(),n.indexOf(c)<0&&c.destroy();for(let c of n)this.dom.appendChild(c.dom);this.gutters=n}return i}destroy(){for(let l of this.gutters)l.destroy();this.dom.remove()}},{provide:l=>w.scrollMargins.of(t=>{let e=t.plugin(l);return!e||e.gutters.length==0||!e.fixed?null:t.textDirection==mt.LTR?{left:e.dom.offsetWidth}:{right:e.dom.offsetWidth}})});function Va(l){return Array.isArray(l)?l:[l]}function ya(l,t,e){for(;l.value&&l.from<=e;)l.from==e&&t.push(l.value),l.next()}class Mb{constructor(t,e,i){this.gutter=t,this.height=i,this.localMarkers=[],this.i=0,this.cursor=lt.iter(t.markers,e.from)}line(t,e,i){this.localMarkers.length&&(this.localMarkers=[]),ya(this.cursor,this.localMarkers,e.from);let n=i.length?this.localMarkers.concat(i):this.localMarkers,c=this.gutter.config.lineMarker(t,e,n);c&&n.unshift(c);let s=this.gutter;if(n.length==0&&!s.config.renderEmptyElements)return;let d=e.top-this.height;if(this.i==s.elements.length){let o=new fa(t,e.height,d,n);s.elements.push(o),s.dom.appendChild(o.dom)}else s.elements[this.i].update(t,e.height,d,n);this.height=e.bottom,this.i++}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let e=t.elements.pop();t.dom.removeChild(e.dom),e.destroy()}}}class Ra{constructor(t,e){this.view=t,this.config=e,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let i in e.domEventHandlers)this.dom.addEventListener(i,n=>{let c=t.lineBlockAtHeight(n.clientY-t.documentTop);e.domEventHandlers[i](t,c,n)&&n.preventDefault()});this.markers=Va(e.markers(t)),e.initialSpacer&&(this.spacer=new fa(t,0,0,[e.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let e=this.markers;if(this.markers=Va(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let n=this.config.updateSpacer(this.spacer.markers[0],t);n!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[n])}let i=t.view.viewport;return!lt.eq(this.markers,e,i.from,i.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(t):!1)}destroy(){for(let t of this.elements)t.destroy()}}class fa{constructor(t,e,i,n){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,e,i,n)}update(t,e,i,n){this.height!=e&&(this.dom.style.height=(this.height=e)+"px"),this.above!=i&&(this.dom.style.marginTop=(this.above=i)?i+"px":""),Pb(this.markers,n)||this.setMarkers(t,n)}setMarkers(t,e){let i="cm-gutterElement",n=this.dom.firstChild;for(let c=0,s=0;;){let d=s,o=c<e.length?e[c++]:null,a=!1;if(o){let h=o.elementClass;h&&(i+=" "+h);for(let u=s;u<this.markers.length;u++)if(this.markers[u].compare(o)){d=u,a=!0;break}}else d=this.markers.length;for(;s<d;){let h=this.markers[s++];if(h.toDOM){h.destroy(n);let u=n.nextSibling;n.remove(),n=u}}if(!o)break;o.toDOM&&(a?n=n.nextSibling:this.dom.insertBefore(o.toDOM(t),n)),a&&s++}this.dom.className=i,this.markers=e}destroy(){this.setMarkers(null,[])}}function Pb(l,t){if(l.length!=t.length)return!1;for(let e=0;e<l.length;e++)if(!l[e].compare(t[e]))return!1;return!0}const Eb=U.define(),Vl=U.define({combine(l){return be(l,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,e){let i=Object.assign({},t);for(let n in e){let c=i[n],s=e[n];i[n]=c?(d,o,a)=>c(d,o,a)||s(d,o,a):s}return i}})}});class Oc extends Ye{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function qc(l,t){return l.state.facet(Vl).formatNumber(t,l.state)}const jb=si.compute([Vl],l=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(t){return t.state.facet(Eb)},lineMarker(t,e,i){return i.some(n=>n.toDOM)?null:new Oc(qc(t,t.state.doc.lineAt(e.from).number))},lineMarkerChange:t=>t.startState.facet(Vl)!=t.state.facet(Vl),initialSpacer(t){return new Oc(qc(t,Ca(t.state.doc.lines)))},updateSpacer(t,e){let i=qc(e.view,Ca(e.view.state.doc.lines));return i==t.number?t:new Oc(i)},domEventHandlers:l.facet(Vl).domEventHandlers}));function Qb(l={}){return[Vl.of(l),Ia(),jb]}function Ca(l){let t=9;for(;t<l;)t=t*10+9;return t}const Db=new class extends Ye{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Ob=tn.compute(["selection"],l=>{let t=[],e=-1;for(let i of l.selection.ranges){let n=l.doc.lineAt(i.head).from;n>e&&(e=n,t.push(Db.range(n)))}return lt.of(t)});function qb(){return Ob}const _b=1024;let $b=0;class _c{constructor(t,e){this.from=t,this.to=e}}class q{constructor(t={}){this.id=$b++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof t!="function"&&(t=Tt.match(t)),e=>{let i=t(e);return i===void 0?null:[this,i]}}}q.closedBy=new q({deserialize:l=>l.split(" ")}),q.openedBy=new q({deserialize:l=>l.split(" ")}),q.group=new q({deserialize:l=>l.split(" ")}),q.contextHash=new q({perNode:!0}),q.lookAhead=new q({perNode:!0}),q.mounted=new q({perNode:!0});const tZ=Object.create(null);class Tt{constructor(t,e,i,n=0){this.name=t,this.props=e,this.id=i,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):tZ,i=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(t.name==null?8:0),n=new Tt(t.name||"",e,t.id,i);if(t.props){for(let c of t.props)if(Array.isArray(c)||(c=c(n)),c){if(c[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[c[0].id]=c[1]}}return n}prop(t){return this.props[t.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(t){if(typeof t=="string"){if(this.name==t)return!0;let e=this.prop(q.group);return e?e.indexOf(t)>-1:!1}return this.id==t}static match(t){let e=Object.create(null);for(let i in t)for(let n of i.split(" "))e[n]=t[i];return i=>{for(let n=i.prop(q.group),c=-1;c<(n?n.length:0);c++){let s=e[c<0?i.name:n[c]];if(s)return s}}}}Tt.none=new Tt("",Object.create(null),0,8);class $c{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let i of this.types){let n=null;for(let c of t){let s=c(i);s&&(n||(n=Object.assign({},i.props)),n[s[0].id]=s[1])}e.push(n?new Tt(i.name,n,i.id,i.flags):i)}return new $c(e)}}const en=new WeakMap,Ya=new WeakMap;var kt;(function(l){l[l.ExcludeBuffers=1]="ExcludeBuffers",l[l.IncludeAnonymous=2]="IncludeAnonymous",l[l.IgnoreMounts=4]="IgnoreMounts",l[l.IgnoreOverlays=8]="IgnoreOverlays"})(kt||(kt={}));class bt{constructor(t,e,i,n,c){if(this.type=t,this.children=e,this.positions=i,this.length=n,this.props=null,c&&c.length){this.props=Object.create(null);for(let[s,d]of c)this.props[typeof s=="number"?s:s.id]=d}}toString(){let t=this.prop(q.mounted);if(t&&!t.overlay)return t.tree.toString();let e="";for(let i of this.children){let n=i.toString();n&&(e&&(e+=","),e+=n)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new cn(this.topNode,t)}cursorAt(t,e=0,i=0){let n=en.get(this)||this.topNode,c=new cn(n);return c.moveTo(t,e),en.set(this,c._tree),c}get topNode(){return new Se(this,0,0,null)}resolve(t,e=0){let i=yl(en.get(this)||this.topNode,t,e,!1);return en.set(this,i),i}resolveInner(t,e=0){let i=yl(Ya.get(this)||this.topNode,t,e,!0);return Ya.set(this,i),i}iterate(t){let{enter:e,leave:i,from:n=0,to:c=this.length}=t;for(let s=this.cursor((t.mode||0)|kt.IncludeAnonymous);;){let d=!1;if(s.from<=c&&s.to>=n&&(s.type.isAnonymous||e(s)!==!1)){if(s.firstChild())continue;d=!0}for(;d&&i&&!s.type.isAnonymous&&i(s),!s.nextSibling();){if(!s.parent())return;d=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:ls(Tt.none,this.children,this.positions,0,this.children.length,0,this.length,(e,i,n)=>new bt(this.type,e,i,n,this.propValues),t.makeTree||((e,i,n)=>new bt(Tt.none,e,i,n)))}static build(t){return lZ(t)}}bt.empty=new bt(Tt.none,[],[],0);class ts{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new ts(this.buffer,this.index)}}class nl{constructor(t,e,i){this.buffer=t,this.length=e,this.set=i}get type(){return Tt.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],i=this.buffer[t+3],n=this.set.types[e],c=n.name;if(/\W/.test(c)&&!n.isError&&(c=JSON.stringify(c)),t+=4,i==t)return c;let s=[];for(;t<i;)s.push(this.childString(t)),t=this.buffer[t+3];return c+"("+s.join(",")+")"}findChild(t,e,i,n,c){let{buffer:s}=this,d=-1;for(let o=t;o!=e&&!(Sa(c,n,s[o+1],s[o+2])&&(d=o,i>0));o=s[o+3]);return d}slice(t,e,i){let n=this.buffer,c=new Uint16Array(e-t),s=0;for(let d=t,o=0;d<e;){c[o++]=n[d++],c[o++]=n[d++]-i;let a=c[o++]=n[d++]-i;c[o++]=n[d++]-t,s=Math.max(s,a)}return new nl(c,s,this.set)}}function Sa(l,t,e,i){switch(l){case-2:return e<t;case-1:return i>=t&&e<t;case 0:return e<t&&i>t;case 1:return e<=t&&i>t;case 2:return i>t;case 4:return!0}}function La(l,t){let e=l.childBefore(t);for(;e;){let i=e.lastChild;if(!i||i.to!=e.to)break;i.type.isError&&i.from==i.to?(l=e,e=i.prevSibling):e=i}return l}function yl(l,t,e,i){for(var n;l.from==l.to||(e<1?l.from>=t:l.from>t)||(e>-1?l.to<=t:l.to<t);){let s=!i&&l instanceof Se&&l.index<0?null:l.parent;if(!s)return l;l=s}let c=i?0:kt.IgnoreOverlays;if(i)for(let s=l,d=s.parent;d;s=d,d=s.parent)s instanceof Se&&s.index<0&&((n=d.enter(t,e,c))===null||n===void 0?void 0:n.from)!=s.from&&(l=d);for(;;){let s=l.enter(t,e,c);if(!s)return l;l=s}}class Se{constructor(t,e,i,n){this._tree=t,this.from=e,this.index=i,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,i,n,c=0){for(let s=this;;){for(let{children:d,positions:o}=s._tree,a=e>0?d.length:-1;t!=a;t+=e){let h=d[t],u=o[t]+s.from;if(!!Sa(n,i,u,u+h.length)){if(h instanceof nl){if(c&kt.ExcludeBuffers)continue;let m=h.findChild(0,h.buffer.length,e,i-u,n);if(m>-1)return new Te(new eZ(s,h,t,u),null,m)}else if(c&kt.IncludeAnonymous||!h.type.isAnonymous||es(h)){let m;if(!(c&kt.IgnoreMounts)&&h.props&&(m=h.prop(q.mounted))&&!m.overlay)return new Se(m.tree,u,t,s);let r=new Se(h,u,t,s);return c&kt.IncludeAnonymous||!r.type.isAnonymous?r:r.nextChild(e<0?h.children.length-1:0,e,i,n)}}}if(c&kt.IncludeAnonymous||!s.type.isAnonymous||(s.index>=0?t=s.index+e:t=e<0?-1:s._parent._tree.children.length,s=s._parent,!s))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,i=0){let n;if(!(i&kt.IgnoreOverlays)&&(n=this._tree.prop(q.mounted))&&n.overlay){let c=t-this.from;for(let{from:s,to:d}of n.overlay)if((e>0?s<=c:s<c)&&(e<0?d>=c:d>c))return new Se(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,i)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(t=0){return new cn(this,t)}get tree(){return this._tree}toTree(){return this._tree}resolve(t,e=0){return yl(this,t,e,!1)}resolveInner(t,e=0){return yl(this,t,e,!0)}enterUnfinishedNodesBefore(t){return La(this,t)}getChild(t,e=null,i=null){let n=ln(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return ln(this,t,e,i)}toString(){return this._tree.toString()}get node(){return this}matchContext(t){return nn(this,t)}}function ln(l,t,e,i){let n=l.cursor(),c=[];if(!n.firstChild())return c;if(e!=null){for(;!n.type.is(e);)if(!n.nextSibling())return c}for(;;){if(i!=null&&n.type.is(i))return c;if(n.type.is(t)&&c.push(n.node),!n.nextSibling())return i==null?c:[]}}function nn(l,t,e=t.length-1){for(let i=l.parent;e>=0;i=i.parent){if(!i)return!1;if(!i.type.isAnonymous){if(t[e]&&t[e]!=i.name)return!1;e--}}return!0}class eZ{constructor(t,e,i,n){this.parent=t,this.buffer=e,this.index=i,this.start=n}}class Te{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,i){this.context=t,this._parent=e,this.index=i,this.type=t.buffer.set.types[t.buffer.buffer[i]]}child(t,e,i){let{buffer:n}=this.context,c=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,i);return c<0?null:new Te(this.context,this,c)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,i=0){if(i&kt.ExcludeBuffers)return null;let{buffer:n}=this.context,c=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return c<0?null:new Te(this.context,this,c)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new Te(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new Te(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}cursor(t=0){return new cn(this,t)}get tree(){return null}toTree(){let t=[],e=[],{buffer:i}=this.context,n=this.index+4,c=i.buffer[this.index+3];if(c>n){let s=i.buffer[this.index+1];t.push(i.slice(n,c,s)),e.push(0)}return new bt(this.type,t,e,this.to-this.from)}resolve(t,e=0){return yl(this,t,e,!1)}resolveInner(t,e=0){return yl(this,t,e,!0)}enterUnfinishedNodesBefore(t){return La(this,t)}toString(){return this.context.buffer.childString(this.index)}getChild(t,e=null,i=null){let n=ln(this,t,e,i);return n.length?n[0]:null}getChildren(t,e=null,i=null){return ln(this,t,e,i)}get node(){return this}matchContext(t){return nn(this,t)}}class cn{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof Se)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let i=t._parent;i;i=i._parent)this.stack.unshift(i.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return t?(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0):!1}yieldBuf(t,e){this.index=t;let{start:i,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=i+n.buffer[t+1],this.to=i+n.buffer[t+2],!0}yield(t){return t?t instanceof Se?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,i){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,i,this.mode));let{buffer:n}=this.buffer,c=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,i);return c<0?!1:(this.stack.push(this.index),this.yieldBuf(c))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,i=this.mode){return this.buffer?i&kt.ExcludeBuffers?!1:this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,i))}parent(){if(!this.buffer)return this.yieldNode(this.mode&kt.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&kt.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode)):!1;let{buffer:e}=this.buffer,i=this.stack.length-1;if(t<0){let n=i<0?0:this.stack[i]+4;if(this.index!=n)return this.yieldBuf(e.findChild(n,this.index,-1,0,4))}else{let n=e.buffer[this.index+3];if(n<(i<0?e.buffer.length:e.buffer[this.stack[i]+3]))return this.yieldBuf(n)}return i<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,i,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let c=0;c<this.index;c++)if(n.buffer.buffer[c+3]<this.index)return!1;({index:e,parent:i}=n)}else({index:e,_parent:i}=this._tree);for(;i;{index:e,_parent:i}=i)if(e>-1)for(let c=e+t,s=t<0?-1:i._tree.children.length;c!=s;c+=t){let d=i._tree.children[c];if(this.mode&kt.IncludeAnonymous||d instanceof nl||!d.type.isAnonymous||es(d))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,i=0;if(t&&t.context==this.buffer){t:for(let n=this.index,c=this.stack.length;c>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,i=c+1;break t}n=this.stack[--c]}}for(let n=i;n<this.stack.length;n++)e=new Te(this.buffer,e,this.stack[n]);return this.bufferNode=new Te(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let i=0;;){let n=!1;if(this.type.isAnonymous||t(this)!==!1){if(this.firstChild()){i++;continue}this.type.isAnonymous||(n=!0)}for(;n&&e&&e(this),n=this.type.isAnonymous,!this.nextSibling();){if(!i)return;this.parent(),i--,n=!0}}}matchContext(t){if(!this.buffer)return nn(this.node,t);let{buffer:e}=this.buffer,{types:i}=e.set;for(let n=t.length-1,c=this.stack.length-1;n>=0;c--){if(c<0)return nn(this.node,t,n);let s=i[e.buffer[this.stack[c]]];if(!s.isAnonymous){if(t[n]&&t[n]!=s.name)return!1;n--}}return!0}}function es(l){return l.children.some(t=>t instanceof nl||!t.type.isAnonymous||es(t))}function lZ(l){var t;let{buffer:e,nodeSet:i,maxBufferLength:n=_b,reused:c=[],minRepeatType:s=i.types.length}=l,d=Array.isArray(e)?new ts(e,e.length):e,o=i.types,a=0,h=0;function u(W,G,K,f,S){let{id:T,start:k,end:E,size:j}=d,D=h;for(;j<0;)if(d.next(),j==-1){let ot=c[T];K.push(ot),f.push(k-W);return}else if(j==-3){a=T;return}else if(j==-4){h=T;return}else throw new RangeError(`Unrecognized record size: ${j}`);let it=o[T],_,J,ht=k-W;if(E-k<=n&&(J=Z(d.pos-G,S))){let ot=new Uint16Array(J.size-J.skip),ut=d.pos-J.size,Ft=ot.length;for(;d.pos>ut;)Ft=g(J.start,ot,Ft);_=new nl(ot,E-J.start,i),ht=J.start-W}else{let ot=d.pos-j;d.next();let ut=[],Ft=[],C=T>=s?T:-1,pt=0,ce=E;for(;d.pos>ot;)C>=0&&d.id==C&&d.size>=0?(d.end<=ce-n&&(r(ut,Ft,k,pt,d.end,ce,C,D),pt=ut.length,ce=d.end),d.next()):u(k,ot,ut,Ft,C);if(C>=0&&pt>0&&pt<ut.length&&r(ut,Ft,k,pt,k,ce,C,D),ut.reverse(),Ft.reverse(),C>-1&&pt>0){let vt=m(it);_=ls(it,ut,Ft,0,ut.length,0,E-k,vt,vt)}else _=b(it,ut,Ft,E-k,D-E)}K.push(_),f.push(ht)}function m(W){return(G,K,f)=>{let S=0,T=G.length-1,k,E;if(T>=0&&(k=G[T])instanceof bt){if(!T&&k.type==W&&k.length==f)return k;(E=k.prop(q.lookAhead))&&(S=K[T]+k.length+E)}return b(W,G,K,f,S)}}function r(W,G,K,f,S,T,k,E){let j=[],D=[];for(;W.length>f;)j.push(W.pop()),D.push(G.pop()+K-S);W.push(b(i.types[k],j,D,T-S,E-T)),G.push(S-K)}function b(W,G,K,f,S=0,T){if(a){let k=[q.contextHash,a];T=T?[k].concat(T):[k]}if(S>25){let k=[q.lookAhead,S];T=T?[k].concat(T):[k]}return new bt(W,G,K,f,T)}function Z(W,G){let K=d.fork(),f=0,S=0,T=0,k=K.end-n,E={size:0,start:0,skip:0};t:for(let j=K.pos-W;K.pos>j;){let D=K.size;if(K.id==G&&D>=0){E.size=f,E.start=S,E.skip=T,T+=4,f+=4,K.next();continue}let it=K.pos-D;if(D<0||it<j||K.start<k)break;let _=K.id>=s?4:0,J=K.start;for(K.next();K.pos>it;){if(K.size<0)if(K.size==-3)_+=4;else break t;else K.id>=s&&(_+=4);K.next()}S=J,f+=D,T+=_}return(G<0||f==W)&&(E.size=f,E.start=S,E.skip=T),E.size>4?E:void 0}function g(W,G,K){let{id:f,start:S,end:T,size:k}=d;if(d.next(),k>=0&&f<s){let E=K;if(k>4){let j=d.pos-(k-4);for(;d.pos>j;)K=g(W,G,K)}G[--K]=E,G[--K]=T-W,G[--K]=S-W,G[--K]=f}else k==-3?a=f:k==-4&&(h=f);return K}let p=[],R=[];for(;d.pos>0;)u(l.start||0,l.bufferStart||0,p,R,-1);let V=(t=l.length)!==null&&t!==void 0?t:p.length?R[0]+p[0].length:0;return new bt(o[l.topID],p.reverse(),R.reverse(),V)}const Ja=new WeakMap;function sn(l,t){if(!l.isAnonymous||t instanceof nl||t.type!=l)return 1;let e=Ja.get(t);if(e==null){e=1;for(let i of t.children){if(i.type!=l||!(i instanceof bt)){e=1;break}e+=sn(l,i)}Ja.set(t,e)}return e}function ls(l,t,e,i,n,c,s,d,o){let a=0;for(let b=i;b<n;b++)a+=sn(l,t[b]);let h=Math.ceil(a*1.5/8),u=[],m=[];function r(b,Z,g,p,R){for(let V=g;V<p;){let W=V,G=Z[V],K=sn(l,b[V]);for(V++;V<p;V++){let f=sn(l,b[V]);if(K+f>=h)break;K+=f}if(V==W+1){if(K>h){let f=b[W];r(f.children,f.positions,0,f.children.length,Z[W]+R);continue}u.push(b[W])}else{let f=Z[V-1]+b[V-1].length-G;u.push(ls(l,b,Z,W,V,G,f,null,o))}m.push(G+R-c)}}return r(t,e,i,n,0),(d||o)(u,m,s)}class cl{constructor(t,e,i,n,c=!1,s=!1){this.from=t,this.to=e,this.tree=i,this.offset=n,this.open=(c?1:0)|(s?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(t,e=[],i=!1){let n=[new cl(0,t.length,t,0,!1,i)];for(let c of e)c.to>t.length&&n.push(c);return n}static applyChanges(t,e,i=128){if(!e.length)return t;let n=[],c=1,s=t.length?t[0]:null;for(let d=0,o=0,a=0;;d++){let h=d<e.length?e[d]:null,u=h?h.fromA:1e9;if(u-o>=i)for(;s&&s.from<u;){let m=s;if(o>=m.from||u<=m.to||a){let r=Math.max(m.from,o)-a,b=Math.min(m.to,u)-a;m=r>=b?null:new cl(r,b,m.tree,m.offset+a,d>0,!!h)}if(m&&n.push(m),s.to>u)break;s=c<t.length?t[c++]:null}if(!h)break;o=h.toA,a=h.toA-h.toB}return n}}class Fa{startParse(t,e,i){return typeof t=="string"&&(t=new iZ(t)),i=i?i.length?i.map(n=>new _c(n.from,n.to)):[new _c(0,0)]:[new _c(0,t.length)],this.createParse(t,e||[],i)}parse(t,e,i){let n=this.startParse(t,e,i);for(;;){let c=n.advance();if(c)return c}}}class iZ{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new q({perNode:!0});let nZ=0;class Ge{constructor(t,e,i){this.set=t,this.base=e,this.modified=i,this.id=nZ++}static define(t){if(t!=null&&t.base)throw new Error("Can not derive from a modified tag");let e=new Ge([],null,[]);if(e.set.push(e),t)for(let i of t.set)e.set.push(i);return e}static defineModifier(){let t=new dn;return e=>e.modified.indexOf(t)>-1?e:dn.get(e.base||e,e.modified.concat(t).sort((i,n)=>i.id-n.id))}}let cZ=0;class dn{constructor(){this.instances=[],this.id=cZ++}static get(t,e){if(!e.length)return t;let i=e[0].instances.find(d=>d.base==t&&sZ(e,d.modified));if(i)return i;let n=[],c=new Ge(n,t,e);for(let d of e)d.instances.push(c);let s=dZ(e);for(let d of t.set)if(!d.modified.length)for(let o of s)n.push(dn.get(d,o));return c}}function sZ(l,t){return l.length==t.length&&l.every((e,i)=>e==t[i])}function dZ(l){let t=[[]];for(let e=0;e<l.length;e++)for(let i=0,n=t.length;i<n;i++)t.push(t[i].concat(l[e]));return t.sort((e,i)=>i.length-e.length)}function oZ(l){let t=Object.create(null);for(let e in l){let i=l[e];Array.isArray(i)||(i=[i]);for(let n of e.split(" "))if(n){let c=[],s=2,d=n;for(let u=0;;){if(d=="..."&&u>0&&u+3==n.length){s=1;break}let m=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(d);if(!m)throw new RangeError("Invalid path: "+n);if(c.push(m[0]=="*"?"":m[0][0]=='"'?JSON.parse(m[0]):m[0]),u+=m[0].length,u==n.length)break;let r=n[u++];if(u==n.length&&r=="!"){s=0;break}if(r!="/")throw new RangeError("Invalid path: "+n);d=n.slice(u)}let o=c.length-1,a=c[o];if(!a)throw new RangeError("Invalid path: "+n);let h=new on(i,s,o>0?c.slice(0,o):null);t[a]=h.sort(t[a])}}return Ka.add(t)}const Ka=new q;class on{constructor(t,e,i,n){this.tags=t,this.mode=e,this.context=i,this.next=n}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}on.empty=new on([],2,null);function Ha(l,t){let e=Object.create(null);for(let c of l)if(!Array.isArray(c.tag))e[c.tag.id]=c.class;else for(let s of c.tag)e[s.id]=c.class;let{scope:i,all:n=null}=t||{};return{style:c=>{let s=n;for(let d of c)for(let o of d.set){let a=e[o.id];if(a){s=s?s+" "+a:a;break}}return s},scope:i}}function aZ(l,t){let e=null;for(let i of l){let n=i.style(t);n&&(e=e?e+" "+n:n)}return e}function hZ(l,t,e,i=0,n=l.length){let c=new uZ(i,Array.isArray(t)?t:[t],e);c.highlightRange(l.cursor(),i,n,"",c.highlighters),c.flush(n)}class uZ{constructor(t,e,i){this.at=t,this.highlighters=e,this.span=i,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,i,n,c){let{type:s,from:d,to:o}=t;if(d>=i||o<=e)return;s.isTop&&(c=this.highlighters.filter(r=>!r.scope||r.scope(s)));let a=n,h=mZ(t)||on.empty,u=aZ(c,h.tags);if(u&&(a&&(a+=" "),a+=u,h.mode==1&&(n+=(n?" ":"")+u)),this.startSpan(t.from,a),h.opaque)return;let m=t.tree&&t.tree.prop(q.mounted);if(m&&m.overlay){let r=t.node.enter(m.overlay[0].from+d,1),b=this.highlighters.filter(g=>!g.scope||g.scope(m.tree.type)),Z=t.firstChild();for(let g=0,p=d;;g++){let R=g<m.overlay.length?m.overlay[g]:null,V=R?R.from+d:o,W=Math.max(e,p),G=Math.min(i,V);if(W<G&&Z)for(;t.from<G&&(this.highlightRange(t,W,G,n,c),this.startSpan(Math.min(G,t.to),a),!(t.to>=V||!t.nextSibling())););if(!R||V>i)break;p=R.to+d,p>e&&(this.highlightRange(r.cursor(),Math.max(e,R.from+d),Math.min(i,p),n,b),this.startSpan(p,a))}Z&&t.parent()}else if(t.firstChild()){do if(!(t.to<=e)){if(t.from>=i)break;this.highlightRange(t,e,i,n,c),this.startSpan(Math.min(i,t.to),a)}while(t.nextSibling());t.parent()}}}function mZ(l){let t=l.type.prop(Ka);for(;t&&t.context&&!l.matchContext(t.context);)t=t.next;return t||null}const F=Ge.define,an=F(),Me=F(),Ba=F(Me),ka=F(Me),Pe=F(),hn=F(Pe),is=F(Pe),We=F(),sl=F(We),Xe=F(),Ie=F(),ns=F(),di=F(ns),un=F(),I={comment:an,lineComment:F(an),blockComment:F(an),docComment:F(an),name:Me,variableName:F(Me),typeName:Ba,tagName:F(Ba),propertyName:ka,attributeName:F(ka),className:F(Me),labelName:F(Me),namespace:F(Me),macroName:F(Me),literal:Pe,string:hn,docString:F(hn),character:F(hn),attributeValue:F(hn),number:is,integer:F(is),float:F(is),bool:F(Pe),regexp:F(Pe),escape:F(Pe),color:F(Pe),url:F(Pe),keyword:Xe,self:F(Xe),null:F(Xe),atom:F(Xe),unit:F(Xe),modifier:F(Xe),operatorKeyword:F(Xe),controlKeyword:F(Xe),definitionKeyword:F(Xe),moduleKeyword:F(Xe),operator:Ie,derefOperator:F(Ie),arithmeticOperator:F(Ie),logicOperator:F(Ie),bitwiseOperator:F(Ie),compareOperator:F(Ie),updateOperator:F(Ie),definitionOperator:F(Ie),typeOperator:F(Ie),controlOperator:F(Ie),punctuation:ns,separator:F(ns),bracket:di,angleBracket:F(di),squareBracket:F(di),paren:F(di),brace:F(di),content:We,heading:sl,heading1:F(sl),heading2:F(sl),heading3:F(sl),heading4:F(sl),heading5:F(sl),heading6:F(sl),contentSeparator:F(We),list:F(We),quote:F(We),emphasis:F(We),strong:F(We),link:F(We),monospace:F(We),strikethrough:F(We),inserted:F(),deleted:F(),changed:F(),invalid:F(),meta:un,documentMeta:F(un),annotation:F(un),processingInstruction:F(un),definition:Ge.defineModifier(),constant:Ge.defineModifier(),function:Ge.defineModifier(),standard:Ge.defineModifier(),local:Ge.defineModifier(),special:Ge.defineModifier()};Ha([{tag:I.link,class:"tok-link"},{tag:I.heading,class:"tok-heading"},{tag:I.emphasis,class:"tok-emphasis"},{tag:I.strong,class:"tok-strong"},{tag:I.keyword,class:"tok-keyword"},{tag:I.atom,class:"tok-atom"},{tag:I.bool,class:"tok-bool"},{tag:I.url,class:"tok-url"},{tag:I.labelName,class:"tok-labelName"},{tag:I.inserted,class:"tok-inserted"},{tag:I.deleted,class:"tok-deleted"},{tag:I.literal,class:"tok-literal"},{tag:I.string,class:"tok-string"},{tag:I.number,class:"tok-number"},{tag:[I.regexp,I.escape,I.special(I.string)],class:"tok-string2"},{tag:I.variableName,class:"tok-variableName"},{tag:I.local(I.variableName),class:"tok-variableName tok-local"},{tag:I.definition(I.variableName),class:"tok-variableName tok-definition"},{tag:I.special(I.variableName),class:"tok-variableName2"},{tag:I.definition(I.propertyName),class:"tok-propertyName tok-definition"},{tag:I.typeName,class:"tok-typeName"},{tag:I.namespace,class:"tok-namespace"},{tag:I.className,class:"tok-className"},{tag:I.macroName,class:"tok-macroName"},{tag:I.propertyName,class:"tok-propertyName"},{tag:I.operator,class:"tok-operator"},{tag:I.comment,class:"tok-comment"},{tag:I.meta,class:"tok-meta"},{tag:I.invalid,class:"tok-invalid"},{tag:I.punctuation,class:"tok-punctuation"}]);var cs;const oi=new q;function rZ(l){return U.define({combine:l?t=>t.concat(l):void 0})}class se{constructor(t,e,i=[],n=""){this.data=t,this.name=n,O.prototype.hasOwnProperty("tree")||Object.defineProperty(O.prototype,"tree",{get(){return Jt(this)}}),this.parser=e,this.extension=[Ee.of(this),O.languageData.of((c,s,d)=>c.facet(xa(c,s,d)))].concat(i)}isActiveAt(t,e,i=-1){return xa(t,e,i)==this.data}findRegions(t){let e=t.facet(Ee);if((e==null?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let i=[],n=(c,s)=>{if(c.prop(oi)==this.data){i.push({from:s,to:s+c.length});return}let d=c.prop(q.mounted);if(d){if(d.tree.prop(oi)==this.data){if(d.overlay)for(let o of d.overlay)i.push({from:o.from+s,to:o.to+s});else i.push({from:s,to:s+c.length});return}else if(d.overlay){let o=i.length;if(n(d.tree,d.overlay[0].from+s),i.length>o)return}}for(let o=0;o<c.children.length;o++){let a=c.children[o];a instanceof bt&&n(a,c.positions[o]+s)}};return n(Jt(t),0),i}get allowsNesting(){return!0}}se.setState=P.define();function xa(l,t,e){let i=l.facet(Ee);if(!i)return null;let n=i.data;if(i.allowsNesting)for(let c=Jt(l).topNode;c;c=c.enter(t,e,kt.ExcludeBuffers))n=c.type.prop(oi)||n;return n}function Jt(l){let t=l.field(se.state,!1);return t?t.tree:bt.empty}class bZ{constructor(t,e=t.length){this.doc=t,this.length=e,this.cursorPos=0,this.string="",this.cursor=t.iter()}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let i=this.cursorPos-this.string.length;return t<i||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-i,e-i)}}let ai=null;class Rl{constructor(t,e,i=[],n,c,s,d,o){this.parser=t,this.state=e,this.fragments=i,this.tree=n,this.treeLen=c,this.viewport=s,this.skipped=d,this.scheduleOn=o,this.parse=null,this.tempSkipped=[]}static create(t,e,i){return new Rl(t,e,[],bt.empty,0,i,[],null)}startParse(){return this.parser.startParse(new bZ(this.state.doc),this.fragments)}work(t,e){return e!=null&&e>=this.state.doc.length&&(e=void 0),this.tree!=bt.empty&&this.isDone(e!=null?e:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var i;if(typeof t=="number"){let n=Date.now()+t;t=()=>Date.now()>n}for(this.parse||(this.parse=this.startParse()),e!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n)if(this.fragments=this.withoutTempSkipped(cl.addTree(n,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(i=this.parse.stoppedAt)!==null&&i!==void 0?i:this.state.doc.length,this.tree=n,this.parse=null,this.treeLen<(e!=null?e:this.state.doc.length))this.parse=this.startParse();else return!0;if(t())return!1}})}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext(()=>{for(;!(e=this.parse.advance()););}),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(cl.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=ai;ai=this;try{return t()}finally{ai=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=wa(t,e.from,e.to);return t}changes(t,e){let{fragments:i,tree:n,treeLen:c,viewport:s,skipped:d}=this;if(this.takeTree(),!t.empty){let o=[];if(t.iterChangedRanges((a,h,u,m)=>o.push({fromA:a,toA:h,fromB:u,toB:m})),i=cl.applyChanges(i,o),n=bt.empty,c=0,s={from:t.mapPos(s.from,-1),to:t.mapPos(s.to,1)},this.skipped.length){d=[];for(let a of this.skipped){let h=t.mapPos(a.from,1),u=t.mapPos(a.to,-1);h<u&&d.push({from:h,to:u})}}}return new Rl(this.parser,e,i,n,c,s,d,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let i=0;i<this.skipped.length;i++){let{from:n,to:c}=this.skipped[i];n<t.to&&c>t.from&&(this.fragments=wa(this.fragments,n,c),this.skipped.splice(i--,1))}return this.skipped.length>=e?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends Fa{createParse(e,i,n){let c=n[0].from,s=n[n.length-1].to;return{parsedPos:c,advance(){let o=ai;if(o){for(let a of n)o.tempSkipped.push(a);t&&(o.scheduleOn=o.scheduleOn?Promise.all([o.scheduleOn,t]):t)}return this.parsedPos=s,new bt(Tt.none,[],[],s-c)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&e[0].from==0&&e[0].to>=t}static get(){return ai}}function wa(l,t,e){return cl.applyChanges(l,[{fromA:t,toA:e,fromB:t,toB:e}])}class fl{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),i=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,i)||e.takeTree(),new fl(e)}static init(t){let e=Math.min(3e3,t.doc.length),i=Rl.create(t.facet(Ee).parser,t,{from:0,to:e});return i.work(20,e)||i.takeTree(),new fl(i)}}se.state=Gt.define({create:fl.init,update(l,t){for(let e of t.effects)if(e.is(se.setState))return e.value;return t.startState.facet(Ee)!=t.state.facet(Ee)?fl.init(t.state):l.apply(t)}});let va=l=>{let t=setTimeout(()=>l(),500);return()=>clearTimeout(t)};typeof requestIdleCallback<"u"&&(va=l=>{let t=-1,e=setTimeout(()=>{t=requestIdleCallback(l,{timeout:500-100})},100);return()=>t<0?clearTimeout(e):cancelIdleCallback(t)});const ss=typeof navigator<"u"&&((cs=navigator.scheduling)===null||cs===void 0?void 0:cs.isInputPending)?()=>navigator.scheduling.isInputPending():null,ZZ=Xt.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(se.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),t.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(se.state);(e.tree!=e.context.tree||!e.context.isDone(t.doc.length))&&(this.working=va(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:i,viewport:{to:n}}=this.view,c=i.field(se.state);if(c.tree==c.context.tree&&c.context.isDone(n+1e5))return;let s=Date.now()+Math.min(this.chunkBudget,100,t&&!ss?Math.max(25,t.timeRemaining()-5):1e9),d=c.context.treeLen<n&&i.doc.length>n+1e3,o=c.context.work(()=>ss&&ss()||Date.now()>s,n+(d?0:1e5));this.chunkBudget-=Date.now()-e,(o||this.chunkBudget<=0)&&(c.context.takeTree(),this.view.dispatch({effects:se.setState.of(new fl(c.context))})),this.chunkBudget>0&&!(o&&!d)&&this.scheduleWork(),this.checkAsyncSchedule(c.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then(()=>this.scheduleWork()).catch(e=>Qt(this.view.state,e)).then(()=>this.workScheduled--),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ee=U.define({combine(l){return l.length?l[0]:null},enables:l=>[se.state,ZZ,w.contentAttributes.compute([l],t=>{let e=t.facet(l);return e&&e.name?{"data-language":e.name}:{}})]}),Ua=U.define(),ds=U.define({combine:l=>{if(!l.length)return"  ";if(!/^(?: +|\t+)$/.test(l[0]))throw new Error("Invalid indent unit: "+JSON.stringify(l[0]));return l[0]}});function dl(l){let t=l.facet(ds);return t.charCodeAt(0)==9?l.tabSize*t.length:t.length}function hi(l,t){let e="",i=l.tabSize;if(l.facet(ds).charCodeAt(0)==9)for(;t>=i;)e+="	",t-=i;for(let n=0;n<t;n++)e+=" ";return e}function os(l,t){l instanceof O&&(l=new mn(l));for(let i of l.state.facet(Ua)){let n=i(l,t);if(n!==void 0)return n}let e=Jt(l.state);return e?pZ(l,e,t):null}class mn{constructor(t,e={}){this.state=t,this.options=e,this.unit=dl(t)}lineAt(t,e=1){let i=this.state.doc.lineAt(t),{simulateBreak:n,simulateDoubleBreak:c}=this.options;return n!=null&&n>=i.from&&n<=i.to?c&&n==t?{text:"",from:t}:(e<0?n<t:n<=t)?{text:i.text.slice(n-i.from),from:n}:{text:i.text.slice(0,n-i.from),from:i.from}:i}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:i,from:n}=this.lineAt(t,e);return i.slice(t-n,Math.min(i.length,t+100-n))}column(t,e=1){let{text:i,from:n}=this.lineAt(t,e),c=this.countColumn(i,t-n),s=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return s>-1&&(c+=s-this.countColumn(i,i.search(/\S|$/))),c}countColumn(t,e=t.length){return El(t,this.state.tabSize,e)}lineIndent(t,e=1){let{text:i,from:n}=this.lineAt(t,e),c=this.options.overrideIndentation;if(c){let s=c(n);if(s>-1)return s}return this.countColumn(i,i.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const gZ=new q;function pZ(l,t,e){return Aa(t.resolveInner(e).enterUnfinishedNodesBefore(e),e,l)}function GZ(l){return l.pos==l.options.simulateBreak&&l.options.simulateDoubleBreak}function WZ(l){let t=l.type.prop(gZ);if(t)return t;let e=l.firstChild,i;if(e&&(i=e.type.prop(q.closedBy))){let n=l.lastChild,c=n&&i.indexOf(n.name)>-1;return s=>yZ(s,!0,1,void 0,c&&!GZ(s)?n.from:void 0)}return l.parent==null?XZ:null}function Aa(l,t,e){for(;l;l=l.parent){let i=WZ(l);if(i)return i(as.create(e,t,l))}return null}function XZ(){return 0}class as extends mn{constructor(t,e,i){super(t.state,t.options),this.base=t,this.pos=e,this.node=i}static create(t,e,i){return new as(t,e,i)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let t=this.state.doc.lineAt(this.node.from);for(;;){let e=this.node.resolve(t.from);for(;e.parent&&e.parent.from==e.from;)e=e.parent;if(IZ(e,this.node))break;t=this.state.doc.lineAt(e.from)}return this.lineIndent(t.from)}continue(){let t=this.node.parent;return t?Aa(t,this.pos,this.base):0}}function IZ(l,t){for(let e=t;e;e=e.parent)if(l==e)return!0;return!1}function VZ(l){let t=l.node,e=t.childAfter(t.from),i=t.lastChild;if(!e)return null;let n=l.options.simulateBreak,c=l.state.doc.lineAt(e.from),s=n==null||n<=c.from?c.to:Math.min(c.to,n);for(let d=e.to;;){let o=t.childAfter(d);if(!o||o==i)return null;if(!o.type.isSkipped)return o.from<s?e:null;d=o.to}}function yZ(l,t,e,i,n){let c=l.textAfter,s=c.match(/^\s*/)[0].length,d=i&&c.slice(s,s+i.length)==i||n==l.pos+s,o=t?VZ(l):null;return o?d?l.column(o.from):l.column(o.to):l.baseIndent+(d?0:l.unit*e)}const RZ=200;function fZ(){return O.transactionFilter.of(l=>{if(!l.docChanged||!l.isUserEvent("input.type")&&!l.isUserEvent("input.complete"))return l;let t=l.startState.languageDataAt("indentOnInput",l.startState.selection.main.head);if(!t.length)return l;let e=l.newDoc,{head:i}=l.newSelection.main,n=e.lineAt(i);if(i>n.from+RZ)return l;let c=e.sliceString(n.from,i);if(!t.some(a=>a.test(c)))return l;let{state:s}=l,d=-1,o=[];for(let{head:a}of s.selection.ranges){let h=s.doc.lineAt(a);if(h.from==d)continue;d=h.from;let u=os(s,h.from);if(u==null)continue;let m=/^\s*/.exec(h.text)[0],r=hi(s,u);m!=r&&o.push({from:h.from,to:h.from+m.length,insert:r})}return o.length?[l,{changes:o,sequential:!0}]:l})}const CZ=U.define(),YZ=new q;function SZ(l,t,e){let i=Jt(l);if(i.length<e)return null;let n=i.resolveInner(e,1),c=null;for(let s=n;s;s=s.parent){if(s.to<=e||s.from>e)continue;if(c&&s.from<t)break;let d=s.type.prop(YZ);if(d&&(s.to<i.length-50||i.length==l.doc.length||!LZ(s))){let o=d(s,l);o&&o.from<=e&&o.from>=t&&o.to>e&&(c=o)}}return c}function LZ(l){let t=l.lastChild;return t&&t.to==l.to&&t.type.isError}function rn(l,t,e){for(let i of l.facet(CZ)){let n=i(l,t,e);if(n)return n}return SZ(l,t,e)}function Na(l,t){let e=t.mapPos(l.from,1),i=t.mapPos(l.to,-1);return e>=i?void 0:{from:e,to:i}}const bn=P.define({map:Na}),ui=P.define({map:Na});function za(l){let t=[];for(let{head:e}of l.state.selection.ranges)t.some(i=>i.from<=e&&i.to>=e)||t.push(l.lineBlockAt(e));return t}const ol=Gt.define({create(){return N.none},update(l,t){l=l.map(t.changes);for(let e of t.effects)e.is(bn)&&!JZ(l,e.value.from,e.value.to)?l=l.update({add:[ja.range(e.value.from,e.value.to)]}):e.is(ui)&&(l=l.update({filter:(i,n)=>e.value.from!=i||e.value.to!=n,filterFrom:e.value.from,filterTo:e.value.to}));if(t.selection){let e=!1,{head:i}=t.selection.main;l.between(i,i,(n,c)=>{n<i&&c>i&&(e=!0)}),e&&(l=l.update({filterFrom:i,filterTo:i,filter:(n,c)=>c<=i||n>=i}))}return l},provide:l=>w.decorations.from(l),toJSON(l,t){let e=[];return l.between(0,t.doc.length,(i,n)=>{e.push(i,n)}),e},fromJSON(l){if(!Array.isArray(l)||l.length%2)throw new RangeError("Invalid JSON for fold state");let t=[];for(let e=0;e<l.length;){let i=l[e++],n=l[e++];if(typeof i!="number"||typeof n!="number")throw new RangeError("Invalid JSON for fold state");t.push(ja.range(i,n))}return N.set(t,!0)}});function Zn(l,t,e){var i;let n=null;return(i=l.field(ol,!1))===null||i===void 0||i.between(t,e,(c,s)=>{(!n||n.from>c)&&(n={from:c,to:s})}),n}function JZ(l,t,e){let i=!1;return l.between(t,t,(n,c)=>{n==t&&c==e&&(i=!0)}),i}function Ta(l,t){return l.field(ol,!1)?t:t.concat(P.appendConfig.of(Ea()))}const FZ=l=>{for(let t of za(l)){let e=rn(l.state,t.from,t.to);if(e)return l.dispatch({effects:Ta(l.state,[bn.of(e),Ma(l,e)])}),!0}return!1},KZ=l=>{if(!l.state.field(ol,!1))return!1;let t=[];for(let e of za(l)){let i=Zn(l.state,e.from,e.to);i&&t.push(ui.of(i),Ma(l,i,!1))}return t.length&&l.dispatch({effects:t}),t.length>0};function Ma(l,t,e=!0){let i=l.state.doc.lineAt(t.from).number,n=l.state.doc.lineAt(t.to).number;return w.announce.of(`${l.state.phrase(e?"Folded lines":"Unfolded lines")} ${i} ${l.state.phrase("to")} ${n}.`)}const HZ=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:FZ},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:KZ},{key:"Ctrl-Alt-[",run:l=>{let{state:t}=l,e=[];for(let i=0;i<t.doc.length;){let n=l.lineBlockAt(i),c=rn(t,n.from,n.to);c&&e.push(bn.of(c)),i=(c?l.lineBlockAt(c.to):n).to+1}return e.length&&l.dispatch({effects:Ta(l.state,e)}),!!e.length}},{key:"Ctrl-Alt-]",run:l=>{let t=l.state.field(ol,!1);if(!t||!t.size)return!1;let e=[];return t.between(0,l.state.doc.length,(i,n)=>{e.push(ui.of({from:i,to:n}))}),l.dispatch({effects:e}),!0}}],BZ={placeholderDOM:null,placeholderText:"\u2026"},Pa=U.define({combine(l){return be(l,BZ)}});function Ea(l){let t=[ol,wZ];return l&&t.push(Pa.of(l)),t}const ja=N.replace({widget:new class extends Ue{toDOM(l){let{state:t}=l,e=t.facet(Pa),i=c=>{let s=l.lineBlockAt(l.posAtDOM(c.target)),d=Zn(l.state,s.from,s.to);d&&l.dispatch({effects:ui.of(d)}),c.preventDefault()};if(e.placeholderDOM)return e.placeholderDOM(l,i);let n=document.createElement("span");return n.textContent=e.placeholderText,n.setAttribute("aria-label",t.phrase("folded code")),n.title=t.phrase("unfold"),n.className="cm-foldPlaceholder",n.onclick=i,n}}}),kZ={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class hs extends Ye{constructor(t,e){super(),this.config=t,this.open=e}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){if(this.config.markerDOM)return this.config.markerDOM(this.open);let e=document.createElement("span");return e.textContent=this.open?this.config.openText:this.config.closedText,e.title=t.state.phrase(this.open?"Fold line":"Unfold line"),e}}function xZ(l={}){let t=Object.assign(Object.assign({},kZ),l),e=new hs(t,!0),i=new hs(t,!1),n=Xt.fromClass(class{constructor(s){this.from=s.viewport.from,this.markers=this.buildMarkers(s)}update(s){(s.docChanged||s.viewportChanged||s.startState.facet(Ee)!=s.state.facet(Ee)||s.startState.field(ol,!1)!=s.state.field(ol,!1)||Jt(s.startState)!=Jt(s.state)||t.foldingChanged(s))&&(this.markers=this.buildMarkers(s.view))}buildMarkers(s){let d=new Be;for(let o of s.viewportLineBlocks){let a=Zn(s.state,o.from,o.to)?i:rn(s.state,o.from,o.to)?e:null;a&&d.add(o.from,o.from,a)}return d.finish()}}),{domEventHandlers:c}=t;return[n,zb({class:"cm-foldGutter",markers(s){var d;return((d=s.plugin(n))===null||d===void 0?void 0:d.markers)||lt.empty},initialSpacer(){return new hs(t,!1)},domEventHandlers:Object.assign(Object.assign({},c),{click:(s,d,o)=>{if(c.click&&c.click(s,d,o))return!0;let a=Zn(s.state,d.from,d.to);if(a)return s.dispatch({effects:ui.of(a)}),!0;let h=rn(s.state,d.from,d.to);return h?(s.dispatch({effects:bn.of(h)}),!0):!1}})}),Ea()]}const wZ=w.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class mi{constructor(t,e){this.specs=t;let i;function n(d){let o=ke.newName();return(i||(i=Object.create(null)))["."+o]=d,o}const c=typeof e.all=="string"?e.all:e.all?n(e.all):void 0,s=e.scope;this.scope=s instanceof se?d=>d.prop(oi)==s.data:s?d=>d==s:void 0,this.style=Ha(t.map(d=>({tag:d.tag,class:d.class||n(Object.assign({},d,{tag:null}))})),{all:c}).style,this.module=i?new ke(i):null,this.themeType=e.themeType}static define(t,e){return new mi(t,e||{})}}const us=U.define(),Qa=U.define({combine(l){return l.length?[l[0]]:null}});function ms(l){let t=l.facet(us);return t.length?t:l.facet(Qa)}function Da(l,t){let e=[UZ],i;return l instanceof mi&&(l.module&&e.push(w.styleModule.of(l.module)),i=l.themeType),t!=null&&t.fallback?e.push(Qa.of(l)):i?e.push(us.computeN([w.darkTheme],n=>n.facet(w.darkTheme)==(i=="dark")?[l]:[])):e.push(us.of(l)),e}class vZ{constructor(t){this.markCache=Object.create(null),this.tree=Jt(t.state),this.decorations=this.buildDeco(t,ms(t.state))}update(t){let e=Jt(t.state),i=ms(t.state),n=i!=ms(t.startState);e.length<t.view.viewport.to&&!n&&e.type==this.tree.type?this.decorations=this.decorations.map(t.changes):(e!=this.tree||t.viewportChanged||n)&&(this.tree=e,this.decorations=this.buildDeco(t.view,i))}buildDeco(t,e){if(!e||!this.tree.length)return N.none;let i=new Be;for(let{from:n,to:c}of t.visibleRanges)hZ(this.tree,e,(s,d,o)=>{i.add(s,d,this.markCache[o]||(this.markCache[o]=N.mark({class:o})))},n,c);return i.finish()}}const UZ=$e.high(Xt.fromClass(vZ,{decorations:l=>l.decorations})),AZ=mi.define([{tag:I.meta,color:"#7a757a"},{tag:I.link,textDecoration:"underline"},{tag:I.heading,textDecoration:"underline",fontWeight:"bold"},{tag:I.emphasis,fontStyle:"italic"},{tag:I.strong,fontWeight:"bold"},{tag:I.strikethrough,textDecoration:"line-through"},{tag:I.keyword,color:"#708"},{tag:[I.atom,I.bool,I.url,I.contentSeparator,I.labelName],color:"#219"},{tag:[I.literal,I.inserted],color:"#164"},{tag:[I.string,I.deleted],color:"#a11"},{tag:[I.regexp,I.escape,I.special(I.string)],color:"#e40"},{tag:I.definition(I.variableName),color:"#00f"},{tag:I.local(I.variableName),color:"#30a"},{tag:[I.typeName,I.namespace],color:"#085"},{tag:I.className,color:"#167"},{tag:[I.special(I.variableName),I.macroName],color:"#256"},{tag:I.definition(I.propertyName),color:"#00c"},{tag:I.comment,color:"#940"},{tag:I.invalid,color:"#f00"}]),NZ=w.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Oa=1e4,qa="()[]{}",_a=U.define({combine(l){return be(l,{afterCursor:!0,brackets:qa,maxScanDistance:Oa,renderMatch:MZ})}}),zZ=N.mark({class:"cm-matchingBracket"}),TZ=N.mark({class:"cm-nonmatchingBracket"});function MZ(l){let t=[],e=l.matched?zZ:TZ;return t.push(e.range(l.start.from,l.start.to)),l.end&&t.push(e.range(l.end.from,l.end.to)),t}const PZ=[Gt.define({create(){return N.none},update(l,t){if(!t.docChanged&&!t.selection)return l;let e=[],i=t.state.facet(_a);for(let n of t.state.selection.ranges){if(!n.empty)continue;let c=Ve(t.state,n.head,-1,i)||n.head>0&&Ve(t.state,n.head-1,1,i)||i.afterCursor&&(Ve(t.state,n.head,1,i)||n.head<t.state.doc.length&&Ve(t.state,n.head+1,-1,i));c&&(e=e.concat(i.renderMatch(c,t.state)))}return N.set(e,!0)},provide:l=>w.decorations.from(l)}),NZ];function EZ(l={}){return[_a.of(l),PZ]}function rs(l,t,e){let i=l.prop(t<0?q.openedBy:q.closedBy);if(i)return i;if(l.name.length==1){let n=e.indexOf(l.name);if(n>-1&&n%2==(t<0?1:0))return[e[n+t]]}return null}function Ve(l,t,e,i={}){let n=i.maxScanDistance||Oa,c=i.brackets||qa,s=Jt(l),d=s.resolveInner(t,e);for(let o=d;o;o=o.parent){let a=rs(o.type,e,c);if(a&&o.from<o.to)return jZ(l,t,e,o,a,c)}return QZ(l,t,e,s,d.type,n,c)}function jZ(l,t,e,i,n,c){let s=i.parent,d={from:i.from,to:i.to},o=0,a=s==null?void 0:s.cursor();if(a&&(e<0?a.childBefore(i.from):a.childAfter(i.to)))do if(e<0?a.to<=i.from:a.from>=i.to){if(o==0&&n.indexOf(a.type.name)>-1&&a.from<a.to)return{start:d,end:{from:a.from,to:a.to},matched:!0};if(rs(a.type,e,c))o++;else if(rs(a.type,-e,c)){if(o==0)return{start:d,end:a.from==a.to?void 0:{from:a.from,to:a.to},matched:!1};o--}}while(e<0?a.prevSibling():a.nextSibling());return{start:d,matched:!1}}function QZ(l,t,e,i,n,c,s){let d=e<0?l.sliceDoc(t-1,t):l.sliceDoc(t,t+1),o=s.indexOf(d);if(o<0||o%2==0!=e>0)return null;let a={from:e<0?t-1:t,to:e>0?t+1:t},h=l.doc.iterRange(t,e>0?l.doc.length:0),u=0;for(let m=0;!h.next().done&&m<=c;){let r=h.value;e<0&&(m+=r.length);let b=t+m*e;for(let Z=e>0?0:r.length-1,g=e>0?r.length:-1;Z!=g;Z+=e){let p=s.indexOf(r[Z]);if(!(p<0||i.resolveInner(b+Z,1).type!=n))if(p%2==0==e>0)u++;else{if(u==1)return{start:a,end:{from:b+Z,to:b+Z+1},matched:p>>1==o>>1};u--}}e>0&&(m+=r.length)}return h.done?{start:a,matched:!1}:null}function $a(l,t,e,i=0,n=0){t==null&&(t=l.search(/[^\s\u00a0]/),t==-1&&(t=l.length));let c=n;for(let s=i;s<t;s++)l.charCodeAt(s)==9?c+=e-c%e:c++;return c}class th{constructor(t,e,i){this.string=t,this.tabSize=e,this.indentUnit=i,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(t){let e=this.string.charAt(this.pos),i;if(typeof t=="string"?i=e==t:i=e&&(t instanceof RegExp?t.test(e):t(e)),i)return++this.pos,e}eatWhile(t){let e=this.pos;for(;this.eat(t););return this.pos>e}eatSpace(){let t=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t}skipToEnd(){this.pos=this.string.length}skipTo(t){let e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0}backUp(t){this.pos-=t}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=$a(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){return $a(this.string,null,this.tabSize)}match(t,e,i){if(typeof t=="string"){let n=s=>i?s.toLowerCase():s,c=this.string.substr(this.pos,t.length);return n(c)==n(t)?(e!==!1&&(this.pos+=t.length),!0):null}else{let n=this.string.slice(this.pos).match(t);return n&&n.index>0?null:(n&&e!==!1&&(this.pos+=n[0].length),n)}}current(){return this.string.slice(this.start,this.pos)}}function DZ(l){return{name:l.name||"",token:l.token,blankLine:l.blankLine||(()=>{}),startState:l.startState||(()=>!0),copyState:l.copyState||OZ,indent:l.indent||(()=>null),languageData:l.languageData||{},tokenTable:l.tokenTable||gs}}function OZ(l){if(typeof l!="object")return l;let t={};for(let e in l){let i=l[e];t[e]=i instanceof Array?i.slice():i}return t}class bs extends se{constructor(t){let e=rZ(t.languageData),i=DZ(t),n,c=new class extends Fa{createParse(s,d,o){return new _Z(n,s,d,o)}};super(e,c,[Ua.of((s,d)=>this.getIndent(s,d))],t.name),this.topNode=e0(e),n=this,this.streamParser=i,this.stateAfter=new q({perNode:!0}),this.tokenTable=t.tokenTable?new ch(i.tokenTable):t0}static define(t){return new bs(t)}getIndent(t,e){let i=Jt(t.state),n=i.resolve(e);for(;n&&n.type!=this.topNode;)n=n.parent;if(!n)return null;let c=Zs(this,i,0,n.from,e),s,d;if(c?(d=c.state,s=c.pos+1):(d=this.streamParser.startState(t.unit),s=0),e-s>1e4)return null;for(;s<e;){let a=t.state.doc.lineAt(s),h=Math.min(e,a.to);if(a.length){let u=new th(a.text,t.state.tabSize,t.unit);for(;u.pos<h-a.from;)lh(this.streamParser.token,u,d)}else this.streamParser.blankLine(d,t.unit);if(h==e)break;s=a.to+1}let{text:o}=t.lineAt(e);return this.streamParser.indent(d,/^\s*(.*)/.exec(o)[1],t)}get allowsNesting(){return!1}}function Zs(l,t,e,i,n){let c=e>=i&&e+t.length<=n&&t.prop(l.stateAfter);if(c)return{state:l.streamParser.copyState(c),pos:e+t.length};for(let s=t.children.length-1;s>=0;s--){let d=t.children[s],o=e+t.positions[s],a=d instanceof bt&&o<n&&Zs(l,d,o,i,n);if(a)return a}return null}function eh(l,t,e,i,n){if(n&&e<=0&&i>=t.length)return t;!n&&t.type==l.topNode&&(n=!0);for(let c=t.children.length-1;c>=0;c--){let s=t.positions[c],d=t.children[c],o;if(s<i&&d instanceof bt){if(!(o=eh(l,d,e-s,i-s,n)))break;return n?new bt(t.type,t.children.slice(0,c).concat(o),t.positions.slice(0,c+1),s+o.length):o}}return null}function qZ(l,t,e,i){for(let n of t){let c=n.from+(n.openStart?25:0),s=n.to-(n.openEnd?25:0),d=c<=e&&s>e&&Zs(l,n.tree,0-n.offset,e,s),o;if(d&&(o=eh(l,n.tree,e+n.offset,d.pos+n.offset,!1)))return{state:d.state,tree:o}}return{state:l.streamParser.startState(i?dl(i):4),tree:bt.empty}}class _Z{constructor(t,e,i,n){this.lang=t,this.input=e,this.fragments=i,this.ranges=n,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=n[n.length-1].to;let c=Rl.get(),s=n[0].from,{state:d,tree:o}=qZ(t,i,s,c==null?void 0:c.state);this.state=d,this.parsedPos=this.chunkStart=s+o.length;for(let a=0;a<o.children.length;a++)this.chunks.push(o.children[a]),this.chunkPos.push(o.positions[a]);c&&this.parsedPos<c.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(dl(c.state)),c.skipUntilInView(this.parsedPos,c.viewport.from),this.parsedPos=c.viewport.from),this.moveRangeIndex()}advance(){let t=Rl.get(),e=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),i=Math.min(e,this.chunkStart+2048);for(t&&(i=Math.min(i,t.viewport.to));this.parsedPos<i;)this.parseLine(t);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=e?this.finish():t&&this.parsedPos>=t.viewport.to?(t.skipUntilInView(this.parsedPos,e),this.finish()):null}stopAt(t){this.stoppedAt=t}lineAfter(t){let e=this.input.chunk(t);if(this.input.lineChunks)e==`
`&&(e="");else{let i=e.indexOf(`
`);i>-1&&(e=e.slice(0,i))}return t+e.length<=this.to?e:e.slice(0,this.to-t)}nextLine(){let t=this.parsedPos,e=this.lineAfter(t),i=t+e.length;for(let n=this.rangeIndex;;){let c=this.ranges[n].to;if(c>=i||(e=e.slice(0,c-(i-e.length)),n++,n==this.ranges.length))break;let s=this.ranges[n].from,d=this.lineAfter(s);e+=d,i=s+d.length}return{line:e,end:i}}skipGapsTo(t,e,i){for(;;){let n=this.ranges[this.rangeIndex].to,c=t+e;if(i>0?n>c:n>=c)break;e+=this.ranges[++this.rangeIndex].from-n}return e}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(t,e,i,n,c){if(this.ranges.length>1){c=this.skipGapsTo(e,c,1),e+=c;let s=this.chunk.length;c=this.skipGapsTo(i,c,-1),i+=c,n+=this.chunk.length-s}return this.chunk.push(t,e,i,n),c}parseLine(t){let{line:e,end:i}=this.nextLine(),n=0,{streamParser:c}=this.lang,s=new th(e,t?t.state.tabSize:4,t?dl(t.state):2);if(s.eol())c.blankLine(this.state,s.indentUnit);else for(;!s.eol();){let d=lh(c.token,s,this.state);if(d&&(n=this.emitToken(this.lang.tokenTable.resolve(d),this.parsedPos+s.start,this.parsedPos+s.pos,4,n)),s.start>1e4)break}this.parsedPos=i,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let t=bt.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:$Z,topID:0,maxBufferLength:2048,reused:this.chunkReused});t=new bt(t.type,t.children,t.positions,t.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(t),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new bt(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function lh(l,t,e){t.start=t.pos;for(let i=0;i<10;i++){let n=l(t,e);if(t.pos>t.start)return n}throw new Error("Stream parser failed to advance stream.")}const gs=Object.create(null),ri=[Tt.none],$Z=new $c(ri),ih=[],nh=Object.create(null);for(let[l,t]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])nh[l]=sh(gs,t);class ch{constructor(t){this.extra=t,this.table=Object.assign(Object.create(null),nh)}resolve(t){return t?this.table[t]||(this.table[t]=sh(this.extra,t)):0}}const t0=new ch(gs);function ps(l,t){ih.indexOf(l)>-1||(ih.push(l),console.warn(t))}function sh(l,t){let e=null;for(let c of t.split(".")){let s=l[c]||I[c];s?typeof s=="function"?e?e=s(e):ps(c,`Modifier ${c} used at start of tag`):e?ps(c,`Tag ${c} used as modifier`):e=s:ps(c,`Unknown highlighting tag ${c}`)}if(!e)return 0;let i=t.replace(/ /g,"_"),n=Tt.define({id:ri.length,name:i,props:[oZ({[i]:e})]});return ri.push(n),n.id}function e0(l){let t=Tt.define({id:ri.length,name:"Document",props:[oi.add(()=>l)]});return ri.push(t),t}const l0=l=>{let t=Ws(l.state);return t.line?i0(l):t.block?c0(l):!1};function Gs(l,t){return({state:e,dispatch:i})=>{if(e.readOnly)return!1;let n=l(t,e);return n?(i(e.update(n)),!0):!1}}const i0=Gs(o0,0),n0=Gs(dh,0),c0=Gs((l,t)=>dh(l,t,d0(t)),0);function Ws(l,t=l.selection.main.head){let e=l.languageDataAt("commentTokens",t);return e.length?e[0]:{}}const bi=50;function s0(l,{open:t,close:e},i,n){let c=l.sliceDoc(i-bi,i),s=l.sliceDoc(n,n+bi),d=/\s*$/.exec(c)[0].length,o=/^\s*/.exec(s)[0].length,a=c.length-d;if(c.slice(a-t.length,a)==t&&s.slice(o,o+e.length)==e)return{open:{pos:i-d,margin:d&&1},close:{pos:n+o,margin:o&&1}};let h,u;n-i<=2*bi?h=u=l.sliceDoc(i,n):(h=l.sliceDoc(i,i+bi),u=l.sliceDoc(n-bi,n));let m=/^\s*/.exec(h)[0].length,r=/\s*$/.exec(u)[0].length,b=u.length-r-e.length;return h.slice(m,m+t.length)==t&&u.slice(b,b+e.length)==e?{open:{pos:i+m+t.length,margin:/\s/.test(h.charAt(m+t.length))?1:0},close:{pos:n-r-e.length,margin:/\s/.test(u.charAt(b-1))?1:0}}:null}function d0(l){let t=[];for(let e of l.selection.ranges){let i=l.doc.lineAt(e.from),n=e.to<=i.to?i:l.doc.lineAt(e.to),c=t.length-1;c>=0&&t[c].to>i.from?t[c].to=n.to:t.push({from:i.from,to:n.to})}return t}function dh(l,t,e=t.selection.ranges){let i=e.map(c=>Ws(t,c.from).block);if(!i.every(c=>c))return null;let n=e.map((c,s)=>s0(t,i[s],c.from,c.to));if(l!=2&&!n.every(c=>c))return{changes:t.changes(e.map((c,s)=>n[s]?[]:[{from:c.from,insert:i[s].open+" "},{from:c.to,insert:" "+i[s].close}]))};if(l!=1&&n.some(c=>c)){let c=[];for(let s=0,d;s<n.length;s++)if(d=n[s]){let o=i[s],{open:a,close:h}=d;c.push({from:a.pos-o.open.length,to:a.pos+a.margin},{from:h.pos-h.margin,to:h.pos+o.close.length})}return{changes:c}}return null}function o0(l,t,e=t.selection.ranges){let i=[],n=-1;for(let{from:c,to:s}of e){let d=i.length,o=1e9;for(let a=c;a<=s;){let h=t.doc.lineAt(a);if(h.from>n&&(c==s||s>h.from)){n=h.from;let u=Ws(t,a).line;if(!u)continue;let m=/^\s*/.exec(h.text)[0].length,r=m==h.length,b=h.text.slice(m,m+u.length)==u?m:-1;m<h.text.length&&m<o&&(o=m),i.push({line:h,comment:b,token:u,indent:m,empty:r,single:!1})}a=h.to+1}if(o<1e9)for(let a=d;a<i.length;a++)i[a].indent<i[a].line.text.length&&(i[a].indent=o);i.length==d+1&&(i[d].single=!0)}if(l!=2&&i.some(c=>c.comment<0&&(!c.empty||c.single))){let c=[];for(let{line:d,token:o,indent:a,empty:h,single:u}of i)(u||!h)&&c.push({from:d.from+a,insert:o+" "});let s=t.changes(c);return{changes:s,selection:t.selection.map(s,1)}}else if(l!=1&&i.some(c=>c.comment>=0)){let c=[];for(let{line:s,comment:d,token:o}of i)if(d>=0){let a=s.from+d,h=a+o.length;s.text[h-s.from]==" "&&h++,c.push({from:a,to:h})}return{changes:c}}return null}const Xs=He.define(),a0=He.define(),h0=U.define(),oh=U.define({combine(l){return be(l,{minDepth:100,newGroupDelay:500},{minDepth:Math.max,newGroupDelay:Math.min})}});function u0(l){let t=0;return l.iterChangedRanges((e,i)=>t=i),t}const ah=Gt.define({create(){return ye.empty},update(l,t){let e=t.state.facet(oh),i=t.annotation(Xs);if(i){let o=t.docChanged?y.single(u0(t.changes)):void 0,a=Mt.fromTransaction(t,o),h=i.side,u=h==0?l.undone:l.done;return a?u=pn(u,u.length,e.minDepth,a):u=mh(u,t.startState.selection),new ye(h==0?i.rest:u,h==0?u:i.rest)}let n=t.annotation(a0);if((n=="full"||n=="before")&&(l=l.isolate()),t.annotation(Wt.addToHistory)===!1)return t.changes.empty?l:l.addMapping(t.changes.desc);let c=Mt.fromTransaction(t),s=t.annotation(Wt.time),d=t.annotation(Wt.userEvent);return c?l=l.addChanges(c,s,d,e.newGroupDelay,e.minDepth):t.selection&&(l=l.addSelection(t.startState.selection,s,d,e.newGroupDelay)),(n=="full"||n=="after")&&(l=l.isolate()),l},toJSON(l){return{done:l.done.map(t=>t.toJSON()),undone:l.undone.map(t=>t.toJSON())}},fromJSON(l){return new ye(l.done.map(Mt.fromJSON),l.undone.map(Mt.fromJSON))}});function m0(l={}){return[ah,oh.of(l),w.domEventHandlers({beforeinput(t,e){let i=t.inputType=="historyUndo"?hh:t.inputType=="historyRedo"?Is:null;return i?(t.preventDefault(),i(e)):!1}})]}function gn(l,t){return function({state:e,dispatch:i}){if(!t&&e.readOnly)return!1;let n=e.field(ah,!1);if(!n)return!1;let c=n.pop(l,e,t);return c?(i(c),!0):!1}}const hh=gn(0,!1),Is=gn(1,!1),r0=gn(0,!0),b0=gn(1,!0);class Mt{constructor(t,e,i,n,c){this.changes=t,this.effects=e,this.mapped=i,this.startSelection=n,this.selectionsAfter=c}setSelAfter(t){return new Mt(this.changes,this.effects,this.mapped,this.startSelection,t)}toJSON(){var t,e,i;return{changes:(t=this.changes)===null||t===void 0?void 0:t.toJSON(),mapped:(e=this.mapped)===null||e===void 0?void 0:e.toJSON(),startSelection:(i=this.startSelection)===null||i===void 0?void 0:i.toJSON(),selectionsAfter:this.selectionsAfter.map(n=>n.toJSON())}}static fromJSON(t){return new Mt(t.changes&&yt.fromJSON(t.changes),[],t.mapped&&re.fromJSON(t.mapped),t.startSelection&&y.fromJSON(t.startSelection),t.selectionsAfter.map(y.fromJSON))}static fromTransaction(t,e){let i=te;for(let n of t.startState.facet(h0)){let c=n(t);c.length&&(i=i.concat(c))}return!i.length&&t.changes.empty?null:new Mt(t.changes.invert(t.startState.doc),i,void 0,e||t.startState.selection,te)}static selection(t){return new Mt(void 0,te,void 0,void 0,t)}}function pn(l,t,e,i){let n=t+1>e+20?t-e-1:0,c=l.slice(n,t);return c.push(i),c}function Z0(l,t){let e=[],i=!1;return l.iterChangedRanges((n,c)=>e.push(n,c)),t.iterChangedRanges((n,c,s,d)=>{for(let o=0;o<e.length;){let a=e[o++],h=e[o++];d>=a&&s<=h&&(i=!0)}}),i}function g0(l,t){return l.ranges.length==t.ranges.length&&l.ranges.filter((e,i)=>e.empty!=t.ranges[i].empty).length===0}function uh(l,t){return l.length?t.length?l.concat(t):l:t}const te=[],p0=200;function mh(l,t){if(l.length){let e=l[l.length-1],i=e.selectionsAfter.slice(Math.max(0,e.selectionsAfter.length-p0));return i.length&&i[i.length-1].eq(t)?l:(i.push(t),pn(l,l.length-1,1e9,e.setSelAfter(i)))}else return[Mt.selection([t])]}function G0(l){let t=l[l.length-1],e=l.slice();return e[l.length-1]=t.setSelAfter(t.selectionsAfter.slice(0,t.selectionsAfter.length-1)),e}function Vs(l,t){if(!l.length)return l;let e=l.length,i=te;for(;e;){let n=W0(l[e-1],t,i);if(n.changes&&!n.changes.empty||n.effects.length){let c=l.slice(0,e);return c[e-1]=n,c}else t=n.mapped,e--,i=n.selectionsAfter}return i.length?[Mt.selection(i)]:te}function W0(l,t,e){let i=uh(l.selectionsAfter.length?l.selectionsAfter.map(d=>d.map(t)):te,e);if(!l.changes)return Mt.selection(i);let n=l.changes.map(t),c=t.mapDesc(l.changes,!0),s=l.mapped?l.mapped.composeDesc(c):c;return new Mt(n,P.mapEffects(l.effects,t),s,l.startSelection.map(c),i)}const X0=/^(input\.type|delete)($|\.)/;class ye{constructor(t,e,i=0,n=void 0){this.done=t,this.undone=e,this.prevTime=i,this.prevUserEvent=n}isolate(){return this.prevTime?new ye(this.done,this.undone):this}addChanges(t,e,i,n,c){let s=this.done,d=s[s.length-1];return d&&d.changes&&!d.changes.empty&&t.changes&&(!i||X0.test(i))&&(!d.selectionsAfter.length&&e-this.prevTime<n&&Z0(d.changes,t.changes)||i=="input.type.compose")?s=pn(s,s.length-1,c,new Mt(t.changes.compose(d.changes),uh(t.effects,d.effects),d.mapped,d.startSelection,te)):s=pn(s,s.length,c,t),new ye(s,te,e,i)}addSelection(t,e,i,n){let c=this.done.length?this.done[this.done.length-1].selectionsAfter:te;return c.length>0&&e-this.prevTime<n&&i==this.prevUserEvent&&i&&/^select($|\.)/.test(i)&&g0(c[c.length-1],t)?this:new ye(mh(this.done,t),this.undone,e,i)}addMapping(t){return new ye(Vs(this.done,t),Vs(this.undone,t),this.prevTime,this.prevUserEvent)}pop(t,e,i){let n=t==0?this.done:this.undone;if(n.length==0)return null;let c=n[n.length-1];if(i&&c.selectionsAfter.length)return e.update({selection:c.selectionsAfter[c.selectionsAfter.length-1],annotations:Xs.of({side:t,rest:G0(n)}),userEvent:t==0?"select.undo":"select.redo",scrollIntoView:!0});if(c.changes){let s=n.length==1?te:n.slice(0,n.length-1);return c.mapped&&(s=Vs(s,c.mapped)),e.update({changes:c.changes,selection:c.startSelection,effects:c.effects,annotations:Xs.of({side:t,rest:s}),filter:!1,userEvent:t==0?"undo":"redo",scrollIntoView:!0})}else return null}}ye.empty=new ye(te,te);const I0=[{key:"Mod-z",run:hh,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Is,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Is,preventDefault:!0},{key:"Mod-u",run:r0,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:b0,preventDefault:!0}];function Cl(l,t){return y.create(l.ranges.map(t),l.mainIndex)}function Re(l,t){return l.update({selection:t,scrollIntoView:!0,userEvent:"select"})}function de({state:l,dispatch:t},e){let i=Cl(l.selection,e);return i.eq(l.selection)?!1:(t(Re(l,i)),!0)}function Gn(l,t){return y.cursor(t?l.to:l.from)}function rh(l,t){return de(l,e=>e.empty?l.moveByChar(e,t):Gn(e,t))}function xt(l){return l.textDirectionAt(l.state.selection.main.head)==mt.LTR}const bh=l=>rh(l,!xt(l)),Zh=l=>rh(l,xt(l));function gh(l,t){return de(l,e=>e.empty?l.moveByGroup(e,t):Gn(e,t))}const V0=l=>gh(l,!xt(l)),y0=l=>gh(l,xt(l));function R0(l,t,e){if(t.type.prop(e))return!0;let i=t.to-t.from;return i&&(i>2||/[^\s,.;:]/.test(l.sliceDoc(t.from,t.to)))||t.firstChild}function Wn(l,t,e){let i=Jt(l).resolveInner(t.head),n=e?q.closedBy:q.openedBy;for(let o=t.head;;){let a=e?i.childAfter(o):i.childBefore(o);if(!a)break;R0(l,a,n)?i=a:o=e?a.to:a.from}let c=i.type.prop(n),s,d;return c&&(s=e?Ve(l,i.from,1):Ve(l,i.to,-1))&&s.matched?d=e?s.end.to:s.end.from:d=e?i.to:i.from,y.cursor(d,e?-1:1)}const f0=l=>de(l,t=>Wn(l.state,t,!xt(l))),C0=l=>de(l,t=>Wn(l.state,t,xt(l)));function ph(l,t){return de(l,e=>{if(!e.empty)return Gn(e,t);let i=l.moveVertically(e,t);return i.head!=e.head?i:l.moveToLineBoundary(e,t)})}const Gh=l=>ph(l,!1),Wh=l=>ph(l,!0);function Xh(l){return Math.max(l.defaultLineHeight,Math.min(l.dom.clientHeight,innerHeight)-5)}function Ih(l,t){let{state:e}=l,i=Cl(e.selection,d=>d.empty?l.moveVertically(d,t,Xh(l)):Gn(d,t));if(i.eq(e.selection))return!1;let n=l.coordsAtPos(e.selection.main.head),c=l.scrollDOM.getBoundingClientRect(),s;return n&&n.top>c.top&&n.bottom<c.bottom&&n.top-c.top<=l.scrollDOM.scrollHeight-l.scrollDOM.scrollTop-l.scrollDOM.clientHeight&&(s=w.scrollIntoView(i.main.head,{y:"start",yMargin:n.top-c.top})),l.dispatch(Re(e,i),{effects:s}),!0}const Vh=l=>Ih(l,!1),ys=l=>Ih(l,!0);function je(l,t,e){let i=l.lineBlockAt(t.head),n=l.moveToLineBoundary(t,e);if(n.head==t.head&&n.head!=(e?i.to:i.from)&&(n=l.moveToLineBoundary(t,e,!1)),!e&&n.head==i.from&&i.length){let c=/^\s*/.exec(l.state.sliceDoc(i.from,Math.min(i.from+100,i.to)))[0].length;c&&t.head!=i.from+c&&(n=y.cursor(i.from+c))}return n}const Y0=l=>de(l,t=>je(l,t,!0)),S0=l=>de(l,t=>je(l,t,!1)),L0=l=>de(l,t=>je(l,t,!xt(l))),J0=l=>de(l,t=>je(l,t,xt(l))),F0=l=>de(l,t=>y.cursor(l.lineBlockAt(t.head).from,1)),K0=l=>de(l,t=>y.cursor(l.lineBlockAt(t.head).to,-1));function H0(l,t,e){let i=!1,n=Cl(l.selection,c=>{let s=Ve(l,c.head,-1)||Ve(l,c.head,1)||c.head>0&&Ve(l,c.head-1,1)||c.head<l.doc.length&&Ve(l,c.head+1,-1);if(!s||!s.end)return c;i=!0;let d=s.start.from==c.head?s.end.to:s.end.from;return e?y.range(c.anchor,d):y.cursor(d)});return i?(t(Re(l,n)),!0):!1}const B0=({state:l,dispatch:t})=>H0(l,t,!1);function ee(l,t){let e=Cl(l.state.selection,i=>{let n=t(i);return y.range(i.anchor,n.head,n.goalColumn)});return e.eq(l.state.selection)?!1:(l.dispatch(Re(l.state,e)),!0)}function yh(l,t){return ee(l,e=>l.moveByChar(e,t))}const Rh=l=>yh(l,!xt(l)),fh=l=>yh(l,xt(l));function Ch(l,t){return ee(l,e=>l.moveByGroup(e,t))}const k0=l=>Ch(l,!xt(l)),x0=l=>Ch(l,xt(l)),w0=l=>ee(l,t=>Wn(l.state,t,!xt(l))),v0=l=>ee(l,t=>Wn(l.state,t,xt(l)));function Yh(l,t){return ee(l,e=>l.moveVertically(e,t))}const Sh=l=>Yh(l,!1),Lh=l=>Yh(l,!0);function Jh(l,t){return ee(l,e=>l.moveVertically(e,t,Xh(l)))}const Fh=l=>Jh(l,!1),Kh=l=>Jh(l,!0),U0=l=>ee(l,t=>je(l,t,!0)),A0=l=>ee(l,t=>je(l,t,!1)),N0=l=>ee(l,t=>je(l,t,!xt(l))),z0=l=>ee(l,t=>je(l,t,xt(l))),T0=l=>ee(l,t=>y.cursor(l.lineBlockAt(t.head).from)),M0=l=>ee(l,t=>y.cursor(l.lineBlockAt(t.head).to)),Hh=({state:l,dispatch:t})=>(t(Re(l,{anchor:0})),!0),Bh=({state:l,dispatch:t})=>(t(Re(l,{anchor:l.doc.length})),!0),kh=({state:l,dispatch:t})=>(t(Re(l,{anchor:l.selection.main.anchor,head:0})),!0),xh=({state:l,dispatch:t})=>(t(Re(l,{anchor:l.selection.main.anchor,head:l.doc.length})),!0),P0=({state:l,dispatch:t})=>(t(l.update({selection:{anchor:0,head:l.doc.length},userEvent:"select"})),!0),E0=({state:l,dispatch:t})=>{let e=Vn(l).map(({from:i,to:n})=>y.range(i,Math.min(n+1,l.doc.length)));return t(l.update({selection:y.create(e),userEvent:"select"})),!0},j0=({state:l,dispatch:t})=>{let e=Cl(l.selection,i=>{var n;let c=Jt(l).resolveInner(i.head,1);for(;!(c.from<i.from&&c.to>=i.to||c.to>i.to&&c.from<=i.from||!(!((n=c.parent)===null||n===void 0)&&n.parent));)c=c.parent;return y.range(c.to,c.from)});return t(Re(l,e)),!0},Q0=({state:l,dispatch:t})=>{let e=l.selection,i=null;return e.ranges.length>1?i=y.create([e.main]):e.main.empty||(i=y.create([y.cursor(e.main.head)])),i?(t(Re(l,i)),!0):!1};function Xn(l,t){if(l.state.readOnly)return!1;let e="delete.selection",{state:i}=l,n=i.changeByRange(c=>{let{from:s,to:d}=c;if(s==d){let o=t(s);o<s?(e="delete.backward",o=In(l,o,!1)):o>s&&(e="delete.forward",o=In(l,o,!0)),s=Math.min(s,o),d=Math.max(d,o)}else s=In(l,s,!1),d=In(l,d,!0);return s==d?{range:c}:{changes:{from:s,to:d},range:y.cursor(s)}});return n.changes.empty?!1:(l.dispatch(i.update(n,{scrollIntoView:!0,userEvent:e,effects:e=="delete.selection"?w.announce.of(i.phrase("Selection deleted")):void 0})),!0)}function In(l,t,e){if(l instanceof w)for(let i of l.state.facet(w.atomicRanges).map(n=>n(l)))i.between(t,t,(n,c)=>{n<t&&c>t&&(t=e?c:n)});return t}const wh=(l,t)=>Xn(l,e=>{let{state:i}=l,n=i.doc.lineAt(e),c,s;if(!t&&e>n.from&&e<n.from+200&&!/[^ \t]/.test(c=n.text.slice(0,e-n.from))){if(c[c.length-1]=="	")return e-1;let d=El(c,i.tabSize),o=d%dl(i)||dl(i);for(let a=0;a<o&&c[c.length-1-a]==" ";a++)e--;s=e}else s=Ut(n.text,e-n.from,t,t)+n.from,s==e&&n.number!=(t?i.doc.lines:1)&&(s+=t?1:-1);return s}),Rs=l=>wh(l,!1),vh=l=>wh(l,!0),Uh=(l,t)=>Xn(l,e=>{let i=e,{state:n}=l,c=n.doc.lineAt(i),s=n.charCategorizer(i);for(let d=null;;){if(i==(t?c.to:c.from)){i==e&&c.number!=(t?n.doc.lines:1)&&(i+=t?1:-1);break}let o=Ut(c.text,i-c.from,t)+c.from,a=c.text.slice(Math.min(i,o)-c.from,Math.max(i,o)-c.from),h=s(a);if(d!=null&&h!=d)break;(a!=" "||i!=e)&&(d=h),i=o}return i}),Ah=l=>Uh(l,!1),D0=l=>Uh(l,!0),Nh=l=>Xn(l,t=>{let e=l.lineBlockAt(t).to;return t<e?e:Math.min(l.state.doc.length,t+1)}),O0=l=>Xn(l,t=>{let e=l.lineBlockAt(t).from;return t>e?e:Math.max(0,t-1)}),q0=({state:l,dispatch:t})=>{if(l.readOnly)return!1;let e=l.changeByRange(i=>({changes:{from:i.from,to:i.to,insert:$.of(["",""])},range:y.cursor(i.from)}));return t(l.update(e,{scrollIntoView:!0,userEvent:"input"})),!0},_0=({state:l,dispatch:t})=>{if(l.readOnly)return!1;let e=l.changeByRange(i=>{if(!i.empty||i.from==0||i.from==l.doc.length)return{range:i};let n=i.from,c=l.doc.lineAt(n),s=n==c.from?n-1:Ut(c.text,n-c.from,!1)+c.from,d=n==c.to?n+1:Ut(c.text,n-c.from,!0)+c.from;return{changes:{from:s,to:d,insert:l.doc.slice(n,d).append(l.doc.slice(s,n))},range:y.cursor(d)}});return e.changes.empty?!1:(t(l.update(e,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Vn(l){let t=[],e=-1;for(let i of l.selection.ranges){let n=l.doc.lineAt(i.from),c=l.doc.lineAt(i.to);if(!i.empty&&i.to==c.from&&(c=l.doc.lineAt(i.to-1)),e>=n.number){let s=t[t.length-1];s.to=c.to,s.ranges.push(i)}else t.push({from:n.from,to:c.to,ranges:[i]});e=c.number+1}return t}function zh(l,t,e){if(l.readOnly)return!1;let i=[],n=[];for(let c of Vn(l)){if(e?c.to==l.doc.length:c.from==0)continue;let s=l.doc.lineAt(e?c.to+1:c.from-1),d=s.length+1;if(e){i.push({from:c.to,to:s.to},{from:c.from,insert:s.text+l.lineBreak});for(let o of c.ranges)n.push(y.range(Math.min(l.doc.length,o.anchor+d),Math.min(l.doc.length,o.head+d)))}else{i.push({from:s.from,to:c.from},{from:c.to,insert:l.lineBreak+s.text});for(let o of c.ranges)n.push(y.range(o.anchor-d,o.head-d))}}return i.length?(t(l.update({changes:i,scrollIntoView:!0,selection:y.create(n,l.selection.mainIndex),userEvent:"move.line"})),!0):!1}const $0=({state:l,dispatch:t})=>zh(l,t,!1),tg=({state:l,dispatch:t})=>zh(l,t,!0);function Th(l,t,e){if(l.readOnly)return!1;let i=[];for(let n of Vn(l))e?i.push({from:n.from,insert:l.doc.slice(n.from,n.to)+l.lineBreak}):i.push({from:n.to,insert:l.lineBreak+l.doc.slice(n.from,n.to)});return t(l.update({changes:i,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const eg=({state:l,dispatch:t})=>Th(l,t,!1),lg=({state:l,dispatch:t})=>Th(l,t,!0),ig=l=>{if(l.state.readOnly)return!1;let{state:t}=l,e=t.changes(Vn(t).map(({from:n,to:c})=>(n>0?n--:c<t.doc.length&&c++,{from:n,to:c}))),i=Cl(t.selection,n=>l.moveVertically(n,!0)).map(e);return l.dispatch({changes:e,selection:i,scrollIntoView:!0,userEvent:"delete.line"}),!0};function ng(l,t){if(/\(\)|\[\]|\{\}/.test(l.sliceDoc(t-1,t+1)))return{from:t,to:t};let e=Jt(l).resolveInner(t),i=e.childBefore(t),n=e.childAfter(t),c;return i&&n&&i.to<=t&&n.from>=t&&(c=i.type.prop(q.closedBy))&&c.indexOf(n.name)>-1&&l.doc.lineAt(i.to).from==l.doc.lineAt(n.from).from?{from:i.to,to:n.from}:null}const cg=Mh(!1),sg=Mh(!0);function Mh(l){return({state:t,dispatch:e})=>{if(t.readOnly)return!1;let i=t.changeByRange(n=>{let{from:c,to:s}=n,d=t.doc.lineAt(c),o=!l&&c==s&&ng(t,c);l&&(c=s=(s<=d.to?d:t.doc.lineAt(s)).to);let a=new mn(t,{simulateBreak:c,simulateDoubleBreak:!!o}),h=os(a,c);for(h==null&&(h=/^\s*/.exec(t.doc.lineAt(c).text)[0].length);s<d.to&&/\s/.test(d.text[s-d.from]);)s++;o?{from:c,to:s}=o:c>d.from&&c<d.from+100&&!/\S/.test(d.text.slice(0,c))&&(c=d.from);let u=["",hi(t,h)];return o&&u.push(hi(t,a.lineIndent(d.from,-1))),{changes:{from:c,to:s,insert:$.of(u)},range:y.cursor(c+1+u[1].length)}});return e(t.update(i,{scrollIntoView:!0,userEvent:"input"})),!0}}function fs(l,t){let e=-1;return l.changeByRange(i=>{let n=[];for(let s=i.from;s<=i.to;){let d=l.doc.lineAt(s);d.number>e&&(i.empty||i.to>d.from)&&(t(d,n,i),e=d.number),s=d.to+1}let c=l.changes(n);return{changes:n,range:y.range(c.mapPos(i.anchor,1),c.mapPos(i.head,1))}})}const dg=({state:l,dispatch:t})=>{if(l.readOnly)return!1;let e=Object.create(null),i=new mn(l,{overrideIndentation:c=>{let s=e[c];return s==null?-1:s}}),n=fs(l,(c,s,d)=>{let o=os(i,c.from);if(o==null)return;/\S/.test(c.text)||(o=0);let a=/^\s*/.exec(c.text)[0],h=hi(l,o);(a!=h||d.from<c.from+a.length)&&(e[c.from]=o,s.push({from:c.from,to:c.from+a.length,insert:h}))});return n.changes.empty||t(l.update(n,{userEvent:"indent"})),!0},Ph=({state:l,dispatch:t})=>l.readOnly?!1:(t(l.update(fs(l,(e,i)=>{i.push({from:e.from,insert:l.facet(ds)})}),{userEvent:"input.indent"})),!0),Eh=({state:l,dispatch:t})=>l.readOnly?!1:(t(l.update(fs(l,(e,i)=>{let n=/^\s*/.exec(e.text)[0];if(!n)return;let c=El(n,l.tabSize),s=0,d=hi(l,Math.max(0,c-dl(l)));for(;s<n.length&&s<d.length&&n.charCodeAt(s)==d.charCodeAt(s);)s++;i.push({from:e.from+s,to:e.from+n.length,insert:d.slice(s)})}),{userEvent:"delete.dedent"})),!0),og=[{key:"Ctrl-b",run:bh,shift:Rh,preventDefault:!0},{key:"Ctrl-f",run:Zh,shift:fh},{key:"Ctrl-p",run:Gh,shift:Sh},{key:"Ctrl-n",run:Wh,shift:Lh},{key:"Ctrl-a",run:F0,shift:T0},{key:"Ctrl-e",run:K0,shift:M0},{key:"Ctrl-d",run:vh},{key:"Ctrl-h",run:Rs},{key:"Ctrl-k",run:Nh},{key:"Ctrl-Alt-h",run:Ah},{key:"Ctrl-o",run:q0},{key:"Ctrl-t",run:_0},{key:"Ctrl-v",run:ys}],ag=[{key:"ArrowLeft",run:bh,shift:Rh,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:V0,shift:k0,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:L0,shift:N0,preventDefault:!0},{key:"ArrowRight",run:Zh,shift:fh,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:y0,shift:x0,preventDefault:!0},{mac:"Cmd-ArrowRight",run:J0,shift:z0,preventDefault:!0},{key:"ArrowUp",run:Gh,shift:Sh,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Hh,shift:kh},{mac:"Ctrl-ArrowUp",run:Vh,shift:Fh},{key:"ArrowDown",run:Wh,shift:Lh,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Bh,shift:xh},{mac:"Ctrl-ArrowDown",run:ys,shift:Kh},{key:"PageUp",run:Vh,shift:Fh},{key:"PageDown",run:ys,shift:Kh},{key:"Home",run:S0,shift:A0,preventDefault:!0},{key:"Mod-Home",run:Hh,shift:kh},{key:"End",run:Y0,shift:U0,preventDefault:!0},{key:"Mod-End",run:Bh,shift:xh},{key:"Enter",run:cg},{key:"Mod-a",run:P0},{key:"Backspace",run:Rs,shift:Rs},{key:"Delete",run:vh},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Ah},{key:"Mod-Delete",mac:"Alt-Delete",run:D0},{mac:"Mod-Backspace",run:O0},{mac:"Mod-Delete",run:Nh}].concat(og.map(l=>({mac:l.key,run:l.run,shift:l.shift}))),hg=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:f0,shift:w0},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:C0,shift:v0},{key:"Alt-ArrowUp",run:$0},{key:"Shift-Alt-ArrowUp",run:eg},{key:"Alt-ArrowDown",run:tg},{key:"Shift-Alt-ArrowDown",run:lg},{key:"Escape",run:Q0},{key:"Mod-Enter",run:sg},{key:"Alt-l",mac:"Ctrl-l",run:E0},{key:"Mod-i",run:j0,preventDefault:!0},{key:"Mod-[",run:Eh},{key:"Mod-]",run:Ph},{key:"Mod-Alt-\\",run:dg},{key:"Shift-Mod-k",run:ig},{key:"Shift-Mod-\\",run:B0},{key:"Mod-/",run:l0},{key:"Alt-A",run:n0}].concat(ag),ug={key:"Tab",run:Ph,shift:Eh};function ct(){var l=arguments[0];typeof l=="string"&&(l=document.createElement(l));var t=1,e=arguments[1];if(e&&typeof e=="object"&&e.nodeType==null&&!Array.isArray(e)){for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=e[i];typeof n=="string"?l.setAttribute(i,n):n!=null&&(l[i]=n)}t++}for(;t<arguments.length;t++)jh(l,arguments[t]);return l}function jh(l,t){if(typeof t=="string")l.appendChild(document.createTextNode(t));else if(t!=null)if(t.nodeType!=null)l.appendChild(t);else if(Array.isArray(t))for(var e=0;e<t.length;e++)jh(l,t[e]);else throw new RangeError("Unsupported child node: "+t)}const Qh=typeof String.prototype.normalize=="function"?l=>l.normalize("NFKD"):l=>l;class Yl{constructor(t,e,i=0,n=t.length,c,s){this.test=s,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=t.iterRange(i,n),this.bufferStart=i,this.normalize=c?d=>c(Qh(d)):Qh,this.query=this.normalize(e)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return Yt(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let t=this.peek();if(t<0)return this.done=!0,this;let e=On(t),i=this.bufferStart+this.bufferPos;this.bufferPos+=Et(t);let n=this.normalize(e);for(let c=0,s=i;;c++){let d=n.charCodeAt(c),o=this.match(d,s);if(o)return this.value=o,this;if(c==n.length-1)break;s==i&&c<e.length&&e.charCodeAt(c)==d&&s++}}}match(t,e){let i=null;for(let n=0;n<this.matches.length;n+=2){let c=this.matches[n],s=!1;this.query.charCodeAt(c)==t&&(c==this.query.length-1?i={from:this.matches[n+1],to:e+1}:(this.matches[n]++,s=!0)),s||(this.matches.splice(n,2),n-=2)}return this.query.charCodeAt(0)==t&&(this.query.length==1?i={from:e,to:e+1}:this.matches.push(1,e)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferPos)&&(i=null),i}}typeof Symbol<"u"&&(Yl.prototype[Symbol.iterator]=function(){return this});const Dh={from:-1,to:-1,match:/.*/.exec("")},Cs="gm"+(/x/.unicode==null?"":"u");class Oh{constructor(t,e,i,n=0,c=t.length){if(this.text=t,this.to=c,this.curLine="",this.done=!1,this.value=Dh,/\\[sWDnr]|\n|\r|\[\^/.test(e))return new qh(t,e,i,n,c);this.re=new RegExp(e,Cs+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.iter=t.iter();let s=t.lineAt(n);this.curLineStart=s.from,this.matchPos=yn(t,n),this.getLine(this.curLineStart)}getLine(t){this.iter.next(t),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let t=this.matchPos-this.curLineStart;;){this.re.lastIndex=t;let e=this.matchPos<=this.to&&this.re.exec(this.curLine);if(e){let i=this.curLineStart+e.index,n=i+e[0].length;if(this.matchPos=yn(this.text,n+(i==n?1:0)),i==this.curLineStart+this.curLine.length&&this.nextLine(),(i<n||i>this.value.to)&&(!this.test||this.test(i,n,e)))return this.value={from:i,to:n,match:e},this;t=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),t=0;else return this.done=!0,this}}}const Ys=new WeakMap;class Sl{constructor(t,e){this.from=t,this.text=e}get to(){return this.from+this.text.length}static get(t,e,i){let n=Ys.get(t);if(!n||n.from>=i||n.to<=e){let d=new Sl(e,t.sliceString(e,i));return Ys.set(t,d),d}if(n.from==e&&n.to==i)return n;let{text:c,from:s}=n;return s>e&&(c=t.sliceString(e,s)+c,s=e),n.to<i&&(c+=t.sliceString(n.to,i)),Ys.set(t,new Sl(s,c)),new Sl(e,c.slice(e-s,i-s))}}class qh{constructor(t,e,i,n,c){this.text=t,this.to=c,this.done=!1,this.value=Dh,this.matchPos=yn(t,n),this.re=new RegExp(e,Cs+(i!=null&&i.ignoreCase?"i":"")),this.test=i==null?void 0:i.test,this.flat=Sl.get(t,n,this.chunkEnd(n+5e3))}chunkEnd(t){return t>=this.to?this.to:this.text.lineAt(t).to}next(){for(;;){let t=this.re.lastIndex=this.matchPos-this.flat.from,e=this.re.exec(this.flat.text);if(e&&!e[0]&&e.index==t&&(this.re.lastIndex=t+1,e=this.re.exec(this.flat.text)),e){let i=this.flat.from+e.index,n=i+e[0].length;if((this.flat.to>=this.to||e.index+e[0].length<=this.flat.text.length-10)&&(!this.test||this.test(i,n,e)))return this.value={from:i,to:n,match:e},this.matchPos=yn(this.text,n+(i==n?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Sl.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(Oh.prototype[Symbol.iterator]=qh.prototype[Symbol.iterator]=function(){return this});function mg(l){try{return new RegExp(l,Cs),!0}catch{return!1}}function yn(l,t){if(t>=l.length)return t;let e=l.lineAt(t),i;for(;t<e.to&&(i=e.text.charCodeAt(t-e.from))>=56320&&i<57344;)t++;return t}function Ss(l){let t=ct("input",{class:"cm-textfield",name:"line"}),e=ct("form",{class:"cm-gotoLine",onkeydown:n=>{n.keyCode==27?(n.preventDefault(),l.dispatch({effects:Rn.of(!1)}),l.focus()):n.keyCode==13&&(n.preventDefault(),i())},onsubmit:n=>{n.preventDefault(),i()}},ct("label",l.state.phrase("Go to line"),": ",t)," ",ct("button",{class:"cm-button",type:"submit"},l.state.phrase("go")));function i(){let n=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!n)return;let{state:c}=l,s=c.doc.lineAt(c.selection.main.head),[,d,o,a,h]=n,u=a?+a.slice(1):0,m=o?+o:s.number;if(o&&h){let b=m/100;d&&(b=b*(d=="-"?-1:1)+s.number/c.doc.lines),m=Math.round(c.doc.lines*b)}else o&&d&&(m=m*(d=="-"?-1:1)+s.number);let r=c.doc.line(Math.max(1,Math.min(c.doc.lines,m)));l.dispatch({effects:Rn.of(!1),selection:y.cursor(r.from+Math.max(0,Math.min(u,r.length))),scrollIntoView:!0}),l.focus()}return{dom:e}}const Rn=P.define(),_h=Gt.define({create(){return!0},update(l,t){for(let e of t.effects)e.is(Rn)&&(l=e.value);return l},provide:l=>ci.from(l,t=>t?Ss:null)}),rg=l=>{let t=ni(l,Ss);if(!t){let e=[Rn.of(!0)];l.state.field(_h,!1)==null&&e.push(P.appendConfig.of([_h,bg])),l.dispatch({effects:e}),t=ni(l,Ss)}return t&&t.dom.querySelector("input").focus(),!0},bg=w.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),Zg={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},$h=U.define({combine(l){return be(l,Zg,{highlightWordAroundCursor:(t,e)=>t||e,minSelectionLength:Math.min,maxMatches:Math.min})}});function gg(l){let t=[Ig,Xg];return l&&t.push($h.of(l)),t}const pg=N.mark({class:"cm-selectionMatch"}),Gg=N.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function tu(l,t,e,i){return(e==0||l(t.sliceDoc(e-1,e))!=at.Word)&&(i==t.doc.length||l(t.sliceDoc(i,i+1))!=at.Word)}function Wg(l,t,e,i){return l(t.sliceDoc(e,e+1))==at.Word&&l(t.sliceDoc(i-1,i))==at.Word}const Xg=Xt.fromClass(class{constructor(l){this.decorations=this.getDeco(l)}update(l){(l.selectionSet||l.docChanged||l.viewportChanged)&&(this.decorations=this.getDeco(l.view))}getDeco(l){let t=l.state.facet($h),{state:e}=l,i=e.selection;if(i.ranges.length>1)return N.none;let n=i.main,c,s=null;if(n.empty){if(!t.highlightWordAroundCursor)return N.none;let o=e.wordAt(n.head);if(!o)return N.none;s=e.charCategorizer(n.head),c=e.sliceDoc(o.from,o.to)}else{let o=n.to-n.from;if(o<t.minSelectionLength||o>200)return N.none;if(t.wholeWords){if(c=e.sliceDoc(n.from,n.to),s=e.charCategorizer(n.head),!(tu(s,e,n.from,n.to)&&Wg(s,e,n.from,n.to)))return N.none}else if(c=e.sliceDoc(n.from,n.to).trim(),!c)return N.none}let d=[];for(let o of l.visibleRanges){let a=new Yl(e.doc,c,o.from,o.to);for(;!a.next().done;){let{from:h,to:u}=a.value;if((!s||tu(s,e,h,u))&&(n.empty&&h<=n.from&&u>=n.to?d.push(Gg.range(h,u)):(h>=n.to||u<=n.from)&&d.push(pg.range(h,u)),d.length>t.maxMatches))return N.none}}return N.set(d)}},{decorations:l=>l.decorations}),Ig=w.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),Vg=({state:l,dispatch:t})=>{let{selection:e}=l,i=y.create(e.ranges.map(n=>l.wordAt(n.head)||y.cursor(n.head)),e.mainIndex);return i.eq(e)?!1:(t(l.update({selection:i})),!0)};function yg(l,t){let{main:e,ranges:i}=l.selection,n=l.wordAt(e.head),c=n&&n.from==e.from&&n.to==e.to;for(let s=!1,d=new Yl(l.doc,t,i[i.length-1].to);;)if(d.next(),d.done){if(s)return null;d=new Yl(l.doc,t,0,Math.max(0,i[i.length-1].from-1)),s=!0}else{if(s&&i.some(o=>o.from==d.value.from))continue;if(c){let o=l.wordAt(d.value.from);if(!o||o.from!=d.value.from||o.to!=d.value.to)continue}return d.value}}const Rg=({state:l,dispatch:t})=>{let{ranges:e}=l.selection;if(e.some(c=>c.from===c.to))return Vg({state:l,dispatch:t});let i=l.sliceDoc(e[0].from,e[0].to);if(l.selection.ranges.some(c=>l.sliceDoc(c.from,c.to)!=i))return!1;let n=yg(l,i);return n?(t(l.update({selection:l.selection.addRange(y.range(n.from,n.to),!1),effects:w.scrollIntoView(n.to)})),!0):!1},Ls=U.define({combine(l){return be(l,{top:!1,caseSensitive:!1,literal:!1,wholeWord:!1,createPanel:t=>new xg(t)})}});class eu{constructor(t){this.search=t.search,this.caseSensitive=!!t.caseSensitive,this.literal=!!t.literal,this.regexp=!!t.regexp,this.replace=t.replace||"",this.valid=!!this.search&&(!this.regexp||mg(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!t.wholeWord}unquote(t){return this.literal?t:t.replace(/\\([nrt\\])/g,(e,i)=>i=="n"?`
`:i=="r"?"\r":i=="t"?"	":"\\")}eq(t){return this.search==t.search&&this.replace==t.replace&&this.caseSensitive==t.caseSensitive&&this.regexp==t.regexp&&this.wholeWord==t.wholeWord}create(){return this.regexp?new Sg(this):new Cg(this)}getCursor(t,e=0,i){let n=t.doc?t:O.create({doc:t});return i==null&&(i=n.doc.length),this.regexp?Jl(this,n,e,i):Ll(this,n,e,i)}}class lu{constructor(t){this.spec=t}}function Ll(l,t,e,i){return new Yl(t.doc,l.unquoted,e,i,l.caseSensitive?void 0:n=>n.toLowerCase(),l.wholeWord?fg(t.doc,t.charCategorizer(t.selection.main.head)):void 0)}function fg(l,t){return(e,i,n,c)=>((c>e||c+n.length<i)&&(c=Math.max(0,e-2),n=l.sliceString(c,Math.min(l.length,i+2))),(t(fn(n,e-c))!=at.Word||t(Cn(n,e-c))!=at.Word)&&(t(Cn(n,i-c))!=at.Word||t(fn(n,i-c))!=at.Word))}class Cg extends lu{constructor(t){super(t)}nextMatch(t,e,i){let n=Ll(this.spec,t,i,t.doc.length).nextOverlapping();return n.done&&(n=Ll(this.spec,t,0,e).nextOverlapping()),n.done?null:n.value}prevMatchInRange(t,e,i){for(let n=i;;){let c=Math.max(e,n-1e4-this.spec.unquoted.length),s=Ll(this.spec,t,c,n),d=null;for(;!s.nextOverlapping().done;)d=s.value;if(d)return d;if(c==e)return null;n-=1e4}}prevMatch(t,e,i){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,i,t.doc.length)}getReplacement(t){return this.spec.unquote(this.spec.replace)}matchAll(t,e){let i=Ll(this.spec,t,0,t.doc.length),n=[];for(;!i.next().done;){if(n.length>=e)return null;n.push(i.value)}return n}highlight(t,e,i,n){let c=Ll(this.spec,t,Math.max(0,e-this.spec.unquoted.length),Math.min(i+this.spec.unquoted.length,t.doc.length));for(;!c.next().done;)n(c.value.from,c.value.to)}}function Jl(l,t,e,i){return new Oh(t.doc,l.search,{ignoreCase:!l.caseSensitive,test:l.wholeWord?Yg(t.charCategorizer(t.selection.main.head)):void 0},e,i)}function fn(l,t){return l.slice(Ut(l,t,!1),t)}function Cn(l,t){return l.slice(t,Ut(l,t))}function Yg(l){return(t,e,i)=>!i[0].length||(l(fn(i.input,i.index))!=at.Word||l(Cn(i.input,i.index))!=at.Word)&&(l(Cn(i.input,i.index+i[0].length))!=at.Word||l(fn(i.input,i.index+i[0].length))!=at.Word)}class Sg extends lu{nextMatch(t,e,i){let n=Jl(this.spec,t,i,t.doc.length).next();return n.done&&(n=Jl(this.spec,t,0,e).next()),n.done?null:n.value}prevMatchInRange(t,e,i){for(let n=1;;n++){let c=Math.max(e,i-n*1e4),s=Jl(this.spec,t,c,i),d=null;for(;!s.next().done;)d=s.value;if(d&&(c==e||d.from>c+10))return d;if(c==e)return null}}prevMatch(t,e,i){return this.prevMatchInRange(t,0,e)||this.prevMatchInRange(t,i,t.doc.length)}getReplacement(t){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,(e,i)=>i=="$"?"$":i=="&"?t.match[0]:i!="0"&&+i<t.match.length?t.match[i]:e))}matchAll(t,e){let i=Jl(this.spec,t,0,t.doc.length),n=[];for(;!i.next().done;){if(n.length>=e)return null;n.push(i.value)}return n}highlight(t,e,i,n){let c=Jl(this.spec,t,Math.max(0,e-250),Math.min(i+250,t.doc.length));for(;!c.next().done;)n(c.value.from,c.value.to)}}const Zi=P.define(),Js=P.define(),Qe=Gt.define({create(l){return new Fs(Hs(l).create(),null)},update(l,t){for(let e of t.effects)e.is(Zi)?l=new Fs(e.value.create(),l.panel):e.is(Js)&&(l=new Fs(l.query,e.value?Ks:null));return l},provide:l=>ci.from(l,t=>t.panel)});class Fs{constructor(t,e){this.query=t,this.panel=e}}const Lg=N.mark({class:"cm-searchMatch"}),Jg=N.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Fg=Xt.fromClass(class{constructor(l){this.view=l,this.decorations=this.highlight(l.state.field(Qe))}update(l){let t=l.state.field(Qe);(t!=l.startState.field(Qe)||l.docChanged||l.selectionSet||l.viewportChanged)&&(this.decorations=this.highlight(t))}highlight({query:l,panel:t}){if(!t||!l.spec.valid)return N.none;let{view:e}=this,i=new Be;for(let n=0,c=e.visibleRanges,s=c.length;n<s;n++){let{from:d,to:o}=c[n];for(;n<s-1&&o>c[n+1].from-2*250;)o=c[++n].to;l.highlight(e.state,d,o,(a,h)=>{let u=e.state.selection.ranges.some(m=>m.from==a&&m.to==h);i.add(a,h,u?Jg:Lg)})}return i.finish()}},{decorations:l=>l.decorations});function gi(l){return t=>{let e=t.state.field(Qe,!1);return e&&e.query.spec.valid?l(t,e):nu(t)}}const Yn=gi((l,{query:t})=>{let{to:e}=l.state.selection.main,i=t.nextMatch(l.state,e,e);return i?(l.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:Bs(l,i),userEvent:"select.search"}),!0):!1}),Sn=gi((l,{query:t})=>{let{state:e}=l,{from:i}=e.selection.main,n=t.prevMatch(e,i,i);return n?(l.dispatch({selection:{anchor:n.from,head:n.to},scrollIntoView:!0,effects:Bs(l,n),userEvent:"select.search"}),!0):!1}),Kg=gi((l,{query:t})=>{let e=t.matchAll(l.state,1e3);return!e||!e.length?!1:(l.dispatch({selection:y.create(e.map(i=>y.range(i.from,i.to))),userEvent:"select.search.matches"}),!0)}),Hg=({state:l,dispatch:t})=>{let e=l.selection;if(e.ranges.length>1||e.main.empty)return!1;let{from:i,to:n}=e.main,c=[],s=0;for(let d=new Yl(l.doc,l.sliceDoc(i,n));!d.next().done;){if(c.length>1e3)return!1;d.value.from==i&&(s=c.length),c.push(y.range(d.value.from,d.value.to))}return t(l.update({selection:y.create(c,s),userEvent:"select.search.matches"})),!0},iu=gi((l,{query:t})=>{let{state:e}=l,{from:i,to:n}=e.selection.main;if(e.readOnly)return!1;let c=t.nextMatch(e,i,i);if(!c)return!1;let s=[],d,o,a=[];if(c.from==i&&c.to==n&&(o=e.toText(t.getReplacement(c)),s.push({from:c.from,to:c.to,insert:o}),c=t.nextMatch(e,c.from,c.to),a.push(w.announce.of(e.phrase("replaced match on line $",e.doc.lineAt(i).number)+"."))),c){let h=s.length==0||s[0].from>=c.to?0:c.to-c.from-o.length;d={anchor:c.from-h,head:c.to-h},a.push(Bs(l,c))}return l.dispatch({changes:s,selection:d,scrollIntoView:!!d,effects:a,userEvent:"input.replace"}),!0}),Bg=gi((l,{query:t})=>{if(l.state.readOnly)return!1;let e=t.matchAll(l.state,1e9).map(n=>{let{from:c,to:s}=n;return{from:c,to:s,insert:t.getReplacement(n)}});if(!e.length)return!1;let i=l.state.phrase("replaced $ matches",e.length)+".";return l.dispatch({changes:e,effects:w.announce.of(i),userEvent:"input.replace.all"}),!0});function Ks(l){return l.state.facet(Ls).createPanel(l)}function Hs(l,t){var e,i,n,c;let s=l.selection.main,d=s.empty||s.to>s.from+100?"":l.sliceDoc(s.from,s.to);if(t&&!d)return t;let o=l.facet(Ls);return new eu({search:((e=t==null?void 0:t.literal)!==null&&e!==void 0?e:o.literal)?d:d.replace(/\n/g,"\\n"),caseSensitive:(i=t==null?void 0:t.caseSensitive)!==null&&i!==void 0?i:o.caseSensitive,literal:(n=t==null?void 0:t.literal)!==null&&n!==void 0?n:o.literal,wholeWord:(c=t==null?void 0:t.wholeWord)!==null&&c!==void 0?c:o.wholeWord})}const nu=l=>{let t=l.state.field(Qe,!1);if(t&&t.panel){let e=ni(l,Ks);if(!e)return!1;let i=e.dom.querySelector("[main-field]");if(i&&i!=l.root.activeElement){let n=Hs(l.state,t.query.spec);n.valid&&l.dispatch({effects:Zi.of(n)}),i.focus(),i.select()}}else l.dispatch({effects:[Js.of(!0),t?Zi.of(Hs(l.state,t.query.spec)):P.appendConfig.of(vg)]});return!0},cu=l=>{let t=l.state.field(Qe,!1);if(!t||!t.panel)return!1;let e=ni(l,Ks);return e&&e.dom.contains(l.root.activeElement)&&l.focus(),l.dispatch({effects:Js.of(!1)}),!0},kg=[{key:"Mod-f",run:nu,scope:"editor search-panel"},{key:"F3",run:Yn,shift:Sn,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Yn,shift:Sn,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:cu,scope:"editor search-panel"},{key:"Mod-Shift-l",run:Hg},{key:"Alt-g",run:rg},{key:"Mod-d",run:Rg,preventDefault:!0}];class xg{constructor(t){this.view=t;let e=this.query=t.state.field(Qe).query.spec;this.commit=this.commit.bind(this),this.searchField=ct("input",{value:e.search,placeholder:Ot(t,"Find"),"aria-label":Ot(t,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ct("input",{value:e.replace,placeholder:Ot(t,"Replace"),"aria-label":Ot(t,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=ct("input",{type:"checkbox",name:"case",form:"",checked:e.caseSensitive,onchange:this.commit}),this.reField=ct("input",{type:"checkbox",name:"re",form:"",checked:e.regexp,onchange:this.commit}),this.wordField=ct("input",{type:"checkbox",name:"word",form:"",checked:e.wholeWord,onchange:this.commit});function i(n,c,s){return ct("button",{class:"cm-button",name:n,onclick:c,type:"button"},s)}this.dom=ct("div",{onkeydown:n=>this.keydown(n),class:"cm-search"},[this.searchField,i("next",()=>Yn(t),[Ot(t,"next")]),i("prev",()=>Sn(t),[Ot(t,"previous")]),i("select",()=>Kg(t),[Ot(t,"all")]),ct("label",null,[this.caseField,Ot(t,"match case")]),ct("label",null,[this.reField,Ot(t,"regexp")]),ct("label",null,[this.wordField,Ot(t,"by word")]),...t.state.readOnly?[]:[ct("br"),this.replaceField,i("replace",()=>iu(t),[Ot(t,"replace")]),i("replaceAll",()=>Bg(t),[Ot(t,"replace all")])],ct("button",{name:"close",onclick:()=>cu(t),"aria-label":Ot(t,"close"),type:"button"},["\xD7"])])}commit(){let t=new eu({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});t.eq(this.query)||(this.query=t,this.view.dispatch({effects:Zi.of(t)}))}keydown(t){_r(this.view,t,"search-panel")?t.preventDefault():t.keyCode==13&&t.target==this.searchField?(t.preventDefault(),(t.shiftKey?Sn:Yn)(this.view)):t.keyCode==13&&t.target==this.replaceField&&(t.preventDefault(),iu(this.view))}update(t){for(let e of t.transactions)for(let i of e.effects)i.is(Zi)&&!i.value.eq(this.query)&&this.setQuery(i.value)}setQuery(t){this.query=t,this.searchField.value=t.search,this.replaceField.value=t.replace,this.caseField.checked=t.caseSensitive,this.reField.checked=t.regexp,this.wordField.checked=t.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Ls).top}}function Ot(l,t){return l.state.phrase(t)}const Ln=30,Jn=/[\s\.,:;?!]/;function Bs(l,{from:t,to:e}){let i=l.state.doc.lineAt(t),n=l.state.doc.lineAt(e).to,c=Math.max(i.from,t-Ln),s=Math.min(n,e+Ln),d=l.state.sliceDoc(c,s);if(c!=i.from){for(let o=0;o<Ln;o++)if(!Jn.test(d[o+1])&&Jn.test(d[o])){d=d.slice(o);break}}if(s!=n){for(let o=d.length-1;o>d.length-Ln;o--)if(!Jn.test(d[o-1])&&Jn.test(d[o])){d=d.slice(0,o);break}}return w.announce.of(`${l.state.phrase("current match")}. ${d} ${l.state.phrase("on line")} ${i.number}.`)}const wg=w.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),vg=[Qe,$e.lowest(Fg),wg];class su{constructor(t,e,i){this.state=t,this.pos=e,this.explicit=i,this.abortListeners=[]}tokenBefore(t){let e=Jt(this.state).resolveInner(this.pos,-1);for(;e&&t.indexOf(e.name)<0;)e=e.parent;return e?{from:e.from,to:this.pos,text:this.state.sliceDoc(e.from,this.pos),type:e.type}:null}matchBefore(t){let e=this.state.doc.lineAt(this.pos),i=Math.max(e.from,this.pos-250),n=e.text.slice(i-e.from,this.pos-e.from),c=n.search(au(t,!1));return c<0?null:{from:i+c,to:this.pos,text:n.slice(c)}}get aborted(){return this.abortListeners==null}addEventListener(t,e){t=="abort"&&this.abortListeners&&this.abortListeners.push(e)}}function du(l){let t=Object.keys(l).join(""),e=/\w/.test(t);return e&&(t=t.replace(/\w/g,"")),`[${e?"\\w":""}${t.replace(/[^\w\s]/g,"\\$&")}]`}function Ug(l){let t=Object.create(null),e=Object.create(null);for(let{label:n}of l){t[n[0]]=!0;for(let c=1;c<n.length;c++)e[n[c]]=!0}let i=du(t)+du(e)+"*$";return[new RegExp("^"+i),new RegExp(i)]}function Ag(l){let t=l.map(n=>typeof n=="string"?{label:n}:n),[e,i]=t.every(n=>/^\w+$/.test(n.label))?[/\w*$/,/\w+$/]:Ug(t);return n=>{let c=n.matchBefore(i);return c||n.explicit?{from:c?c.from:n.pos,options:t,validFor:e}:null}}class ou{constructor(t,e,i){this.completion=t,this.source=e,this.match=i}}function De(l){return l.selection.main.head}function au(l,t){var e;let{source:i}=l,n=t&&i[0]!="^",c=i[i.length-1]!="$";return!n&&!c?l:new RegExp(`${n?"^":""}(?:${i})${c?"$":""}`,(e=l.flags)!==null&&e!==void 0?e:l.ignoreCase?"i":"")}const Ng=He.define();function zg(l,t,e,i){return Object.assign(Object.assign({},l.changeByRange(n=>{if(n==l.selection.main)return{changes:{from:e,to:i,insert:t},range:y.cursor(e+t.length)};let c=i-e;return!n.empty||c&&l.sliceDoc(n.from-c,n.from)!=l.sliceDoc(e,i)?{range:n}:{changes:{from:n.from-c,to:n.from,insert:t},range:y.cursor(n.from-c+t.length)}})),{userEvent:"input.complete"})}function hu(l,t){const e=t.completion.apply||t.completion.label;let i=t.source;typeof e=="string"?l.dispatch(Object.assign(Object.assign({},zg(l.state,e,i.from,i.to)),{annotations:Ng.of(t.completion)})):e(l,t.completion,i.from,i.to)}const uu=new WeakMap;function Tg(l){if(!Array.isArray(l))return l;let t=uu.get(l);return t||uu.set(l,t=Ag(l)),t}class Mg{constructor(t){this.pattern=t,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[];for(let e=0;e<t.length;){let i=Yt(t,e),n=Et(i);this.chars.push(i);let c=t.slice(e,e+n),s=c.toUpperCase();this.folded.push(Yt(s==c?c.toLowerCase():s,0)),e+=n}this.astral=t.length!=this.chars.length}match(t){if(this.pattern.length==0)return[0];if(t.length<this.pattern.length)return null;let{chars:e,folded:i,any:n,precise:c,byWord:s}=this;if(e.length==1){let R=Yt(t,0);return R==e[0]?[0,0,Et(R)]:R==i[0]?[-200,0,Et(R)]:null}let d=t.indexOf(this.pattern);if(d==0)return[0,0,this.pattern.length];let o=e.length,a=0;if(d<0){for(let R=0,V=Math.min(t.length,200);R<V&&a<o;){let W=Yt(t,R);(W==e[a]||W==i[a])&&(n[a++]=R),R+=Et(W)}if(a<o)return null}let h=0,u=0,m=!1,r=0,b=-1,Z=-1,g=/[a-z]/.test(t),p=!0;for(let R=0,V=Math.min(t.length,200),W=0;R<V&&u<o;){let G=Yt(t,R);d<0&&(h<o&&G==e[h]&&(c[h++]=R),r<o&&(G==e[r]||G==i[r]?(r==0&&(b=R),Z=R+1,r++):r=0));let K,f=G<255?G>=48&&G<=57||G>=97&&G<=122?2:G>=65&&G<=90?1:0:(K=On(G))!=K.toLowerCase()?1:K!=K.toUpperCase()?2:0;(!R||f==1&&g||W==0&&f!=0)&&(e[u]==G||i[u]==G&&(m=!0)?s[u++]=R:s.length&&(p=!1)),W=f,R+=Et(G)}return u==o&&s[0]==0&&p?this.result(-100+(m?-200:0),s,t):r==o&&b==0?[-200-t.length,0,Z]:d>-1?[-700-t.length,d,d+this.pattern.length]:r==o?[-200+-700-t.length,b,Z]:u==o?this.result(-100+(m?-200:0)+-700+(p?0:-1100),s,t):e.length==2?null:this.result((n[0]?-700:0)+-200+-1100,n,t)}result(t,e,i){let n=[t-i.length],c=1;for(let s of e){let d=s+(this.astral?Et(Yt(i,s)):1);c>1&&n[c-1]==s?n[c-1]=d:(n[c++]=s,n[c++]=d)}return n}}const le=U.define({combine(l){return be(l,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],compareCompletions:(t,e)=>t.label.localeCompare(e.label),interactionDelay:75},{defaultKeymap:(t,e)=>t&&e,closeOnBlur:(t,e)=>t&&e,icons:(t,e)=>t&&e,optionClass:(t,e)=>i=>Pg(t(i),e(i)),addToOptions:(t,e)=>t.concat(e)})}});function Pg(l,t){return l?t?l+" "+t:l:t}function Eg(l){let t=l.addToOptions.slice();return l.icons&&t.push({render(e){let i=document.createElement("div");return i.classList.add("cm-completionIcon"),e.type&&i.classList.add(...e.type.split(/\s+/g).map(n=>"cm-completionIcon-"+n)),i.setAttribute("aria-hidden","true"),i},position:20}),t.push({render(e,i,n){let c=document.createElement("span");c.className="cm-completionLabel";let{label:s}=e,d=0;for(let o=1;o<n.length;){let a=n[o++],h=n[o++];a>d&&c.appendChild(document.createTextNode(s.slice(d,a)));let u=c.appendChild(document.createElement("span"));u.appendChild(document.createTextNode(s.slice(a,h))),u.className="cm-completionMatchedText",d=h}return d<s.length&&c.appendChild(document.createTextNode(s.slice(d))),c},position:50},{render(e){if(!e.detail)return null;let i=document.createElement("span");return i.className="cm-completionDetail",i.textContent=e.detail,i},position:80}),t.sort((e,i)=>e.position-i.position).map(e=>e.render)}function mu(l,t,e){if(l<=e)return{from:0,to:l};if(t<0&&(t=0),t<=l>>1){let n=Math.floor(t/e);return{from:n*e,to:(n+1)*e}}let i=Math.floor((l-t)/e);return{from:l-(i+1)*e,to:l-i*e}}class jg{constructor(t,e){this.view=t,this.stateField=e,this.info=null,this.placeInfo={read:()=>this.measureInfo(),write:d=>this.positionInfo(d),key:this},this.space=null;let i=t.state.field(e),{options:n,selected:c}=i.open,s=t.state.facet(le);this.optionContent=Eg(s),this.optionClass=s.optionClass,this.range=mu(n.length,c,s.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.dom.addEventListener("mousedown",d=>{for(let o=d.target,a;o&&o!=this.dom;o=o.parentNode)if(o.nodeName=="LI"&&(a=/-(\d+)$/.exec(o.id))&&+a[1]<n.length){hu(t,n[+a[1]]),d.preventDefault();return}}),this.list=this.dom.appendChild(this.createListBox(n,i.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})}mount(){this.updateSel()}update(t){var e,i,n;let c=t.state.field(this.stateField),s=t.startState.field(this.stateField);c!=s&&(this.updateSel(),((e=c.open)===null||e===void 0?void 0:e.disabled)!=((i=s.open)===null||i===void 0?void 0:i.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!(!((n=c.open)===null||n===void 0)&&n.disabled)))}positioned(t){this.space=t,this.info&&this.view.requestMeasure(this.placeInfo)}updateSel(){let t=this.view.state.field(this.stateField),e=t.open;if((e.selected>-1&&e.selected<this.range.from||e.selected>=this.range.to)&&(this.range=mu(e.options.length,e.selected,this.view.state.facet(le).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e.options,t.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfo)})),this.updateSelectedOption(e.selected)){this.info&&(this.info.remove(),this.info=null);let{completion:i}=e.options[e.selected],{info:n}=i;if(!n)return;let c=typeof n=="string"?document.createTextNode(n):n(i);if(!c)return;"then"in c?c.then(s=>{s&&this.view.state.field(this.stateField,!1)==t&&this.addInfoPane(s)}).catch(s=>Qt(this.view.state,s,"completion info")):this.addInfoPane(c)}}addInfoPane(t){let e=this.info=document.createElement("div");e.className="cm-tooltip cm-completionInfo",e.appendChild(t),this.dom.appendChild(e),this.view.requestMeasure(this.placeInfo)}updateSelectedOption(t){let e=null;for(let i=this.list.firstChild,n=this.range.from;i;i=i.nextSibling,n++)n==t?i.hasAttribute("aria-selected")||(i.setAttribute("aria-selected","true"),e=i):i.hasAttribute("aria-selected")&&i.removeAttribute("aria-selected");return e&&Dg(this.list,e),e}measureInfo(){let t=this.dom.querySelector("[aria-selected]");if(!t||!this.info)return null;let e=this.dom.getBoundingClientRect(),i=this.info.getBoundingClientRect(),n=t.getBoundingClientRect(),c=this.space;if(!c){let b=this.dom.ownerDocument.defaultView||window;c={left:0,top:0,right:b.innerWidth,bottom:b.innerHeight}}if(n.top>Math.min(c.bottom,e.bottom)-10||n.bottom<Math.max(c.top,e.top)+10)return null;let s=this.view.textDirection==mt.RTL,d=s,o=!1,a,h="",u="",m=e.left-c.left,r=c.right-e.right;if(d&&m<Math.min(i.width,r)?d=!1:!d&&r<Math.min(i.width,m)&&(d=!0),i.width<=(d?m:r))h=Math.max(c.top,Math.min(n.top,c.bottom-i.height))-e.top+"px",a=Math.min(400,d?m:r)+"px";else{o=!0,a=Math.min(400,(s?e.right:c.right-e.left)-30)+"px";let b=c.bottom-e.bottom;b>=i.height||b>e.top?h=n.bottom-e.top+"px":u=e.bottom-n.top+"px"}return{top:h,bottom:u,maxWidth:a,class:o?s?"left-narrow":"right-narrow":d?"left":"right"}}positionInfo(t){this.info&&(t?(this.info.style.top=t.top,this.info.style.bottom=t.bottom,this.info.style.maxWidth=t.maxWidth,this.info.className="cm-tooltip cm-completionInfo cm-completionInfo-"+t.class):this.info.style.top="-1e6px")}createListBox(t,e,i){const n=document.createElement("ul");n.id=e,n.setAttribute("role","listbox"),n.setAttribute("aria-expanded","true"),n.setAttribute("aria-label",this.view.state.phrase("Completions"));for(let c=i.from;c<i.to;c++){let{completion:s,match:d}=t[c];const o=n.appendChild(document.createElement("li"));o.id=e+"-"+c,o.setAttribute("role","option");let a=this.optionClass(s);a&&(o.className=a);for(let h of this.optionContent){let u=h(s,this.view.state,d);u&&o.appendChild(u)}}return i.from&&n.classList.add("cm-completionListIncompleteTop"),i.to<t.length&&n.classList.add("cm-completionListIncompleteBottom"),n}}function Qg(l){return t=>new jg(t,l)}function Dg(l,t){let e=l.getBoundingClientRect(),i=t.getBoundingClientRect();i.top<e.top?l.scrollTop-=e.top-i.top:i.bottom>e.bottom&&(l.scrollTop+=i.bottom-e.bottom)}function ru(l){return(l.boost||0)*100+(l.apply?10:0)+(l.info?5:0)+(l.type?1:0)}function Og(l,t){let e=[],i=0;for(let d of l)if(d.hasResult())if(d.result.filter===!1){let o=d.result.getMatch;for(let a of d.result.options){let h=[1e9-i++];if(o)for(let u of o(a))h.push(u);e.push(new ou(a,d,h))}}else{let o=new Mg(t.sliceDoc(d.from,d.to)),a;for(let h of d.result.options)(a=o.match(h.label))&&(h.boost!=null&&(a[0]+=h.boost),e.push(new ou(h,d,a)))}let n=[],c=null,s=t.facet(le).compareCompletions;for(let d of e.sort((o,a)=>a.match[0]-o.match[0]||s(o.completion,a.completion)))!c||c.label!=d.completion.label||c.detail!=d.completion.detail||c.type!=null&&d.completion.type!=null&&c.type!=d.completion.type||c.apply!=d.completion.apply?n.push(d):ru(d.completion)>ru(c)&&(n[n.length-1]=d),c=d.completion;return n}class Fl{constructor(t,e,i,n,c,s){this.options=t,this.attrs=e,this.tooltip=i,this.timestamp=n,this.selected=c,this.disabled=s}setSelected(t,e){return t==this.selected||t>=this.options.length?this:new Fl(this.options,bu(e,t),this.tooltip,this.timestamp,t,this.disabled)}static build(t,e,i,n,c){let s=Og(t,e);if(!s.length)return n&&t.some(o=>o.state==1)?new Fl(n.options,n.attrs,n.tooltip,n.timestamp,n.selected,!0):null;let d=e.facet(le).selectOnOpen?0:-1;if(n&&n.selected!=d&&n.selected!=-1){let o=n.options[n.selected].completion;for(let a=0;a<s.length;a++)if(s[a].completion==o){d=a;break}}return new Fl(s,bu(i,d),{pos:t.reduce((o,a)=>a.hasResult()?Math.min(o,a.from):o,1e8),create:Qg(ie),above:c.aboveCursor},n?n.timestamp:Date.now(),d,!1)}map(t){return new Fl(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:t.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class Fn{constructor(t,e,i){this.active=t,this.id=e,this.open=i}static start(){return new Fn($g,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(t){let{state:e}=t,i=e.facet(le),c=(i.override||e.languageDataAt("autocomplete",De(e)).map(Tg)).map(d=>(this.active.find(a=>a.source==d)||new Pt(d,this.active.some(a=>a.state!=0)?1:0)).update(t,i));c.length==this.active.length&&c.every((d,o)=>d==this.active[o])&&(c=this.active);let s=this.open;t.selection||c.some(d=>d.hasResult()&&t.changes.touchesRange(d.from,d.to))||!qg(c,this.active)?s=Fl.build(c,e,this.id,this.open,i):s&&s.disabled&&!c.some(d=>d.state==1)?s=null:s&&t.docChanged&&(s=s.map(t.changes)),!s&&c.every(d=>d.state!=1)&&c.some(d=>d.hasResult())&&(c=c.map(d=>d.hasResult()?new Pt(d.source,0):d));for(let d of t.effects)d.is(gu)&&(s=s&&s.setSelected(d.value,this.id));return c==this.active&&s==this.open?this:new Fn(c,this.id,s)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:_g}}function qg(l,t){if(l==t)return!0;for(let e=0,i=0;;){for(;e<l.length&&!l[e].hasResult;)e++;for(;i<t.length&&!t[i].hasResult;)i++;let n=e==l.length,c=i==t.length;if(n||c)return n==c;if(l[e++].result!=t[i++].result)return!1}}const _g={"aria-autocomplete":"list"};function bu(l,t){let e={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":l};return t>-1&&(e["aria-activedescendant"]=l+"-"+t),e}const $g=[];function ks(l){return l.isUserEvent("input.type")?"input":l.isUserEvent("delete.backward")?"delete":null}class Pt{constructor(t,e,i=-1){this.source=t,this.state=e,this.explicitPos=i}hasResult(){return!1}update(t,e){let i=ks(t),n=this;i?n=n.handleUserEvent(t,i,e):t.docChanged?n=n.handleChange(t):t.selection&&n.state!=0&&(n=new Pt(n.source,0));for(let c of t.effects)if(c.is(xs))n=new Pt(n.source,1,c.value?De(t.state):-1);else if(c.is(Kn))n=new Pt(n.source,0);else if(c.is(Zu))for(let s of c.value)s.source==n.source&&(n=s);return n}handleUserEvent(t,e,i){return e=="delete"||!i.activateOnTyping?this.map(t.changes):new Pt(this.source,1)}handleChange(t){return t.changes.touchesRange(De(t.startState))?new Pt(this.source,0):this.map(t.changes)}map(t){return t.empty||this.explicitPos<0?this:new Pt(this.source,this.state,t.mapPos(this.explicitPos))}}class pi extends Pt{constructor(t,e,i,n,c){super(t,2,e),this.result=i,this.from=n,this.to=c}hasResult(){return!0}handleUserEvent(t,e,i){var n;let c=t.changes.mapPos(this.from),s=t.changes.mapPos(this.to,1),d=De(t.state);if((this.explicitPos<0?d<=c:d<this.from)||d>s||e=="delete"&&De(t.startState)==this.from)return new Pt(this.source,e=="input"&&i.activateOnTyping?1:0);let o=this.explicitPos<0?-1:t.changes.mapPos(this.explicitPos),a;return tp(this.result.validFor,t.state,c,s)?new pi(this.source,o,this.result,c,s):this.result.update&&(a=this.result.update(this.result,c,s,new su(t.state,d,o>=0)))?new pi(this.source,o,a,a.from,(n=a.to)!==null&&n!==void 0?n:De(t.state)):new Pt(this.source,1,o)}handleChange(t){return t.changes.touchesRange(this.from,this.to)?new Pt(this.source,0):this.map(t.changes)}map(t){return t.empty?this:new pi(this.source,this.explicitPos<0?-1:t.mapPos(this.explicitPos),this.result,t.mapPos(this.from),t.mapPos(this.to,1))}}function tp(l,t,e,i){if(!l)return!1;let n=t.sliceDoc(e,i);return typeof l=="function"?l(n,e,i,t):au(l,!0).test(n)}const xs=P.define(),Kn=P.define(),Zu=P.define({map(l,t){return l.map(e=>e.map(t))}}),gu=P.define(),ie=Gt.define({create(){return Fn.start()},update(l,t){return l.update(t)},provide:l=>[jc.from(l,t=>t.tooltip),w.contentAttributes.from(l,t=>t.attrs)]});function Hn(l,t="option"){return e=>{let i=e.state.field(ie,!1);if(!i||!i.open||i.open.disabled||Date.now()-i.open.timestamp<e.state.facet(le).interactionDelay)return!1;let n=1,c;t=="page"&&(c=Ub(e,i.open.tooltip))&&(n=Math.max(2,Math.floor(c.dom.offsetHeight/c.dom.querySelector("li").offsetHeight)-1));let{length:s}=i.open.options,d=i.open.selected>-1?i.open.selected+n*(l?1:-1):l?0:s-1;return d<0?d=t=="page"?0:s-1:d>=s&&(d=t=="page"?s-1:0),e.dispatch({effects:gu.of(d)}),!0}}const ep=l=>{let t=l.state.field(ie,!1);return l.state.readOnly||!t||!t.open||t.open.selected<0||Date.now()-t.open.timestamp<l.state.facet(le).interactionDelay?!1:(t.open.disabled||hu(l,t.open.options[t.open.selected]),!0)},lp=l=>l.state.field(ie,!1)?(l.dispatch({effects:xs.of(!0)}),!0):!1,ip=l=>{let t=l.state.field(ie,!1);return!t||!t.active.some(e=>e.state!=0)?!1:(l.dispatch({effects:Kn.of(null)}),!0)};class np{constructor(t,e){this.active=t,this.context=e,this.time=Date.now(),this.updates=[],this.done=void 0}}const pu=50,cp=50,sp=1e3,dp=Xt.fromClass(class{constructor(l){this.view=l,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let t of l.state.field(ie).active)t.state==1&&this.startQuery(t)}update(l){let t=l.state.field(ie);if(!l.selectionSet&&!l.docChanged&&l.startState.field(ie)==t)return;let e=l.transactions.some(i=>(i.selection||i.docChanged)&&!ks(i));for(let i=0;i<this.running.length;i++){let n=this.running[i];if(e||n.updates.length+l.transactions.length>cp&&Date.now()-n.time>sp){for(let c of n.context.abortListeners)try{c()}catch(s){Qt(this.view.state,s)}n.context.abortListeners=null,this.running.splice(i--,1)}else n.updates.push(...l.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=t.active.some(i=>i.state==1&&!this.running.some(n=>n.active.source==i.source))?setTimeout(()=>this.startUpdate(),pu):-1,this.composing!=0)for(let i of l.transactions)ks(i)=="input"?this.composing=2:this.composing==2&&i.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:l}=this.view,t=l.field(ie);for(let e of t.active)e.state==1&&!this.running.some(i=>i.active.source==e.source)&&this.startQuery(e)}startQuery(l){let{state:t}=this.view,e=De(t),i=new su(t,e,l.explicitPos==e),n=new np(l,i);this.running.push(n),Promise.resolve(l.source(i)).then(c=>{n.context.aborted||(n.done=c||null,this.scheduleAccept())},c=>{this.view.dispatch({effects:Kn.of(null)}),Qt(this.view.state,c)})}scheduleAccept(){this.running.every(l=>l.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),pu))}accept(){var l;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let t=[],e=this.view.state.facet(le);for(let i=0;i<this.running.length;i++){let n=this.running[i];if(n.done===void 0)continue;if(this.running.splice(i--,1),n.done){let s=new pi(n.active.source,n.active.explicitPos,n.done,n.done.from,(l=n.done.to)!==null&&l!==void 0?l:De(n.updates.length?n.updates[0].startState:this.view.state));for(let d of n.updates)s=s.update(d,e);if(s.hasResult()){t.push(s);continue}}let c=this.view.state.field(ie).active.find(s=>s.source==n.active.source);if(c&&c.state==1)if(n.done==null){let s=new Pt(n.active.source,0);for(let d of n.updates)s=s.update(d,e);s.state!=1&&t.push(s)}else this.startQuery(c)}t.length&&this.view.dispatch({effects:Zu.of(t)})}},{eventHandlers:{blur(){let l=this.view.state.field(ie,!1);l&&l.tooltip&&this.view.state.facet(le).closeOnBlur&&this.view.dispatch({effects:Kn.of(null)})},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:xs.of(!1)}),20),this.composing=0}}}),op=w.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer",padding:"1px 3px",lineHeight:1.2}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:`${400}px`,boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:`${30}px`},".cm-completionInfo.cm-completionInfo-right-narrow":{left:`${30}px`},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Gi={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},al=P.define({map(l,t){let e=t.mapPos(l,-1,At.TrackAfter);return e==null?void 0:e}}),ws=P.define({map(l,t){return t.mapPos(l)}}),vs=new class extends el{};vs.startSide=1,vs.endSide=-1;const Gu=Gt.define({create(){return lt.empty},update(l,t){if(t.selection){let e=t.state.doc.lineAt(t.selection.main.head).from,i=t.startState.doc.lineAt(t.startState.selection.main.head).from;e!=t.changes.mapPos(i,-1)&&(l=lt.empty)}l=l.map(t.changes);for(let e of t.effects)e.is(al)?l=l.update({add:[vs.range(e.value,e.value+1)]}):e.is(ws)&&(l=l.update({filter:i=>i!=e.value}));return l}});function ap(){return[up,Gu]}const Us="()[]{}<>";function Wu(l){for(let t=0;t<Us.length;t+=2)if(Us.charCodeAt(t)==l)return Us.charAt(t+1);return On(l<128?l:l+1)}function Xu(l,t){return l.languageDataAt("closeBrackets",t)[0]||Gi}const hp=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),up=w.inputHandler.of((l,t,e,i)=>{if((hp?l.composing:l.compositionStarted)||l.state.readOnly)return!1;let n=l.state.selection.main;if(i.length>2||i.length==2&&Et(Yt(i,0))==1||t!=n.from||e!=n.to)return!1;let c=rp(l.state,i);return c?(l.dispatch(c),!0):!1}),mp=[{key:"Backspace",run:({state:l,dispatch:t})=>{if(l.readOnly)return!1;let i=Xu(l,l.selection.main.head).brackets||Gi.brackets,n=null,c=l.changeByRange(s=>{if(s.empty){let d=bp(l.doc,s.head);for(let o of i)if(o==d&&Bn(l.doc,s.head)==Wu(Yt(o,0)))return{changes:{from:s.head-o.length,to:s.head+o.length},range:y.cursor(s.head-o.length)}}return{range:n=s}});return n||t(l.update(c,{scrollIntoView:!0,userEvent:"delete.backward"})),!n}}];function rp(l,t){let e=Xu(l,l.selection.main.head),i=e.brackets||Gi.brackets;for(let n of i){let c=Wu(Yt(n,0));if(t==n)return c==n?pp(l,n,i.indexOf(n+n+n)>-1,e):Zp(l,n,c,e.before||Gi.before);if(t==c&&Iu(l,l.selection.main.from))return gp(l,n,c)}return null}function Iu(l,t){let e=!1;return l.field(Gu).between(0,l.doc.length,i=>{i==t&&(e=!0)}),e}function Bn(l,t){let e=l.sliceString(t,t+2);return e.slice(0,Et(Yt(e,0)))}function bp(l,t){let e=l.sliceString(t-2,t);return Et(Yt(e,0))==e.length?e:e.slice(1)}function Zp(l,t,e,i){let n=null,c=l.changeByRange(s=>{if(!s.empty)return{changes:[{insert:t,from:s.from},{insert:e,from:s.to}],effects:al.of(s.to+t.length),range:y.range(s.anchor+t.length,s.head+t.length)};let d=Bn(l.doc,s.head);return!d||/\s/.test(d)||i.indexOf(d)>-1?{changes:{insert:t+e,from:s.head},effects:al.of(s.head+t.length),range:y.cursor(s.head+t.length)}:{range:n=s}});return n?null:l.update(c,{scrollIntoView:!0,userEvent:"input.type"})}function gp(l,t,e){let i=null,n=l.selection.ranges.map(c=>c.empty&&Bn(l.doc,c.head)==e?y.cursor(c.head+e.length):i=c);return i?null:l.update({selection:y.create(n,l.selection.mainIndex),scrollIntoView:!0,effects:l.selection.ranges.map(({from:c})=>ws.of(c))})}function pp(l,t,e,i){let n=i.stringPrefixes||Gi.stringPrefixes,c=null,s=l.changeByRange(d=>{if(!d.empty)return{changes:[{insert:t,from:d.from},{insert:t,from:d.to}],effects:al.of(d.to+t.length),range:y.range(d.anchor+t.length,d.head+t.length)};let o=d.head,a=Bn(l.doc,o),h;if(a==t){if(Vu(l,o))return{changes:{insert:t+t,from:o},effects:al.of(o+t.length),range:y.cursor(o+t.length)};if(Iu(l,o)){let u=e&&l.sliceDoc(o,o+t.length*3)==t+t+t;return{range:y.cursor(o+t.length*(u?3:1)),effects:ws.of(o)}}}else{if(e&&l.sliceDoc(o-2*t.length,o)==t+t&&(h=yu(l,o-2*t.length,n))>-1&&Vu(l,h))return{changes:{insert:t+t+t+t,from:o},effects:al.of(o+t.length),range:y.cursor(o+t.length)};if(l.charCategorizer(o)(a)!=at.Word&&yu(l,o,n)>-1&&!Gp(l,o,t,n))return{changes:{insert:t+t,from:o},effects:al.of(o+t.length),range:y.cursor(o+t.length)}}return{range:c=d}});return c?null:l.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function Vu(l,t){let e=Jt(l).resolveInner(t+1);return e.parent&&e.from==t}function Gp(l,t,e,i){let n=Jt(l).resolveInner(t,-1),c=i.reduce((s,d)=>Math.max(s,d.length),0);for(let s=0;s<5;s++){let d=l.sliceDoc(n.from,Math.min(n.to,n.from+e.length+c)),o=d.indexOf(e);if(!o||o>-1&&i.indexOf(d.slice(0,o))>-1){let h=n.firstChild;for(;h&&h.from==n.from&&h.to-h.from>e.length+o;){if(l.sliceDoc(h.to-e.length,h.to)==e)return!1;h=h.firstChild}return!0}let a=n.to==t&&n.parent;if(!a)break;n=a}return!1}function yu(l,t,e){let i=l.charCategorizer(t);if(i(l.sliceDoc(t-1,t))!=at.Word)return t;for(let n of e){let c=t-n.length;if(l.sliceDoc(c,t)==n&&i(l.sliceDoc(c-1,c))!=at.Word)return c}return-1}function Wp(l={}){return[ie,le.of(l),dp,Xp,op]}const Ru=[{key:"Ctrl-Space",run:lp},{key:"Escape",run:ip},{key:"ArrowDown",run:Hn(!0)},{key:"ArrowUp",run:Hn(!1)},{key:"PageDown",run:Hn(!0,"page")},{key:"PageUp",run:Hn(!1,"page")},{key:"Enter",run:ep}],Xp=$e.highest(ei.computeN([le],l=>l.facet(le).defaultKeymap?[Ru]:[]));class Ip{constructor(t,e,i){this.from=t,this.to=e,this.diagnostic=i}}class hl{constructor(t,e,i){this.diagnostics=t,this.panel=e,this.selected=i}static init(t,e,i){let n=t,c=i.facet(Hl).markerFilter;c&&(n=c(n));let s=N.set(n.map(d=>d.from==d.to||d.from==d.to-1&&i.doc.lineAt(d.from).to==d.from?N.widget({widget:new Jp(d),diagnostic:d}).range(d.from):N.mark({attributes:{class:"cm-lintRange cm-lintRange-"+d.severity},diagnostic:d}).range(d.from,d.to)),!0);return new hl(s,e,Kl(s))}}function Kl(l,t=null,e=0){let i=null;return l.between(e,1e9,(n,c,{spec:s})=>{if(!(t&&s.diagnostic!=t))return i=new Ip(n,c,s.diagnostic),!1}),i}function Vp(l,t){return!!(l.effects.some(e=>e.is(As))||l.changes.touchesRange(t.pos))}function fu(l,t){return l.field(qt,!1)?t:t.concat(P.appendConfig.of([qt,w.decorations.compute([qt],e=>{let{selected:i,panel:n}=e.field(qt);return!i||!n||i.from==i.to?N.none:N.set([Rp.range(i.from,i.to)])}),vb(fp,{hideOn:Vp}),Kp]))}function yp(l,t){return{effects:fu(l,[As.of(t)])}}const As=P.define(),Ns=P.define(),Cu=P.define(),qt=Gt.define({create(){return new hl(N.none,null,null)},update(l,t){if(t.docChanged){let e=l.diagnostics.map(t.changes),i=null;if(l.selected){let n=t.changes.mapPos(l.selected.from,1);i=Kl(e,l.selected.diagnostic,n)||Kl(e,null,n)}l=new hl(e,l.panel,i)}for(let e of t.effects)e.is(As)?l=hl.init(e.value,l.panel,t.state):e.is(Ns)?l=new hl(l.diagnostics,e.value?kn.open:null,l.selected):e.is(Cu)&&(l=new hl(l.diagnostics,l.panel,e.value));return l},provide:l=>[ci.from(l,t=>t.panel),w.decorations.from(l,t=>t.diagnostics)]}),Rp=N.mark({class:"cm-lintRange cm-lintRange-active"});function fp(l,t,e){let{diagnostics:i}=l.state.field(qt),n=[],c=2e8,s=0;i.between(t-(e<0?1:0),t+(e>0?1:0),(o,a,{spec:h})=>{t>=o&&t<=a&&(o==a||(t>o||e>0)&&(t<a||e<0))&&(n.push(h.diagnostic),c=Math.min(o,c),s=Math.max(a,s))});let d=l.state.facet(Hl).tooltipFilter;return d&&(n=d(n)),n.length?{pos:c,end:s,above:l.state.doc.lineAt(c).to<s,create(){return{dom:Cp(l,n)}}}:null}function Cp(l,t){return ct("ul",{class:"cm-tooltip-lint"},t.map(e=>Lu(l,e,!1)))}const Yp=l=>{let t=l.state.field(qt,!1);(!t||!t.panel)&&l.dispatch({effects:fu(l.state,[Ns.of(!0)])});let e=ni(l,kn.open);return e&&e.dom.querySelector(".cm-panel-lint ul").focus(),!0},Yu=l=>{let t=l.state.field(qt,!1);return!t||!t.panel?!1:(l.dispatch({effects:Ns.of(!1)}),!0)},Sp=[{key:"Mod-Shift-m",run:Yp,preventDefault:!0},{key:"F8",run:l=>{let t=l.state.field(qt,!1);if(!t)return!1;let e=l.state.selection.main,i=t.diagnostics.iter(e.to+1);return!i.value&&(i=t.diagnostics.iter(0),!i.value||i.from==e.from&&i.to==e.to)?!1:(l.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0}),!0)}}],Lp=Xt.fromClass(class{constructor(l){this.view=l,this.timeout=-1,this.set=!0;let{delay:t}=l.state.facet(Hl);this.lintTime=Date.now()+t,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,t)}run(){let l=Date.now();if(l<this.lintTime-10)setTimeout(this.run,this.lintTime-l);else{this.set=!1;let{state:t}=this.view,{sources:e}=t.facet(Hl);Promise.all(e.map(i=>Promise.resolve(i(this.view)))).then(i=>{let n=i.reduce((c,s)=>c.concat(s));this.view.state.doc==t.doc&&this.view.dispatch(yp(this.view.state,n))},i=>{Qt(this.view.state,i)})}}update(l){let t=l.state.facet(Hl);(l.docChanged||t!=l.startState.facet(Hl))&&(this.lintTime=Date.now()+t.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,t.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),Hl=U.define({combine(l){return Object.assign({sources:l.map(t=>t.source)},be(l.map(t=>t.config),{delay:750,markerFilter:null,tooltipFilter:null}))},enables:Lp});function Su(l){let t=[];if(l)t:for(let{name:e}of l){for(let i=0;i<e.length;i++){let n=e[i];if(/[a-zA-Z]/.test(n)&&!t.some(c=>c.toLowerCase()==n.toLowerCase())){t.push(n);continue t}}t.push("")}return t}function Lu(l,t,e){var i;let n=e?Su(t.actions):[];return ct("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},ct("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage():t.message),(i=t.actions)===null||i===void 0?void 0:i.map((c,s)=>{let d=u=>{u.preventDefault();let m=Kl(l.state.field(qt).diagnostics,t);m&&c.apply(l,m.from,m.to)},{name:o}=c,a=n[s]?o.indexOf(n[s]):-1,h=a<0?o:[o.slice(0,a),ct("u",o.slice(a,a+1)),o.slice(a+1)];return ct("button",{type:"button",class:"cm-diagnosticAction",onclick:d,onmousedown:d,"aria-label":` Action: ${o}${a<0?"":` (access key "${n[s]})"`}.`},h)}),t.source&&ct("div",{class:"cm-diagnosticSource"},t.source))}class Jp extends Ue{constructor(t){super(),this.diagnostic=t}eq(t){return t.diagnostic==this.diagnostic}toDOM(){return ct("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Ju{constructor(t,e){this.diagnostic=e,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Lu(t,e,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class kn{constructor(t){this.view=t,this.items=[];let e=n=>{if(n.keyCode==27)Yu(this.view),this.view.focus();else if(n.keyCode==38||n.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(n.keyCode==40||n.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(n.keyCode==36)this.moveSelection(0);else if(n.keyCode==35)this.moveSelection(this.items.length-1);else if(n.keyCode==13)this.view.focus();else if(n.keyCode>=65&&n.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:c}=this.items[this.selectedIndex],s=Su(c.actions);for(let d=0;d<s.length;d++)if(s[d].toUpperCase().charCodeAt(0)==n.keyCode){let o=Kl(this.view.state.field(qt).diagnostics,c);o&&c.actions[d].apply(t,o.from,o.to)}}else return;n.preventDefault()},i=n=>{for(let c=0;c<this.items.length;c++)this.items[c].dom.contains(n.target)&&this.moveSelection(c)};this.list=ct("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:e,onclick:i}),this.dom=ct("div",{class:"cm-panel-lint"},this.list,ct("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Yu(this.view)},"\xD7")),this.update()}get selectedIndex(){let t=this.view.state.field(qt).selected;if(!t)return-1;for(let e=0;e<this.items.length;e++)if(this.items[e].diagnostic==t.diagnostic)return e;return-1}update(){let{diagnostics:t,selected:e}=this.view.state.field(qt),i=0,n=!1,c=null;for(t.between(0,this.view.state.doc.length,(s,d,{spec:o})=>{let a=-1,h;for(let u=i;u<this.items.length;u++)if(this.items[u].diagnostic==o.diagnostic){a=u;break}a<0?(h=new Ju(this.view,o.diagnostic),this.items.splice(i,0,h),n=!0):(h=this.items[a],a>i&&(this.items.splice(i,a-i),n=!0)),e&&h.diagnostic==e.diagnostic?h.dom.hasAttribute("aria-selected")||(h.dom.setAttribute("aria-selected","true"),c=h):h.dom.hasAttribute("aria-selected")&&h.dom.removeAttribute("aria-selected"),i++});i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)n=!0,this.items.pop();this.items.length==0&&(this.items.push(new Ju(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),n=!0),c?(this.list.setAttribute("aria-activedescendant",c.id),this.view.requestMeasure({key:this,read:()=>({sel:c.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:s,panel:d})=>{s.top<d.top?this.list.scrollTop-=d.top-s.top:s.bottom>d.bottom&&(this.list.scrollTop+=s.bottom-d.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),n&&this.sync()}sync(){let t=this.list.firstChild;function e(){let i=t;t=i.nextSibling,i.remove()}for(let i of this.items)if(i.dom.parentNode==this.list){for(;t!=i.dom;)e();t=i.dom.nextSibling}else this.list.insertBefore(i.dom,t);for(;t;)e()}moveSelection(t){if(this.selectedIndex<0)return;let e=this.view.state.field(qt),i=Kl(e.diagnostics,this.items[t].diagnostic);!i||this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:!0,effects:Cu.of(i)})}static open(t){return new kn(t)}}function Fp(l,t='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(l)}</svg>')`}function zs(l){return Fp(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${l}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const Kp=w.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:zs("#d11")},".cm-lintRange-warning":{backgroundImage:zs("orange")},".cm-lintRange-info":{backgroundImage:zs("#999")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),Hp=(()=>[Qb(),qb(),gb(),m0(),xZ(),ib(),hb(),O.allowMultipleSelections.of(!0),fZ(),Da(AZ,{fallback:!0}),EZ(),ap(),Wp(),Sb(),Fb(),Vb(),gg(),ei.of([...mp,...hg,...kg,...I0,...HZ,...Ru,...Sp])])(),Bp="#e5c07b",Fu="#e06c75",kp="#56b6c2",xp="#ffffff",xn="#abb2bf",Ts="#7d8799",wp="#61afef",vp="#98c379",Ku="#d19a66",Up="#c678dd",Ap="#21252b",Hu="#2c313a",Bu="#282c34",Ms="#353a42",Np="#3E4451",ku="#528bff",zp=w.theme({"&":{color:xn,backgroundColor:Bu},".cm-content":{caretColor:ku},".cm-cursor, .cm-dropCursor":{borderLeftColor:ku},"&.cm-focused .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:Np},".cm-panels":{backgroundColor:Ap,color:xn},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847",outline:"1px solid #515a6b"},".cm-gutters":{backgroundColor:Bu,color:Ts,border:"none"},".cm-activeLineGutter":{backgroundColor:Hu},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Ms},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Ms,borderBottomColor:Ms},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Hu,color:xn}}},{dark:!0}),Tp=mi.define([{tag:I.keyword,color:Up},{tag:[I.name,I.deleted,I.character,I.propertyName,I.macroName],color:Fu},{tag:[I.function(I.variableName),I.labelName],color:wp},{tag:[I.color,I.constant(I.name),I.standard(I.name)],color:Ku},{tag:[I.definition(I.name),I.separator],color:xn},{tag:[I.typeName,I.className,I.number,I.changed,I.annotation,I.modifier,I.self,I.namespace],color:Bp},{tag:[I.operator,I.operatorKeyword,I.url,I.escape,I.regexp,I.link,I.special(I.string)],color:kp},{tag:[I.meta,I.comment],color:Ts},{tag:I.strong,fontWeight:"bold"},{tag:I.emphasis,fontStyle:"italic"},{tag:I.strikethrough,textDecoration:"line-through"},{tag:I.link,color:Ts,textDecoration:"underline"},{tag:I.heading,fontWeight:"bold",color:Fu},{tag:[I.atom,I.bool,I.special(I.variableName)],color:Ku},{tag:[I.processingInstruction,I.string,I.inserted],color:vp},{tag:I.invalid,color:xp}]),xu=[zp,Da(Tp)],Mp=N.mark({class:"cm-editable",inclusive:!0}),Pp=N.mark({class:"cm-not-editable"}),Ep=N.mark({class:"cm-editable-before"}),jp=N.mark({class:"cm-editable-after"}),Ps=w.baseTheme({"&light .cm-editable":{borderTop:"1px solid blue",borderBottom:"1px solid blue"},"&dark .cm-editable":{borderTop:"1px solid yellow",borderBottom:"1px solid yellow",backgroundColor:"rgb(25, 28, 33, 0.3)"},"&light .cm-editable-before":{borderRight:"2px solid blue"},"&light .cm-editable-after":{borderLeft:"2px solid blue"},"&dark .cm-editable-before":{borderRight:"2px solid yellow"},"&dark .cm-editable-after":{borderLeft:"2px solid yellow"},"&light .cm-not-editable":{backgroundColor:"rgb(50, 50, 50, 0.07)",cursor:"not-allowed"},"&dark .cm-not-editable":{backgroundColor:"rgb(200, 200, 200, 0.07)",cursor:"not-allowed"}}),wu=P.define(),vu=P.define(),Uu=P.define(),Au=P.define(),Es=Gt.define({create(){return N.none},update(l,t){l=l.map(t.changes);for(let e of t.effects)e.is(wu)&&(l=l.update({add:[Mp.range(e.value.from,e.value.to)]}));return l},provide:l=>w.decorations.from(l)}),Nu=Gt.define({create(){return N.none},update(l,t){l=l.map(t.changes);for(let e of t.effects)e.is(Au)&&(l=l.update({add:[Pp.range(e.value.from,e.value.to)]}));return l},provide:l=>w.decorations.from(l)}),zu=Gt.define({create(){return N.none},update(l,t){l=l.map(t.changes);for(let e of t.effects)e.is(vu)?l=l.update({add:[Ep.range(e.value.from,e.value.to)]}):e.is(Uu)&&(l=l.update({add:[jp.range(e.value.from,e.value.to)]}));return l},provide:l=>w.decorations.from(l)});function Tu(){return O.transactionFilter.of(l=>{let t=l.startState.field(Es,!1);if(t&&l.docChanged&&!l.annotation(Wt.remote)){let e=!1;if(l.changes.iterChangedRanges((i,n)=>{t.between(i,n,(c,s)=>{if(i>=c&&n<=s)e=!0;else if(i<=c&&n>=c&&l.newDoc.toString().indexOf("<EDITABLE>")!=-1){let d=l.newDoc.toString(),o=d.substring(d.indexOf("<EDITABLE>",c)+10,d.indexOf("</EDITABLE>",c));o.length<s-c&&(o+="".repeat(s-o.length-c)),l=l.startState.update({changes:{from:c,to:s,insert:o}}),e=!0}})}),!e)return[]}return l})}function Mu(l,t,e){let i=[wu.of({from:t,to:e})];if(!i.length)return!1;l.state.field(Es,!1)||i.push(P.appendConfig.of([Es,Ps]));let n=[vu.of({from:t-1,to:t}),Uu.of({from:e,to:e+1})];return l.state.field(zu,!1)||n.push(P.appendConfig.of([zu,Ps])),l.dispatch({effects:n}),l.dispatch({effects:i}),!0}function wn(l,t,e){let i=[Au.of({from:t,to:e})];return i.length?(l.state.field(Nu,!1)||i.push(P.appendConfig.of([Nu,Ps])),l.dispatch({effects:i}),!0):!1}function Qp(l,t,e=!1,i=""){console.log("Creating editor for element",l);let n=new tl,c=new tl,s=new tl,d=[Hp,w.lineWrapping,t,n.of([]),s.of(e?xu:[]),$e.highest(ei.of([{key:"Ctrl-Enter",run:()=>(l.dispatchEvent(new CustomEvent("execute")),!0)}])),w.updateListener.of(u=>{u.docChanged&&l.dispatchEvent(new CustomEvent("changedcode",{detail:{content:u.state.doc.toString()},bubbles:!0,cancelable:!0,composed:!0}))})],o=[],a=[];if(i.includes("<EDITABLE>")){d.push(c.of([Tu()]));let u=0,m=new RegExp("(?<=<EDITABLE>)(.|\\n)*?(?=<\\/EDITABLE>)","gm"),r,b=0;for(;(r=m.exec(i))!==null;){u++,o.push({from:r.index-10*u-11*(u-1),to:r.index+r[0].length-10*u-11*(u-1)});const Z=r.index-10*u-11*(u-1);a.push({from:b,to:Z}),b=r.index+r[0].length-10*u-11*(u-1)}i=i.replace(/<EDITABLE>/gm,"").replace(/<\/EDITABLE>/gm,"")}let h=new w({state:O.create({doc:i,extensions:d}),parent:l});return a.length>0&&a.forEach(u=>{wn(h,u.from,u.to)}),o.length>0&&(o.forEach(u=>{Mu(h,u.from,u.to)}),wn(h,o[o.length-1].to,i.length)),{editor:h,tabsConfiguration:n,editableFilterConfiguration:c,darkModeConfiguration:s}}function Dp(l,t,e){l.dispatch({effects:t.reconfigure(e?ei.of([ug]):[])})}function Op(l,t,e){l.dispatch({effects:t.reconfigure(e?xu:[])})}function qp(l,t,e,i){if(l.dispatch({effects:t.reconfigure(i?Tu():[])}),i){let n=[],c=[],s=0,d=new RegExp("(?<=<EDITABLE>)(.|\\n)*?(?=<\\/EDITABLE>)","gm"),o,a=0;for(;(o=d.exec(e))!==null;){s++,n.push({from:o.index-10*s-11*(s-1),to:o.index+o[0].length-10*s-11*(s-1)});const h=o.index-10*s-11*(s-1);c.push({from:a,to:h}),a=o.index+o[0].length-10*s-11*(s-1)}e=e.replace(/<EDITABLE>/gm,"").replace(/<\/EDITABLE>/gm,""),c.length>0&&c.forEach(h=>{wn(l,h.from,h.to)}),n.length>0&&(n.forEach(h=>{Mu(l,h.from,h.to)}),wn(l,n[n.length-1].to,e.length)),l.dispatch({changes:[{from:0,to:l.state.doc.length,insert:e}]})}else l.dispatch({changes:[{from:0,to:l.state.doc.length,insert:e.replace(/<EDITABLE>/gm,"").replace(/<\/EDITABLE>/gm,"")}]})}function _p(l){let t,e,i,n,c,s,d,o,a,h,u,m,r,b,Z,g,p,R,V,W;return{c(){t=Q("div"),e=Q("div"),i=Q("input"),n=Ct(),c=Q("label"),c.innerHTML='<svg class="settings" style="width: min(0.8vw, 1.6vh); height: min(0.8vw, 1.6vh)" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.20442 13.6177H5.7956C5.64467 13.6177 5.49827 13.5661 5.38067 13.4715C5.26308 13.3769 5.18135 13.2449 5.14905 13.0975L4.87972 11.8507C4.52042 11.6933 4.17972 11.4964 3.86391 11.2638L2.64825 11.6509C2.50435 11.6968 2.34909 11.6921 2.20825 11.6375C2.06741 11.583 1.94946 11.4819 1.87398 11.3511L0.666921 9.26589C0.592238 9.13495 0.564204 8.98254 0.587405 8.83359C0.610607 8.68465 0.68367 8.54798 0.794642 8.44596L1.73766 7.58567C1.69477 7.19596 1.69477 6.80273 1.73766 6.41302L0.794642 5.55471C0.683513 5.45265 0.61035 5.31587 0.587145 5.16677C0.56394 5.01768 0.592069 4.86513 0.666921 4.73412L1.87133 2.64758C1.94681 2.51676 2.06476 2.41569 2.2056 2.36116C2.34645 2.30663 2.50171 2.30191 2.6456 2.3478L3.86126 2.73493C4.02273 2.61581 4.19082 2.50464 4.3642 2.40405C4.53163 2.31008 4.70369 2.22471 4.87972 2.14861L5.14972 0.903167C5.18186 0.755725 5.26343 0.623696 5.3809 0.528972C5.49837 0.434247 5.64469 0.382517 5.7956 0.382359H8.20442C8.35533 0.382517 8.50165 0.434247 8.61912 0.528972C8.73659 0.623696 8.81816 0.755725 8.85031 0.903167L9.12295 2.14927C9.48179 2.30761 9.82239 2.50442 10.1388 2.73626L11.3551 2.34912C11.4989 2.30341 11.654 2.30821 11.7947 2.36273C11.9354 2.41725 12.0532 2.51822 12.1287 2.6489L13.3331 4.73545C13.4866 5.00479 13.4337 5.3456 13.2054 5.55537L12.2624 6.41567C12.3052 6.80537 12.3052 7.19861 12.2624 7.58832L13.2054 8.44861C13.4337 8.65905 13.4866 8.9992 13.3331 9.26854L12.1287 11.3551C12.0532 11.4859 11.9353 11.587 11.7944 11.6415C11.6536 11.696 11.4983 11.7007 11.3544 11.6549L10.1388 11.2677C9.82319 11.5002 9.48271 11.6969 9.12361 11.8541L8.85031 13.0975C8.81803 13.2448 8.73641 13.3767 8.61895 13.4713C8.50148 13.5659 8.35524 13.6175 8.20442 13.6177V13.6177ZM6.99736 4.35295C6.29532 4.35295 5.62203 4.63183 5.12561 5.12825C4.62919 5.62467 4.3503 6.29796 4.3503 7.00001C4.3503 7.70205 4.62919 8.37534 5.12561 8.87176C5.62203 9.36818 6.29532 9.64707 6.99736 9.64707C7.69941 9.64707 8.3727 9.36818 8.86912 8.87176C9.36554 8.37534 9.64442 7.70205 9.64442 7.00001C9.64442 6.29796 9.36554 5.62467 8.86912 5.12825C8.3727 4.63183 7.69941 4.35295 6.99736 4.35295V4.35295Z" fill="white"></path></svg>',s=Ct(),d=Q("div"),d.innerHTML='<svg style="width: min(0.62vw, 1.24vh); height: min(0.72vw, 1.44vh);" viewBox="0 0 12 14" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.0625 0.682514C10.0625 0.592517 10.0447 0.503409 10.0101 0.420318C9.97556 0.337227 9.92489 0.261794 9.86105 0.19836C9.79721 0.134927 9.72146 0.0847456 9.63815 0.0507051C9.55484 0.0166647 9.46562 -0.000562877 9.37562 1.40238e-05H0.686875C0.59688 -0.000562877 0.50766 0.0166647 0.42435 0.0507051C0.341039 0.0847456 0.265284 0.134927 0.201444 0.19836C0.137604 0.261794 0.0869395 0.337227 0.0523675 0.420318C0.0177954 0.503409 -1.84891e-06 0.592517 1.44068e-10 0.682514V11.5675C-1.84891e-06 11.6575 0.0177954 11.7466 0.0523675 11.8297C0.0869395 11.9128 0.137604 11.9882 0.201444 12.0517C0.265284 12.1151 0.341039 12.1653 0.42435 12.1993C0.50766 12.2334 0.59688 12.2506 0.686875 12.25H0.914375V0.905639H10.0625V0.682514Z" fill="white"></path><path d="M11.1562 1.75H2.40625C2.04381 1.75 1.75 2.04381 1.75 2.40625V13.3437C1.75 13.7062 2.04381 14 2.40625 14H11.1562C11.5187 14 11.8125 13.7062 11.8125 13.3437V2.40625C11.8125 2.04381 11.5187 1.75 11.1562 1.75Z" fill="white"></path></svg>',o=Ct(),a=Q("div"),h=Rt("svg"),u=Rt("path"),m=Ct(),r=Q("div"),r.innerHTML='<svg style="width: min(0.65vw, 1.3vh); height: min(0.65vw, 1.3vh)" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.48807 1.0568e-05C4.75119 0.00312952 3.17418 0.687569 2.00989 1.80022L1.07384 0.86417C0.677546 0.46788 0 0.748533 0 1.30895V4.82259C0 5.17 0.281623 5.45162 0.629032 5.45162H4.14268C4.70309 5.45162 4.98374 4.77408 4.58748 4.37779L3.49323 3.28353C4.30216 2.5261 5.3489 2.10653 6.46095 2.09694C8.88267 2.07603 10.924 4.03586 10.9031 6.53796C10.8832 8.91154 8.95889 10.9032 6.5 10.9032C5.42207 10.9032 4.4033 10.5185 3.60042 9.81407C3.47611 9.70501 3.28837 9.71164 3.17142 9.82856L2.1319 10.8681C2.0042 10.9958 2.01052 11.204 2.14453 11.325C3.29712 12.3661 4.82452 13 6.5 13C10.0898 13 13 10.0899 13 6.50006C13 2.91434 10.0738 -0.0064108 6.48807 1.0568e-05Z" fill="white"></path></svg>',b=Ct(),Z=Q("div"),g=Q("div"),p=Q("span"),this.c=tt,X(i,"type","checkbox"),X(i,"class","menu-open"),X(i,"name","menu-open"),X(i,"id","menu-open"),X(c,"id","settings-button"),X(c,"class","settings-button"),X(c,"for","menu-open"),X(d,"class","menu-item"),H(d,"background-color","#00CC3D"),X(u,"d","M14 0.7C14 0.514348 13.9263 0.336301 13.795 0.205025C13.6637 0.0737497 13.4857 0 13.3 0C13.1143 0 12.9363 0.0737497 12.805 0.205025C12.6738 0.336301 12.6 0.514348 12.6 0.7V10.5C12.6 10.6857 12.6738 10.8637 12.805 10.995C12.9363 11.1262 13.1143 11.2 13.3 11.2C13.4857 11.2 13.6637 11.1262 13.795 10.995C13.9263 10.8637 14 10.6857 14 10.5V0.7ZM6.09467 0.205333C5.96197 0.0816851 5.78646 0.0143704 5.60511 0.01757C5.42377 0.0207697 5.25074 0.094234 5.12249 0.222486C4.99423 0.350738 4.92077 0.523765 4.91757 0.705112C4.91437 0.88646 4.98169 1.06197 5.10533 1.19467L8.81067 4.9H0.7C0.514348 4.9 0.336301 4.97375 0.205025 5.10503C0.0737497 5.2363 0 5.41435 0 5.6C0 5.78565 0.0737497 5.9637 0.205025 6.09497C0.336301 6.22625 0.514348 6.3 0.7 6.3H8.81067L5.10533 10.0053C5.03656 10.0694 4.9814 10.1467 4.94314 10.2326C4.90488 10.3184 4.88431 10.4111 4.88265 10.5051C4.88099 10.5991 4.89828 10.6925 4.93349 10.7796C4.96869 10.8668 5.02109 10.946 5.08756 11.0124C5.15404 11.0789 5.23321 11.1313 5.32038 11.1665C5.40754 11.2017 5.5009 11.219 5.59489 11.2174C5.68888 11.2157 5.78157 11.1951 5.86744 11.1569C5.9533 11.1186 6.03058 11.0634 6.09467 10.9947L10.9947 6.09467C11.1258 5.96342 11.1994 5.7855 11.1994 5.6C11.1994 5.4145 11.1258 5.23658 10.9947 5.10533L6.09467 0.205333Z"),X(u,"fill","white"),H(h,"width","min(0.72vw, 1.44vh)"),H(h,"height","min(0.62vw, 1.24vh)"),X(h,"viewBox","0 0 14 12"),X(h,"fill","none"),X(h,"xmlns","http://www.w3.org/2000/svg"),X(a,"class","menu-item"),H(a,"background-color",l[9]?"#00cc3d":"#ff4133"),X(r,"class","menu-item"),H(r,"background-color","#ff4133"),X(p,"class",R="lock "+(l[10]?"":"unlocked")),X(g,"class","container"),X(Z,"class","menu-item"),X(Z,"style",V="background-color: "+(l[10]?"#ff4133":"#00cc3d")+"; "+(!l[2]||!l[2].get(l[1].state)?"display: none !important":"")),X(e,"class","menu"),X(t,"id","settings-container"),X(t,"style",W=l[0]=="vertical"?"right: calc(var(--output-height) + min(0.7vw, 1.4vh) + 1px); bottom: min(4.5vw, 9vh)":"right: min(0.4vw, 0.8vh); bottom: calc(var(--output-height) + min(4.7vw, 9.4vh))")},m(G,K){et(G,t,K),z(t,e),z(e,i),l[13](i),z(e,n),z(e,c),z(e,s),z(e,d),l[14](d),z(e,o),z(e,a),z(a,h),z(h,u),l[15](a),z(e,m),z(e,r),l[16](r),z(e,b),z(e,Z),z(Z,g),z(g,p),l[17](Z),l[18](t)},p(G,[K]){K&512&&H(a,"background-color",G[9]?"#00cc3d":"#ff4133"),K&1024&&R!==(R="lock "+(G[10]?"":"unlocked"))&&X(p,"class",R),K&1030&&V!==(V="background-color: "+(G[10]?"#ff4133":"#00cc3d")+"; "+(!G[2]||!G[2].get(G[1].state)?"display: none !important":""))&&X(Z,"style",V),K&1&&W!==(W=G[0]=="vertical"?"right: calc(var(--output-height) + min(0.7vw, 1.4vh) + 1px); bottom: min(4.5vw, 9vh)":"right: min(0.4vw, 0.8vh); bottom: calc(var(--output-height) + min(4.7vw, 9.4vh))")&&X(t,"style",W)},i:tt,o:tt,d(G){G&&Zt(t),l[13](null),l[14](null),l[15](null),l[16](null),l[17](null),l[18](null)}}}function $p(l,t,e){let{type:i="normal"}=t,{editor:n}=t,{tabsconf:c}=t,{editableconf:s}=t,{code:d}=t,o,a,h,u,m,r,b=!1,Z=!0;function g(S){const T=new CustomEvent("showmsg",{detail:S,bubbles:!0,cancelable:!0,composed:!0});o==null||o.dispatchEvent(T)}function p(){const S=new CustomEvent("changedout",{detail:{output:"",outputError:!1},bubbles:!0,cancelable:!0,composed:!0});o==null||o.dispatchEvent(S)}wl(()=>{h.addEventListener("click",S=>{var T=n.state.doc.toString();navigator.clipboard.writeText(T),a.click(),g("Text Copied!")}),u.addEventListener("click",S=>{e(9,b=!b),Dp(n,c,b),a.click(),g(b?"Tabs handling enabled":"Tabs handling disabled")}),m.addEventListener("click",S=>{n.dispatch({changes:[{from:0,to:n.state.doc.length,insert:Z?d:d.replaceAll("<EDITABLE>","").replaceAll("</EDITABLE>","")}]}),p(),a.click(),g("Code reset!")}),r.addEventListener("click",S=>{m.click(),e(10,Z=!Z),qp(n,s,d,Z),g(Z?"Text locked":"Text unlocked")})});function R(S){Vt[S?"unshift":"push"](()=>{a=S,e(4,a)})}function V(S){Vt[S?"unshift":"push"](()=>{h=S,e(5,h)})}function W(S){Vt[S?"unshift":"push"](()=>{u=S,e(6,u)})}function G(S){Vt[S?"unshift":"push"](()=>{m=S,e(7,m)})}function K(S){Vt[S?"unshift":"push"](()=>{r=S,e(8,r)})}function f(S){Vt[S?"unshift":"push"](()=>{o=S,e(3,o)})}return l.$$set=S=>{"type"in S&&e(0,i=S.type),"editor"in S&&e(1,n=S.editor),"tabsconf"in S&&e(11,c=S.tabsconf),"editableconf"in S&&e(2,s=S.editableconf),"code"in S&&e(12,d=S.code)},[i,n,s,o,a,h,u,m,r,b,Z,c,d,R,V,W,G,K,f]}class tG extends Ce{constructor(t){super(),this.shadowRoot.innerHTML='<style>#settings-container{position:absolute;z-index:10}#settings-button{transition:all ease-in 150ms;display:flex;align-items:center;justify-content:center;border:none;cursor:pointer;box-shadow:2px -7px 17px -5px rgba(0, 0, 0, 0.35)}.menu-item,.settings-button{cursor:pointer;background:#5f5f5f;border-radius:100%;width:min(1.85vw, 3.7vh);height:min(1.85vw, 3.7vh);margin-left:max(-1.85vw, -3.7vh);position:absolute;transition:all ease-in-out 200ms;display:flex;align-items:center;justify-content:center}.menu-open{display:none}.menu-item:nth-child(3){transition-duration:70ms}.menu-item:nth-child(4){transition-duration:130ms}.menu-item:nth-child(5){transition-duration:190ms}.menu-item:nth-child(6){transition-duration:250ms}.settings-button{z-index:2;transition-timing-function:cubic-bezier(0.175, 0.885, 0.32, 1.275);transition-duration:400ms;transform:scale(1.1, 1.1);cursor:pointer}.settings-button:hover{transform:scale(1.2, 1.2)}.menu-open:checked+.settings-button{transition-timing-function:linear;transition-duration:200ms;transform:scale(0.8, 0.8)}.menu-open:checked~.menu-item{transition-timing-function:cubic-bezier(0.935, 0, 0.34, 1.33)}.menu-open:checked~.menu-item:nth-child(3){transition-duration:160ms;transform:translate3d(max(-2.5vw, -5vh), 0, 0)}.menu-open:checked~.menu-item:nth-child(4){transition-duration:240ms;transform:translate3d(max(-2.5vw, -5vh), max(-2.5vw, -5vh), 0)}.menu-open:checked~.menu-item:nth-child(5){transition-duration:320ms;transform:translate3d(0, max(-2.5vw, -5vh), 0)}.menu-open:checked~.menu-item:nth-child(6){transition-duration:400ms;transform:translate3d(0, max(-5vw, -10vh), 0)}.container{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.lock{transform:scale(0.5);width:60%;height:52.5%;border:min(0.25vw, 0.5vh) solid white;margin-top:12.5%;border-radius:5px;position:relative;cursor:pointer;-webkit-transition:all 0.1s ease-in-out;transition:all 0.1s ease-in-out}.lock:after{content:"";display:block;background:white;width:10%;height:23.3%;position:absolute;top:50%;left:50%;margin:-11.7% 0 0 -6.7%;-webkit-transition:all 0.1s ease-in-out;transition:all 0.1s ease-in-out}.lock:before{content:"";display:block;width:33.3%;height:50%;bottom:105%;position:absolute;left:40%;margin-left:-26.7%;border:min(0.25vw, 0.5vh) solid white;border-top-right-radius:50%;border-top-left-radius:50%;border-bottom:0;-webkit-transition:all 0.1s ease-in-out;transition:all 0.1s ease-in-out}.lock:hover:before{height:40%}.unlocked{transform:rotate(10deg) scale(0.5);margin-top:26.7%}.unlocked:before{bottom:120%;left:31%;margin-left:-38.3%;transform:rotate(-45deg)}.unlocked,.unlocked:before{border-color:white}.unlocked:after{background:white}.unlocked:hover{transform:rotate(3deg) scale(0.5)}.unlocked:hover:before{height:33.3%;left:40%;bottom:124%;transform:rotate(-30deg)}</style>',Fe(this,{target:this.shadowRoot,props:Je(this.attributes),customElement:!0},$p,_p,fe,{type:0,editor:1,tabsconf:11,editableconf:2,code:12},null),t&&(t.target&&et(t.target,this,t.anchor),t.props&&(this.$set(t.props),v()))}static get observedAttributes(){return["type","editor","tabsconf","editableconf","code"]}get type(){return this.$$.ctx[0]}set type(t){this.$$set({type:t}),v()}get editor(){return this.$$.ctx[1]}set editor(t){this.$$set({editor:t}),v()}get tabsconf(){return this.$$.ctx[11]}set tabsconf(t){this.$$set({tabsconf:t}),v()}get editableconf(){return this.$$.ctx[2]}set editableconf(t){this.$$set({editableconf:t}),v()}get code(){return this.$$.ctx[12]}set code(t){this.$$set({code:t}),v()}}customElements.define("settings-button",tG);function eG(l){let t,e,i;return{c(){t=Q("div"),e=Ii(l[2]),this.c=tt,X(t,"style",i=(l[3]?"opacity: 1;":"opacity: 0;")+" "+(l[0]=="vertical"?l[1]=="p5"||l[1]=="processing"?"width: 40%; left: 25%; top: 50%;":"width: 50%; left: 35%; top: 50%;":"")),X(t,"id","message")},m(n,c){et(n,t,c),z(t,e)},p(n,[c]){c&4&&Mn(e,n[2]),c&11&&i!==(i=(n[3]?"opacity: 1;":"opacity: 0;")+" "+(n[0]=="vertical"?n[1]=="p5"||n[1]=="processing"?"width: 40%; left: 25%; top: 50%;":"width: 50%; left: 35%; top: 50%;":""))&&X(t,"style",i)},i:tt,o:tt,d(n){n&&Zt(t)}}}function lG(l,t,e){let{type:i="normal"}=t,{language:n}=t,{message:c}=t,{show:s}=t;return l.$$set=d=>{"type"in d&&e(0,i=d.type),"language"in d&&e(1,n=d.language),"message"in d&&e(2,c=d.message),"show"in d&&e(3,s=d.show)},[i,n,c,s]}class iG extends Ce{constructor(t){super(),this.shadowRoot.innerHTML="<style>#message{transition:500ms;position:absolute;text-align:center;width:70%;pointer-events:none;font-family:monospace;z-index:20;font-size:min(1.1vw, 2.2vh);top:40%;left:50%;transform:translate(-50%, -50%);background-color:black;color:white}</style>",Fe(this,{target:this.shadowRoot,props:Je(this.attributes),customElement:!0},lG,eG,fe,{type:0,language:1,message:2,show:3},null),t&&(t.target&&et(t.target,this,t.anchor),t.props&&(this.$set(t.props),v()))}static get observedAttributes(){return["type","language","message","show"]}get type(){return this.$$.ctx[0]}set type(t){this.$$set({type:t}),v()}get language(){return this.$$.ctx[1]}set language(t){this.$$set({language:t}),v()}get message(){return this.$$.ctx[2]}set message(t){this.$$set({message:t}),v()}get show(){return this.$$.ctx[3]}set show(t){this.$$set({show:t}),v()}}customElements.define("overlay-message",iG);var ne=typeof window<"u"?window:null,js=ne===null,Wi=js?void 0:ne.document,oe="addEventListener",ae="removeEventListener",Qs="getBoundingClientRect",Xi="_a",he="_b",Le="_c",vn="horizontal",ue=function(){return!1},nG=js?"calc":["","-webkit-","-moz-","-o-"].filter(function(l){var t=Wi.createElement("div");return t.style.cssText="width:"+l+"calc(9px)",!!t.style.length}).shift()+"calc",Pu=function(l){return typeof l=="string"||l instanceof String},Eu=function(l){if(Pu(l)){var t=Wi.querySelector(l);if(!t)throw new Error("Selector "+l+" did not match a DOM element");return t}return l},wt=function(l,t,e){var i=l[t];return i!==void 0?i:e},Un=function(l,t,e,i){if(t){if(i==="end")return 0;if(i==="center")return l/2}else if(e){if(i==="start")return 0;if(i==="center")return l/2}return l},cG=function(l,t){var e=Wi.createElement("div");return e.className="gutter gutter-"+t,e},sG=function(l,t,e){var i={};return Pu(t)?i[l]=t:i[l]=nG+"("+t+"% - "+e+"px)",i},dG=function(l,t){var e;return e={},e[l]=t+"px",e},ju=function(l,t){if(t===void 0&&(t={}),js)return{};var e=l,i,n,c,s,d,o;Array.from&&(e=Array.from(e));var a=Eu(e[0]),h=a.parentNode,u=getComputedStyle?getComputedStyle(h):null,m=u?u.flexDirection:null,r=wt(t,"sizes")||e.map(function(){return 100/e.length}),b=wt(t,"minSize",100),Z=Array.isArray(b)?b:e.map(function(){return b}),g=wt(t,"maxSize",1/0),p=Array.isArray(g)?g:e.map(function(){return g}),R=wt(t,"expandToMin",!1),V=wt(t,"gutterSize",10),W=wt(t,"gutterAlign","center"),G=wt(t,"snapOffset",30),K=Array.isArray(G)?G:e.map(function(){return G}),f=wt(t,"dragInterval",1),S=wt(t,"direction",vn),T=wt(t,"cursor",S===vn?"col-resize":"row-resize"),k=wt(t,"gutter",cG),E=wt(t,"elementStyle",sG),j=wt(t,"gutterStyle",dG);S===vn?(i="width",n="clientX",c="left",s="right",d="clientWidth"):S==="vertical"&&(i="height",n="clientY",c="top",s="bottom",d="clientHeight");function D(x,Y,B,M){var Kt=E(i,Y,B,M);Object.keys(Kt).forEach(function(It){x.style[It]=Kt[It]})}function it(x,Y,B){var M=j(i,Y,B);Object.keys(M).forEach(function(Kt){x.style[Kt]=M[Kt]})}function _(){return o.map(function(x){return x.size})}function J(x){return"touches"in x?x.touches[0][n]:x[n]}function ht(x){var Y=o[this.a],B=o[this.b],M=Y.size+B.size;Y.size=x/this.size*M,B.size=M-x/this.size*M,D(Y.element,Y.size,this[he],Y.i),D(B.element,B.size,this[Le],B.i)}function ot(x){var Y,B=o[this.a],M=o[this.b];!this.dragging||(Y=J(x)-this.start+(this[he]-this.dragOffset),f>1&&(Y=Math.round(Y/f)*f),Y<=B.minSize+B.snapOffset+this[he]?Y=B.minSize+this[he]:Y>=this.size-(M.minSize+M.snapOffset+this[Le])&&(Y=this.size-(M.minSize+this[Le])),Y>=B.maxSize-B.snapOffset+this[he]?Y=B.maxSize+this[he]:Y<=this.size-(M.maxSize-M.snapOffset+this[Le])&&(Y=this.size-(M.maxSize+this[Le])),ht.call(this,Y),wt(t,"onDrag",ue)(_()))}function ut(){var x=o[this.a].element,Y=o[this.b].element,B=x[Qs](),M=Y[Qs]();this.size=B[i]+M[i]+this[he]+this[Le],this.start=B[c],this.end=B[s]}function Ft(x){if(!getComputedStyle)return null;var Y=getComputedStyle(x);if(!Y)return null;var B=x[d];return B===0?null:(S===vn?B-=parseFloat(Y.paddingLeft)+parseFloat(Y.paddingRight):B-=parseFloat(Y.paddingTop)+parseFloat(Y.paddingBottom),B)}function C(x){var Y=Ft(h);if(Y===null||Z.reduce(function(It,_t){return It+_t},0)>Y)return x;var B=0,M=[],Kt=x.map(function(It,_t){var ul=Y*It/100,An=Un(V,_t===0,_t===x.length-1,W),Nn=Z[_t]+An;return ul<Nn?(B+=Nn-ul,M.push(0),Nn):(M.push(ul-Nn),ul)});return B===0?x:Kt.map(function(It,_t){var ul=It;if(B>0&&M[_t]-B>0){var An=Math.min(B,M[_t]-B);B-=An,ul=It-An}return ul/Y*100})}function pt(){var x=this,Y=o[x.a].element,B=o[x.b].element;x.dragging&&wt(t,"onDragEnd",ue)(_()),x.dragging=!1,ne[ae]("mouseup",x.stop),ne[ae]("touchend",x.stop),ne[ae]("touchcancel",x.stop),ne[ae]("mousemove",x.move),ne[ae]("touchmove",x.move),x.stop=null,x.move=null,Y[ae]("selectstart",ue),Y[ae]("dragstart",ue),B[ae]("selectstart",ue),B[ae]("dragstart",ue),Y.style.userSelect="",Y.style.webkitUserSelect="",Y.style.MozUserSelect="",Y.style.pointerEvents="",B.style.userSelect="",B.style.webkitUserSelect="",B.style.MozUserSelect="",B.style.pointerEvents="",x.gutter.style.cursor="",x.parent.style.cursor="",Wi.body.style.cursor=""}function ce(x){if(!("button"in x&&x.button!==0)){var Y=this,B=o[Y.a].element,M=o[Y.b].element;Y.dragging||wt(t,"onDragStart",ue)(_()),x.preventDefault(),Y.dragging=!0,Y.move=ot.bind(Y),Y.stop=pt.bind(Y),ne[oe]("mouseup",Y.stop),ne[oe]("touchend",Y.stop),ne[oe]("touchcancel",Y.stop),ne[oe]("mousemove",Y.move),ne[oe]("touchmove",Y.move),B[oe]("selectstart",ue),B[oe]("dragstart",ue),M[oe]("selectstart",ue),M[oe]("dragstart",ue),B.style.userSelect="none",B.style.webkitUserSelect="none",B.style.MozUserSelect="none",B.style.pointerEvents="none",M.style.userSelect="none",M.style.webkitUserSelect="none",M.style.MozUserSelect="none",M.style.pointerEvents="none",Y.gutter.style.cursor=T,Y.parent.style.cursor=T,Wi.body.style.cursor=T,ut.call(Y),Y.dragOffset=J(x)-Y.end}}r=C(r);var vt=[];o=e.map(function(x,Y){var B={element:Eu(x),size:r[Y],minSize:Z[Y],maxSize:p[Y],snapOffset:K[Y],i:Y},M;if(Y>0&&(M={a:Y-1,b:Y,dragging:!1,direction:S,parent:h},M[he]=Un(V,Y-1===0,!1,W),M[Le]=Un(V,!1,Y===e.length-1,W),m==="row-reverse"||m==="column-reverse")){var Kt=M.a;M.a=M.b,M.b=Kt}if(Y>0){var It=k(Y,S,B.element);it(It,V,Y),M[Xi]=ce.bind(M),It[oe]("mousedown",M[Xi]),It[oe]("touchstart",M[Xi]),h.insertBefore(It,B.element),M.gutter=It}return D(B.element,B.size,Un(V,Y===0,Y===e.length-1,W),Y),Y>0&&vt.push(M),B});function Oe(x){var Y=x.i===vt.length,B=Y?vt[x.i-1]:vt[x.i];ut.call(B);var M=Y?B.size-x.minSize-B[Le]:x.minSize+B[he];ht.call(B,M)}o.forEach(function(x){var Y=x.element[Qs]()[i];Y<x.minSize&&(R?Oe(x):x.minSize=Y)});function Os(x){var Y=C(x);Y.forEach(function(B,M){if(M>0){var Kt=vt[M-1],It=o[Kt.a],_t=o[Kt.b];It.size=Y[M-1],_t.size=B,D(It.element,It.size,Kt[he],It.i),D(_t.element,_t.size,Kt[Le],_t.i)}})}function qs(x,Y){vt.forEach(function(B){if(Y!==!0?B.parent.removeChild(B.gutter):(B.gutter[ae]("mousedown",B[Xi]),B.gutter[ae]("touchstart",B[Xi])),x!==!0){var M=E(i,B.a.size,B[he]);Object.keys(M).forEach(function(Kt){o[B.a].element.style[Kt]="",o[B.b].element.style[Kt]=""})}})}return{setSizes:Os,getSizes:_,collapse:function(Y){Oe(o[Y])},destroy:qs,parent:h,pairs:vt}};function oG(l){let t,e,i,n,c,s;function d(h,u){return h[0]=="sql"?uG:hG}let o=d(l),a=o(l);return{c(){t=Q("div"),e=Q("p"),e.textContent="OUTPUT",n=Ct(),c=Q("div"),a.c(),X(e,"id","output-title"),X(t,"id","output-title-container"),X(t,"style",i=l[1]=="vertical"?"height: min(1.6vw, 3.2vh); margin-top: min(0.3vw, 0.6vh);":""),X(c,"id","output-container"),X(c,"style",s=l[1]=="vertical"?"height: calc(100% - min(1.6vw, 3.2vh)} - min(0.3vw, 0.6vh));":"width: 100%;"),X(c,"class","rounded-scrollbar")},m(h,u){et(h,t,u),z(t,e),et(h,n,u),et(h,c,u),a.m(c,null)},p(h,u){u&2&&i!==(i=h[1]=="vertical"?"height: min(1.6vw, 3.2vh); margin-top: min(0.3vw, 0.6vh);":"")&&X(t,"style",i),o===(o=d(h))&&a?a.p(h,u):(a.d(1),a=o(h),a&&(a.c(),a.m(c,null))),u&2&&s!==(s=h[1]=="vertical"?"height: calc(100% - min(1.6vw, 3.2vh)} - min(0.3vw, 0.6vh));":"width: 100%;")&&X(c,"style",s)},d(h){h&&Zt(t),h&&Zt(n),h&&Zt(c),a.d()}}}function aG(l){let t,e,i,n,c,s,d,o,a,h,u,m;return{c(){t=Q("div"),e=Q("div"),i=Ct(),n=Q("div"),c=Q("div"),s=Q("p"),s.textContent="CONSOLE",o=Ct(),a=Q("div"),h=Ii(l[2]),H(e,"display","flex"),H(e,"flex-direction","column"),H(e,"width","100%"),H(e,"height","70%"),X(s,"id","output-title"),X(c,"id","output-title-container"),X(c,"style",d=l[1]=="vertical"?"height: min(1.6vw, 3.2vh);":""),X(a,"style",u=(l[3]?"color: var(--error-color);":"")+" display: flex; flex-direction: column; width: 100%; height: calc(100% - min(1.6vw, 3.2vh)); padding: 5px; box-sizing: border-box; white-space:pre-wrap; overflow: auto;"),X(a,"class","output-text"),H(n,"height","30%"),H(n,"position","relative"),H(n,"z-index","99"),H(n,"background-color","var(--main-output-bg-color)"),X(t,"id","output-container"),X(t,"style",m=l[1]=="vertical"?"height: 100%; overflow: hidden;":"width: 100%;"),X(t,"class","rounded-scrollbar")},m(r,b){et(r,t,b),z(t,e),l[21](e),z(t,i),z(t,n),z(n,c),z(c,s),z(n,o),z(n,a),z(a,h),l[22](a),l[23](n)},p(r,b){b&2&&d!==(d=r[1]=="vertical"?"height: min(1.6vw, 3.2vh);":"")&&X(c,"style",d),b&4&&Mn(h,r[2]),b&8&&u!==(u=(r[3]?"color: var(--error-color);":"")+" display: flex; flex-direction: column; width: 100%; height: calc(100% - min(1.6vw, 3.2vh)); padding: 5px; box-sizing: border-box; white-space:pre-wrap; overflow: auto;")&&X(a,"style",u),b&2&&m!==(m=r[1]=="vertical"?"height: 100%; overflow: hidden;":"width: 100%;")&&X(t,"style",m)},d(r){r&&Zt(t),l[21](null),l[22](null),l[23](null)}}}function hG(l){let t,e,i;return{c(){t=Q("p"),e=Ii(l[2]),X(t,"style",i=l[3]?"color: var(--error-color);":""),X(t,"class","output-text"),X(t,"id","output")},m(n,c){et(n,t,c),z(t,e)},p(n,c){c&4&&Mn(e,n[2]),c&8&&i!==(i=n[3]?"color: var(--error-color);":"")&&X(t,"style",i)},d(n){n&&Zt(t)}}}function uG(l){let t,e;return{c(){t=Q("div"),X(t,"style",e=l[3]?"color: var(--error-color);":""),X(t,"class","output-text"),X(t,"id","output")},m(i,n){et(i,t,n),l[24](t)},p(i,n){n&8&&e!==(e=i[3]?"color: var(--error-color);":"")&&X(t,"style",e)},d(i){i&&Zt(t),l[24](null)}}}function mG(l){let t,e,i,n,c,s,d,o;function a(m,r){return m[0]=="p5"||m[0]=="processing"?aG:oG}let h=a(l),u=h(l);return{c(){t=Q("div"),e=Ct(),i=Q("div"),c=Ct(),s=Q("div"),u.c(),this.c=tt,X(i,"style",n=l[1]=="vertical"?"height: 100%; width: calc(100% - var(--output-height));":""),X(i,"id","editor"),X(s,"id","editor-output"),X(s,"style",d=l[1]=="vertical"?"height: 100%; width: var(--output-height); min-height: 0;":""),X(t,"id","editor-container"),X(t,"style",o=l[1]=="vertical"?"display: flex; flex-direction: row; justify-content: space-between;":"display: flex; flex-direction: column;")},m(m,r){et(m,t,r),z(t,e),z(t,i),l[20](i),z(t,c),z(t,s),u.m(s,null),l[25](s),l[26](t)},p(m,[r]){r&2&&n!==(n=m[1]=="vertical"?"height: 100%; width: calc(100% - var(--output-height));":"")&&X(i,"style",n),h===(h=a(m))&&u?u.p(m,r):(u.d(1),u=h(m),u&&(u.c(),u.m(s,null))),r&2&&d!==(d=m[1]=="vertical"?"height: 100%; width: var(--output-height); min-height: 0;":"")&&X(s,"style",d),r&2&&o!==(o=m[1]=="vertical"?"display: flex; flex-direction: row; justify-content: space-between;":"display: flex; flex-direction: column;")&&X(t,"style",o)},i:tt,o:tt,d(m){m&&Zt(t),l[20](null),u.d(),l[25](null),l[26](null)}}}function rG(l,t,e){let i,n;Bl(l,Ri,J=>e(27,i=J)),Bl(l,Dn,J=>e(28,n=J));let{language:c="javascript"}=t,{syntax:s}=t,{type:d="normal"}=t,{theme:o="light"}=t,{code:a}=t,{output:h}=t,{canvas:u}=t,{iserror:m}=t,{id:r=""}=t,{save:b=!1}=t,Z,g,p,R,V,W,G,K,f,S;wl(()=>{if(g.addEventListener("execute",()=>{Tn(Dn,n=g.firstChild,n),Tn(Ri,i=!0,i)}),ju([g,p],{gutterSize:1,minSize:0,sizes:c=="p5"||c=="processing"?[50,50]:[70,30],direction:d=="normal"?"vertical":"horizontal"}),(c=="p5"||c=="processing")&&ju([V,W],{gutterSize:1,minSize:0,sizes:[70,30],direction:"vertical"}),r&&b){const ht=localStorage.getItem(r);ht&&e(10,a=ht)}let J;G||(J=Qp(g,s,o=="dark",a)),e(16,G=J.editor),e(17,K=J.tabsConfiguration),e(18,f=J.editableFilterConfiguration),e(19,S=J.darkModeConfiguration)});function T(J){Vt[J?"unshift":"push"](()=>{g=J,e(8,g)})}function k(J){Vt[J?"unshift":"push"](()=>{V=J,e(7,V),e(13,u),e(5,p)})}function E(J){Vt[J?"unshift":"push"](()=>{R=J,e(6,R),e(0,c),e(2,h)})}function j(J){Vt[J?"unshift":"push"](()=>{W=J,e(9,W)})}function D(J){Vt[J?"unshift":"push"](()=>{R=J,e(6,R),e(0,c),e(2,h)})}function it(J){Vt[J?"unshift":"push"](()=>{p=J,e(5,p),e(13,u),e(7,V)})}function _(J){Vt[J?"unshift":"push"](()=>{Z=J,e(4,Z)})}return l.$$set=J=>{"language"in J&&e(0,c=J.language),"syntax"in J&&e(11,s=J.syntax),"type"in J&&e(1,d=J.type),"theme"in J&&e(12,o=J.theme),"code"in J&&e(10,a=J.code),"output"in J&&e(2,h=J.output),"canvas"in J&&e(13,u=J.canvas),"iserror"in J&&e(3,m=J.iserror),"id"in J&&e(14,r=J.id),"save"in J&&e(15,b=J.save)},l.$$.update=()=>{if(l.$$.dirty&983056){const J=new CustomEvent("editormsg",{detail:{editor:G,tabsConfiguration:K,editableFilterConfiguration:f,darkModeConfiguration:S},bubbles:!0,cancelable:!0,composed:!0});Z==null||Z.dispatchEvent(J)}l.$$.dirty&8352&&(u?(e(7,V.innerHTML="",V),V.appendChild(u)):p&&p.getElementsByTagName("canvas").length>0&&e(5,p.innerHTML="",p)),l.$$.dirty&69&&c=="sql"&&R&&e(6,R.innerHTML=h,R)},[c,d,h,m,Z,p,R,V,g,W,a,s,o,u,r,b,G,K,f,S,T,k,E,j,D,it,_]}class bG extends Ce{constructor(t){super(),this.shadowRoot.innerHTML='<style>#editor-container{position:absolute;left:0;top:0;height:100%;width:100%;box-shadow:rgba(0, 0, 0, 0.35) 0px 5px 15px}#editor{height:calc(100% - var(--output-height))}#editor-output{z-index:99;box-sizing:border-box;background-color:var(--main-output-bg-color);color:var(--main-output-text-color);height:var(--output-height);overflow:hidden}#output-title-container{height:min(1.6vw, 3.2vh);display:flex;align-items:center}#output-title{margin:0;height:60%;margin-left:min(0.8vw, 1.6vh);font-size:min(0.9vw, 1.8vh);width:fit-content;border-bottom:1px solid var(--output-text-color);color:var(--output-text-color);box-sizing:border-box}#output-container{overflow:auto;height:calc(100% - min(1.6vw, 3.2vh));width:100%}.output-text{color:var(--output-text-color);padding:min(0.05vw, 0.1vh) 0 0 min(0.6vw, 1.2vh);margin:0;font-family:monospace;font-size:min(1.1vw, 2.2vh);white-space:pre-wrap}.cm-editor{height:100%;font-size:min(1.1vw, 2.2vh)}.cm-scroller{overflow:auto}.\u037C1 .cm-lineNumbers .cm-gutterElement{padding:0 min(0.3vw, 0.6vh) !important;min-width:unset !important}.\u037C1 .cm-content{padding:min(0.1vw, 0.2vh) 0 !important}.\u037C1 .cm-line{padding:0 min(0.05vw, 0.025vh) 0 min(0.15vw, 0.075vh) !important}.gutter{width:min(0.2vw, 0.4vh) !important;height:100%;z-index:99;position:relative;background-color:rgb(150, 150, 150);background-repeat:no-repeat;background-position:50%;transition:background-color 1s}.gutter:hover{background-color:#466be5}.gutter.gutter-vertical{height:min(0.2vw, 0.4vh) !important;width:100% !important;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAFAQMAAABo7865AAAABlBMVEVHcEzMzMzyAv2sAAAAAXRSTlMAQObYZgAAABBJREFUeF5jOAMEEAIEEFwAn3kMwcB6I2AAAAAASUVORK5CYII=");cursor:row-resize}.gutter.gutter-horizontal{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAeCAYAAADkftS9AAAAIklEQVQoU2M4c+bMfxAGAgYYmwGrIIiDjrELjpo5aiZeMwF+yNnOs5KSvgAAAABJRU5ErkJggg==");cursor:col-resize}table{margin:min(0.7vw, 1.4vh);border-collapse:collapse}td,th{border:1px solid var(--table-th-color);text-align:center;padding:8px}tr:nth-child(even){background-color:var(--table-tr-even-color)}tr:hover{background-color:var(--table-tr-hover-color)}th{padding-top:12px;padding-bottom:12px;text-align:center;background-color:var(--table-th-background-color);color:var(--table-th-text-color)}*::-webkit-scrollbar-track{box-shadow:inset 0 0 min(0.29vw, 0.6vh) rgba(0, 0, 0, 0.3);-webkit-box-shadow:inset 0 0 min(0.29vw, 0.6vh) rgba(0, 0, 0, 0.3);background-color:var(--dark-mode-main-output-bg-color-light)}*::-webkit-scrollbar{width:min(0.29vw, 0.6vh);background-color:var(--main-output-bg-color)}*::-webkit-scrollbar-thumb{box-shadow:inset 0 0 min(0.29vw, 0.6vh) rgba(0, 0, 0, 0.3);-webkit-box-shadow:inset 0 0 min(0.29vw, 0.6vh) rgba(0, 0, 0, 0.3);background-color:#999999}.rounded-scrollbar::-webkit-scrollbar-track{border-radius:10px;background-color:var(--main-output-bg-color)}.rounded-scrollbar::-webkit-scrollbar-thumb{border-radius:10px}</style>',Fe(this,{target:this.shadowRoot,props:Je(this.attributes),customElement:!0},rG,mG,fe,{language:0,syntax:11,type:1,theme:12,code:10,output:2,canvas:13,iserror:3,id:14,save:15},null),t&&(t.target&&et(t.target,this,t.anchor),t.props&&(this.$set(t.props),v()))}static get observedAttributes(){return["language","syntax","type","theme","code","output","canvas","iserror","id","save"]}get language(){return this.$$.ctx[0]}set language(t){this.$$set({language:t}),v()}get syntax(){return this.$$.ctx[11]}set syntax(t){this.$$set({syntax:t}),v()}get type(){return this.$$.ctx[1]}set type(t){this.$$set({type:t}),v()}get theme(){return this.$$.ctx[12]}set theme(t){this.$$set({theme:t}),v()}get code(){return this.$$.ctx[10]}set code(t){this.$$set({code:t}),v()}get output(){return this.$$.ctx[2]}set output(t){this.$$set({output:t}),v()}get canvas(){return this.$$.ctx[13]}set canvas(t){this.$$set({canvas:t}),v()}get iserror(){return this.$$.ctx[3]}set iserror(t){this.$$set({iserror:t}),v()}get id(){return this.$$.ctx[14]}set id(t){this.$$set({id:t}),v()}get save(){return this.$$.ctx[15]}set save(t){this.$$set({save:t}),v()}}customElements.define("editor-container",bG);function ZG(l){let t,e;return{c(){t=Rt("svg"),e=Rt("path"),X(e,"stroke-linecap","round"),X(e,"stroke-linejoin","round"),X(e,"d","M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z"),H(t,"height","100%"),X(t,"xmlns","http://www.w3.org/2000/svg"),X(t,"fill","none"),X(t,"viewBox","0 0 24 24"),X(t,"stroke-width","1.5"),X(t,"stroke","black"),X(t,"class","w-6 h-6")},m(i,n){et(i,t,n),z(t,e)},d(i){i&&Zt(t)}}}function gG(l){let t,e;return{c(){t=Rt("svg"),e=Rt("path"),X(e,"stroke-linecap","round"),X(e,"stroke-linejoin","round"),X(e,"d","M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z"),H(t,"height","100%"),X(t,"xmlns","http://www.w3.org/2000/svg"),X(t,"fill","none"),X(t,"viewBox","0 0 24 24"),X(t,"stroke-width","1.5"),X(t,"stroke","white"),X(t,"class","w-6 h-6")},m(i,n){et(i,t,n),z(t,e)},d(i){i&&Zt(t)}}}function pG(l){let t,e,i;function n(d,o){return d[0]=="dark"?gG:ZG}let c=n(l),s=c(l);return{c(){t=Q("button"),s.c(),this.c=tt,H(t,"position","absolute"),H(t,"right",l[1]=="vertical"?"calc(var(--output-height) + min(0.5vw, 1vh))":"min(0.5vw, 1vh)"),H(t,"top","min(2.5vw, 5vh)"),H(t,"padding","min(0.25vw, 0.5vh)"),H(t,"width","min(1.7vw, 3.4vh)"),H(t,"height","min(1.7vw, 3.4vh)"),H(t,"border","0px"),H(t,"border-radius",".4em"),H(t,"display","flex"),H(t,"justify-content","center"),H(t,"align-items","center"),H(t,"z-index","99"),H(t,"background-color","var(--theme-color)"),H(t,"cursor","pointer")},m(d,o){et(d,t,o),s.m(t,null),l[5](t),e||(i=$t(t,"click",l[6]),e=!0)},p(d,[o]){c!==(c=n(d))&&(s.d(1),s=c(d),s&&(s.c(),s.m(t,null))),o&2&&H(t,"right",d[1]=="vertical"?"calc(var(--output-height) + min(0.5vw, 1vh))":"min(0.5vw, 1vh)")},i:tt,o:tt,d(d){d&&Zt(t),s.d(),l[5](null),e=!1,i()}}}function GG(l,t,e){let i;Bl(l,ed,h=>e(4,i=h));let{theme:n}=t,{type:c}=t,s;function d(h){localStorage.setItem("icp-default-theme",h?"dark":"light"),ed.set(h?"dark":"light");const u=new CustomEvent("changedtheme",{detail:{darkMode:h},bubbles:!0,cancelable:!0,composed:!0});s.dispatchEvent(u)}function o(h){Vt[h?"unshift":"push"](()=>{s=h,e(2,s)})}const a=()=>{d(n=="light")};return l.$$set=h=>{"theme"in h&&e(0,n=h.theme),"type"in h&&e(1,c=h.type)},l.$$.update=()=>{l.$$.dirty&21&&s&&i&&i!=n&&d(i=="dark")},[n,c,s,d,i,o,a]}class WG extends Ce{constructor(t){super(),Fe(this,{target:this.shadowRoot,props:Je(this.attributes),customElement:!0},GG,pG,fe,{theme:0,type:1},null),t&&(t.target&&et(t.target,this,t.anchor),t.props&&(this.$set(t.props),v()))}static get observedAttributes(){return["theme","type"]}get theme(){return this.$$.ctx[0]}set theme(t){this.$$set({theme:t}),v()}get type(){return this.$$.ctx[1]}set type(t){this.$$set({type:t}),v()}}customElements.define("theme-switch",WG);function XG(l){let t,e,i,n,c,s,d,o;return{c(){t=Q("button"),e=Rt("svg"),i=Rt("path"),n=Rt("path"),c=Rt("path"),this.c=tt,X(i,"d","M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"),X(n,"d","m7 10 5 5 5-5"),X(c,"d","M12 15V3"),H(e,"width","min(1.2vw, 2.4vh)"),H(e,"height","min(1.2vw, 2.4vh)"),X(e,"fill","none"),X(e,"stroke",s=l[0]=="dark"?"#ffffff":"#000000"),X(e,"stroke-linecap","round"),X(e,"stroke-linejoin","round"),X(e,"stroke-width","2"),X(e,"viewBox","0 0 24 24"),X(e,"xmlns","http://www.w3.org/2000/svg"),H(t,"position","absolute"),H(t,"right",l[1]=="vertical"?"calc(var(--output-height) + min(2vw, 4vh))":"min(2vw, 4vh)"),H(t,"top","min(0.5vw, 1vh)"),H(t,"padding","0"),H(t,"border","0px"),H(t,"border-radius",".4em"),H(t,"display","flex"),H(t,"justify-content","center"),H(t,"width","min(1.5vw, 3vh)"),H(t,"height","min(1.5vw, 3vh)"),H(t,"align-items","center"),H(t,"z-index","99"),H(t,"background-color","transparent"),H(t,"cursor","pointer")},m(a,h){et(a,t,h),z(t,e),z(e,i),z(e,n),z(e,c),l[7](t),d||(o=$t(t,"click",l[8]),d=!0)},p(a,[h]){h&1&&s!==(s=a[0]=="dark"?"#ffffff":"#000000")&&X(e,"stroke",s),h&2&&H(t,"right",a[1]=="vertical"?"calc(var(--output-height) + min(2vw, 4vh))":"min(2vw, 4vh)")},i:tt,o:tt,d(a){a&&Zt(t),l[7](null),d=!1,o()}}}function IG(l,t,e){let{language:i}=t,{theme:n}=t,{type:c}=t,{code:s=""}=t,{id:d=""}=t,o,a={sql:"sql",javascript:"js",typescript:"ts",python:"py",java:"java",cpp:"cpp",processing:"pde",p5:"js",ml:"ml"},h={sql:"text/x-sql",javascript:"text/javascript",typescript:"text/typescript",python:"text/x-python",java:"text/x-java",cpp:"text/x-c++src",processing:"text/x-processing",p5:"text/javascript",ml:"text/x-sml"};async function u(){const b=`${d!=""?d:"code-snippet"}.${a[i]}`;if(window.showSaveFilePicker){const g=await(await window.showSaveFilePicker({suggestedName:b,types:[{description:i,accept:{[h[i]]:[`.${a[i]}`]}}]})).createWritable();await g.write(s),await g.close()}else{const Z=document.createElement("a");Z.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(s)),Z.setAttribute("download",b),Z.style.display="none",document.body.appendChild(Z),Z.click(),document.body.removeChild(Z)}}function m(b){Vt[b?"unshift":"push"](()=>{o=b,e(2,o)})}const r=()=>{u()};return l.$$set=b=>{"language"in b&&e(4,i=b.language),"theme"in b&&e(0,n=b.theme),"type"in b&&e(1,c=b.type),"code"in b&&e(5,s=b.code),"id"in b&&e(6,d=b.id)},[n,c,o,u,i,s,d,m,r]}class VG extends Ce{constructor(t){super(),Fe(this,{target:this.shadowRoot,props:Je(this.attributes),customElement:!0},IG,XG,fe,{language:4,theme:0,type:1,code:5,id:6},null),t&&(t.target&&et(t.target,this,t.anchor),t.props&&(this.$set(t.props),v()))}static get observedAttributes(){return["language","theme","type","code","id"]}get language(){return this.$$.ctx[4]}set language(t){this.$$set({language:t}),v()}get theme(){return this.$$.ctx[0]}set theme(t){this.$$set({theme:t}),v()}get type(){return this.$$.ctx[1]}set type(t){this.$$set({type:t}),v()}get code(){return this.$$.ctx[5]}set code(t){this.$$set({code:t}),v()}get id(){return this.$$.ctx[6]}set id(t){this.$$set({id:t}),v()}}customElements.define("download-button",VG);function Qu(l){let t;return{c(){t=Q("download-button"),L(t,"language",l[2]),L(t,"id",l[8]),L(t,"theme",l[0]),L(t,"type",l[4]),L(t,"code",l[1])},m(e,i){et(e,t,i)},p(e,i){i[0]&4&&L(t,"language",e[2]),i[0]&256&&L(t,"id",e[8]),i[0]&1&&L(t,"theme",e[0]),i[0]&16&&L(t,"type",e[4]),i[0]&2&&L(t,"code",e[1])},d(e){e&&Zt(t)}}}function yG(l){let t,e,i;return{c(){t=Rt("svg"),e=Rt("path"),X(e,"fill-rule","evenodd"),X(e,"d","M7 10H5V5h5v2H7v3Zm-2 4h2v3h3v2H5v-5Zm12 3h-3v2h5v-5h-2v3ZM14 7V5h5v5h-2V7h-3Z"),X(e,"clip-rule","evenodd"),H(t,"height","100%"),X(t,"fill",i=l[0]=="dark"?"white":"black"),X(t,"viewBox","0 0 24 24"),X(t,"xmlns","http://www.w3.org/2000/svg")},m(n,c){et(n,t,c),z(t,e)},p(n,c){c[0]&1&&i!==(i=n[0]=="dark"?"white":"black")&&X(t,"fill",i)},d(n){n&&Zt(t)}}}function RG(l){let t,e,i;return{c(){t=Rt("svg"),e=Rt("path"),X(e,"fill-rule","evenodd"),X(e,"d","M5 8h3V5h2v5H5V8Zm3 8H5v-2h5v5H8v-3Zm6 3h2v-3h3v-2h-5v5Zm2-14v3h3v2h-5V5h2Z"),X(e,"clip-rule","evenodd"),H(t,"height","100%"),X(t,"fill",i=l[0]=="dark"?"white":"black"),X(t,"viewBox","0 0 24 24"),X(t,"xmlns","http://www.w3.org/2000/svg")},m(n,c){et(n,t,c),z(t,e)},p(n,c){c[0]&1&&i!==(i=n[0]=="dark"?"white":"black")&&X(t,"fill",i)},d(n){n&&Zt(t)}}}function fG(l){let t,e,i,n,c,s,d,o,a,h,u,m,r,b,Z,g=l[10]&&Qu(l);function p(W,G){return W[21]?RG:yG}let R=p(l),V=R(l);return{c(){t=Q("div"),e=Q("overlay-message"),i=Ct(),n=Q("theme-switch"),c=Ct(),g&&g.c(),s=Ct(),d=Q("button"),V.c(),o=Ct(),a=Q("settings-button"),h=Ct(),u=Q("run-button"),m=Ct(),r=Q("editor-container"),this.c=tt,L(e,"type",l[4]),L(e,"language",l[2]),L(e,"show",l[20]),L(e,"message",l[19]),L(n,"theme",l[0]),L(n,"type",l[4]),H(d,"position","absolute"),H(d,"right",l[4]=="vertical"?"calc(var(--output-height) + min(0.5vw, 1vh))":"min(0.5vw, 1vh)"),H(d,"top","min(0.5vw, 1vh)"),H(d,"width","min(1.5vw, 3vh)"),H(d,"height","min(1.5vw, 3vh)"),H(d,"border","0px"),H(d,"border-radius",".4em"),H(d,"display","flex"),H(d,"justify-content","center"),H(d,"align-items","center"),H(d,"z-index","99"),H(d,"background-color","transparent"),H(d,"cursor","pointer"),L(a,"type",l[4]),L(a,"editor",l[13]),L(a,"tabsconf",l[14]),L(a,"editableconf",l[15]),L(a,"code",l[5]),L(u,"type",l[4]),L(u,"language",l[2]),L(u,"editor",l[13]),L(u,"webworker",l[7]),L(u,"offline",l[6]),L(u,"modules",l[11]),L(r,"syntax",l[3]),L(r,"language",l[2]),L(r,"type",l[4]),L(r,"theme",l[0]),L(r,"code",l[5]),L(r,"output",l[17]),L(r,"canvas",l[22]),L(r,"id",l[8]),L(r,"save",l[9]),L(r,"iserror",l[18]),X(t,"id","code-container")},m(W,G){et(W,t,G),z(t,e),z(t,i),z(t,n),z(t,c),g&&g.m(t,null),z(t,s),z(t,d),V.m(d,null),z(t,o),z(t,a),z(t,h),z(t,u),z(t,m),z(t,r),l[33](t),b||(Z=[$t(n,"changedtheme",l[25]),$t(d,"click",l[26]),$t(a,"changedout",l[27]),$t(a,"showmsg",l[28]),$t(u,"changedout",l[29]),$t(u,"canvasout",l[30]),$t(r,"editormsg",l[31]),$t(r,"changedcode",l[32])],b=!0)},p(W,G){G[0]&16&&L(e,"type",W[4]),G[0]&4&&L(e,"language",W[2]),G[0]&1048576&&L(e,"show",W[20]),G[0]&524288&&L(e,"message",W[19]),G[0]&1&&L(n,"theme",W[0]),G[0]&16&&L(n,"type",W[4]),W[10]?g?g.p(W,G):(g=Qu(W),g.c(),g.m(t,s)):g&&(g.d(1),g=null),R===(R=p(W))&&V?V.p(W,G):(V.d(1),V=R(W),V&&(V.c(),V.m(d,null))),G[0]&16&&H(d,"right",W[4]=="vertical"?"calc(var(--output-height) + min(0.5vw, 1vh))":"min(0.5vw, 1vh)"),G[0]&16&&L(a,"type",W[4]),G[0]&8192&&L(a,"editor",W[13]),G[0]&16384&&L(a,"tabsconf",W[14]),G[0]&32768&&L(a,"editableconf",W[15]),G[0]&32&&L(a,"code",W[5]),G[0]&16&&L(u,"type",W[4]),G[0]&4&&L(u,"language",W[2]),G[0]&8192&&L(u,"editor",W[13]),G[0]&128&&L(u,"webworker",W[7]),G[0]&64&&L(u,"offline",W[6]),G[0]&2048&&L(u,"modules",W[11]),G[0]&8&&L(r,"syntax",W[3]),G[0]&4&&L(r,"language",W[2]),G[0]&16&&L(r,"type",W[4]),G[0]&1&&L(r,"theme",W[0]),G[0]&32&&L(r,"code",W[5]),G[0]&131072&&L(r,"output",W[17]),G[0]&4194304&&L(r,"canvas",W[22]),G[0]&256&&L(r,"id",W[8]),G[0]&512&&L(r,"save",W[9]),G[0]&262144&&L(r,"iserror",W[18])},i:tt,o:tt,d(W){W&&Zt(t),g&&g.d(),V.d(),l[33](null),b=!1,ml(Z)}}}function CG(l,t,e){let{language:i}=t,{syntax:n}=t,{type:c="normal"}=t,{theme:s="light"}=t,{code:d=""}=t,{userCode:o=""}=t,{offline:a=!1}=t,{webworker:h}=t,{id:u=""}=t,{save:m=!1}=t,{downloadable:r=!1}=t,{modules:b={}}=t,Z,g,p,R,V,W="",G=!1,K="",f=!1,S=!1,T;wl(()=>{e(1,o=d)});function k(C){e(20,f=!0),e(19,K=C),setTimeout(function(){e(20,f=!1)},1e3)}function E(C){e(0,s=C?"dark":"light"),Op(g,V,C)}document.addEventListener("fullscreenchange",C=>{e(21,S=document.fullscreenElement!=null)});const j=C=>{E(C.detail.darkMode)},D=()=>{S?document.exitFullscreen():Z&&Z.requestFullscreen&&Z.requestFullscreen()},it=C=>{e(17,W=C.detail.output)},_=C=>{k(C.detail)},J=C=>{e(17,W=C.detail.output),e(18,G=C.detail.outputError)},ht=C=>{e(22,T=C.detail.canvas)},ot=C=>{e(13,g=C.detail.editor),e(14,p=C.detail.tabsConfiguration),e(15,R=C.detail.editableFilterConfiguration),e(16,V=C.detail.darkModeConfiguration)},ut=C=>{e(1,o=C.detail.content),m&&localStorage.setItem(u,C.detail.content)};function Ft(C){Vt[C?"unshift":"push"](()=>{Z=C,e(12,Z)})}return l.$$set=C=>{"language"in C&&e(2,i=C.language),"syntax"in C&&e(3,n=C.syntax),"type"in C&&e(4,c=C.type),"theme"in C&&e(0,s=C.theme),"code"in C&&e(5,d=C.code),"userCode"in C&&e(1,o=C.userCode),"offline"in C&&e(6,a=C.offline),"webworker"in C&&e(7,h=C.webworker),"id"in C&&e(8,u=C.id),"save"in C&&e(9,m=C.save),"downloadable"in C&&e(10,r=C.downloadable),"modules"in C&&e(11,b=C.modules)},l.$$.update=()=>{l.$$.dirty[0]&4101&&Z&&(Z.style.setProperty("--output-height",i=="p5"||i=="processing"?"50%":"30%"),Z.style.setProperty("--main-output-bg-color",s=="dark"?"#333842":"#f5f5f5"),Z.style.setProperty("--main-output-text-color",s=="dark"?"#cccccc":"#303030"),Z.style.setProperty("--output-text-color",s=="dark"?"#eeeeee":"#303030"),Z.style.setProperty("--run-button-bg-color",s=="dark"?"#333842":"white"),Z.style.setProperty("--run-button-bg-color-hover",s=="dark"?"#2C313A":"#eeeeee"),Z.style.setProperty("--run-button-text-color",s=="dark"?"white":"black"),Z.style.setProperty("--table-th-color",(s=="dark","#dddddd")),Z.style.setProperty("--table-tr-even-color",s=="dark"?"#404652":"#e8e8e8"),Z.style.setProperty("--table-tr-hover-color",s=="dark"?"#252930":"#cccccc"),Z.style.setProperty("--table-th-background-color",(s=="dark","#362f4b")),Z.style.setProperty("--table-th-text-color",(s=="dark","white")),Z.style.setProperty("--theme-color",s=="dark"?"#cccccc":"#ffee00"))},[s,o,i,n,c,d,a,h,u,m,r,b,Z,g,p,R,V,W,G,K,f,S,T,k,E,j,D,it,_,J,ht,ot,ut,Ft]}class YG extends Ce{constructor(t){super(),this.shadowRoot.innerHTML='<style>:host{--error-color:red;--run-btn-main-color:#00cc3d;--run-btn-active-color:#00aa33;--run-btn-shadow-color:#00cc3d81;--run-btn-active-shadow-color:#00cc3d3d}#code-container>*{margin:0;padding:0;vertical-align:baseline;line-height:normal;font-size:medium;text-align:left}#code-container{font-family:"Roboto", sans-serif;font-weight:300;background-color:white;color:black;position:relative;width:100%;height:100%}</style>',Fe(this,{target:this.shadowRoot,props:Je(this.attributes),customElement:!0},CG,fG,fe,{language:2,syntax:3,type:4,theme:0,code:5,userCode:1,offline:6,webworker:7,id:8,save:9,downloadable:10,modules:11},null,[-1,-1]),t&&(t.target&&et(t.target,this,t.anchor),t.props&&(this.$set(t.props),v()))}static get observedAttributes(){return["language","syntax","type","theme","code","userCode","offline","webworker","id","save","downloadable","modules"]}get language(){return this.$$.ctx[2]}set language(t){this.$$set({language:t}),v()}get syntax(){return this.$$.ctx[3]}set syntax(t){this.$$set({syntax:t}),v()}get type(){return this.$$.ctx[4]}set type(t){this.$$set({type:t}),v()}get theme(){return this.$$.ctx[0]}set theme(t){this.$$set({theme:t}),v()}get code(){return this.$$.ctx[5]}set code(t){this.$$set({code:t}),v()}get userCode(){return this.$$.ctx[1]}set userCode(t){this.$$set({userCode:t}),v()}get offline(){return this.$$.ctx[6]}set offline(t){this.$$set({offline:t}),v()}get webworker(){return this.$$.ctx[7]}set webworker(t){this.$$set({webworker:t}),v()}get id(){return this.$$.ctx[8]}set id(t){this.$$set({id:t}),v()}get save(){return this.$$.ctx[9]}set save(t){this.$$set({save:t}),v()}get downloadable(){return this.$$.ctx[10]}set downloadable(t){this.$$set({downloadable:t}),v()}get modules(){return this.$$.ctx[11]}set modules(t){this.$$set({modules:t}),v()}}customElements.define("base-editor",YG);const Du="KGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO3ZhciBOZT10eXBlb2YgZ2xvYmFsVGhpczwidSI/Z2xvYmFsVGhpczp0eXBlb2Ygd2luZG93PCJ1Ij93aW5kb3c6dHlwZW9mIGdsb2JhbDwidSI/Z2xvYmFsOnR5cGVvZiBzZWxmPCJ1Ij9zZWxmOnt9LGtlPXtleHBvcnRzOnt9fTsoZnVuY3Rpb24oYmUsSWUpeyhmdW5jdGlvbihUZSxTZSl7YmUuZXhwb3J0cz1TZSgpfSkoTmUsZnVuY3Rpb24oKXtyZXR1cm4oKCk9Pnt2YXIgVGU9ezY1NTpmdW5jdGlvbihmZSx1LEspe3ZhciBtLGc9dGhpcyYmdGhpcy5fX2V4dGVuZHN8fChtPWZ1bmN0aW9uKEgsUCl7cmV0dXJuKG09T2JqZWN0LnNldFByb3RvdHlwZU9mfHx7X19wcm90b19fOltdfWluc3RhbmNlb2YgQXJyYXkmJmZ1bmN0aW9uKHgsUil7eC5fX3Byb3RvX189Un18fGZ1bmN0aW9uKHgsUil7Zm9yKHZhciBfIGluIFIpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKFIsXykmJih4W19dPVJbX10pfSkoSCxQKX0sZnVuY3Rpb24oSCxQKXtpZih0eXBlb2YgUCE9ImZ1bmN0aW9uIiYmUCE9PW51bGwpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSAiK1N0cmluZyhQKSsiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGwiKTtmdW5jdGlvbiB4KCl7dGhpcy5jb25zdHJ1Y3Rvcj1IfW0oSCxQKSxILnByb3RvdHlwZT1QPT09bnVsbD9PYmplY3QuY3JlYXRlKFApOih4LnByb3RvdHlwZT1QLnByb3RvdHlwZSxuZXcgeCl9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkodSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdS5FeGNlcHRpb25BbGlhcz11LkRpcmVjdEV4Y2VwdGlvbkJpbmRpbmc9dS5EYXRhdHlwZUJpbmRpbmc9dS5UeXBlQmluZGluZz11LkZ1bmN0aW9uVmFsdWVCaW5kaW5nPXUuVmFsdWVCaW5kaW5nPXUuTm9uZml4RGVjbGFyYXRpb249dS5JbmZpeFJEZWNsYXJhdGlvbj11LkluZml4RGVjbGFyYXRpb249dS5BYnN0eXBlRGVjbGFyYXRpb249dS5FdmFsdWF0aW9uPXUuRnVuY3Rpb25EZWNsYXJhdGlvbj11LlNlcXVlbnRpYWxEZWNsYXJhdGlvbj11LkVtcHR5RGVjbGFyYXRpb249dS5PcGVuRGVjbGFyYXRpb249dS5Mb2NhbERlY2xhcmF0aW9uPXUuRXhjZXB0aW9uRGVjbGFyYXRpb249dS5EYXRhdHlwZVJlcGxpY2F0aW9uPXUuRGF0YXR5cGVEZWNsYXJhdGlvbj11LlR5cGVEZWNsYXJhdGlvbj11LlZhbHVlRGVjbGFyYXRpb249dS5EZWNsYXJhdGlvbj12b2lkIDA7dmFyIHM9Syg0OTQpLHE9Syg1MzQpLEI9Syg2OTkpLE09SygzNjcpLFY9Syg3NTgpLEQ9SygxMDYpLGg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBIKCl7fXJldHVybiBILnByb3RvdHlwZS5lbGFib3JhdGU9ZnVuY3Rpb24oUCx4LFIsXyxXLFEpe3Rocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiTm90IHlldCBpbXBsZW1lbnRlZC4iKX0sSC5wcm90b3R5cGUuZXZhbHVhdGU9ZnVuY3Rpb24oUCx4KXt0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIk5vdCB5ZXQgaW1wbGVtZW50ZWQuIil9LEgucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7dGhyb3cgbmV3IFYuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJOb3QgeWV0IGltcGxlbWVudGVkLiIpfSxILnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3Rocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiTm90IHlldCBpbXBsZW1lbnRlZC4iKX0sSC5wcm90b3R5cGUuYXNzZXJ0VW5pcXVlQmluZGluZz1mdW5jdGlvbihQLHgpe3JldHVybiBuZXcgU2V0fSxIfSgpO3UuRGVjbGFyYXRpb249aDt2YXIgQT1mdW5jdGlvbihIKXtmdW5jdGlvbiBQKHgsUixfKXtfPT09dm9pZCAwJiYoXz0wKTt2YXIgVz1ILmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIFcudHlwZVZhcmlhYmxlU2VxdWVuY2U9eCxXLnZhbHVlQmluZGluZz1SLFcuaWQ9XyxXfXJldHVybiBnKFAsSCksUC5wcm90b3R5cGUuYXNzZXJ0VW5pcXVlQmluZGluZz1mdW5jdGlvbih4LFIpe2Zvcih2YXIgXz0wO188dGhpcy52YWx1ZUJpbmRpbmcubGVuZ3RoOysrXyl0aGlzLnZhbHVlQmluZGluZ1tfXS5wYXR0ZXJuLmFzc2VydFVuaXF1ZUJpbmRpbmcoeCxSKSx0aGlzLnZhbHVlQmluZGluZ1tfXS5leHByZXNzaW9uLmFzc2VydFVuaXF1ZUJpbmRpbmcoeCxSKTtyZXR1cm4gbmV3IFNldH0sUC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtmb3IodmFyIHg9W10sUj0wO1I8dGhpcy52YWx1ZUJpbmRpbmcubGVuZ3RoOysrUil4LnB1c2gobmV3IHAodGhpcy52YWx1ZUJpbmRpbmdbUl0uaXNSZWN1cnNpdmUsdGhpcy52YWx1ZUJpbmRpbmdbUl0ucGF0dGVybi5zaW1wbGlmeSgpLHRoaXMudmFsdWVCaW5kaW5nW1JdLmV4cHJlc3Npb24uc2ltcGxpZnkoKSkpO3JldHVybiBuZXcgUCh0aGlzLnR5cGVWYXJpYWJsZVNlcXVlbmNlLHgsdGhpcy5pZCl9LFAucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbih4LFIsXyxXLFEsbmUpe2Zvcih2YXIgRj1bXSxiPVtdLGw9W10sdD1bXSxuPVIsaT0wLGE9ZnVuY3Rpb24oKXtpZihmLnZhbHVlQmluZGluZ1tpXS5pc1JlY3Vyc2l2ZSl7Zm9yKHZhciB1ZT1pO3VlPGYudmFsdWVCaW5kaW5nLmxlbmd0aDsrK3VlKXtmb3IodmFyIGllPWYudmFsdWVCaW5kaW5nW3VlXS5wYXR0ZXJuO2llIGluc3RhbmNlb2Ygcy5UeXBlZEV4cHJlc3Npb247KWllPWllLmV4cHJlc3Npb247dmFyIHBlPWllLm5hbWUuZ2V0VGV4dCgpO0YucHVzaChbcGUsbmV3IEIuVHlwZVZhcmlhYmxlQmluZCgiJ2EiLG5ldyBCLlR5cGVWYXJpYWJsZUJpbmQoIidiIixuZXcgQi5GdW5jdGlvblR5cGUobmV3IEIuVHlwZVZhcmlhYmxlKCInYSIpLG5ldyBCLlR5cGVWYXJpYWJsZSgiJ2IiKSkpKV0pfXJldHVybiJicmVhayJ9dmFyIHJlPSExO3RyeXt2YXIgYWU9eC5nZXROZXN0ZWRTdGF0ZSh4LmlkKSxjZT1uZXcgTWFwO24uZm9yRWFjaChmdW5jdGlvbihoZSxnZSl7Y2U9Y2Uuc2V0KGdlLGhlKX0pO3ZhciBsZT1uZXcgTWFwO1cuZm9yRWFjaChmdW5jdGlvbihoZSxnZSl7bGU9bGUuc2V0KGdlLG51bGwpfSksZi52YWx1ZUJpbmRpbmdbaV0uZ2V0VHlwZShmLnR5cGVWYXJpYWJsZVNlcXVlbmNlLGFlLGNlLF8sbGUsUSl9Y2F0Y2h7cmU9ITB9dmFyIGRlPWYudmFsdWVCaW5kaW5nW2ldLmdldFR5cGUoZi50eXBlVmFyaWFibGVTZXF1ZW5jZSx4LG4sXyxXLFEpO2Zvcih0PXQuY29uY2F0KGRlWzFdKSxuPWRlWzJdLF89ZGVbM10seC52YWx1ZUlkZW50aWZpZXJJZD1kZVs0XSx1ZT0wO3VlPGRlWzBdLmxlbmd0aDsrK3VlKWwucHVzaChyZSksYi5wdXNoKGRlWzBdW3VlXSl9LGY9dGhpcztpPHRoaXMudmFsdWVCaW5kaW5nLmxlbmd0aCYmYSgpIT09ImJyZWFrIjsrK2kpO2Zvcih2YXIgUz14LmdldE5lc3RlZFN0YXRlKHguaWQpLEw9MDtMPEYubGVuZ3RoOysrTCl7aWYoIShuZSYmbmUuYWxsb3dTdWNjZXNzb3JNTD09PSEwfHxGW0xdWzFdLmlzUmVzb2x2ZWQoKSkpdGhyb3cgbmV3IFYuRWxhYm9yYXRpb25FcnJvcigiVW5yZXNvbHZlZCByZWNvcmQgdHlwZTogTXVsdGlwbGUgbm9uLWFncmVlaW5nIHR5cGVzIHBvc3NpYmxlLiIpO1Muc2V0U3RhdGljVmFsdWUoRltMXVswXSxGW0xdWzFdLE0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSl9dmFyIGs9dCxVPW5ldyBNYXA7bi5mb3JFYWNoKGZ1bmN0aW9uKHVlLGllKXtVPVUuc2V0KGllLHVlKX0pO2Zvcih2YXIgaj1fLFg9Uy52YWx1ZUlkZW50aWZpZXJJZCxaPXRoaXMudmFsdWVCaW5kaW5nLmxlbmd0aC1pKzEsZWU9MDtlZTxaKlorMTsrK2VlKXt0PWssbj1uZXcgTWFwLFUuZm9yRWFjaChmdW5jdGlvbih1ZSxpZSl7bj1uLnNldChpZSx1ZSl9KSxfPWosUy52YWx1ZUlkZW50aWZpZXJJZD1YO3ZhciB0ZT0hMSxvZT1mdW5jdGlvbih1ZSl7dmFyIGllPSExO2lmKCFRKXRyeXt2YXIgcGU9Uy5nZXROZXN0ZWRTdGF0ZSh4LmlkKSxyZT1uZXcgTWFwO24uZm9yRWFjaChmdW5jdGlvbihkZSxoZSl7cmU9cmUuc2V0KGhlLGRlKX0pLHNlLnZhbHVlQmluZGluZ1t1ZV0uZ2V0VHlwZShzZS50eXBlVmFyaWFibGVTZXF1ZW5jZSxwZSxyZSxfLG5ldyBNYXAsUSl9Y2F0Y2h7aWU9ITB9dmFyIGFlPXNlLnZhbHVlQmluZGluZ1t1ZV0uZ2V0VHlwZShzZS50eXBlVmFyaWFibGVTZXF1ZW5jZSxTLG4sXyxXLFEpO3Q9dC5jb25jYXQoYWVbMV0pLG49YWVbMl0sXz1hZVszXSxTLnZhbHVlSWRlbnRpZmllcklkPWFlWzRdO2Zvcih2YXIgY2U9MDtjZTxhZVswXS5sZW5ndGg7KytjZSl7dmFyIGxlPVMuZ2V0U3RhdGljVmFsdWUoYWVbMF1bY2VdWzBdKTtpZihsZSE9PXZvaWQgMCYmbGVbMF0ubm9ybWFsaXplKClbMF0uZXF1YWxzKGFlWzBdW2NlXVsxXS5ub3JtYWxpemUoKVswXSl8fCh0ZT0hMCksIShuZSYmbmUuYWxsb3dTdWNjZXNzb3JNTD09PSEwfHxhZVswXVtjZV1bMV0uaXNSZXNvbHZlZCgpKSl0aHJvdyBuZXcgVi5FbGFib3JhdGlvbkVycm9yKCJVbnJlc29sdmVkIHJlY29yZCB0eXBlOiBNdWx0aXBsZSBub24tYWdyZWVpbmcgdHlwZXMgcG9zc2libGUuIik7aWV8fChXPVcuc2V0KGFlWzBdW2NlXVswXSxhZVswXVtjZV1bMV0pKSxTLnNldFN0YXRpY1ZhbHVlKGFlWzBdW2NlXVswXSxhZVswXVtjZV1bMV0sTS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKX19LHNlPXRoaXM7Zm9yKEw9aTtMPHRoaXMudmFsdWVCaW5kaW5nLmxlbmd0aDsrK0wpb2UoTCk7aWYoIXRlKWJyZWFrO2lmKGVlPT09WipaKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoIk15IGJyYWluIHRyZW1ibGVzOyB0b28gbXVjaCBjaXJjdWxhcml0eS4iKX1mb3IoTD0wO0w8Yi5sZW5ndGg7KytMKXtpZighKG5lJiZuZS5hbGxvd1N1Y2Nlc3Nvck1MPT09ITB8fGJbTF1bMV0uaXNSZXNvbHZlZCgpKSl0aHJvdyBuZXcgVi5FbGFib3JhdGlvbkVycm9yKCJVbnJlc29sdmVkIHJlY29yZCB0eXBlOiBNdWx0aXBsZSBub24tYWdyZWVpbmcgdHlwZXMgcG9zc2libGUuIik7bFtMXXx8KFc9Vy5zZXQoYltMXVswXSxiW0xdWzFdKSksUy5zZXRTdGF0aWNWYWx1ZShiW0xdWzBdLGJbTF1bMV0sTS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKX1yZXR1cm5bUyx0LG4sX119LFAucHJvdG90eXBlLmV2YWx1YXRlPWZ1bmN0aW9uKHgsUil7dmFyIF89eC5zdGF0ZTt4LnN0ZXA9PT12b2lkIDAmJih4LnJlc3VsdD1bXSx4LnJlY3Vyc2l2ZXM9W10seC5pc1JlYz0hMSx4LnN0ZXA9LTEpO3ZhciBXPXgucmVzdWx0LFE9eC5yZWN1cnNpdmVzLG5lPXguaXNSZWMsRj14LnN0ZXA7aWYoRj49MCl7dmFyIGI9eC5yZWNSZXN1bHQ7aWYoYj09PXZvaWQgMCl0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIkhvdyBpcyB0aGlzIHVuZGVmaW5lZD8gIitKU09OLnN0cmluZ2lmeShiKSk7aWYodGhpcy52YWx1ZUJpbmRpbmdbRl0uaXNSZWN1cnNpdmUmJihuZT0hMCksYi5oYXNUaHJvd24pcmV0dXJue25ld1N0YXRlOl8sdmFsdWU6Yi52YWx1ZSxoYXNUaHJvd246ITB9O3ZhciBsPXRoaXMudmFsdWVCaW5kaW5nW0ZdLnBhdHRlcm4ubWF0Y2hlcyhfLGIudmFsdWUpO2lmKGw9PT12b2lkIDApcmV0dXJue25ld1N0YXRlOl8sdmFsdWU6bmV3IEQuRXhjZXB0aW9uVmFsdWUoIkJpbmQiLHZvaWQgMCwwLDEpLGhhc1Rocm93bjohMH07Zm9yKHZhciB0PTA7dDxsLmxlbmd0aDsrK3QpbmU/US5wdXNoKGxbdF0pOlcucHVzaChsW3RdKX1pZigrK0Y8dGhpcy52YWx1ZUJpbmRpbmcubGVuZ3RoKXJldHVybiB4LnN0ZXA9Rix4LmlzUmVjPW5lLFIucHVzaCh7bmV4dDp0aGlzLHBhcmFtczp4fSksdm9pZCBSLnB1c2goe25leHQ6dGhpcy52YWx1ZUJpbmRpbmdbRl0uZXhwcmVzc2lvbixwYXJhbXM6e3N0YXRlOl8sbW9kaWZpYWJsZTp4Lm1vZGlmaWFibGUscmVjUmVzdWx0OnZvaWQgMH19KTt2YXIgbj1fLmdldE5lc3RlZFN0YXRlKF8uaWQpO2Zvcih0PTA7dDxRLmxlbmd0aDsrK3Qpe2lmKFFbdF1bMF09PT0iPSIpdGhyb3cgbmV3IFYuRXZhbHVhdGlvbkVycm9yKCJBbGwgZGVjbGFyYXRpb25zIGFyZSBlcXVhbCwgYnV0IHNvbWUgZGVjbGFyYXRpb25zIGFyZSBtb3JlIGVxdWFsIHRoYW4gb3RoZXJzLiIpO1FbdF1bMV1pbnN0YW5jZW9mIEQuRnVuY3Rpb25WYWx1ZT9uLnNldER5bmFtaWNWYWx1ZShRW3RdWzBdLG5ldyBELkZ1bmN0aW9uVmFsdWUoUVt0XVsxXS5zdGF0ZSxRLFFbdF1bMV0uYm9keSksTS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKTpuLnNldER5bmFtaWNWYWx1ZShRW3RdWzBdLFFbdF1bMV0sTS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKX1mb3IodD0wO3Q8Vy5sZW5ndGg7Kyt0KXtpZihXW3RdWzBdPT09Ij0iKXRocm93IG5ldyBWLkV2YWx1YXRpb25FcnJvcigiQWxsIGRlY2xhcmF0aW9ucyBhcmUgZXF1YWwsIGJ1dCBzb21lIGRlY2xhcmF0aW9ucyBhcmUgbW9yZSBlcXVhbCB0aGFuIG90aGVycy4iKTtuLnNldER5bmFtaWNWYWx1ZShXW3RdWzBdLFdbdF1bMV0sTS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKX1yZXR1cm57bmV3U3RhdGU6bix2YWx1ZTp2b2lkIDAsaGFzVGhyb3duOiExfX0sUC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtmb3IodmFyIHg9InZhbCIsUj0wO1I8dGhpcy50eXBlVmFyaWFibGVTZXF1ZW5jZS5sZW5ndGg7KytSKXgrPSIgIit0aGlzLnR5cGVWYXJpYWJsZVNlcXVlbmNlLnRvU3RyaW5nKCk7Zm9yKFI9MDtSPHRoaXMudmFsdWVCaW5kaW5nLmxlbmd0aDsrK1IpUj4wJiYoeCs9IiBhbmQiKSx4Kz0iICIrdGhpcy52YWx1ZUJpbmRpbmdbUl07cmV0dXJuIHgrIjsifSxQfShoKTt1LlZhbHVlRGVjbGFyYXRpb249QTt2YXIgST1mdW5jdGlvbihIKXtmdW5jdGlvbiBQKHgsUil7Uj09PXZvaWQgMCYmKFI9MCk7dmFyIF89SC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBfLnR5cGVCaW5kaW5nPXgsXy5pZD1SLF99cmV0dXJuIGcoUCxIKSxQLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe2Zvcih2YXIgeD1bXSxSPTA7Ujx0aGlzLnR5cGVCaW5kaW5nLmxlbmd0aDsrK1IpeC5wdXNoKG5ldyB3KHRoaXMudHlwZUJpbmRpbmdbUl0udHlwZVZhcmlhYmxlU2VxdWVuY2UsdGhpcy50eXBlQmluZGluZ1tSXS5uYW1lLHRoaXMudHlwZUJpbmRpbmdbUl0udHlwZS5zaW1wbGlmeSgpKSk7cmV0dXJuIG5ldyBQKHgsdGhpcy5pZCl9LFAucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbih4LFIsXyxXLFEsbmUpe2Zvcih2YXIgRj1mdW5jdGlvbih0KXtmb3IodmFyIG49bmV3IFNldCxpPVtdLGE9MCxmPWIudHlwZUJpbmRpbmdbdF0udHlwZVZhcmlhYmxlU2VxdWVuY2U7YTxmLmxlbmd0aDthKyspe3ZhciBTPWZbYV07bj1uLmFkZChTLnRvU3RyaW5nKCkpfWlmKGIudHlwZUJpbmRpbmdbdF0udHlwZS5pbnN0YW50aWF0ZSh4LFIpLmdldFR5cGVWYXJpYWJsZXMoKS5mb3JFYWNoKGZ1bmN0aW9uKGssVSl7bi5oYXMoVSl8fGkucHVzaChVKX0pLGkubGVuZ3RoPjApdGhyb3cgVi5FbGFib3JhdGlvbkVycm9yLmdldFVuZ3VhcmRlZChpKTt2YXIgTD14LmdldFN0YXRpY1R5cGUoYi50eXBlQmluZGluZ1t0XS5uYW1lLmdldFRleHQoKSk7aWYoTCE9PXZvaWQgMCYmTC50eXBlIGluc3RhbmNlb2YgQi5DdXN0b21UeXBlKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoIk5uYWFhfiBSZWRlZmluaW5nIHR5cGVzIGFzIGFsaWFzZXMgaXMgbm90IHlldCBpbXBsZW1lbnRlZC4iKTt4LnNldFN0YXRpY1R5cGUoYi50eXBlQmluZGluZ1t0XS5uYW1lLmdldFRleHQoKSxuZXcgQi5GdW5jdGlvblR5cGUobmV3IEIuQ3VzdG9tVHlwZShiLnR5cGVCaW5kaW5nW3RdLm5hbWUuZ2V0VGV4dCgpLGIudHlwZUJpbmRpbmdbdF0udHlwZVZhcmlhYmxlU2VxdWVuY2UpLGIudHlwZUJpbmRpbmdbdF0udHlwZS5pbnN0YW50aWF0ZSh4LFIpKSxbXSxiLnR5cGVCaW5kaW5nW3RdLnR5cGVWYXJpYWJsZVNlcXVlbmNlLmxlbmd0aCwhMCl9LGI9dGhpcyxsPTA7bDx0aGlzLnR5cGVCaW5kaW5nLmxlbmd0aDsrK2wpRihsKTtyZXR1cm5beCxbXSxSLF9dfSxQLnByb3RvdHlwZS5ldmFsdWF0ZT1mdW5jdGlvbih4LFIpe2Zvcih2YXIgXz14LnN0YXRlLFc9MDtXPHRoaXMudHlwZUJpbmRpbmcubGVuZ3RoOysrVylfLnNldER5bmFtaWNUeXBlKHRoaXMudHlwZUJpbmRpbmdbV10ubmFtZS5nZXRUZXh0KCksW10pO3JldHVybntuZXdTdGF0ZTpfLHZhbHVlOnZvaWQgMCxoYXNUaHJvd246ITF9fSxQLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe2Zvcih2YXIgeD0idHlwZSIsUj0wO1I8dGhpcy50eXBlQmluZGluZy5sZW5ndGg7KytSKVI+MCYmKHgrPSIgYW5kIikseCs9IiA8c3R1ZmY+ICIrdGhpcy50eXBlQmluZGluZ1tSXS5uYW1lLmdldFRleHQoKSx4Kz0iID0gIit0aGlzLnR5cGVCaW5kaW5nW1JdLnR5cGU7cmV0dXJuIHgrIjsifSxQfShoKTt1LlR5cGVEZWNsYXJhdGlvbj1JO3ZhciBPPWZ1bmN0aW9uKEgpe2Z1bmN0aW9uIFAoeCxSLF8sVyl7Xz09PXZvaWQgMCYmKF89MCksVz09PXZvaWQgMCYmKFc9e30pO3ZhciBRPUguY2FsbCh0aGlzKXx8dGhpcztpZihRLmRhdGF0eXBlQmluZGluZz14LFEudHlwZUJpbmRpbmc9UixRLmlkPV8sUS5naXZlbklkcz1XLFEudHlwZUJpbmRpbmchPT12b2lkIDApdGhyb3cgbmV3IFYuRmVhdHVyZURpc2FibGVkRXJyb3IoJ1dobyBpcyAid2l0aHR5cGUiPycpO3JldHVybiBRfXJldHVybiBnKFAsSCksUC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtmb3IodmFyIHg9W10sUj0wO1I8dGhpcy5kYXRhdHlwZUJpbmRpbmcubGVuZ3RoOysrUil7Zm9yKHZhciBfPVtdLFc9MDtXPHRoaXMuZGF0YXR5cGVCaW5kaW5nW1JdLnR5cGUubGVuZ3RoOysrVyl0aGlzLmRhdGF0eXBlQmluZGluZ1tSXS50eXBlW1ddWzFdIT09dm9pZCAwP18ucHVzaChbdGhpcy5kYXRhdHlwZUJpbmRpbmdbUl0udHlwZVtXXVswXSx0aGlzLmRhdGF0eXBlQmluZGluZ1tSXS50eXBlW1ddWzFdLnNpbXBsaWZ5KCldKTpfLnB1c2godGhpcy5kYXRhdHlwZUJpbmRpbmdbUl0udHlwZVtXXSk7eC5wdXNoKG5ldyBUKHRoaXMuZGF0YXR5cGVCaW5kaW5nW1JdLnR5cGVWYXJpYWJsZVNlcXVlbmNlLHRoaXMuZGF0YXR5cGVCaW5kaW5nW1JdLm5hbWUsXykpfXJldHVybiBuZXcgUCh4LHZvaWQgMCx0aGlzLmlkKX0sUC5wcm90b3R5cGUuZWxhYm9yYXRlPWZ1bmN0aW9uKHgsUixfLFcsUSxuZSl7Zm9yKHZhciBGPVtdLGI9MDtiPHRoaXMuZGF0YXR5cGVCaW5kaW5nLmxlbmd0aDsrK2Ipe3ZhciBsPXRoaXMuZGF0YXR5cGVCaW5kaW5nW2JdLmdldFR5cGUoeCxRLFcsITApO3guc2V0U3RhdGljVHlwZShsWzJdWzBdLGxbMV0sbFsyXVsxXSx0aGlzLmRhdGF0eXBlQmluZGluZ1tiXS50eXBlVmFyaWFibGVTZXF1ZW5jZS5sZW5ndGgsITApO2Zvcih2YXIgdD0wO3Q8bFswXS5sZW5ndGg7Kyt0KXguc2V0U3RhdGljVmFsdWUobFswXVt0XVswXSxsWzBdW3RdWzFdLE0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9DT05TVFJVQ1RPUil9Zm9yKGI9MDtiPHRoaXMuZGF0YXR5cGVCaW5kaW5nLmxlbmd0aDsrK2Ipe2ZvcihsPXRoaXMuZGF0YXR5cGVCaW5kaW5nW2JdLmdldFR5cGUoeCxRLFcpLHQ9MDt0PGxbMF0ubGVuZ3RoOysrdCl7aWYoIU0uU3RhdGUuYWxsb3dzUmViaW5kKGxbMF1bdF1bMF0pKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoJ1lvdSBzaW1wbHkgY2Fubm90IHJlYmluZCAiJytsWzBdW3RdWzBdKyciLicpO0YucHVzaChsWzBdW3RdWzFdKSx4LnNldFN0YXRpY1ZhbHVlKGxbMF1bdF1bMF0sbFswXVt0XVsxXSxNLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfQ09OU1RSVUNUT1IpfXguc2V0U3RhdGljVHlwZShsWzJdWzBdLGxbMV0sbFsyXVsxXSx0aGlzLmRhdGF0eXBlQmluZGluZ1tiXS50eXBlVmFyaWFibGVTZXF1ZW5jZS5sZW5ndGgsITApLHguaW5jcmVtZW50VmFsdWVJZGVudGlmaWVySWQobFsyXVswXSl9Zm9yKGI9MDtiPEYubGVuZ3RoOysrYilGW2JdLmluc3RhbnRpYXRlKHgsbmV3IE1hcCk7cmV0dXJuW3gsW10sUixfXX0sUC5wcm90b3R5cGUuZXZhbHVhdGU9ZnVuY3Rpb24oeCxSKXtmb3IodmFyIF89eC5zdGF0ZSxXPXgubW9kaWZpYWJsZSxRPTA7UTx0aGlzLmRhdGF0eXBlQmluZGluZy5sZW5ndGg7KytRKXtmb3IodmFyIG5lPXRoaXMuZGF0YXR5cGVCaW5kaW5nW1FdLmNvbXB1dGUoXyxXKSxGPTA7RjxuZVswXS5sZW5ndGg7KytGKXtpZighTS5TdGF0ZS5hbGxvd3NSZWJpbmQobmVbMF1bRl1bMF0pKXRocm93IG5ldyBWLkV2YWx1YXRpb25FcnJvcignWW91IHNpbXBseSBjYW5ub3QgcmViaW5kICInK25lWzBdW0ZdWzBdKyciLicpO18uc2V0RHluYW1pY1ZhbHVlKG5lWzBdW0ZdWzBdLG5lWzBdW0ZdWzFdLE0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9DT05TVFJVQ1RPUil9Xy5zZXREeW5hbWljVHlwZShuZVsxXVswXSxuZVsxXVsxXSksdGhpcy5naXZlbklkc1tuZVsxXVswXV09PT12b2lkIDAmJihXLmluY3JlbWVudFZhbHVlSWRlbnRpZmllcklkKG5lWzFdWzBdKSx0aGlzLmdpdmVuSWRzW25lWzFdWzBdXT1fLmdldFZhbHVlSWRlbnRpZmllcklkKG5lWzFdWzBdKSl9cmV0dXJue25ld1N0YXRlOl8sdmFsdWU6dm9pZCAwLGhhc1Rocm93bjohMX19LFAucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7Zm9yKHZhciB4PSJkYXRhdHlwZSIsUj0wO1I8dGhpcy5kYXRhdHlwZUJpbmRpbmcubGVuZ3RoOysrUil7Uj4wJiYoeCs9IiBhbmQiKSx4Kz0iICIrdGhpcy5kYXRhdHlwZUJpbmRpbmdbUl0ubmFtZS5nZXRUZXh0KCkrIiA9Ijtmb3IodmFyIF89MDtfPHRoaXMuZGF0YXR5cGVCaW5kaW5nW1JdLnR5cGUubGVuZ3RoOysrXylfPjAmJih4Kz0iIHwiKSx4Kz0iICIrdGhpcy5kYXRhdHlwZUJpbmRpbmdbUl0udHlwZVtfXVswXS5nZXRUZXh0KCksdGhpcy5kYXRhdHlwZUJpbmRpbmdbUl0udHlwZVtfXVsxXSE9PXZvaWQgMCYmKHgrPSIgb2YgIit0aGlzLmRhdGF0eXBlQmluZGluZ1tSXS50eXBlW19dWzFdKX1yZXR1cm4geCsiOyJ9LFB9KGgpO3UuRGF0YXR5cGVEZWNsYXJhdGlvbj1PO3ZhciBFPWZ1bmN0aW9uKEgpe2Z1bmN0aW9uIFAoeCxSLF8pe189PT12b2lkIDAmJihfPTApO3ZhciBXPUguY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gVy5uYW1lPXgsVy5vbGRuYW1lPVIsVy5pZD1fLFd9cmV0dXJuIGcoUCxIKSxQLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSxQLnByb3RvdHlwZS5lbGFib3JhdGU9ZnVuY3Rpb24oeCxSLF8sVyxRLG5lKXt2YXIgRj12b2lkIDA7aWYodGhpcy5vbGRuYW1lIGluc3RhbmNlb2YgcS5Mb25nSWRlbnRpZmllclRva2VuKXt2YXIgYj14LmdldEFuZFJlc29sdmVTdGF0aWNTdHJ1Y3R1cmUodGhpcy5vbGRuYW1lKTtiIT09dm9pZCAwJiYoRj1iLmdldFR5cGUodGhpcy5vbGRuYW1lLmlkLmdldFRleHQoKSkpfWVsc2UgRj14LmdldFN0YXRpY1R5cGUodGhpcy5vbGRuYW1lLmdldFRleHQoKSk7aWYoRj09PXZvaWQgMCl0aHJvdyBuZXcgVi5FbGFib3JhdGlvbkVycm9yKCdUaGUgZGF0YXR5cGUgIicrdGhpcy5vbGRuYW1lLmdldFRleHQoKStgIiBkb2Vzbid0IGV4aXN0LmApO3ZhciBsPUYudHlwZS5pbnN0YW50aWF0ZSh4LFIpO3JldHVybiB4LnNldFN0YXRpY1R5cGUodGhpcy5uYW1lLmdldFRleHQoKSxuZXcgQi5GdW5jdGlvblR5cGUobmV3IEIuQ3VzdG9tVHlwZSh0aGlzLm5hbWUuZ2V0VGV4dCgpLGwudHlwZUFyZ3VtZW50cyx0aGlzLm9sZG5hbWUgaW5zdGFuY2VvZiBxLkxvbmdJZGVudGlmaWVyVG9rZW4/dGhpcy5vbGRuYW1lOnZvaWQgMCksbCksW10sRi5hcml0eSxGLmFsbG93c0VxdWFsaXR5KSxbeCxbXSxSLF9dfSxQLnByb3RvdHlwZS5ldmFsdWF0ZT1mdW5jdGlvbih4LFIpe3ZhciBfPXguc3RhdGUsVz1bXTtpZih0aGlzLm9sZG5hbWUgaW5zdGFuY2VvZiBxLkxvbmdJZGVudGlmaWVyVG9rZW4pe3ZhciBRPV8uZ2V0QW5kUmVzb2x2ZUR5bmFtaWNTdHJ1Y3R1cmUodGhpcy5vbGRuYW1lKTtRIT09dm9pZCAwJiYoVz1RLmdldFR5cGUodGhpcy5vbGRuYW1lLmlkLmdldFRleHQoKSkpfWVsc2UgVz1fLmdldER5bmFtaWNUeXBlKHRoaXMub2xkbmFtZS5nZXRUZXh0KCkpO2lmKFc9PT12b2lkIDApdGhyb3cgbmV3IFYuRXZhbHVhdGlvbkVycm9yKCdUaGUgZGF0YXR5cGUgIicrdGhpcy5vbGRuYW1lLmdldFRleHQoKSsnIiBkb2VzIG5vdCBleGlzdC4nKTtyZXR1cm4gXy5zZXREeW5hbWljVHlwZSh0aGlzLm5hbWUuZ2V0VGV4dCgpLFcpLHtuZXdTdGF0ZTpfLHZhbHVlOnZvaWQgMCxoYXNUaHJvd246ITF9fSxQLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiJkYXRhdHlwZSAiK3RoaXMubmFtZS5nZXRUZXh0KCkrIiA9IGRhdGF0eXBlICIrdGhpcy5vbGRuYW1lLmdldFRleHQoKSsiOyJ9LFB9KGgpO3UuRGF0YXR5cGVSZXBsaWNhdGlvbj1FO3ZhciByPWZ1bmN0aW9uKEgpe2Z1bmN0aW9uIFAoeCxSKXtSPT09dm9pZCAwJiYoUj0wKTt2YXIgXz1ILmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIF8uYmluZGluZ3M9eCxfLmlkPVIsX31yZXR1cm4gZyhQLEgpLFAucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LFAucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuImV4Y2VwdGlvbiA8c3R1ZmY+OyJ9LFAucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbih4LFIsXyxXLFEsbmUpe3ZhciBGPW5ldyBTZXQ7Ui5mb3JFYWNoKGZ1bmN0aW9uKGwsdCl7dC5pbmNsdWRlcygiISIpJiYoRj1GLmFkZCh0LnN1YnN0cmluZygxKSkpfSk7Zm9yKHZhciBiPTA7Yjx0aGlzLmJpbmRpbmdzLmxlbmd0aDsrK2IpeD10aGlzLmJpbmRpbmdzW2JdLmVsYWJvcmF0ZSh4LFEsRixuZSk7cmV0dXJuW3gsW10sUixfXX0sUC5wcm90b3R5cGUuZXZhbHVhdGU9ZnVuY3Rpb24oeCxSKXtmb3IodmFyIF89eC5zdGF0ZSxXPTA7Vzx0aGlzLmJpbmRpbmdzLmxlbmd0aDsrK1cpdGhpcy5iaW5kaW5nc1tXXS5ldmFsdWF0ZShfLHgubW9kaWZpYWJsZSk7cmV0dXJue25ld1N0YXRlOl8sdmFsdWU6dm9pZCAwLGhhc1Rocm93bjohMX19LFB9KGgpO3UuRXhjZXB0aW9uRGVjbGFyYXRpb249cjt2YXIgZT1mdW5jdGlvbihIKXtmdW5jdGlvbiBQKHgsUixfKXtfPT09dm9pZCAwJiYoXz0wKTt2YXIgVz1ILmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIFcuZGVjbGFyYXRpb249eCxXLmJvZHk9UixXLmlkPV8sV31yZXR1cm4gZyhQLEgpLFAucHJvdG90eXBlLmFzc2VydFVuaXF1ZUJpbmRpbmc9ZnVuY3Rpb24oeCxSKXtyZXR1cm4gdGhpcy5kZWNsYXJhdGlvbi5hc3NlcnRVbmlxdWVCaW5kaW5nKHgsUiksdGhpcy5ib2R5LmFzc2VydFVuaXF1ZUJpbmRpbmcoeCxSKSxuZXcgU2V0fSxQLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiBuZXcgUCh0aGlzLmRlY2xhcmF0aW9uLnNpbXBsaWZ5KCksdGhpcy5ib2R5LnNpbXBsaWZ5KCksdGhpcy5pZCl9LFAucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbih4LFIsXyxXLFEsbmUpe3ZhciBGPVt4LmdldE5lc3RlZFN0YXRlKDApLmdldE5lc3RlZFN0YXRlKHguaWQpLFtdLFIsX10sYj1uZXcgTWFwO1cuZm9yRWFjaChmdW5jdGlvbihuLGkpe2I9Yi5zZXQoaSxuKX0pO3ZhciBsPXRoaXMuZGVjbGFyYXRpb24uZWxhYm9yYXRlKEZbMF0sUixfLGIsITEsbmUpO3gudmFsdWVJZGVudGlmaWVySWQ9bFswXS5nZXRJZENoYW5nZXMoMCk7dmFyIHQ9bFswXS5nZXROZXN0ZWRTdGF0ZSh4LmlkKTtyZXR1cm4gRj10aGlzLmJvZHkuZWxhYm9yYXRlKHQsbFsyXSxsWzNdLGIsUSxuZSksdC5wYXJlbnQ9eCxbRlswXSxsWzFdLmNvbmNhdChGWzFdKSxGWzJdLEZbM11dfSxQLnByb3RvdHlwZS5ldmFsdWF0ZT1mdW5jdGlvbih4LFIpe3ZhciBfPXguc3RhdGUsVz14Lm1vZGlmaWFibGU7eC5zdGVwPT09dm9pZCAwJiYoeC5zdGVwPS0xKTt2YXIgUT14LnN0ZXA7aWYoUT09PS0xKXt2YXIgbmU9Xy5nZXROZXN0ZWRTdGF0ZSgwKSxGPW5lLmdldE5lc3RlZFN0YXRlKF8uaWQpO3JldHVybiBuZS5pbnNpZGVMb2NhbERlY2xCb2R5fHwobmUubG9jYWxEZWNsU3RhcnQ9ITApLHgubnN0YXRlPUYseC5zdGVwPVErMSxSLnB1c2goe25leHQ6dGhpcyxwYXJhbXM6eH0pLHZvaWQgUi5wdXNoKHtuZXh0OnRoaXMuZGVjbGFyYXRpb24scGFyYW1zOntzdGF0ZTpGLG1vZGlmaWFibGU6VyxyZWNSZXN1bHQ6dm9pZCAwfX0pfWlmKFE9PT0wKXtpZigodD14LnJlY1Jlc3VsdCk9PT12b2lkIDB8fHQubmV3U3RhdGU9PT12b2lkIDApdGhyb3cgbmV3IFYuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJIb3cgaXMgdGhpcyB1bmRlZmluZWQ/Iik7dmFyIGI9dC5uZXdTdGF0ZTtyZXR1cm4gdC5oYXNUaHJvd24/e25ld1N0YXRlOl8sdmFsdWU6dC52YWx1ZSxoYXNUaHJvd246ITB9OigoRj1iLmdldE5lc3RlZFN0YXRlKF8uaWQpKS5pbnNpZGVMb2NhbERlY2xCb2R5PSEwLHgubnN0YXRlPUYseC5yZXM9dCx4LnN0ZXA9USsxLFIucHVzaCh7bmV4dDp0aGlzLHBhcmFtczp4fSksdm9pZCBSLnB1c2goe25leHQ6dGhpcy5ib2R5LHBhcmFtczp7c3RhdGU6Rixtb2RpZmlhYmxlOlcscmVjUmVzdWx0OnZvaWQgMH19KSl9dmFyIGw9eC5yZWNSZXN1bHQsdD0oRj14Lm5zdGF0ZSx4LnJlcyk7aWYobD09PXZvaWQgMHx8dD09PXZvaWQgMCl0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIkhvdyBpcyB0aGlzIHVuZGVmaW5lZD8iKTtyZXR1cm4gRi5wYXJlbnQ9XyxsLm5ld1N0YXRlIT09dm9pZCAwJiYobC5uZXdTdGF0ZS5pbnNpZGVMb2NhbERlY2xCb2R5PV8uaW5zaWRlTG9jYWxEZWNsQm9keSksbH0sUC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgeD0ibG9jYWwgIit0aGlzLmRlY2xhcmF0aW9uO3JldHVybih4Kz0iIGluICIrdGhpcy5ib2R5KSsiIGVuZDsifSxQfShoKTt1LkxvY2FsRGVjbGFyYXRpb249ZTt2YXIgbz1mdW5jdGlvbihIKXtmdW5jdGlvbiBQKHgsUil7Uj09PXZvaWQgMCYmKFI9MCk7dmFyIF89SC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBfLm5hbWVzPXgsXy5pZD1SLF99cmV0dXJuIGcoUCxIKSxQLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSxQLnByb3RvdHlwZS5lbGFib3JhdGU9ZnVuY3Rpb24oeCxSLF8sVyxRLG5lKXtmb3IodmFyIEY9MDtGPHRoaXMubmFtZXMubGVuZ3RoOysrRil7dmFyIGI9dm9pZCAwO2lmKHRoaXMubmFtZXNbRl1pbnN0YW5jZW9mIHEuTG9uZ0lkZW50aWZpZXJUb2tlbj8oYj14LmdldEFuZFJlc29sdmVTdGF0aWNTdHJ1Y3R1cmUodGhpcy5uYW1lc1tGXSkpIT09dm9pZCAwJiYoYj1iLmdldFN0cnVjdHVyZSh0aGlzLm5hbWVzW0ZdLmlkLmdldFRleHQoKSkpOmI9eC5nZXRTdGF0aWNTdHJ1Y3R1cmUodGhpcy5uYW1lc1tGXS5nZXRUZXh0KCkpLGI9PT12b2lkIDApdGhyb3cgbmV3IFYuRXZhbHVhdGlvbkVycm9yKCdVbmRlZmluZWQgbW9kdWxlICInK3RoaXMubmFtZXNbRl0uZ2V0VGV4dCgpKyciLicpO3guc3RhdGljQmFzaXMuZXh0ZW5kKGIpfXJldHVyblt4LFtdLFIsX119LFAucHJvdG90eXBlLmV2YWx1YXRlPWZ1bmN0aW9uKHgsUil7Zm9yKHZhciBfPXguc3RhdGUsVz0wO1c8dGhpcy5uYW1lcy5sZW5ndGg7KytXKXt2YXIgUT12b2lkIDA7aWYodGhpcy5uYW1lc1tXXWluc3RhbmNlb2YgcS5Mb25nSWRlbnRpZmllclRva2VuPyhRPV8uZ2V0QW5kUmVzb2x2ZUR5bmFtaWNTdHJ1Y3R1cmUodGhpcy5uYW1lc1tXXSkpIT09dm9pZCAwJiYoUT1RLmdldFN0cnVjdHVyZSh0aGlzLm5hbWVzW1ddLmlkLmdldFRleHQoKSkpOlE9Xy5nZXREeW5hbWljU3RydWN0dXJlKHRoaXMubmFtZXNbV10uZ2V0VGV4dCgpKSxRPT09dm9pZCAwKXRocm93IG5ldyBWLkV2YWx1YXRpb25FcnJvcignVW5kZWZpbmVkIG1vZHVsZSAiJyt0aGlzLm5hbWVzW1ddLmdldFRleHQoKSsnIi4nKTtfLmR5bmFtaWNCYXNpcy5leHRlbmQoUSl9cmV0dXJue25ld1N0YXRlOl8sdmFsdWU6dm9pZCAwLGhhc1Rocm93bjohMX19LFAucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7Zm9yKHZhciB4PSJvcGVuIixSPTA7Ujx0aGlzLm5hbWVzLmxlbmd0aDsrK1IpeCs9IiAiK3RoaXMubmFtZXNbUl0uZ2V0VGV4dCgpO3JldHVybiB4KyI7In0sUH0oaCk7dS5PcGVuRGVjbGFyYXRpb249bzt2YXIgeT1mdW5jdGlvbihIKXtmdW5jdGlvbiBQKHgpe3g9PT12b2lkIDAmJih4PTApO3ZhciBSPUguY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gUi5pZD14LFJ9cmV0dXJuIGcoUCxIKSxQLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSxQLnByb3RvdHlwZS5lbGFib3JhdGU9ZnVuY3Rpb24oeCxSLF8sVyxRLG5lKXtyZXR1cm5beCxbXSxSLF9dfSxQLnByb3RvdHlwZS5ldmFsdWF0ZT1mdW5jdGlvbih4LFIpe3JldHVybntuZXdTdGF0ZTp4LnN0YXRlLHZhbHVlOnZvaWQgMCxoYXNUaHJvd246ITF9fSxQLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiIgOyJ9LFB9KGgpO3UuRW1wdHlEZWNsYXJhdGlvbj15O3ZhciBkPWZ1bmN0aW9uKEgpe2Z1bmN0aW9uIFAoeCxSKXtSPT09dm9pZCAwJiYoUj0wKTt2YXIgXz1ILmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIF8uZGVjbGFyYXRpb25zPXgsXy5pZD1SLF99cmV0dXJuIGcoUCxIKSxQLnByb3RvdHlwZS5hc3NlcnRVbmlxdWVCaW5kaW5nPWZ1bmN0aW9uKHgsUil7Zm9yKHZhciBfPTA7Xzx0aGlzLmRlY2xhcmF0aW9ucy5sZW5ndGg7KytfKXRoaXMuZGVjbGFyYXRpb25zW19dLmFzc2VydFVuaXF1ZUJpbmRpbmcoeCxSKTtyZXR1cm4gbmV3IFNldH0sUC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtmb3IodmFyIHg9W10sUj0wO1I8dGhpcy5kZWNsYXJhdGlvbnMubGVuZ3RoOysrUil4LnB1c2godGhpcy5kZWNsYXJhdGlvbnNbUl0uc2ltcGxpZnkoKSk7cmV0dXJuIG5ldyBQKHgsdGhpcy5pZCl9LFAucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbih4LFIsXyxXLFEsbmUpe2Zvcih2YXIgRj1bXSxiPVIsbD1fLHQ9ZnVuY3Rpb24oTCl7USYmKGI9bmV3IE1hcCx4LmdldFR5cGVWYXJpYWJsZUJpbmRzKClbMV0uZm9yRWFjaChmdW5jdGlvbihlZSx0ZSl7Yj1iLnNldCh0ZSxlZSl9KSxXPW5ldyBNYXApO3ZhciBrPW4uZGVjbGFyYXRpb25zW0xdLmVsYWJvcmF0ZSh4LmdldE5lc3RlZFN0YXRlKG4uZGVjbGFyYXRpb25zW0xdLmlkKSxiLGwsVyxRLG5lKTt4PWtbMF0sRj1GLmNvbmNhdChrWzFdKSxiPWtbMl07dmFyIFU9bmV3IE1hcDtpZihRJiYoVT1SKSxrWzJdLmZvckVhY2goZnVuY3Rpb24oZWUsdGUpe2lmKHRlWzFdPT09In4iKXt2YXIgb2U9ZWVbMF0uaW5zdGFudGlhdGUoeCxrWzJdKS5ub3JtYWxpemUoeC5mcmVlVHlwZVZhcmlhYmxlc1swXSxuZSk7eC5wYXJlbnQuZ2V0VHlwZVZhcmlhYmxlQmluZHMoKVsxXS5oYXModGUpfHxGLnB1c2gobmV3IFYuV2FybmluZygwLCdUaGUgZnJlZSB0eXBlIHZhcmlhYmxlICInK3RlKyciIGhhcyBiZWVuIGluc3RhbnRpYXRlZCB0byAiJytvZVswXStgIi4KYCkpLFU9VS5zZXQodGUsW29lWzBdLCEwXSl9ZWxzZSBRfHwoVT1VLnNldCh0ZSxlZSkpfSksYj1VLFEpe2Zvcih2YXIgaiBpbiB4LmZyZWVUeXBlVmFyaWFibGVzWzFdPVUseC5zdGF0aWNCYXNpcy52YWx1ZUVudmlyb25tZW50KWlmKHguc3RhdGljQmFzaXMudmFsdWVFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShqKSl7dmFyIFg9eC5zdGF0aWNCYXNpcy52YWx1ZUVudmlyb25tZW50W2pdLFo9WFswXS5ub3JtYWxpemUoeC5mcmVlVHlwZVZhcmlhYmxlc1swXSxuZSk7eC5mcmVlVHlwZVZhcmlhYmxlc1swXT1aWzFdLHguc2V0U3RhdGljVmFsdWUoaixaWzBdLFhbMV0pfX1sPWtbM119LG49dGhpcyxpPTA7aTx0aGlzLmRlY2xhcmF0aW9ucy5sZW5ndGg7KytpKXQoaSk7aWYoIVEpe3ZhciBhPW5ldyBNYXAsZj1uZXcgTWFwLFM9bmV3IFNldDtiLmZvckVhY2goZnVuY3Rpb24oTCxrKXtmPWEuc2V0KGssTCl9KSxiLmZvckVhY2goZnVuY3Rpb24oTCxrKXtpZighUy5oYXMoaykmJihhPWEuc2V0KGssTCksay5zdGFydHNXaXRoKCJAIikpKXt2YXIgVT1rLnN1YnN0cigxKTtpZihTPVMuYWRkKFUpLGYuaGFzKFUpKXt2YXIgaj1mLmdldChVKTt0cnl7dmFyIFg9alswXS5tZXJnZSh4LGYsTFswXSk7YT1hLnNldChVLFtYWzBdLGpbMV18fExbMV1dKX1jYXRjaChaKXt0aHJvdyBaIGluc3RhbmNlb2YgQXJyYXk/bmV3IFYuRWxhYm9yYXRpb25FcnJvcignQ2Fubm90IG1lcmdlICInK2pbMF0ubm9ybWFsaXplKClbMF0rJyIgYW5kICInK0xbMF0ubm9ybWFsaXplKClbMF0rJyIgOicrWlswXSsiLiIpOlp9fWVsc2UgYT1hLnNldChVLEwpfX0pLGI9YX1yZXR1cm5beCxGLGIsbF19LFAucHJvdG90eXBlLmV2YWx1YXRlPWZ1bmN0aW9uKHgsUil7dmFyIF89eC5zdGF0ZTt4LnN0ZXA9PT12b2lkIDAmJih4LnN0ZXA9LTEpO3ZhciBXPXguc3RlcDtpZihXPj0wKXt2YXIgUT14LnJlY1Jlc3VsdDtpZihRPT09dm9pZCAwfHxRLm5ld1N0YXRlPT09dm9pZCAwKXRocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiSG93IGlzIHRoaXMgdW5kZWZpbmVkPyIpO2lmKFEuaGFzVGhyb3duKXJldHVybntuZXdTdGF0ZTpRLm5ld1N0YXRlLHZhbHVlOlEudmFsdWUsaGFzVGhyb3duOiEwfTtfPVEubmV3U3RhdGV9aWYoKytXPHRoaXMuZGVjbGFyYXRpb25zLmxlbmd0aCl7dmFyIG5lPV8uZ2V0TmVzdGVkU3RhdGUodGhpcy5kZWNsYXJhdGlvbnNbV10uaWQpO3JldHVybiB4LnN0ZXA9Vyx4LnN0YXRlPV8sUi5wdXNoKHtuZXh0OnRoaXMscGFyYW1zOnh9KSx2b2lkIFIucHVzaCh7bmV4dDp0aGlzLmRlY2xhcmF0aW9uc1tXXSxwYXJhbXM6e3N0YXRlOm5lLG1vZGlmaWFibGU6eC5tb2RpZmlhYmxlLHJlY1Jlc3VsdDp2b2lkIDB9fSl9cmV0dXJue25ld1N0YXRlOl8sdmFsdWU6dm9pZCAwLGhhc1Rocm93bjohMX19LFAucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7Zm9yKHZhciB4PSIiLFI9MDtSPHRoaXMuZGVjbGFyYXRpb25zLmxlbmd0aDsrK1IpUj4wJiYoeCs9IiAiKSx4Kz10aGlzLmRlY2xhcmF0aW9uc1tSXTtyZXR1cm4geH0sUH0oaCk7dS5TZXF1ZW50aWFsRGVjbGFyYXRpb249ZDt2YXIgdj1mdW5jdGlvbihIKXtmdW5jdGlvbiBQKHgsUixfKXtfPT09dm9pZCAwJiYoXz0wKTt2YXIgVz1ILmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIFcudHlwZVZhcmlhYmxlU2VxdWVuY2U9eCxXLmZ1bmN0aW9uVmFsdWVCaW5kaW5nPVIsVy5pZD1fLFd9cmV0dXJuIGcoUCxIKSxQLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe2Zvcih2YXIgeD1bXSxSPTA7Ujx0aGlzLmZ1bmN0aW9uVmFsdWVCaW5kaW5nLmxlbmd0aDsrK1IpeC5wdXNoKHRoaXMuZnVuY3Rpb25WYWx1ZUJpbmRpbmdbUl0uc2ltcGxpZnkoKSk7cmV0dXJuIG5ldyBBKHRoaXMudHlwZVZhcmlhYmxlU2VxdWVuY2UseCx0aGlzLmlkKX0sUH0oaCk7dS5GdW5jdGlvbkRlY2xhcmF0aW9uPXY7dmFyIEM9ZnVuY3Rpb24oSCl7ZnVuY3Rpb24gUCh4KXt2YXIgUj1ILmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIFIuZXhwcmVzc2lvbj14LFJ9cmV0dXJuIGcoUCxIKSxQLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiBuZXcgQShbXSxbbmV3IHAoITEsbmV3IHMuVHVwbGUoW10pLHRoaXMuZXhwcmVzc2lvbildKS5zaW1wbGlmeSgpfSxQfShoKTt1LkV2YWx1YXRpb249Qzt2YXIgRz1mdW5jdGlvbihIKXtmdW5jdGlvbiBQKHgsUixfLFcpe1c9PT12b2lkIDAmJihXPTApO3ZhciBRPUguY2FsbCh0aGlzKXx8dGhpcztpZihRLmRhdGF0eXBlQmluZGluZz14LFEudHlwZUJpbmRpbmc9UixRLmRlY2xhcmF0aW9uPV8sUS5pZD1XLFEudHlwZUJpbmRpbmchPT12b2lkIDApdGhyb3cgbmV3IFYuRmVhdHVyZURpc2FibGVkRXJyb3IoJ1dobyBpcyAid2l0aHR5cGUiPycpO3JldHVybiBRfXJldHVybiBnKFAsSCksUC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtmb3IodmFyIHg9bmV3IE8odGhpcy5kYXRhdHlwZUJpbmRpbmcsdm9pZCAwLHRoaXMuaWQpLFI9W10sXz0wO188dGhpcy5kYXRhdHlwZUJpbmRpbmcubGVuZ3RoOysrXylSLnB1c2gobmV3IHcodGhpcy5kYXRhdHlwZUJpbmRpbmdbX10udHlwZVZhcmlhYmxlU2VxdWVuY2UsdGhpcy5kYXRhdHlwZUJpbmRpbmdbX10ubmFtZSxuZXcgQi5DdXN0b21UeXBlKHRoaXMuZGF0YXR5cGVCaW5kaW5nW19dLm5hbWUuZ2V0VGV4dCgpLHRoaXMuZGF0YXR5cGVCaW5kaW5nW19dLnR5cGVWYXJpYWJsZVNlcXVlbmNlKSkpO3ZhciBXPW5ldyBJKFIsdGhpcy5pZCk7cmV0dXJuIG5ldyBlKHgsbmV3IGQoW1csdGhpcy5kZWNsYXJhdGlvbl0sdGhpcy5pZCksdGhpcy5pZCkuc2ltcGxpZnkoKX0sUH0oaCk7dS5BYnN0eXBlRGVjbGFyYXRpb249Rzt2YXIgWT1mdW5jdGlvbihIKXtmdW5jdGlvbiBQKHgsUixfKXtSPT09dm9pZCAwJiYoUj0wKSxfPT09dm9pZCAwJiYoXz0wKTt2YXIgVz1ILmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIFcub3BlcmF0b3JzPXgsVy5wcmVjZWRlbmNlPVIsVy5pZD1fLFd9cmV0dXJuIGcoUCxIKSxQLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSxQLnByb3RvdHlwZS5lbGFib3JhdGU9ZnVuY3Rpb24oeCxSLF8sVyl7cmV0dXJuW3gsW10sUixfXX0sUC5wcm90b3R5cGUuc2V0SW5maXhTdGF0dXM9ZnVuY3Rpb24oeCl7Zm9yKHZhciBSPTA7Ujx0aGlzLm9wZXJhdG9ycy5sZW5ndGg7KytSKXguc2V0SW5maXhTdGF0dXModGhpcy5vcGVyYXRvcnNbUl0sdGhpcy5wcmVjZWRlbmNlLCExLCEwKX0sUC5wcm90b3R5cGUuZXZhbHVhdGU9ZnVuY3Rpb24oeCxSKXt2YXIgXz14LnN0YXRlO3JldHVybiB0aGlzLnNldEluZml4U3RhdHVzKF8pLHtuZXdTdGF0ZTpfLHZhbHVlOnZvaWQgMCxoYXNUaHJvd246ITF9fSxQLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciB4PSJpbmZpeCI7eCs9IiAiK3RoaXMucHJlY2VkZW5jZTtmb3IodmFyIFI9MDtSPHRoaXMub3BlcmF0b3JzLmxlbmd0aDsrK1IpeCs9IiAiK3RoaXMub3BlcmF0b3JzW1JdLmdldFRleHQoKTtyZXR1cm4geCsiOyJ9LFB9KGgpO3UuSW5maXhEZWNsYXJhdGlvbj1ZO3ZhciBKPWZ1bmN0aW9uKEgpe2Z1bmN0aW9uIFAoeCxSLF8pe1I9PT12b2lkIDAmJihSPTApLF89PT12b2lkIDAmJihfPTApO3ZhciBXPUguY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gVy5vcGVyYXRvcnM9eCxXLnByZWNlZGVuY2U9UixXLmlkPV8sV31yZXR1cm4gZyhQLEgpLFAucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LFAucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbih4LFIsXyxXKXtyZXR1cm5beCxbXSxSLF9dfSxQLnByb3RvdHlwZS5zZXRJbmZpeFN0YXR1cz1mdW5jdGlvbih4KXtmb3IodmFyIFI9MDtSPHRoaXMub3BlcmF0b3JzLmxlbmd0aDsrK1IpeC5zZXRJbmZpeFN0YXR1cyh0aGlzLm9wZXJhdG9yc1tSXSx0aGlzLnByZWNlZGVuY2UsITAsITApfSxQLnByb3RvdHlwZS5ldmFsdWF0ZT1mdW5jdGlvbih4LFIpe3ZhciBfPXguc3RhdGU7cmV0dXJuIHRoaXMuc2V0SW5maXhTdGF0dXMoXykse25ld1N0YXRlOl8sdmFsdWU6dm9pZCAwLGhhc1Rocm93bjohMX19LFAucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7dmFyIHg9ImluZml4ciI7eCs9IiAiK3RoaXMucHJlY2VkZW5jZTtmb3IodmFyIFI9MDtSPHRoaXMub3BlcmF0b3JzLmxlbmd0aDsrK1IpeCs9IiAiK3RoaXMub3BlcmF0b3JzW1JdLmdldFRleHQoKTtyZXR1cm4geCsiOyJ9LFB9KGgpO3UuSW5maXhSRGVjbGFyYXRpb249Sjt2YXIgej1mdW5jdGlvbihIKXtmdW5jdGlvbiBQKHgsUil7Uj09PXZvaWQgMCYmKFI9MCk7dmFyIF89SC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBfLm9wZXJhdG9ycz14LF8uaWQ9UixffXJldHVybiBnKFAsSCksUC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sUC5wcm90b3R5cGUuZWxhYm9yYXRlPWZ1bmN0aW9uKHgsUixfLFcpe3JldHVyblt4LFtdLFIsX119LFAucHJvdG90eXBlLnNldEluZml4U3RhdHVzPWZ1bmN0aW9uKHgpe2Zvcih2YXIgUj0wO1I8dGhpcy5vcGVyYXRvcnMubGVuZ3RoOysrUil4LnNldEluZml4U3RhdHVzKHRoaXMub3BlcmF0b3JzW1JdLDAsITEsITEpfSxQLnByb3RvdHlwZS5ldmFsdWF0ZT1mdW5jdGlvbih4LFIpe3ZhciBfPXguc3RhdGU7cmV0dXJuIHRoaXMuc2V0SW5maXhTdGF0dXMoXykse25ld1N0YXRlOl8sdmFsdWU6dm9pZCAwLGhhc1Rocm93bjohMX19LFAucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7Zm9yKHZhciB4PSJub25maXgiLFI9MDtSPHRoaXMub3BlcmF0b3JzLmxlbmd0aDsrK1IpeCs9IiAiK3RoaXMub3BlcmF0b3JzW1JdLmdldFRleHQoKTtyZXR1cm4geCsiOyJ9LFB9KGgpO3UuTm9uZml4RGVjbGFyYXRpb249ejt2YXIgcD1mdW5jdGlvbigpe2Z1bmN0aW9uIEgoUCx4LFIpe3RoaXMuaXNSZWN1cnNpdmU9UCx0aGlzLnBhdHRlcm49eCx0aGlzLmV4cHJlc3Npb249Un1yZXR1cm4gSC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgUD0iIjtyZXR1cm4gdGhpcy5pc1JlY3Vyc2l2ZSYmKFArPSJyZWMgIiksUCs9dGhpcy5wYXR0ZXJuLChQKz0iID0gIikrdGhpcy5leHByZXNzaW9ufSxILnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKFAseCxSLF8sVyxRKXt2YXIgbmU9eC5nZXROZXN0ZWRTdGF0ZSh4LmlkKSxGPVIsYj10aGlzLmV4cHJlc3Npb24uZ2V0VHlwZShuZSxGLF8sbmV3IFNldCwhMSxXKSxsPWJbMV0sdD10aGlzLnBhdHRlcm4ubWF0Y2hUeXBlKG5lLGJbNF0sYlswXSk7dHJ5e2Zvcih2YXIgbj1uZXcgcy5NYXRjaChbW3RoaXMucGF0dGVybix0aGlzLmV4cHJlc3Npb25dXSkuY2hlY2tFeGhhdXN0aXZlbmVzcyh4KSxpPVtdLGE9bmV3IFNldCxmPTAsUz1uO2Y8Uy5sZW5ndGg7ZisrKXt2YXIgTD1TW2ZdO2EuaGFzKEwubWVzc2FnZSl8fChhLmFkZChMLm1lc3NhZ2UpLGkucHVzaChuZXcgVi5XYXJuaW5nKEwudHlwZT09PS0xPy0xOjAsTC5tZXNzYWdlKSkpfWw9bC5jb25jYXQoaSl9Y2F0Y2h7fXZhciBrPW5ldyBTZXQ7aWYodD09PXZvaWQgMCl0aHJvdyBuZXcgVi5FbGFib3JhdGlvbkVycm9yKCdUeXBlIGNsYXNoLiBBbiBleHByZXNzaW9uIG9mIHR5cGUgIicrYlswXSsnIiBjYW5ub3QgYmUgYXNzaWduZWQgdG8gIicrdFsxXSsnIi4nKTtmb3IodmFyIFU9W10saj1uZXcgU2V0LFg9MDtYPFAubGVuZ3RoOysrWCl7aWYoai5oYXMoUFtYXS5uYW1lKSl0aHJvdyBuZXcgVi5FbGFib3JhdGlvbkVycm9yKCdJIHdpbGwgbm90IGxldCBhIGR1cGxpY2F0ZSB0eXBlIHZhcmlhYmxlIG5hbWUgIicrUFtYXS5uYW1lKyciIGRpc3R1cmIgbXkgSGFwcHkgU3VnYXIgTGlmZS4nKTtqPWouYWRkKFBbWF0ubmFtZSk7dmFyIFo9UFtYXS5pbnN0YW50aWF0ZSh4LHRbMl0pO2lmKCEoWiBpbnN0YW5jZW9mIEIuVHlwZVZhcmlhYmxlKXx8Wi5kb21haW4ubGVuZ3RoPjB8fFBbWF0uYWRtaXRzRXF1YWxpdHkoeCkhPT1aLmFkbWl0c0VxdWFsaXR5KHgpKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoJ1R5cGUgY2xhc2guIEFuIGV4cHJlc3Npb24gb2YgZXhwbGljaXQgdHlwZSAiJytQW1hdKyciIGNhbm5vdCBoYXZlIHR5cGUgIicrWi5ub3JtYWxpemUoKVswXSsnIi4nKTtVLnB1c2goWil9dGhpcy5leHByZXNzaW9uLmdldEV4cGxpY2l0VHlwZVZhcmlhYmxlcygpLmZvckVhY2goZnVuY3Rpb24oc2Upe3ZhciB1ZT1zZS5pbnN0YW50aWF0ZSh4LHRbMl0pO2lmKCEodWUgaW5zdGFuY2VvZiBCLlR5cGVWYXJpYWJsZSl8fHVlLmRvbWFpbi5sZW5ndGg+MHx8c2UuYWRtaXRzRXF1YWxpdHkoeCkhPT11ZS5hZG1pdHNFcXVhbGl0eSh4KSl0aHJvdyBuZXcgVi5FbGFib3JhdGlvbkVycm9yKCdUeXBlIGNsYXNoLiBBbiBleHByZXNzaW9uIG9mIGV4cGxpY2l0IHR5cGUgIicrc2UrJyIgY2Fubm90IGhhdmUgdHlwZSAiJyt1ZS5ub3JtYWxpemUoKVswXSsnIi4nKX0pO3ZhciBlZT0hdGhpcy5pc1JlY3Vyc2l2ZSYmIXRoaXMuZXhwcmVzc2lvbi5pc1NhZmUoeCksdGU9ITEsb2U9ZnVuY3Rpb24oc2Upe2lmKHRbMF1bc2VdWzBdPT09Ij0iKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoIkFsbCBkZWNsYXJhdGlvbnMgYXJlIGVxdWFsLCBidXQgc29tZSBkZWNsYXJhdGlvbnMgYXJlIG1vcmUgZXF1YWwgdGhhbiBvdGhlcnMuIik7dFswXVtzZV1bMV09dFswXVtzZV1bMV0uaW5zdGFudGlhdGUoeCx0WzJdKSxRfHwoVz1XLnNldCh0WzBdW3NlXVswXSx0WzBdW3NlXVsxXSkpO2Zvcih2YXIgdWU9dFswXVtzZV1bMV0uZ2V0VHlwZVZhcmlhYmxlcygpLGllPXRbMF1bc2VdWzFdLmdldFR5cGVWYXJpYWJsZXMoITApLHBlPW5ldyBTZXQscmU9VS5sZW5ndGgtMTtyZT49MDstLXJlKWlmKHVlLmhhcyhVW3JlXS5uYW1lKSl7dmFyIGFlPXVlLmdldChVW3JlXS5uYW1lKTt0WzJdLmhhcygiJCIrVVtyZV0ubmFtZSkmJihhZT1CLlR5cGVWYXJpYWJsZS5tZXJnZURvbWFpbihhZSx0WzJdLmdldCgiJCIrVVtyZV0ubmFtZSlbMF0uZG9tYWluKSksdFswXVtzZV1bMV09bmV3IEIuVHlwZVZhcmlhYmxlQmluZChVW3JlXS5uYW1lLHRbMF1bc2VdWzFdLGFlKSx0WzBdW3NlXVsxXS5pc0ZyZWU9dFswXVtzZV1bMV0uZG9tYWluLmxlbmd0aD09PTAmJihlZXx8aWUuaGFzKFVbcmVdLm5hbWUpKSx0ZT10ZXx8dFswXVtzZV1bMV0uaXNGcmVlLHBlLmFkZChVW3JlXS5uYW1lKX1mb3IoVT1bXSx0WzBdW3NlXVsxXS5nZXRUeXBlVmFyaWFibGVzKCkuZm9yRWFjaChmdW5jdGlvbihjZSxsZSl7aWYoKFF8fCFrLmhhcyhsZSkpJiYhcGUuaGFzKGxlKSl7dmFyIGRlPWNlO3RbMl0uaGFzKCIkIitsZSkmJihkZT1CLlR5cGVWYXJpYWJsZS5tZXJnZURvbWFpbihkZSx0WzJdLmdldCgiJCIrbGUpWzBdLmRvbWFpbikpLFUucHVzaChuZXcgQi5UeXBlVmFyaWFibGUobGUsZGUpKX19KSxyZT1VLmxlbmd0aC0xO3JlPj0wOy0tcmUpdFswXVtzZV1bMV09bmV3IEIuVHlwZVZhcmlhYmxlQmluZChVW3JlXS5uYW1lLHRbMF1bc2VdWzFdLFVbcmVdLmRvbWFpbiksdFswXVtzZV1bMV0uaXNGcmVlPXRbMF1bc2VdWzFdLmRvbWFpbi5sZW5ndGg9PT0wJiYoZWV8fGllLmhhcyhVW3JlXS5uYW1lKSksdGU9dGV8fHRbMF1bc2VdWzFdLmlzRnJlZX07Zm9yKFg9MDtYPHRbMF0ubGVuZ3RoOysrWClvZShYKTtyZXR1cm4gdGUmJlEmJmwucHVzaChuZXcgVi5XYXJuaW5nKDAsYEZyZWUgdHlwZSB2YXJpYWJsZXMgYXQgdG9wIGxldmVsLgpgKSksW3RbMF0sbCx0WzJdLGJbMl0sYls1XV19LEh9KCk7dS5WYWx1ZUJpbmRpbmc9cDt2YXIgYz1mdW5jdGlvbigpe2Z1bmN0aW9uIEgoUCx4KXt0aGlzLnBhcmFtZXRlcnM9UCx0aGlzLm5hbWU9eH1yZXR1cm4gSC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtpZih0aGlzLm5hbWU9PT12b2lkIDApdGhyb3cgbmV3IFYuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJUaGlzIGZ1bmN0aW9uIGlzbid0IHJlYWR5IHRvIGJlIHNpbXBsaWZpZWQgeWV0LiIpO2Zvcih2YXIgUCx4PVtdLFI9W10sXz0wO188dGhpcy5wYXJhbWV0ZXJzWzBdWzBdLmxlbmd0aDsrK18peC5wdXNoKG5ldyBzLlZhbHVlSWRlbnRpZmllcihuZXcgcS5JZGVudGlmaWVyVG9rZW4oIl9fYXJnIitfKSkpO2ZvcihfPTA7Xzx0aGlzLnBhcmFtZXRlcnMubGVuZ3RoOysrXyl7dmFyIFc7Vz10aGlzLnBhcmFtZXRlcnNbX11bMF0ubGVuZ3RoPT09MT90aGlzLnBhcmFtZXRlcnNbX11bMF1bMF06bmV3IHMuVHVwbGUodGhpcy5wYXJhbWV0ZXJzW19dWzBdKSx0aGlzLnBhcmFtZXRlcnNbX11bMV09PT12b2lkIDA/Ui5wdXNoKFtXLHRoaXMucGFyYW1ldGVyc1tfXVsyXV0pOlIucHVzaChbVyxuZXcgcy5UeXBlZEV4cHJlc3Npb24odGhpcy5wYXJhbWV0ZXJzW19dWzJdLHRoaXMucGFyYW1ldGVyc1tfXVsxXSldKX1QPXgubGVuZ3RoIT09MT9uZXcgcy5UdXBsZSh4KS5zaW1wbGlmeSgpOnhbMF07dmFyIFEsbmU9bmV3IHMuTWF0Y2goUik7Zm9yKFE9bmV3IHMuQ2FzZUFuYWx5c2lzKFAsbmUpLF89dGhpcy5wYXJhbWV0ZXJzWzBdWzBdLmxlbmd0aC0xO18+PTA7LS1fKVE9bmV3IHMuTGFtYmRhKG5ldyBzLk1hdGNoKFtbbmV3IHMuVmFsdWVJZGVudGlmaWVyKG5ldyBxLklkZW50aWZpZXJUb2tlbigiX19hcmciK18pKSxRXV0pKTtyZXR1cm4gbmV3IHAoITAsdGhpcy5uYW1lLFEuc2ltcGxpZnkoKSl9LEgucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7Zm9yKHZhciBQPSIiLHg9MDt4PHRoaXMucGFyYW1ldGVycy5sZW5ndGg7Kyt4KXt4PjAmJihQKz0iIHwgIiksUCs9dGhpcy5uYW1lLm5hbWUuZ2V0VGV4dCgpO2Zvcih2YXIgUj0wO1I8dGhpcy5wYXJhbWV0ZXJzW3hdWzBdLmxlbmd0aDsrK1IpUCs9IiAiK3RoaXMucGFyYW1ldGVyc1t4XVswXVtSXTt0aGlzLnBhcmFtZXRlcnNbeF1bMV0hPT12b2lkIDAmJihQKz0iOiAiK3RoaXMucGFyYW1ldGVyc1t4XVsxXSksUCs9IiA9ICIrdGhpcy5wYXJhbWV0ZXJzW3hdWzJdfXJldHVybiBQfSxIfSgpO3UuRnVuY3Rpb25WYWx1ZUJpbmRpbmc9Yzt2YXIgdz1mdW5jdGlvbihILFAseCl7dGhpcy50eXBlVmFyaWFibGVTZXF1ZW5jZT1ILHRoaXMubmFtZT1QLHRoaXMudHlwZT14fTt1LlR5cGVCaW5kaW5nPXc7dmFyIFQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBIKFAseCxSLF8pe189PT12b2lkIDAmJihfPXt9KSx0aGlzLnR5cGVWYXJpYWJsZVNlcXVlbmNlPVAsdGhpcy5uYW1lPXgsdGhpcy50eXBlPVIsdGhpcy5naXZlbklkcz1ffXJldHVybiBILnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKFAseCxSLF8pe189PT12b2lkIDAmJihfPSExKTt2YXIgVz1bXSxRPVtdLG5lPVAuZ2V0TmVzdGVkU3RhdGUoUC5pZCksRj1QLmdldFZhbHVlSWRlbnRpZmllcklkKHRoaXMubmFtZS5nZXRUZXh0KCkpO25lLmluY3JlbWVudFZhbHVlSWRlbnRpZmllcklkKHRoaXMubmFtZS5nZXRUZXh0KCkpO3ZhciBiPW5ldyBCLkN1c3RvbVR5cGUodGhpcy5uYW1lLmdldFRleHQoKSx0aGlzLnR5cGVWYXJpYWJsZVNlcXVlbmNlLHZvaWQgMCwhMSwwKSxsPW5ldyBCLkN1c3RvbVR5cGUodGhpcy5uYW1lLmdldFRleHQoKSx0aGlzLnR5cGVWYXJpYWJsZVNlcXVlbmNlLHZvaWQgMCwhMSxGKSx0PXRoaXMudHlwZVZhcmlhYmxlU2VxdWVuY2UubGVuZ3RoO25lLnNldFN0YXRpY1R5cGUodGhpcy5uYW1lLmdldFRleHQoKSxsLFtdLHQsITApO2Zvcih2YXIgbj1mdW5jdGlvbihmKXt2YXIgUz1sO2lmKGkudHlwZVtmXVsxXSE9PXZvaWQgMCl7dmFyIEw9aS50eXBlW2ZdWzFdO198fEwuaW5zdGFudGlhdGUobmUsbmV3IE1hcCksTD1MLnJlcGxhY2UoYixsKSxTPW5ldyBCLkZ1bmN0aW9uVHlwZShMLFMpfWZvcih2YXIgaz1uZXcgU2V0LFU9MDtVPGkudHlwZVZhcmlhYmxlU2VxdWVuY2UubGVuZ3RoOysrVSl7aWYoay5oYXMoaS50eXBlVmFyaWFibGVTZXF1ZW5jZVtVXS5uYW1lKSl0aHJvdyBuZXcgVi5FbGFib3JhdGlvbkVycm9yKGBJJ20gbm90IGludGVyZXN0ZWQgaW4gZHVwbGljYXRlIHR5cGUgdmFyaWFibGUgbmFtZXMgc3VjaCBhcyAiYCtpLnR5cGVWYXJpYWJsZVNlcXVlbmNlW1VdKyciLicpO2s9ay5hZGQoaS50eXBlVmFyaWFibGVTZXF1ZW5jZVtVXS5uYW1lKX12YXIgaj1bXTtpZihTLmdldFR5cGVWYXJpYWJsZXMoKS5mb3JFYWNoKGZ1bmN0aW9uKFgsWil7ay5oYXMoWik/Uz1uZXcgQi5UeXBlVmFyaWFibGVCaW5kKFosUyxYKTpqLnB1c2goWil9KSxqLmxlbmd0aD4wKXRocm93IFYuRWxhYm9yYXRpb25FcnJvci5nZXRVbmd1YXJkZWQoaik7US5wdXNoKFtpLnR5cGVbZl1bMF0uZ2V0VGV4dCgpLFNdKSxXLnB1c2goaS50eXBlW2ZdWzBdLmdldFRleHQoKSl9LGk9dGhpcyxhPTA7YTx0aGlzLnR5cGUubGVuZ3RoOysrYSluKGEpO3JldHVybltRLGwsW3RoaXMubmFtZS5nZXRUZXh0KCksV11dfSxILnByb3RvdHlwZS5jb21wdXRlPWZ1bmN0aW9uKFAseCl7Zm9yKHZhciBSPVtdLF89W10sVz0wO1c8dGhpcy50eXBlLmxlbmd0aDsrK1cpe3ZhciBRPTA7dGhpcy50eXBlW1ddWzFdIT09dm9pZCAwJiYoUT0xKTt2YXIgbmU9LTE7dGhpcy5naXZlbklkc1t0aGlzLnR5cGVbV11bMF0uZ2V0VGV4dCgpXT09PXZvaWQgMD8obmU9eC5nZXRWYWx1ZUlkZW50aWZpZXJJZCh0aGlzLnR5cGVbV11bMF0uZ2V0VGV4dCgpKSx4LmluY3JlbWVudFZhbHVlSWRlbnRpZmllcklkKHRoaXMudHlwZVtXXVswXS5nZXRUZXh0KCkpLHRoaXMuZ2l2ZW5JZHNbdGhpcy50eXBlW1ddWzBdLmdldFRleHQoKV09bmUpOm5lPXRoaXMuZ2l2ZW5JZHNbdGhpcy50eXBlW1ddWzBdLmdldFRleHQoKV0sXy5wdXNoKFt0aGlzLnR5cGVbV11bMF0uZ2V0VGV4dCgpLG5ldyBELlZhbHVlQ29uc3RydWN0b3IodGhpcy50eXBlW1ddWzBdLmdldFRleHQoKSxRLG5lKV0pLFIucHVzaCh0aGlzLnR5cGVbV11bMF0uZ2V0VGV4dCgpKX1yZXR1cm5bXyxbdGhpcy5uYW1lLmdldFRleHQoKSxSXV19LEh9KCk7dS5EYXRhdHlwZUJpbmRpbmc9VDt2YXIgTj1mdW5jdGlvbigpe2Z1bmN0aW9uIEgoUCx4KXt0aGlzLm5hbWU9UCx0aGlzLnR5cGU9eH1yZXR1cm4gSC5wcm90b3R5cGUuZWxhYm9yYXRlPWZ1bmN0aW9uKFAseCxSLF8pe2lmKHRoaXMudHlwZSE9PXZvaWQgMCl7dmFyIFc9dGhpcy50eXBlLnNpbXBsaWZ5KCkuaW5zdGFudGlhdGUoUCxuZXcgTWFwKSxRPVtdO2lmKFcuZ2V0VHlwZVZhcmlhYmxlcygpLmZvckVhY2goZnVuY3Rpb24obmUsRil7US5wdXNoKEYpfSkseCYmUS5sZW5ndGg+MCl0aHJvdyBWLkVsYWJvcmF0aW9uRXJyb3IuZ2V0VW5ndWFyZGVkKFEpO1Auc2V0U3RhdGljVmFsdWUodGhpcy5uYW1lLmdldFRleHQoKSxuZXcgQi5GdW5jdGlvblR5cGUoVy5tYWtlRnJlZSgpLG5ldyBCLkN1c3RvbVR5cGUoImV4biIpKSxNLklkZW50aWZpZXJTdGF0dXMuRVhDRVBUSU9OX0NPTlNUUlVDVE9SKX1lbHNlIFAuc2V0U3RhdGljVmFsdWUodGhpcy5uYW1lLmdldFRleHQoKSxuZXcgQi5DdXN0b21UeXBlKCJleG4iKSxNLklkZW50aWZpZXJTdGF0dXMuRVhDRVBUSU9OX0NPTlNUUlVDVE9SKTtyZXR1cm4gUH0sSC5wcm90b3R5cGUuZXZhbHVhdGU9ZnVuY3Rpb24oUCx4KXt2YXIgUj0wO3RoaXMudHlwZSE9PXZvaWQgMCYmKFI9MSk7dmFyIF89UC5nZXRWYWx1ZUlkZW50aWZpZXJJZCh0aGlzLm5hbWUuZ2V0VGV4dCgpKTtQLmluY3JlbWVudFZhbHVlSWRlbnRpZmllcklkKHRoaXMubmFtZS5nZXRUZXh0KCkpO3ZhciBXPXguZ2V0TmV4dEV4Y2VwdGlvbkV2YWxJZCgpO2lmKCFNLlN0YXRlLmFsbG93c1JlYmluZCh0aGlzLm5hbWUuZ2V0VGV4dCgpKSl0aHJvdyBuZXcgVi5FdmFsdWF0aW9uRXJyb3IoJ1lvdSBzaW1wbHkgY2Fubm90IHJlYmluZCAiJyt0aGlzLm5hbWUuZ2V0VGV4dCgpKyciLicpO1Auc2V0RHluYW1pY1ZhbHVlKHRoaXMubmFtZS5nZXRUZXh0KCksbmV3IEQuRXhjZXB0aW9uQ29uc3RydWN0b3IodGhpcy5uYW1lLmdldFRleHQoKSxSLF8sVyksTS5JZGVudGlmaWVyU3RhdHVzLkVYQ0VQVElPTl9DT05TVFJVQ1RPUil9LEh9KCk7dS5EaXJlY3RFeGNlcHRpb25CaW5kaW5nPU47dmFyICQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBIKFAseCl7dGhpcy5uYW1lPVAsdGhpcy5vbGRuYW1lPXh9cmV0dXJuIEgucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbihQLHgsUixfKXt2YXIgVz12b2lkIDA7aWYodGhpcy5vbGRuYW1lIGluc3RhbmNlb2YgcS5Mb25nSWRlbnRpZmllclRva2VuKXt2YXIgUT1QLmdldEFuZFJlc29sdmVTdGF0aWNTdHJ1Y3R1cmUodGhpcy5vbGRuYW1lKTtRIT09dm9pZCAwJiYoVz1RLmdldFZhbHVlKHRoaXMub2xkbmFtZS5pZC5nZXRUZXh0KCkpKX1lbHNlIFc9UC5nZXRTdGF0aWNWYWx1ZSh0aGlzLm9sZG5hbWUuZ2V0VGV4dCgpKTtpZihXPT09dm9pZCAwKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoJ1VuYm91bmQgdmFsdWUgaWRlbnRpZmllciAiJyt0aGlzLm9sZG5hbWUuZ2V0VGV4dCgpKyciLicpO2lmKFdbMV0hPT1NLklkZW50aWZpZXJTdGF0dXMuRVhDRVBUSU9OX0NPTlNUUlVDVE9SKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoJ1lvdSBjYW5ub3QgdHJhbnNmb3JtICInK1dbMF0rJyIgaW50byBhbiBleGNlcHRpb24uJyk7cmV0dXJuIFAuc2V0U3RhdGljVmFsdWUodGhpcy5uYW1lLmdldFRleHQoKSxXWzBdLm5vcm1hbGl6ZSgpWzBdLE0uSWRlbnRpZmllclN0YXR1cy5FWENFUFRJT05fQ09OU1RSVUNUT1IpLFB9LEgucHJvdG90eXBlLmV2YWx1YXRlPWZ1bmN0aW9uKFAseCl7dmFyIFI9dm9pZCAwO2lmKHRoaXMub2xkbmFtZSBpbnN0YW5jZW9mIHEuTG9uZ0lkZW50aWZpZXJUb2tlbil7dmFyIF89UC5nZXRBbmRSZXNvbHZlRHluYW1pY1N0cnVjdHVyZSh0aGlzLm9sZG5hbWUpO18hPT12b2lkIDAmJihSPV8uZ2V0VmFsdWUodGhpcy5vbGRuYW1lLmlkLmdldFRleHQoKSkpfWVsc2UgUj1QLmdldER5bmFtaWNWYWx1ZSh0aGlzLm9sZG5hbWUuZ2V0VGV4dCgpKTtpZihSPT09dm9pZCAwKXRocm93IG5ldyBWLkV2YWx1YXRpb25FcnJvcignVW5ib3VuZCB2YWx1ZSBpZGVudGlmaWVyICInK3RoaXMub2xkbmFtZS5nZXRUZXh0KCkrJyIuJyk7aWYoUlsxXSE9PU0uSWRlbnRpZmllclN0YXR1cy5FWENFUFRJT05fQ09OU1RSVUNUT1IpdGhyb3cgbmV3IFYuRXZhbHVhdGlvbkVycm9yKCdZb3UgY2Fubm90IHRyYW5zZm9ybSAiJytSWzBdLnRvU3RyaW5nKFAsNDApKyciIGludG8gYW4gZXhjZXB0aW9uLicpO1Auc2V0RHluYW1pY1ZhbHVlKHRoaXMubmFtZS5nZXRUZXh0KCksUlswXSxNLklkZW50aWZpZXJTdGF0dXMuRVhDRVBUSU9OX0NPTlNUUlVDVE9SKX0sSH0oKTt1LkV4Y2VwdGlvbkFsaWFzPSR9LDc1ODpmdW5jdGlvbihmZSx1KXt2YXIgSyxtPXRoaXMmJnRoaXMuX19leHRlbmRzfHwoSz1mdW5jdGlvbihPLEUpe3JldHVybihLPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihyLGUpe3IuX19wcm90b19fPWV9fHxmdW5jdGlvbihyLGUpe2Zvcih2YXIgbyBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG8pJiYocltvXT1lW29dKX0pKE8sRSl9LGZ1bmN0aW9uKE8sRSl7aWYodHlwZW9mIEUhPSJmdW5jdGlvbiImJkUhPT1udWxsKXRocm93IG5ldyBUeXBlRXJyb3IoIkNsYXNzIGV4dGVuZHMgdmFsdWUgIitTdHJpbmcoRSkrIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsIik7ZnVuY3Rpb24gcigpe3RoaXMuY29uc3RydWN0b3I9T31LKE8sRSksTy5wcm90b3R5cGU9RT09PW51bGw/T2JqZWN0LmNyZWF0ZShFKTooci5wcm90b3R5cGU9RS5wcm90b3R5cGUsbmV3IHIpfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KHUsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHUuV2FybmluZz11LlBhdHRlcm5NYXRjaEVycm9yPXUuRXZhbHVhdGlvbkVycm9yPXUuRWxhYm9yYXRpb25FcnJvcj11LlBhcnNlckVycm9yPXUuTGV4ZXJFcnJvcj11LkluY29tcGxldGVFcnJvcj11LkZlYXR1cmVEaXNhYmxlZEVycm9yPXUuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yPXUuSW50ZXJwcmV0ZXJFcnJvcj12b2lkIDA7dmFyIGc9ZnVuY3Rpb24oTyl7ZnVuY3Rpb24gRShyLGUpe3ZhciBvPU8uY2FsbCh0aGlzLHIpfHx0aGlzO3JldHVybiBvLm1lc3NhZ2U9cixvLm5hbWU9ZSxPYmplY3Quc2V0UHJvdG90eXBlT2YobyxFLnByb3RvdHlwZSksb31yZXR1cm4gbShFLE8pLEUucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmFtZSsiOiAiK3RoaXMubWVzc2FnZX0sRX0oRXJyb3IpO3UuSW50ZXJwcmV0ZXJFcnJvcj1nO3ZhciBzPWZ1bmN0aW9uKE8pe2Z1bmN0aW9uIEUocil7dmFyIGU9Ty5jYWxsKHRoaXMsciwiWW91IHRyaWdnZXJlZCBUaGlyZCBJbXBhY3QiKXx8dGhpcztyZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mKGUsRS5wcm90b3R5cGUpLGV9cmV0dXJuIG0oRSxPKSxFfShnKTt1LkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcj1zO3ZhciBxPWZ1bmN0aW9uKE8pe2Z1bmN0aW9uIEUocil7dmFyIGU9Ty5jYWxsKHRoaXMsciwiSGF2ZSB5b3UgZXZlciB0cmllZCBkb2luZyBzb21ldGhpbmcgeW91IHdlcmUgbm90IHN1cHBvc2VkIHRvPyBCYXNpY2FsbHkgdGhhdCIpfHx0aGlzO3JldHVybiBPYmplY3Quc2V0UHJvdG90eXBlT2YoZSxFLnByb3RvdHlwZSksZX1yZXR1cm4gbShFLE8pLEV9KGcpO3UuRmVhdHVyZURpc2FibGVkRXJyb3I9cTt2YXIgQj1mdW5jdGlvbihPKXtmdW5jdGlvbiBFKHIpe3ZhciBlPU8uY2FsbCh0aGlzLHIsIklucHV0IEluY29tcGxldGUiKXx8dGhpcztyZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mKGUsRS5wcm90b3R5cGUpLGV9cmV0dXJuIG0oRSxPKSxFfShnKTt1LkluY29tcGxldGVFcnJvcj1CO3ZhciBNPWZ1bmN0aW9uKE8pe2Z1bmN0aW9uIEUocil7dmFyIGU9Ty5jYWxsKHRoaXMsciwiTGV4aW5nIGZhaWxlZCIpfHx0aGlzO3JldHVybiBPYmplY3Quc2V0UHJvdG90eXBlT2YoZSxFLnByb3RvdHlwZSksZX1yZXR1cm4gbShFLE8pLEV9KGcpO3UuTGV4ZXJFcnJvcj1NO3ZhciBWPWZ1bmN0aW9uKE8pe2Z1bmN0aW9uIEUocil7dmFyIGU9Ty5jYWxsKHRoaXMsciwiUGFyc2luZyBmYWlsZWQiKXx8dGhpcztyZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mKGUsRS5wcm90b3R5cGUpLGV9cmV0dXJuIG0oRSxPKSxFfShnKTt1LlBhcnNlckVycm9yPVY7dmFyIEQ9ZnVuY3Rpb24oTyl7ZnVuY3Rpb24gRShyKXt2YXIgZT1PLmNhbGwodGhpcyxyLCJFbGFib3JhdGlvbiBmYWlsZWQiKXx8dGhpcztyZXR1cm4gT2JqZWN0LnNldFByb3RvdHlwZU9mKGUsRS5wcm90b3R5cGUpLGV9cmV0dXJuIG0oRSxPKSxFLmdldFVuZ3VhcmRlZD1mdW5jdGlvbihyKXt2YXIgZT0iIjtyLmxlbmd0aD4xJiYoZSs9InMiKSxlKz0iICI7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDsrK28pbz4wJiYoZSs9IiwgIiksZSs9JyInK3Jbb10rJyInO3JldHVybiBuZXcgRSgiVW5ndWFyZGVkIHR5cGUgdmFyaWFibGUiK2UrIi4iKX0sRX0oZyk7dS5FbGFib3JhdGlvbkVycm9yPUQ7dmFyIGg9ZnVuY3Rpb24oTyl7ZnVuY3Rpb24gRShyKXt2YXIgZT1PLmNhbGwodGhpcyxyLCJFdmFsdWF0aW9uIGZhaWxlZCIpfHx0aGlzO3JldHVybiBPYmplY3Quc2V0UHJvdG90eXBlT2YoZSxFLnByb3RvdHlwZSksZX1yZXR1cm4gbShFLE8pLEV9KGcpO3UuRXZhbHVhdGlvbkVycm9yPWg7dmFyIEE9ZnVuY3Rpb24oTyl7ZnVuY3Rpb24gRShyKXt2YXIgZT1PLmNhbGwodGhpcyxyLCJDaGVja2luZyBQYXR0ZXJuIGZhaWxlZCIpfHx0aGlzO3JldHVybiBPYmplY3Quc2V0UHJvdG90eXBlT2YoZSxFLnByb3RvdHlwZSksZX1yZXR1cm4gbShFLE8pLEV9KGcpO3UuUGF0dGVybk1hdGNoRXJyb3I9QTt2YXIgST1mdW5jdGlvbihPKXtmdW5jdGlvbiBFKHIsZSl7dmFyIG89Ty5jYWxsKHRoaXMsZSwiV2FybmluZyIpfHx0aGlzO3JldHVybiBvLnR5cGU9cixPYmplY3Quc2V0UHJvdG90eXBlT2YobyxFLnByb3RvdHlwZSksb31yZXR1cm4gbShFLE8pLEV9KGcpO3UuV2FybmluZz1JfSw4NTk6KGZlLHUsSyk9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdS5ldmFsdWF0ZT12b2lkIDA7dmFyIG09Syg2NTUpLGc9Syg3NTgpO3UuZXZhbHVhdGU9ZnVuY3Rpb24ocyxxKXt2YXIgQj1zLmdldE5lc3RlZFN0YXRlKCksTT1bXTtNLnB1c2goe25leHQ6cSxwYXJhbXM6e3N0YXRlOnMsbW9kaWZpYWJsZTpCLHJlY1Jlc3VsdDp2b2lkIDB9fSk7Zm9yKHZhciBWPXZvaWQgMDtNLmxlbmd0aD4wOyl7dmFyIEQ9TS5wb3AoKTtpZihEPT09dm9pZCAwKXRocm93IG5ldyBnLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiSG93IGlzIHRoaXMgdW5kZWZpbmVkPyIpO3ZhciBoPUQubmV4dDtpZihELm5leHQ9PT12b2lkIDApdGhyb3cgbmV3IGcuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJJJ2xsIHNvbHZlIGV2ZXJ5dGhpbmcgYnkgYnVybmluZyBpdCEiKTt2YXIgQT1ELnBhcmFtcztBLnJlY1Jlc3VsdD1WLFY9aCBpbnN0YW5jZW9mIG0uRGVjbGFyYXRpb24/aC5ldmFsdWF0ZShBLE0pOmguY29tcHV0ZShBLE0pfWlmKFYhPT12b2lkIDApe3ZhciBJPVYubmV3U3RhdGU7aWYoSSE9PXZvaWQgMCl7SS5zZXRXYXJuaW5ncyhCLmdldFdhcm5pbmdzKCkpO2Zvcih2YXIgTz0wLEU9Qi5nZXRNZW1vcnlDaGFuZ2VzKHMuaWQpO088RS5sZW5ndGg7TysrKXt2YXIgcj1FW09dO0kuc2V0Q2VsbChyWzBdLHJbMV0pfXZhciBlPUIuZ2V0SWRDaGFuZ2VzKHMuaWQpO2Zvcih2YXIgbyBpbiBlKWUuaGFzT3duUHJvcGVydHkobykmJkkuc2V0VmFsdWVJZGVudGlmaWVySWQobyxlW29dKTtJLmV4Y2VwdGlvbkV2YWxJZD1CLmV4Y2VwdGlvbkV2YWxJZH19cmV0dXJuIFZ9fSw0OTQ6ZnVuY3Rpb24oZmUsdSxLKXt2YXIgbSxnPXRoaXMmJnRoaXMuX19leHRlbmRzfHwobT1mdW5jdGlvbihsLHQpe3JldHVybihtPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihuLGkpe24uX19wcm90b19fPWl9fHxmdW5jdGlvbihuLGkpe2Zvcih2YXIgYSBpbiBpKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChpLGEpJiYoblthXT1pW2FdKX0pKGwsdCl9LGZ1bmN0aW9uKGwsdCl7aWYodHlwZW9mIHQhPSJmdW5jdGlvbiImJnQhPT1udWxsKXRocm93IG5ldyBUeXBlRXJyb3IoIkNsYXNzIGV4dGVuZHMgdmFsdWUgIitTdHJpbmcodCkrIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsIik7ZnVuY3Rpb24gbigpe3RoaXMuY29uc3RydWN0b3I9bH1tKGwsdCksbC5wcm90b3R5cGU9dD09PW51bGw/T2JqZWN0LmNyZWF0ZSh0KToobi5wcm90b3R5cGU9dC5wcm90b3R5cGUsbmV3IG4pfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KHUsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHUuUGF0dGVybkd1YXJkPXUuV2hpbGU9dS5Db25kaXRpb25hbD11LkNhc2VBbmFseXNpcz11LlJlY29yZFNlbGVjdG9yPXUuU2VxdWVuY2U9dS5MaXN0PXUuVHVwbGU9dS5EaXNqdW5jdGlvbj11LkNvbmp1bmN0aW9uPXUuSW5maXhFeHByZXNzaW9uPXUuTmVzdGVkTWF0Y2g9dS5EaXNqdW5jdGl2ZVBhdHRlcm49dS5Db25qdW5jdGl2ZVBhdHRlcm49dS5WZWN0b3I9dS5MYXllcmVkUGF0dGVybj11LldpbGRjYXJkPXUuTWF0Y2g9dS5MYW1iZGE9dS5SYWlzZUV4Y2VwdGlvbj11LkhhbmRsZUV4Y2VwdGlvbj11LkZ1bmN0aW9uQXBwbGljYXRpb249dS5UeXBlZEV4cHJlc3Npb249dS5Mb2NhbERlY2xhcmF0aW9uRXhwcmVzc2lvbj11LlJlY29yZD11LlZhbHVlSWRlbnRpZmllcj11LkNvbnN0YW50PXUuRXhwcmVzc2lvbj12b2lkIDA7dmFyIHM9Syg2OTkpLHE9Syg2NTUpLEI9Syg1MzQpLE09SygzNjcpLFY9Syg3NTgpLEQ9SygxMDYpLGg9ZnVuY3Rpb24oKXtmdW5jdGlvbiBsKCl7fXJldHVybiBsLnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKHQsbixpLGEsZixTKXt0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ0NhbGxlZCAiZ2V0VHlwZSIgb24gYSBkZXJpdmVkIGZvcm0uIFsnK3RoaXMrIl0iKX0sbC5wcm90b3R5cGUuY29tcHV0ZT1mdW5jdGlvbih0LG4pe3Rocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignQ2FsbGVkICJnZXRWYWx1ZSIgb24gYSBkZXJpdmVkIGZvcm0uIFsnK3RoaXMrIl0iKX0sbC5wcm90b3R5cGUuaXNTYWZlPWZ1bmN0aW9uKHQpe3JldHVybiEwfSxsLnByb3RvdHlwZS5nZXRFeHBsaWNpdFR5cGVWYXJpYWJsZXM9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFNldH0sbC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIllvdSBodW1hbnMgY2FuJ3Qgc2VlbSB0byB3cml0ZSBidWctZnJlZSBjb2RlLiBXaGF0IGFuIGluZmVyaW9yIHNwZWNpZXMuIil9LGwucHJvdG90eXBlLmFzc2VydFVuaXF1ZUJpbmRpbmc9ZnVuY3Rpb24odCxuKXtyZXR1cm4gbmV3IFNldH0sbH0oKTt1LkV4cHJlc3Npb249aDt2YXIgQT1mdW5jdGlvbihsKXtmdW5jdGlvbiB0KG4pe3ZhciBpPWwuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gaS50b2tlbj1uLGl9cmV0dXJuIGcodCxsKSx0LnByb3RvdHlwZS5tYXRjaFR5cGU9ZnVuY3Rpb24obixpLGEpe3JldHVybltbXSx0aGlzLmdldFR5cGUobixpKVswXSxpXX0sdC5wcm90b3R5cGUuc3Vic3VtZXM9ZnVuY3Rpb24obixpKXtmb3IoO2kgaW5zdGFuY2VvZiByOylpPWkuZXhwcmVzc2lvbjtyZXR1cm4gaSBpbnN0YW5jZW9mIHQmJnRoaXMudG9TdHJpbmcoKT09PWkudG9TdHJpbmcoKX0sdC5wcm90b3R5cGUuY292ZXI9ZnVuY3Rpb24obixpKXt0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIlx1NEUwMFx1NjYyOFx1NjVFNVx1Njc2NVx1MzA4NFx1MzA0Q1x1MzA4Q1x1MzAwMiIpfSx0LnByb3RvdHlwZS5tYXRjaGVzPWZ1bmN0aW9uKG4saSl7dmFyIGE9dGhpcy5jb21wdXRlKHtzdGF0ZTpuLG1vZGlmaWFibGU6bixyZWNSZXN1bHQ6dm9pZCAwfSxbXSk7aWYoYT09PXZvaWQgMHx8YS52YWx1ZT09PXZvaWQgMCl0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIlJpZ2h0IG5vdywgSSdtIHRoZSBoYXBwaWVzdCBpbnRlcnByZXRlciBpbiB0aGUgd29ybGQhIik7cmV0dXJuIGEudmFsdWUuZXF1YWxzKGkpP1tdOnZvaWQgMH0sdC5wcm90b3R5cGUuZ2V0VHlwZT1mdW5jdGlvbihuLGksYSxmLFMsTCl7aWYoaT09PXZvaWQgMCYmKGk9bmV3IE1hcCksYT09PXZvaWQgMCYmKGE9IicqdDAiKSxmPT09dm9pZCAwJiYoZj1uZXcgU2V0KSx0aGlzLnRva2VuIGluc3RhbmNlb2YgQi5JbnRlZ2VyQ29uc3RhbnRUb2tlbnx8dGhpcy50b2tlbiBpbnN0YW5jZW9mIEIuTnVtZXJpY1Rva2VuKXJldHVybltuZXcgcy5DdXN0b21UeXBlKCJpbnQiKSxbXSxhLGYsaSxuLnZhbHVlSWRlbnRpZmllcklkXTtpZih0aGlzLnRva2VuIGluc3RhbmNlb2YgQi5SZWFsQ29uc3RhbnRUb2tlbilyZXR1cm5bbmV3IHMuQ3VzdG9tVHlwZSgicmVhbCIpLFtdLGEsZixpLG4udmFsdWVJZGVudGlmaWVySWRdO2lmKHRoaXMudG9rZW4gaW5zdGFuY2VvZiBCLldvcmRDb25zdGFudFRva2VuKXJldHVybltuZXcgcy5DdXN0b21UeXBlKCJ3b3JkIiksW10sYSxmLGksbi52YWx1ZUlkZW50aWZpZXJJZF07aWYodGhpcy50b2tlbiBpbnN0YW5jZW9mIEIuQ2hhcmFjdGVyQ29uc3RhbnRUb2tlbilyZXR1cm5bbmV3IHMuQ3VzdG9tVHlwZSgiY2hhciIpLFtdLGEsZixpLG4udmFsdWVJZGVudGlmaWVySWRdO2lmKHRoaXMudG9rZW4gaW5zdGFuY2VvZiBCLlN0cmluZ0NvbnN0YW50VG9rZW4pcmV0dXJuW25ldyBzLkN1c3RvbVR5cGUoInN0cmluZyIpLFtdLGEsZixpLG4udmFsdWVJZGVudGlmaWVySWRdO3Rocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignIicrdGhpcysnIiBkb2VzIG5vdCBzZWVtIHRvIGJlIGEgdmFsaWQgY29uc3RhbnQuJyl9LHQucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LHQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudG9rZW4uZ2V0VGV4dCgpfSx0LnByb3RvdHlwZS5jb21wdXRlPWZ1bmN0aW9uKG4saSl7dmFyIGE9dm9pZCAwO2lmKHRoaXMudG9rZW4gaW5zdGFuY2VvZiBCLkludGVnZXJDb25zdGFudFRva2VufHx0aGlzLnRva2VuIGluc3RhbmNlb2YgQi5OdW1lcmljVG9rZW4/YT1uZXcgRC5JbnRlZ2VyKHRoaXMudG9rZW4udmFsdWUpOnRoaXMudG9rZW4gaW5zdGFuY2VvZiBCLlJlYWxDb25zdGFudFRva2VuP2E9bmV3IEQuUmVhbCh0aGlzLnRva2VuLnZhbHVlKTp0aGlzLnRva2VuIGluc3RhbmNlb2YgQi5Xb3JkQ29uc3RhbnRUb2tlbj9hPW5ldyBELldvcmQodGhpcy50b2tlbi52YWx1ZSk6dGhpcy50b2tlbiBpbnN0YW5jZW9mIEIuQ2hhcmFjdGVyQ29uc3RhbnRUb2tlbj9hPW5ldyBELkNoYXJWYWx1ZSh0aGlzLnRva2VuLnZhbHVlKTp0aGlzLnRva2VuIGluc3RhbmNlb2YgQi5TdHJpbmdDb25zdGFudFRva2VuJiYoYT1uZXcgRC5TdHJpbmdWYWx1ZSh0aGlzLnRva2VuLnZhbHVlKSksYT09PXZvaWQgMCl0aHJvdyBuZXcgVi5FdmFsdWF0aW9uRXJyb3IoIllvdSBzdXJlIHRoYXQgdGhpcyBpcyBhIGNvbnN0YW50PyIpO3JldHVybntuZXdTdGF0ZTp2b2lkIDAsdmFsdWU6YSxoYXNUaHJvd246ITF9fSx0fShoKTt1LkNvbnN0YW50PUE7dmFyIEk9ZnVuY3Rpb24obCl7ZnVuY3Rpb24gdChuKXt2YXIgaT1sLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIGkubmFtZT1uLGl9cmV0dXJuIGcodCxsKSx0LnByb3RvdHlwZS5nZXRDb25zdHJ1Y3Rvck5hbWU9ZnVuY3Rpb24obil7dmFyIGk9dGhpcy5uYW1lLmdldFRleHQoKSxhPW4uZ2V0U3RhdGljVmFsdWUoaSk7aWYoYSE9PXZvaWQgMCYmYVsxXSE9PU0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSlyZXR1cm4gaX0sdC5wcm90b3R5cGUuZ2V0Q29uc3RydWN0b3JMaXN0PWZ1bmN0aW9uKG4pe3ZhciBpPXRoaXMubmFtZS5nZXRUZXh0KCksYT1uLmdldFN0YXRpY1ZhbHVlKGkpO2lmKGEhPT12b2lkIDAmJmFbMV0hPT1NLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpe2lmKGFbMV09PT1NLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfQ09OU1RSVUNUT1Ipe2Zvcih2YXIgZj1hWzBdO2YgaW5zdGFuY2VvZiBzLlR5cGVWYXJpYWJsZUJpbmQ7KWY9Zi50eXBlO2lmKGYgaW5zdGFuY2VvZiBzLkZ1bmN0aW9uVHlwZSYmKGY9Zi5yZXR1cm5UeXBlKSwhKGYgaW5zdGFuY2VvZiBzLkN1c3RvbVR5cGUpKXJldHVybjt2YXIgUz1mLm5hbWUsTD1uLmdldFN0YXRpY1R5cGUoUyk7cmV0dXJuIEw9PT12b2lkIDA/dm9pZCAwOkwuY29uc3RydWN0b3JzfXJldHVyblsiX19leG4iXX19LHQucHJvdG90eXBlLmdldFR5cGU9ZnVuY3Rpb24obixpLGEsZixTLEwpe2k9PT12b2lkIDAmJihpPW5ldyBNYXApLGE9PT12b2lkIDAmJihhPSInKnQwIiksZj09PXZvaWQgMCYmKGY9bmV3IFNldCksTD09PXZvaWQgMCYmKEw9bmV3IE1hcCk7dmFyIGs9dm9pZCAwO2lmKHRoaXMubmFtZSBpbnN0YW5jZW9mIEIuTG9uZ0lkZW50aWZpZXJUb2tlbil7dmFyIFU9bi5nZXRBbmRSZXNvbHZlU3RhdGljU3RydWN0dXJlKHRoaXMubmFtZSk7aWYoVSE9PXZvaWQgMCYmKGs9VS5nZXRWYWx1ZSh0aGlzLm5hbWUuaWQuZ2V0VGV4dCgpKSkhPT12b2lkIDApe3ZhciBqPW5ldyBNLlN0YXRlKDAsdm9pZCAwLFUsbi5keW5hbWljQmFzaXMsWzAse31dLDQpO2s9W2tbMF0ucXVhbGlmeShqLHRoaXMubmFtZSksa1sxXV19fWVsc2V7dmFyIFg9TC5nZXQodGhpcy5uYW1lLmdldFRleHQoKSk7az1YIT09dm9pZCAwP1tYLE0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV06bi5nZXRTdGF0aWNWYWx1ZSh0aGlzLm5hbWUuZ2V0VGV4dCgpKX1pZihrPT09dm9pZCAwKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoJ1VuYm91bmQgdmFsdWUgaWRlbnRpZmllciAiJyt0aGlzLm5hbWUuZ2V0VGV4dCgpKyciLicpO2Zvcih2YXIgWj1uZXcgU2V0LGVlPW5ldyBTZXQsdGU9bmV3IE1hcDtrWzBdaW5zdGFuY2VvZiBzLlR5cGVWYXJpYWJsZUJpbmQ7KWtbMF0uaXNGcmVlPyhlZT1lZS5hZGQoa1swXS5uYW1lKSx0ZT10ZS5zZXQoa1swXS5uYW1lLGtbMF0ubmFtZSkpOlo9Wi5hZGQoa1swXS5uYW1lKSxrWzBdPWtbMF0udHlwZTtaPVouYWRkKCIqIik7dmFyIG9lPVtdO1ouZm9yRWFjaChmdW5jdGlvbih1ZSl7dmFyIGllPWE9cy5UeXBlVmFyaWFibGUuZ2V0VW51c2VkVHlwZVZhcmlhYmxlTmFtZShuLGEsZixpLFopO3VlWzFdPT09IiciJiYoaWU9IiciK2llKSxvZS5wdXNoKGllKSx0ZT10ZS5zZXQodWUsaWUpfSk7Zm9yKHZhciBzZT0wO3NlPG9lLmxlbmd0aDsrK3NlKWY9Zi5hZGQob2Vbc2VdKTtyZXR1cm5ba1swXS5yZXBsYWNlVHlwZVZhcmlhYmxlcyh0ZSxlZSkuaW5zdGFudGlhdGUobixpKSxbXSxhLGYsaSxuLnZhbHVlSWRlbnRpZmllcklkXX0sdC5wcm90b3R5cGUubWF0Y2hUeXBlPWZ1bmN0aW9uKG4saSxhKXtpZih0aGlzLm5hbWUgaW5zdGFuY2VvZiBCLkxvbmdJZGVudGlmaWVyVG9rZW4pdGhyb3cgbmV3IFYuRWxhYm9yYXRpb25FcnJvcigiVmFyaWFibGUgbmFtZXMgaW4gcGF0dGVybnMgY2Fubm90IGJlIHF1YWxpZmllZC4iKTt2YXIgZj1uLmdldFN0YXRpY1ZhbHVlKHRoaXMubmFtZS5nZXRUZXh0KCkpO2lmKGY9PT12b2lkIDB8fGZbMV09PT1NLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpcmV0dXJuW1tbdGhpcy5uYW1lLmdldFRleHQoKSxhLmluc3RhbnRpYXRlKG4saSldXSxhLmluc3RhbnRpYXRlKG4saSksaV07dmFyIFM9dGhpcy5nZXRUeXBlKG4saSwiJypnMCIpO1NbM10uZm9yRWFjaChmdW5jdGlvbihrKXt2YXIgVT0iJypwIitrLnN1YnN0cmluZygzKTtrWzFdPT09IiciJiYoVT0iJycqcCIray5zdWJzdHJpbmcoNCkpLFNbNF09U1s0XS5zZXQoayxbbmV3IHMuVHlwZVZhcmlhYmxlKFUpLCExXSl9KSxmWzBdPVNbMF0saT1TWzRdO3RyeXt2YXIgTD1hLm1lcmdlKG4saSxmWzBdKTtyZXR1cm5bW10sTFswXSxMWzFdXX1jYXRjaChrKXt0aHJvdyBrIGluc3RhbmNlb2YgQXJyYXk/bmV3IFYuRWxhYm9yYXRpb25FcnJvcignVHlwZSBjbGFzaDogIicrYS5ub3JtYWxpemUoKVswXSsnIiB2cy4gIicrZlswXS5ub3JtYWxpemUoKVswXSsnIjogJytrWzBdKTprfX0sdC5wcm90b3R5cGUuc3Vic3VtZXM9ZnVuY3Rpb24obixpKXtmb3IoO2kgaW5zdGFuY2VvZiByOylpPWkuZXhwcmVzc2lvbjt2YXIgYT10aGlzLmdldENvbnN0cnVjdG9yTmFtZShuKTtyZXR1cm4gYT09PXZvaWQgMHx8aSBpbnN0YW5jZW9mIHQmJmE9PT1pLmdldENvbnN0cnVjdG9yTmFtZShuKX0sdC5wcm90b3R5cGUuY292ZXI9ZnVuY3Rpb24obixpKXtyZXR1cm5bXX0sdC5wcm90b3R5cGUubWF0Y2hlcz1mdW5jdGlvbihuLGkpe3ZhciBhPXZvaWQgMDtpZih0aGlzLm5hbWUgaW5zdGFuY2VvZiBCLkxvbmdJZGVudGlmaWVyVG9rZW4pe3ZhciBmPW4uZ2V0QW5kUmVzb2x2ZUR5bmFtaWNTdHJ1Y3R1cmUodGhpcy5uYW1lKTtmIT09dm9pZCAwJiYoYT1mLmdldFZhbHVlKHRoaXMubmFtZS5pZC5nZXRUZXh0KCkpKX1lbHNlIGE9bi5nZXREeW5hbWljVmFsdWUodGhpcy5uYW1lLmdldFRleHQoKSk7aWYoYT09PXZvaWQgMHx8YVsxXT09PU0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSlyZXR1cm5bW3RoaXMubmFtZS5nZXRUZXh0KCksaV1dO3RyeXtpZihpLmVxdWFscyhhWzBdKSlyZXR1cm5bXX1jYXRjaHtyZXR1cm5bW3RoaXMubmFtZS5nZXRUZXh0KCksaV1dfX0sdC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sdC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uYW1lLmdldFRleHQoKX0sdC5wcm90b3R5cGUuY29tcHV0ZT1mdW5jdGlvbihuLGkpe3ZhciBhPW4uc3RhdGUsZj12b2lkIDA7aWYodGhpcy5uYW1lIGluc3RhbmNlb2YgQi5Mb25nSWRlbnRpZmllclRva2VuKXt2YXIgUz1hLmdldEFuZFJlc29sdmVEeW5hbWljU3RydWN0dXJlKHRoaXMubmFtZSk7UyE9PXZvaWQgMCYmKGY9Uy5nZXRWYWx1ZSh0aGlzLm5hbWUuaWQuZ2V0VGV4dCgpKSl9ZWxzZSBmPWEuZ2V0RHluYW1pY1ZhbHVlKHRoaXMubmFtZS5nZXRUZXh0KCkpO2lmKGY9PT12b2lkIDApdGhyb3cgbmV3IFYuRXZhbHVhdGlvbkVycm9yKCdVbmJvdW5kIHZhbHVlIGlkZW50aWZpZXIgIicrdGhpcy5uYW1lLmdldFRleHQoKSsnIi4nKTtyZXR1cm4gZlsxXT09PU0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9DT05TVFJVQ1RPUiYmZlswXS5udW1BcmdzPT09MHx8ZlsxXT09PU0uSWRlbnRpZmllclN0YXR1cy5FWENFUFRJT05fQ09OU1RSVUNUT1ImJmZbMF0ubnVtQXJncz09PTA/e25ld1N0YXRlOnZvaWQgMCx2YWx1ZTpmWzBdLmNvbnN0cnVjdCgpLGhhc1Rocm93bjohMX06e25ld1N0YXRlOnZvaWQgMCx2YWx1ZTpmWzBdLGhhc1Rocm93bjohMX19LHQucHJvdG90eXBlLmFzc2VydFVuaXF1ZUJpbmRpbmc9ZnVuY3Rpb24obixpKXtpZihpLmhhcyh0aGlzLm5hbWUuZ2V0VGV4dCgpKSlyZXR1cm4gbmV3IFNldDt2YXIgYT1uLmdldFN0YXRpY1ZhbHVlKHRoaXMubmFtZS5nZXRUZXh0KCkpO2lmKGEhPT12b2lkIDAmJmFbMV0hPT1NLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpcmV0dXJuIG5ldyBTZXQ7dmFyIGY9bi5nZXREeW5hbWljVmFsdWUodGhpcy5uYW1lLmdldFRleHQoKSk7cmV0dXJuIGYhPT12b2lkIDAmJmZbMV0hPT1NLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEU/bmV3IFNldDpuZXcgU2V0KCkuYWRkKHRoaXMubmFtZS5nZXRUZXh0KCkpfSx0fShoKTt1LlZhbHVlSWRlbnRpZmllcj1JO3ZhciBPPWZ1bmN0aW9uKGwpe2Z1bmN0aW9uIHQobixpKXt2YXIgYT1sLmNhbGwodGhpcyl8fHRoaXM7YS5jb21wbGV0ZT1uLGEuZW50cmllcz1pLGEuZW50cmllcy5zb3J0KCk7Zm9yKHZhciBmPTE7ZjxhLmVudHJpZXMubGVuZ3RoOysrZilpZihhLmVudHJpZXNbZl1bMF09PT1hLmVudHJpZXNbZi0xXVswXSl0aHJvdyBuZXcgVi5FbGFib3JhdGlvbkVycm9yKCdMYWJlbCAiJythLmVudHJpZXNbZl1bMF0rJyIgb2NjdXJzIG1vcmUgdGhhbiBvbmNlIGluIHRoZSBzYW1lIHJlY29yZC4nKTtyZXR1cm4gYX1yZXR1cm4gZyh0LGwpLHQucHJvdG90eXBlLmhhc0NvbnN0YW50PWZ1bmN0aW9uKCl7Zm9yKHZhciBuPTAsaT10aGlzLmVudHJpZXM7bjxpLmxlbmd0aDtuKyspe3ZhciBhPWlbbl07aWYoYVsxXWluc3RhbmNlb2YgQXx8YVsxXWluc3RhbmNlb2YgdCYmYVsxXS5oYXNDb25zdGFudCgpKXJldHVybiEwfXJldHVybiExfSx0LnByb3RvdHlwZS5zdWJzdW1lcz1mdW5jdGlvbihuLGkpe2Zvcig7aSBpbnN0YW5jZW9mIHI7KWk9aS5leHByZXNzaW9uO2lmKCEoaSBpbnN0YW5jZW9mIHQpKXJldHVybiExO2Zvcih2YXIgYT0wLGY9MDthPHRoaXMuZW50cmllcy5sZW5ndGh8fGY8aS5lbnRyaWVzLmxlbmd0aDspe3ZhciBTPWE8dGhpcy5lbnRyaWVzLmxlbmd0aD90aGlzLmVudHJpZXNbYV06dm9pZCAwLEw9ZjxpLmVudHJpZXMubGVuZ3RoP2kuZW50cmllc1tmXTp2b2lkIDA7aWYoTD09PXZvaWQgMHx8UyE9PXZvaWQgMCYmU1swXTxMWzBdKXtpZihTPT09dm9pZCAwKWJyZWFrO2lmKFNbMV0uc3Vic3VtZXMobixuZXcgQykpeysrYTtjb250aW51ZX1yZXR1cm4hMX1pZihTIT09dm9pZCAwJiZMIT09dm9pZCAwJiZTWzBdPT09TFswXSl7aWYoU1sxXS5zdWJzdW1lcyhuLExbMV0pKXsrK2EsKytmO2NvbnRpbnVlfXJldHVybiExfWlmKFM9PT12b2lkIDB8fEwhPT12b2lkIDAmJlNbMF0+TFswXSl7aWYoTD09PXZvaWQgMClicmVhaztpZihuZXcgQygpLnN1YnN1bWVzKG4sTFsxXSkpeysrZjtjb250aW51ZX1yZXR1cm4hMX19cmV0dXJuITB9LHQucHJvdG90eXBlLmdldEV4cGxpY2l0VHlwZVZhcmlhYmxlcz1mdW5jdGlvbigpe2Zvcih2YXIgbj1uZXcgU2V0LGk9MDtpPHRoaXMuZW50cmllcy5sZW5ndGg7KytpKXRoaXMuZW50cmllc1tpXVsxXS5nZXRFeHBsaWNpdFR5cGVWYXJpYWJsZXMoKS5mb3JFYWNoKGZ1bmN0aW9uKGEpe249bi5hZGQoYSl9KTtyZXR1cm4gbn0sdC5wcm90b3R5cGUuaGFzRW50cnk9ZnVuY3Rpb24obil7Zm9yKHZhciBpPTA7aTx0aGlzLmVudHJpZXMubGVuZ3RoOysraSlpZih0aGlzLmVudHJpZXNbaV1bMF09PT1uKXJldHVybiEwO3JldHVybiExfSx0LnByb3RvdHlwZS5nZXRFbnRyeT1mdW5jdGlvbihuKXtmb3IodmFyIGk9MDtpPHRoaXMuZW50cmllcy5sZW5ndGg7KytpKWlmKHRoaXMuZW50cmllc1tpXVswXT09PW4pcmV0dXJuIHRoaXMuZW50cmllc1tpXVsxXTt0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ1llYWgsICInK24rJyIgd291bGQgYmUgbmljZSB0byBoYXZlLicpfSx0LnByb3RvdHlwZS5pc1NhZmU9ZnVuY3Rpb24obil7Zm9yKHZhciBpPTA7aTx0aGlzLmVudHJpZXMubGVuZ3RoOysraSlpZighdGhpcy5lbnRyaWVzW2ldWzFdLmlzU2FmZShuKSlyZXR1cm4hMTtyZXR1cm4hMH0sdC5wcm90b3R5cGUubWF0Y2hUeXBlPWZ1bmN0aW9uKG4saSxhKXtpZihhIGluc3RhbmNlb2Ygcy5SZWNvcmRUeXBlfHwoYT1hLmluc3RhbnRpYXRlKG4saSkpLGEgaW5zdGFuY2VvZiBzLlR5cGVWYXJpYWJsZXx8YSBpbnN0YW5jZW9mIHMuUmVjb3JkVHlwZSYmIWEuY29tcGxldGUpe3ZhciBmPW5ldyBNYXAsUz0iIixMPSExO2lmKGEgaW5zdGFuY2VvZiBzLlR5cGVWYXJpYWJsZSlTPWEubmFtZSxMPWEuaXNGcmVlO2Vsc2V7aWYoIShhIGluc3RhbmNlb2Ygcy5SZWNvcmRUeXBlJiZhLnNvdXJjZVR5VmFyIT09dm9pZCAwKSl0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIkFuIGluY29tcGxldGUgcmVjb3JkIHR5cGUganVzdCBkaWVkLiIpO2lmKFM9YS5zb3VyY2VUeVZhciwhaS5oYXMoUykpdGhyb3cgbmV3IFYuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJBbiBpbmNvbXBsZXRlIHJlY29yZCB0eXBlIGp1c3QgZGllZC4iKTtMPWkuZ2V0KFMpWzFdfWZvcih2YXIgaz0wO2s8dGhpcy5lbnRyaWVzLmxlbmd0aDsrK2spe3ZhciBVPW5ldyBzLlR5cGVWYXJpYWJsZShTKyIqIit0aGlzLmVudHJpZXNba11bMF0pO1UuaXNGcmVlPUwsZj1mLnNldCh0aGlzLmVudHJpZXNba11bMF0sVSl9dmFyIGo9bmV3IHMuUmVjb3JkVHlwZShmLHRoaXMuY29tcGxldGUsdGhpcy5jb21wbGV0ZT92b2lkIDA6Uyk7aWYoaS5oYXMoIkAiK1MpKXt2YXIgWD1pLmdldCgiQCIrUyk7dHJ5e3ZhciBaPVhbMF0ubWVyZ2UobixpLGopO2k9aS5zZXQoIkAiK1MsW1pbMF0sTF0pLHRoaXMuY29tcGxldGUmJihpPWkuc2V0KFMsW1pbMF0sTF0pKX1jYXRjaChwZSl7dGhyb3cgcGUgaW5zdGFuY2VvZiBBcnJheT9uZXcgVi5FbGFib3JhdGlvbkVycm9yKCdUeXBlIG1pc21hdGNoICInK1hbMF0ubm9ybWFsaXplKClbMF0rJyIgdnMuICInK2oubm9ybWFsaXplKClbMF0rJyI6ICcrcGVbMF0pOnBlfX1lbHNlIGk9aS5zZXQoIkAiK1MsW2osTF0pO2E9an1pZighKGEgaW5zdGFuY2VvZiBzLlJlY29yZFR5cGUpKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoJ0V4cGVjdGVkIHBhdHRlcm4gb2YgYSByZWNvcmQgdHlwZSwgZ290ICInK2EudHlwZU5hbWUoKSsnIi4nKTtpZih0aGlzLmNvbXBsZXRlJiZhLmNvbXBsZXRlJiZ0aGlzLmVudHJpZXMubGVuZ3RoIT09YS5lbGVtZW50cy5zaXplKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoIkV4cGVjdGVkIGEgcmVjb3JkIHR5cGUgd2l0aCAiK3RoaXMuZW50cmllcy5sZW5ndGgrIiBlbnRyaWVzLCBidXQgdGhlIGdpdmVuIHJlY29yZCBoYXMgIithLmVsZW1lbnRzLnNpemUrIiBlbnRyaWVzLiIpO3ZhciBlZT1bXSx0ZT1uZXcgTWFwLG9lPWksc2U9bmV3IFNldDtmb3Ioaz0wO2s8dGhpcy5lbnRyaWVzLmxlbmd0aDsrK2spe2lmKHNlPXNlLmFkZCh0aGlzLmVudHJpZXNba11bMF0pLCFhLmhhc1R5cGUodGhpcy5lbnRyaWVzW2tdWzBdKSl7aWYoYS5jb21wbGV0ZSl0aHJvdyBuZXcgVi5FbGFib3JhdGlvbkVycm9yKCdSZWNvcmQgaXMgbWlzc2luZyBlbnRyeSAiJyt0aGlzLmVudHJpZXNba11bMF0rJyIuJyk7YS5zZXRUeXBlKHRoaXMuZW50cmllc1trXVswXSxuZXcgcy5UeXBlVmFyaWFibGUoIip6IitrKyIqIithLnRvU3RyaW5nKCkubGVuZ3RoKyIqIikpfXZhciB1ZT10aGlzLmVudHJpZXNba11bMV0ubWF0Y2hUeXBlKG4sb2UsYS5nZXRUeXBlKHRoaXMuZW50cmllc1trXVswXSkpO2VlPWVlLmNvbmNhdCh1ZVswXSksdGU9dGUuc2V0KHRoaXMuZW50cmllc1trXVswXSx1ZVsxXSksb2U9dWVbMl19dmFyIGllPW5ldyBzLlJlY29yZFR5cGUodGUsdGhpcy5jb21wbGV0ZXx8YS5jb21wbGV0ZSk7dHJ5e3JldHVybltlZSwoWj1pZS5tZXJnZShuLG9lLGEpKVswXSxaWzFdXX1jYXRjaChwZSl7dGhyb3cgcGUgaW5zdGFuY2VvZiBBcnJheT9uZXcgVi5FbGFib3JhdGlvbkVycm9yKCdUeXBlIG1pc21hdGNoICInK2Eubm9ybWFsaXplKClbMF0rJyIgdnMuICInK2llLm5vcm1hbGl6ZSgpWzBdKyciOiAnK3BlWzBdKTpwZX19LHQucHJvdG90eXBlLmNvdmVyPWZ1bmN0aW9uKG4saSl7aWYodGhpcy5lbnRyaWVzLmxlbmd0aD09PTApcmV0dXJuIGkubGVuZ3RoPT09MD9bbmV3IFYuV2FybmluZygtMSxgUGF0dGVybiBtYXRjaGluZyBpcyBub3QgZXhoYXVzdGl2ZS4KYCldOltdO2Zvcih2YXIgYT10aGlzLmVudHJpZXNbMF1bMF0sZj1bXSxTPW5ldyBNYXAsTD1uZXcgQyxrPVtdLFU9W10saj1bXSxYPVtdLFo9W10sZWU9W10sdGU9dm9pZCAwLG9lPW5ldyBTZXQsc2U9ZnVuY3Rpb24oaGUpe2lmKHRlIT09dm9pZCAwKXJldHVybiBlZS5wdXNoKG5ldyBWLldhcm5pbmcoMCwnUnVsZXMgYWZ0ZXIgIicrdGUrYCIgdW51c2VkIGluIHBhdHRlcm4gbWF0Y2hpbmcuCmApKSwiYnJlYWsiO2lmKCEoaGUgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIlBpcGlydSBwaXJ1IHBpcnUgcGlwaXJ1IHBpaSEiKTtpZihoZS5oYXNDb25zdGFudCgpKXJldHVybiJjb250aW51ZSI7aGUuc3Vic3VtZXMobix1ZSkmJih0ZT1oZS50b1N0cmluZygpKTtmb3IodmFyIGdlPVtdLHllPXZvaWQgMCx3ZT0wLHhlPWhlLmVudHJpZXM7d2U8eGUubGVuZ3RoO3dlKyspe3ZhciBFZT14ZVt3ZV07RWVbMF09PT1hPyh5ZT1FZVsxXSlpbnN0YW5jZW9mIGUmJmdlLnB1c2goW0VlWzBdLHllLmFyZ3VtZW50XSk6Z2UucHVzaChFZSl9aWYoeWU9PT12b2lkIDAmJih5ZT1MKSx5ZSBpbnN0YW5jZW9mIEkpe2lmKHllLmdldENvbnN0cnVjdG9yTmFtZShuKT09PXZvaWQgMCl5ZT1MO2Vsc2UgaWYoVS5sZW5ndGg9PT0wKXtpZigoUmU9eWUuZ2V0Q29uc3RydWN0b3JMaXN0KG4pKT09PXZvaWQgMCl0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIlBpcGlydSBwaXJ1IHBpcnUgcGlwaXJ1IHBpaSEiKTtVPVJlfX1pZihmLnB1c2goeWUpLHllIGluc3RhbmNlb2YgdCl7aWYoeWUuaGFzQ29uc3RhbnQoKSlyZXR1cm4iY29udGludWUiO3ZhciBtZT1bXTtaLnB1c2goWyExLCExXSk7Zm9yKHZhciB2ZT0wO3ZlPGoubGVuZ3RoOysrdmUpe3ZhciBBZT15ZS5zdWJzdW1lcyhuLGpbdmVdKSxEZT1qW3ZlXS5zdWJzdW1lcyhuLHllKTtBZSYmKFpbdmVdWzBdPSEwLFpbai5sZW5ndGhdWzFdPSEwLChMZT1TLmdldCh2ZSsiIikpLnB1c2gobmV3IHQoaGUuY29tcGxldGUsZ2UpKSxTPVMuc2V0KHZlKyIiLExlKSksRGUmJihaW3ZlXVsxXT0hMCxaW2oubGVuZ3RoXVswXT0hMCxtZS5wdXNoKG5ldyB0KGhlLmNvbXBsZXRlLFhbdmVdKSkpfXJldHVybiBtZS5wdXNoKG5ldyB0KGhlLmNvbXBsZXRlLGdlKSksUz1TLnNldChqLmxlbmd0aCsiIixrLmNvbmNhdChtZSkpLGoucHVzaCh5ZSksWC5wdXNoKGdlKSwiY29udGludWUifXZhciBMZSxPZT0hMSxWZT15ZS50b1N0cmluZygpO2lmKHllIGluc3RhbmNlb2YgZSl7T2U9ITA7dmFyIEJlPXllLmZ1bmM7aWYoIShCZSBpbnN0YW5jZW9mIEkpKXRocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiVGhlcmUuIEp1c3QgYW5vdGhlciB1bmZvcnR1bmF0ZSBhY2NpZGVudC4iKTtpZihWZT1CZS5uYW1lLmdldFRleHQoKSxVLmxlbmd0aD09PTApe3ZhciBSZTtpZigoUmU9QmUuZ2V0Q29uc3RydWN0b3JMaXN0KG4pKT09PXZvaWQgMCl0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIlBpcGlydSBwaXJ1IHBpcnUgcGlwaXJ1IHBpaSEiKTtVPVJlfX1pZihWZSs9eWUuY29uc3RydWN0b3IubmFtZSxPZSYmKG9lPW9lLmFkZChWZSkpLHllIGluc3RhbmNlb2YgQSlyZXR1cm4iY29udGludWUiO2lmKHllIGluc3RhbmNlb2YgQyl7ay5wdXNoKG5ldyB0KGhlLmNvbXBsZXRlLGdlKSk7dmFyIENlPW5ldyBNYXA7cmV0dXJuIFMuZm9yRWFjaChmdW5jdGlvbihfZSxxZSl7X2UucHVzaChuZXcgdChoZS5jb21wbGV0ZSxnZSkpLENlPUNlLnNldChxZSxfZSl9KSxTPUNlLCJjb250aW51ZSJ9Uy5oYXMoVmUpPygoTGU9Uy5nZXQoVmUpKS5wdXNoKG5ldyB0KGhlLmNvbXBsZXRlLGdlKSksUz1TLnNldChWZSxMZSkpOlM9Uy5zZXQoVmUsay5jb25jYXQoW25ldyB0KGhlLmNvbXBsZXRlLGdlKV0pKX0sdWU9dGhpcyxpZT0wLHBlPWk7aWU8cGUubGVuZ3RoJiZzZShwZVtpZV0pIT09ImJyZWFrIjtpZSsrKTtlZT1lZS5jb25jYXQoTC5jb3ZlcihuLGYpLmZpbHRlcihmdW5jdGlvbihoZSl7cmV0dXJuIGhlLnR5cGU9PT0tMX0pKTtmb3IodmFyIHJlPVtdLGFlPTE7YWU8dGhpcy5lbnRyaWVzLmxlbmd0aDsrK2FlKXJlLnB1c2godGhpcy5lbnRyaWVzW2FlXSk7dmFyIGNlPW5ldyB0KCEwLHJlKSxsZT1bXTtmb3IobGUucHVzaChbdGhpcy5lbnRyaWVzWzBdWzBdLG5ldyBDXSksYWU9MTthZTx0aGlzLmVudHJpZXMubGVuZ3RoOysrYWUpbGUucHVzaCh0aGlzLmVudHJpZXNbYWVdKTt2YXIgZGU9bmV3IHQoITAsbGUpO3JldHVybiBTLmZvckVhY2goZnVuY3Rpb24oaGUsZ2Upe2lmKG9lLmhhcyhnZSkpe2Zvcih2YXIgeWU9W10sd2U9MCx4ZT1oZTt3ZTx4ZS5sZW5ndGg7d2UrKyl7dmFyIEVlPXhlW3dlXTtpZihFZSBpbnN0YW5jZW9mIHQpaWYoRWUuaGFzRW50cnkoYSkpeWUucHVzaChFZSk7ZWxzZXt2YXIgbWU9W107bWUucHVzaChbYSxuZXcgQ10pO2Zvcih2YXIgdmU9MDt2ZTxFZS5lbnRyaWVzLmxlbmd0aDsrK3ZlKW1lLnB1c2goRWUuZW50cmllc1t2ZV0pO3llLnB1c2gobmV3IHQoITAsbWUpKX1lbHNlIHllLnB1c2goRWUpfWVlPWVlLmNvbmNhdChkZS5jb3ZlcihuLHllKS5maWx0ZXIoZnVuY3Rpb24oQWUpe3JldHVybiBBZS50eXBlPT09LTF9KSl9ZWxzZSBlZT1lZS5jb25jYXQoY2UuY292ZXIobixoZSkuZmlsdGVyKGZ1bmN0aW9uKEFlKXtyZXR1cm4gQWUudHlwZT09PS0xfSkpfSksKFMuc2l6ZT09PTB8fFMuc2l6ZTxVLmxlbmd0aCkmJihlZT1lZS5jb25jYXQoY2UuY292ZXIobixrKSkpLGVlfSx0LnByb3RvdHlwZS5tYXRjaGVzPWZ1bmN0aW9uKG4saSl7aWYoaSBpbnN0YW5jZW9mIEQuUmVjb3JkVmFsdWUmJighdGhpcy5jb21wbGV0ZXx8dGhpcy5lbnRyaWVzLmxlbmd0aD09PWkuZW50cmllcy5zaXplKSl7Zm9yKHZhciBhPVtdLGY9MDtmPHRoaXMuZW50cmllcy5sZW5ndGg7KytmKXtpZighaS5oYXNWYWx1ZSh0aGlzLmVudHJpZXNbZl1bMF0pKXJldHVybjt2YXIgUz10aGlzLmVudHJpZXNbZl1bMV0ubWF0Y2hlcyhuLGkuZ2V0VmFsdWUodGhpcy5lbnRyaWVzW2ZdWzBdKSk7aWYoUz09PXZvaWQgMClyZXR1cm4gUztmb3IodmFyIEw9MDtMPFMubGVuZ3RoOysrTClhLnB1c2goU1tMXSl9cmV0dXJuIGF9fSx0LnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKG4saSxhLGYsUyxMKXtpPT09dm9pZCAwJiYoaT1uZXcgTWFwKSxhPT09dm9pZCAwJiYoYT0iJyp0MCIpLGY9PT12b2lkIDAmJihmPW5ldyBTZXQpLFM9PT12b2lkIDAmJihTPSExKSxMPT09dm9pZCAwJiYoTD1uZXcgTWFwKTtmb3IodmFyIGs9bmV3IE1hcCxVPVtdLGo9aSxYPTA7WDx0aGlzLmVudHJpZXMubGVuZ3RoOysrWCl7dmFyIFo9dGhpcy5lbnRyaWVzW1hdWzBdLGVlPXRoaXMuZW50cmllc1tYXVsxXTtpZihrLmhhcyhaKSl0aHJvdyBuZXcgVi5FbGFib3JhdGlvbkVycm9yKCdMYWJlbCAiJytaKyciIG9jY3VycyBtb3JlIHRoYW4gb25jZSBpbiB0aGUgc2FtZSByZWNvcmQuJyk7aWYoZWUgaW5zdGFuY2VvZiBJJiZTKXt2YXIgdGU9bi5nZXRTdGF0aWNWYWx1ZShlZS5uYW1lLmdldFRleHQoKSk7aWYodGUhPT12b2lkIDAmJnRlWzFdIT09TS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFJiZ0ZVswXWluc3RhbmNlb2Ygcy5GdW5jdGlvblR5cGUpdGhyb3cgbmV3IFYuRWxhYm9yYXRpb25FcnJvcigiVW5hcnkgY29uc3RydWN0b3IgaW4gdGhlIHBhdHRlcm4gbmVlZHMgYW4gYXJndW1lbnQuIil9dmFyIG9lPWVlLmdldFR5cGUobixqLGEsZixTLEwpO1U9VS5jb25jYXQob2VbMV0pLGE9b2VbMl0sZj1vZVszXSxvZVs0XS5mb3JFYWNoKGZ1bmN0aW9uKHNlLHVlKXtqPWouc2V0KHVlLHNlKX0pLG4udmFsdWVJZGVudGlmaWVySWQ9b2VbNV0saz1rLnNldChaLG9lWzBdKX1yZXR1cm5bbmV3IHMuUmVjb3JkVHlwZShrLHRoaXMuY29tcGxldGUpLFUsYSxmLGosbi52YWx1ZUlkZW50aWZpZXJJZF19LHQucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7Zm9yKHZhciBuPVtdLGk9MDtpPHRoaXMuZW50cmllcy5sZW5ndGg7KytpKXt2YXIgYT10aGlzLmVudHJpZXNbaV07bi5wdXNoKFthWzBdLGFbMV0uc2ltcGxpZnkoKV0pfXJldHVybiBuZXcgdCh0aGlzLmNvbXBsZXRlLG4pfSx0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe2Zvcih2YXIgbj10aGlzLmVudHJpZXMubGVuZ3RoIT09MSxpPTA7aTx0aGlzLmVudHJpZXMubGVuZ3RoOysraSl0aGlzLmVudHJpZXNbaV1bMF0hPT0iIisoaSsxKSYmKG49ITEpO3ZhciBhPSJ7IjtpZihuKXtmb3IoYT0iKCIsaT0wO2k8dGhpcy5lbnRyaWVzLmxlbmd0aDsrK2kpaT4wJiYoYSs9IiwgIiksYSs9dGhpcy5lbnRyaWVzW2ldWzFdLnRvU3RyaW5nKCk7cmV0dXJuIGErIikifXZhciBmPSEwO2ZvcihpPTA7aTx0aGlzLmVudHJpZXMubGVuZ3RoOysraSlmfHwoYSs9IiwgIiksZj0hMSxhKz10aGlzLmVudHJpZXNbaV1bMF0rIiA9ICIrdGhpcy5lbnRyaWVzW2ldWzFdO3JldHVybiB0aGlzLmNvbXBsZXRlfHwoZnx8KGErPSIsICIpLGErPSIuLi4iKSxhKyJ9In0sdC5wcm90b3R5cGUuY29tcHV0ZT1mdW5jdGlvbihuLGkpe3ZhciBhPW4uc3RhdGU7bi5zdGVwPT09dm9pZCAwJiYobi5zdGVwPS0xLG4ubmVudHI9bmV3IE1hcCk7dmFyIGY9bi5uZW50cixTPW4uc3RlcDtpZihTPj0wKXt2YXIgTD1uLnJlY1Jlc3VsdDtpZihMPT09dm9pZCAwKXRocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiTmFtamFsYSBMYXRhayIpO2lmKEwuaGFzVGhyb3duKXJldHVybntuZXdTdGF0ZTp2b2lkIDAsdmFsdWU6TC52YWx1ZSxoYXNUaHJvd246ITB9O2Y9Zi5zZXQodGhpcy5lbnRyaWVzW1NdWzBdLEwudmFsdWUpfXJldHVybisrUzx0aGlzLmVudHJpZXMubGVuZ3RoPyhuLnN0ZXA9UyxuLm5lbnRyPWYsaS5wdXNoKHtuZXh0OnRoaXMscGFyYW1zOm59KSx2b2lkIGkucHVzaCh7bmV4dDp0aGlzLmVudHJpZXNbU11bMV0scGFyYW1zOntzdGF0ZTphLG1vZGlmaWFibGU6bi5tb2RpZmlhYmxlLHJlY1Jlc3VsdDp2b2lkIDB9fSkpOntuZXdTdGF0ZTp2b2lkIDAsdmFsdWU6bmV3IEQuUmVjb3JkVmFsdWUoZiksaGFzVGhyb3duOiExfX0sdC5wcm90b3R5cGUuYXNzZXJ0VW5pcXVlQmluZGluZz1mdW5jdGlvbihuLGkpe2Zvcih2YXIgYT1uZXcgU2V0LGY9MDtmPHRoaXMuZW50cmllcy5sZW5ndGg7KytmKXRoaXMuZW50cmllc1tmXVsxXS5hc3NlcnRVbmlxdWVCaW5kaW5nKG4saSkuZm9yRWFjaChmdW5jdGlvbihTKXtpZihhLmhhcyhTKSl0aHJvdyBuZXcgVi5QYXJzZXJFcnJvcihgRG9uJ3QgdHJ5IHRvIHJlYmluZCAiYCtTKyciICInK1MrJyIgaW4gdGhlIHNhbWUgcGF0dGVybi4uLiBTb3JyeSwgSSBzdHV0dGVyZWQuJyk7YT1hLmFkZChTKX0pO3JldHVybiBhfSx0fShoKTt1LlJlY29yZD1PO3ZhciBFPWZ1bmN0aW9uKGwpe2Z1bmN0aW9uIHQobixpKXt2YXIgYT1sLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIGEuZGVjbGFyYXRpb249bixhLmV4cHJlc3Npb249aSxhfXJldHVybiBnKHQsbCksdC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHQodGhpcy5kZWNsYXJhdGlvbi5zaW1wbGlmeSgpLHRoaXMuZXhwcmVzc2lvbi5zaW1wbGlmeSgpKX0sdC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4ibGV0ICIrdGhpcy5kZWNsYXJhdGlvbisiIGluICIrdGhpcy5leHByZXNzaW9uKyIgZW5kIn0sdC5wcm90b3R5cGUuaXNTYWZlPWZ1bmN0aW9uKG4pe3JldHVybiExfSx0LnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKG4saSxhLGYsUyxMKXtpPT09dm9pZCAwJiYoaT1uZXcgTWFwKSxhPT09dm9pZCAwJiYoYT0iJyp0MCIpLGY9PT12b2lkIDAmJihmPW5ldyBTZXQpLFM9PT12b2lkIDAmJihTPSExKSxMPT09dm9pZCAwJiYoTD1uZXcgTWFwKTt2YXIgaz1uZXcgTWFwO0wuZm9yRWFjaChmdW5jdGlvbihaLGVlKXtrPWsuc2V0KGVlLFopfSk7dmFyIFU9bi5nZXROZXN0ZWRTdGF0ZShuLmlkKSxqPXRoaXMuZGVjbGFyYXRpb24uZWxhYm9yYXRlKFUsaSxhLGssITEpLFg9dGhpcy5leHByZXNzaW9uLmdldFR5cGUoalswXSxqWzJdLGpbM10sZixTLGspO3JldHVybltYWzBdLGpbMV0uY29uY2F0KFhbMV0pLFhbMl0sWFszXSxYWzRdLFhbNV1dfSx0LnByb3RvdHlwZS5jb21wdXRlPWZ1bmN0aW9uKG4saSl7dmFyIGE9bi5zdGF0ZTtuLnN0ZXA9PT12b2lkIDAmJihuLnN0ZXA9LTEpO3ZhciBmPW4uc3RlcDtpZihmPT09LTEpe3ZhciBTPWEuZ2V0TmVzdGVkU3RhdGUoMCkuZ2V0TmVzdGVkU3RhdGUoYS5pZCk7cmV0dXJuIG4uc3RlcD1mKzEsbi5zdGF0ZT1hLGkucHVzaCh7bmV4dDp0aGlzLHBhcmFtczpufSksdm9pZCBpLnB1c2goe25leHQ6dGhpcy5kZWNsYXJhdGlvbixwYXJhbXM6e3N0YXRlOlMsbW9kaWZpYWJsZTpuLm1vZGlmaWFibGUscmVjUmVzdWx0OnZvaWQgMH19KX1pZihmPT09MCl7dmFyIEw9bi5yZWNSZXN1bHQ7aWYoTD09PXZvaWQgMHx8TC5uZXdTdGF0ZT09PXZvaWQgMCl0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIllvdSBzZWUsIGV2ZW4gSSBzbGVlcCBhdCBuaWdodCBhbmQgd2FrZSB1cCBpbiB0aGUgbW9ybmluZyIpO3JldHVybiBTPUwubmV3U3RhdGUsTC5oYXNUaHJvd24/e25ld1N0YXRlOnZvaWQgMCx2YWx1ZTpMLnZhbHVlLGhhc1Rocm93bjohMH06dm9pZCBpLnB1c2goe25leHQ6dGhpcy5leHByZXNzaW9uLHBhcmFtczp7c3RhdGU6Uyxtb2RpZmlhYmxlOm4ubW9kaWZpYWJsZSxyZWNSZXN1bHQ6dm9pZCAwfX0pfXZhciBrPW4ucmVjUmVzdWx0O2lmKGs9PT12b2lkIDApdGhyb3cgbmV3IFYuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCdJIGp1c3QgZ2F2ZSB0aGlzICJkeWluZyIgYSB0cnkuLi4nKTtyZXR1cm57bmV3U3RhdGU6dm9pZCAwLHZhbHVlOmsudmFsdWUsaGFzVGhyb3duOmsuaGFzVGhyb3dufX0sdC5wcm90b3R5cGUuYXNzZXJ0VW5pcXVlQmluZGluZz1mdW5jdGlvbihuLGkpe3JldHVybiB0aGlzLmRlY2xhcmF0aW9uLmFzc2VydFVuaXF1ZUJpbmRpbmcobixpKSx0aGlzLmV4cHJlc3Npb24uYXNzZXJ0VW5pcXVlQmluZGluZyhuLGkpLG5ldyBTZXR9LHR9KGgpO3UuTG9jYWxEZWNsYXJhdGlvbkV4cHJlc3Npb249RTt2YXIgcj1mdW5jdGlvbihsKXtmdW5jdGlvbiB0KG4saSl7dmFyIGE9bC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBhLmV4cHJlc3Npb249bixhLnR5cGVBbm5vdGF0aW9uPWksYX1yZXR1cm4gZyh0LGwpLHQucHJvdG90eXBlLmdldEV4cGxpY2l0VHlwZVZhcmlhYmxlcz1mdW5jdGlvbigpe3ZhciBuPW5ldyBTZXQ7cmV0dXJuIHRoaXMudHlwZUFubm90YXRpb24uZ2V0VHlwZVZhcmlhYmxlcygpLmZvckVhY2goZnVuY3Rpb24oaSxhKXtuPW4uYWRkKG5ldyBzLlR5cGVWYXJpYWJsZShhLGkpKX0pLG59LHQucHJvdG90eXBlLmlzU2FmZT1mdW5jdGlvbihuKXtyZXR1cm4gdGhpcy5leHByZXNzaW9uLmlzU2FmZShuKX0sdC5wcm90b3R5cGUubWF0Y2hUeXBlPWZ1bmN0aW9uKG4saSxhKXt2YXIgZj10aGlzLmV4cHJlc3Npb24ubWF0Y2hUeXBlKG4saSxhKTt0cnl7dmFyIFM9ZlsxXS5tZXJnZShuLGZbMl0sdGhpcy50eXBlQW5ub3RhdGlvbi5pbnN0YW50aWF0ZShuLGZbMl0pKTtyZXR1cm4gdGhpcy5leHByZXNzaW9uLm1hdGNoVHlwZShuLFNbMV0sU1swXSl9Y2F0Y2goTCl7dGhyb3cgTCBpbnN0YW5jZW9mIEFycmF5P25ldyBWLkVsYWJvcmF0aW9uRXJyb3IoJ1RoZSBhbm5vdGF0ZWQgdHlwZSAiJyt0aGlzLnR5cGVBbm5vdGF0aW9uK2AiIGRvZXMgbm90IG1hdGNoIHRoZSBleHByZXNzaW9uJ3MgdHlwZSAiYCtmWzFdLm5vcm1hbGl6ZSgpWzBdKyciOiAnK0xbMF0pOkx9fSx0LnByb3RvdHlwZS5zdWJzdW1lcz1mdW5jdGlvbihuLGkpe3JldHVybiB0aGlzLmV4cHJlc3Npb24uc3Vic3VtZXMobixpKX0sdC5wcm90b3R5cGUuY292ZXI9ZnVuY3Rpb24obixpKXt0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIlx1NEUwMFx1NjYyOFx1NjVFNVx1Njc2NVx1MzA4NFx1MzA0Q1x1MzA4Q1x1MzAwMiIpfSx0LnByb3RvdHlwZS5tYXRjaGVzPWZ1bmN0aW9uKG4saSl7cmV0dXJuIHRoaXMuZXhwcmVzc2lvbi5tYXRjaGVzKG4saSl9LHQucHJvdG90eXBlLmdldFR5cGU9ZnVuY3Rpb24obixpLGEsZixTLEwpe2k9PT12b2lkIDAmJihpPW5ldyBNYXApLGE9PT12b2lkIDAmJihhPSInKnQwIiksZj09PXZvaWQgMCYmKGY9bmV3IFNldCksUz09PXZvaWQgMCYmKFM9ITEpLEw9PT12b2lkIDAmJihMPW5ldyBNYXApO3ZhciBrPXRoaXMuZXhwcmVzc2lvbi5nZXRUeXBlKG4saSxhLGYsUyxMKTt0cnl7dmFyIFU9dGhpcy50eXBlQW5ub3RhdGlvbi5pbnN0YW50aWF0ZShuLGtbNF0pLGo9a1swXS5tZXJnZShuLGtbNF0sVSk7cmV0dXJuW2pbMF0sa1sxXSxrWzJdLGtbM10salsxXSxrWzVdXX1jYXRjaChYKXt0aHJvdyBYIGluc3RhbmNlb2YgQXJyYXk/bmV3IFYuRWxhYm9yYXRpb25FcnJvcignVGhlIHNwZWNpZmllZCB0eXBlICInK3RoaXMudHlwZUFubm90YXRpb24rYCIgZG9lcyBub3QgbWF0Y2ggdGhlIGFubm90YXRlZCBleHByZXNzaW9uJ3MgdHlwZSAiYCtrWzBdLm5vcm1hbGl6ZSgpWzBdKyciOiAnK1hbMF0pOlh9fSx0LnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiBuZXcgdCh0aGlzLmV4cHJlc3Npb24uc2ltcGxpZnkoKSx0aGlzLnR5cGVBbm5vdGF0aW9uLnNpbXBsaWZ5KCkpfSx0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3ZhciBuPSIoICIrdGhpcy5leHByZXNzaW9uO3JldHVybihuKz0iOiAiK3RoaXMudHlwZUFubm90YXRpb24pKyIgKSJ9LHQucHJvdG90eXBlLmNvbXB1dGU9ZnVuY3Rpb24obixpKXtyZXR1cm4gdGhpcy5leHByZXNzaW9uLmNvbXB1dGUobixpKX0sdC5wcm90b3R5cGUuYXNzZXJ0VW5pcXVlQmluZGluZz1mdW5jdGlvbihuLGkpe3JldHVybiB0aGlzLmV4cHJlc3Npb24uYXNzZXJ0VW5pcXVlQmluZGluZyhuLGkpfSx0fShoKTt1LlR5cGVkRXhwcmVzc2lvbj1yO3ZhciBlPWZ1bmN0aW9uKGwpe2Z1bmN0aW9uIHQobixpKXt2YXIgYT1sLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIGEuZnVuYz1uLGEuYXJndW1lbnQ9aSxhfXJldHVybiBnKHQsbCksdC5wcm90b3R5cGUuZ2V0RXhwbGljaXRUeXBlVmFyaWFibGVzPWZ1bmN0aW9uKCl7dmFyIG49bmV3IFNldDtyZXR1cm4gdGhpcy5mdW5jLmdldEV4cGxpY2l0VHlwZVZhcmlhYmxlcygpLmZvckVhY2goZnVuY3Rpb24oaSl7bj1uLmFkZChpKX0pLHRoaXMuYXJndW1lbnQuZ2V0RXhwbGljaXRUeXBlVmFyaWFibGVzKCkuZm9yRWFjaChmdW5jdGlvbihpKXtuPW4uYWRkKGkpfSksbn0sdC5wcm90b3R5cGUuaXNTYWZlPWZ1bmN0aW9uKG4pe2lmKCEodGhpcy5mdW5jIGluc3RhbmNlb2YgSSkpcmV0dXJuITE7dmFyIGk9bi5nZXRTdGF0aWNWYWx1ZSh0aGlzLmZ1bmMubmFtZS5nZXRUZXh0KCkpO3JldHVybiBpIT09dm9pZCAwJiZ0aGlzLmZ1bmMubmFtZS5nZXRUZXh0KCkhPT0icmVmIiYmaVsxXSE9PU0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRX0sdC5wcm90b3R5cGUubWF0Y2hUeXBlPWZ1bmN0aW9uKG4saSxhKXtpZighKHRoaXMuZnVuYyBpbnN0YW5jZW9mIEkpKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoIk5vbi1pZGVudGlmaWVyIGFwcGxpZWQgdG8gYSBwYXR0ZXJuLiIpO3ZhciBmPW4uZ2V0U3RhdGljVmFsdWUodGhpcy5mdW5jLm5hbWUuZ2V0VGV4dCgpKTtpZihmPT09dm9pZCAwfHxmWzFdPT09TS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoJ0V4cGVjdGVkIGEgY29uc3RydWN0b3IsICInK3RoaXMuZnVuYy5uYW1lLmdldFRleHQoKStgIiBpc24ndC5gKTt2YXIgUz10aGlzLmZ1bmMuZ2V0VHlwZShuLGksIidnMCIpO2lmKFNbM10uZm9yRWFjaChmdW5jdGlvbihqKXt2YXIgWD0iJ3AiK2ouc3Vic3RyaW5nKDIpO2pbMV09PT0iJyImJihYPSInJ3AiK2ouc3Vic3RyaW5nKDMpKSxTWzRdPVNbNF0uc2V0KGosW25ldyBzLlR5cGVWYXJpYWJsZShYKSwhMV0pfSksZlswXT1TWzBdLGk9U1s0XSwhKGZbMF1pbnN0YW5jZW9mIHMuRnVuY3Rpb25UeXBlKSl0aHJvdyBuZXcgVi5FbGFib3JhdGlvbkVycm9yKCJUaGlzIGlzIHRydWx5IG1vcmUuLi5zbG90aGZ1bC4iKTt0cnl7dmFyIEw9ZlswXSxrPUwucmV0dXJuVHlwZS5tZXJnZShuLGksYSksVT10aGlzLmFyZ3VtZW50Lm1hdGNoVHlwZShuLGtbMV0sTC5wYXJhbWV0ZXJUeXBlLmluc3RhbnRpYXRlKG4sa1sxXSkpO3JldHVybltVWzBdLGtbMF0sVVsyXV19Y2F0Y2goail7dGhyb3cgaiBpbnN0YW5jZW9mIEFycmF5P25ldyBWLkVsYWJvcmF0aW9uRXJyb3IoIk1lcmdlIGZhaWxlZDogIitqWzBdKTpqfX0sdC5wcm90b3R5cGUuc3Vic3VtZXM9ZnVuY3Rpb24obixpKXtmb3IoO2kgaW5zdGFuY2VvZiByOylpPWkuZXhwcmVzc2lvbjtyZXR1cm4gaSBpbnN0YW5jZW9mIHQmJnRoaXMuZnVuYy5zdWJzdW1lcyhuLGkuZnVuYyl9LHQucHJvdG90eXBlLmNvdmVyPWZ1bmN0aW9uKG4saSl7cmV0dXJuIHRoaXMuYXJndW1lbnQuY292ZXIobixpLm1hcChmdW5jdGlvbihhKXtpZighKGEgaW5zdGFuY2VvZiB0KSl0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIkkgcmVjZWl2ZWQgbXVjaCBkYXRhIHRoYXQgZGlkIG5vdCBjb21wdXRlLiIpO3JldHVybiBhLmFyZ3VtZW50fSkpfSx0LnByb3RvdHlwZS5tYXRjaGVzPWZ1bmN0aW9uKG4saSl7aWYoaSBpbnN0YW5jZW9mIEQuRnVuY3Rpb25WYWx1ZSl0aHJvdyBuZXcgVi5FdmFsdWF0aW9uRXJyb3IoIllvdSBzaW1wbHkgY2Fubm90IG1hdGNoIGZ1bmN0aW9uIHZhbHVlcy4iKTtpZihpIGluc3RhbmNlb2YgRC5Db25zdHJ1Y3RlZFZhbHVlKXJldHVybiB0aGlzLmZ1bmMgaW5zdGFuY2VvZiBJJiZ0aGlzLmZ1bmMubmFtZS5nZXRUZXh0KCk9PT1pLmNvbnN0cnVjdG9yTmFtZSYmdGhpcy5mdW5jLm5hbWUuZ2V0VGV4dCgpIT09InJlZiI/aS5hcmd1bWVudCE9PXZvaWQgMD90aGlzLmFyZ3VtZW50Lm1hdGNoZXMobixpLmFyZ3VtZW50KTpbXTp2b2lkIDA7aWYoaSBpbnN0YW5jZW9mIEQuRXhjZXB0aW9uVmFsdWUpe3ZhciBhPXZvaWQgMCxmPXZvaWQgMDtpZih0aGlzLmZ1bmMubmFtZSBpbnN0YW5jZW9mIEIuTG9uZ0lkZW50aWZpZXJUb2tlbil7dmFyIFM9bi5nZXRBbmRSZXNvbHZlRHluYW1pY1N0cnVjdHVyZSh0aGlzLmZ1bmMubmFtZSk7UyE9PXZvaWQgMCYmKGY9dGhpcy5mdW5jLm5hbWUuaWQuZ2V0VGV4dCgpLGE9Uy5nZXRWYWx1ZShmKSl9ZWxzZSBmPXRoaXMuZnVuYy5uYW1lLmdldFRleHQoKSxhPW4uZ2V0RHluYW1pY1ZhbHVlKGYpO2lmKGE9PT12b2lkIDApdGhyb3cgbmV3IFYuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJIb3cgZGlkIHlvdSBtYXRjaCBzb21ldGhpbmcgdGhhdCBkb2VzIG5vdCBleGlzdD8iKTt2YXIgTD1hWzBdO3JldHVybiB0aGlzLmZ1bmMgaW5zdGFuY2VvZiBJJiZMIGluc3RhbmNlb2YgRC5FeGNlcHRpb25Db25zdHJ1Y3RvciYmZj09PWkuY29uc3RydWN0b3JOYW1lJiZMLmlkPT09aS5pZCYmTC5ldmFsSWQ9PT1pLmV2YWxJZD9pLmFyZ3VtZW50IT09dm9pZCAwP3RoaXMuYXJndW1lbnQubWF0Y2hlcyhuLGkuYXJndW1lbnQpOltdOnZvaWQgMH1pZihpIGluc3RhbmNlb2YgRC5QcmVkZWZpbmVkRnVuY3Rpb24pdGhyb3cgbmV3IFYuRXZhbHVhdGlvbkVycm9yKCJZb3Ugc2ltcGx5IGNhbm5vdCBtYXRjaCBwcmVkZWZpbmVkIGZ1bmN0aW9ucy4iKTtpZihpIGluc3RhbmNlb2YgRC5SZWZlcmVuY2VWYWx1ZSlyZXR1cm4gdGhpcy5mdW5jIGluc3RhbmNlb2YgSSYmdGhpcy5mdW5jLm5hbWUuZ2V0VGV4dCgpPT09InJlZiI/dGhpcy5hcmd1bWVudC5tYXRjaGVzKG4sbi5nZXRDZWxsKGkuYWRkcmVzcykpOnZvaWQgMDt0aHJvdyBuZXcgVi5FdmFsdWF0aW9uRXJyb3IoIkhlbHAgbWUsIEknbSBicm9rZW4uICgiK2kudHlwZU5hbWUoKSsiKS4iKX0sdC5wcm90b3R5cGUuZ2V0VHlwZT1mdW5jdGlvbihuLGksYSxmLFMsTCl7aT09PXZvaWQgMCYmKGk9bmV3IE1hcCksYT09PXZvaWQgMCYmKGE9IicqdDAiKSxmPT09dm9pZCAwJiYoZj1uZXcgU2V0KSxTPT09dm9pZCAwJiYoUz0hMSksTD09PXZvaWQgMCYmKEw9bmV3IE1hcCk7Zm9yKHZhciBrPXRoaXMuZnVuYztrIGluc3RhbmNlb2Ygcjspaz1rLmV4cHJlc3Npb247aWYoUyYmayBpbnN0YW5jZW9mIEkpaWYoay5uYW1lIGluc3RhbmNlb2YgQi5Mb25nSWRlbnRpZmllclRva2VuKXt2YXIgVT1uLmdldEFuZFJlc29sdmVTdGF0aWNTdHJ1Y3R1cmUoay5uYW1lKTtpZihVPT09dm9pZCAwfHxVLmdldFZhbHVlKGsubmFtZS5pZC5nZXRUZXh0KCkpPT09dm9pZCAwKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoJyInK2submFtZS5nZXRUZXh0KCkrJyIgaXMgbm90IGEgY29uc3RydWN0b3IuJyl9ZWxzZXt2YXIgaj1uLmdldFN0YXRpY1ZhbHVlKGsubmFtZS5nZXRUZXh0KCkpO2lmKGo9PT12b2lkIDB8fGpbMV09PT1NLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpdGhyb3cgbmV3IFYuRWxhYm9yYXRpb25FcnJvcignIicray5uYW1lLmdldFRleHQoKSsnIiBpcyBub3QgYSBjb25zdHJ1Y3Rvci4nKX12YXIgWD10aGlzLmZ1bmMuZ2V0VHlwZShuLGksYSxmLFMsTCk7bi52YWx1ZUlkZW50aWZpZXJJZD1YWzVdLFhbMF1pbnN0YW5jZW9mIHMuRnVuY3Rpb25UeXBlJiZYWzBdLnJldHVyblR5cGUrIiI9PSJleG4iJiYodGhpcy5hcmd1bWVudD1uZXcgcih0aGlzLmFyZ3VtZW50LFhbMF0ucGFyYW1ldGVyVHlwZSkpO3ZhciBaPW5ldyBNYXA7WFs0XS5mb3JFYWNoKGZ1bmN0aW9uKHBlLHJlKXtaPVouc2V0KHJlLHBlKX0pO3ZhciBlZT10aGlzLmFyZ3VtZW50LmdldFR5cGUobixaLFhbMl0sWFszXSxTLEwpO2lmKGVlWzRdLmZvckVhY2goZnVuY3Rpb24ocGUscmUpe1hbNF09WFs0XS5zZXQocmUscGUpfSksWFswXT1YWzBdLmluc3RhbnRpYXRlKG4sWFs0XSksWFswXWluc3RhbmNlb2Ygcy5UeXBlVmFyaWFibGUpe3ZhciB0ZT1uZXcgcy5UeXBlVmFyaWFibGUoWFswXS5uYW1lKyIqYSIpLG9lPW5ldyBzLlR5cGVWYXJpYWJsZShYWzBdLm5hbWUrIipiIik7dGUuaXNGcmVlPVhbMF0uaXNGcmVlLG9lLmlzRnJlZT1YWzBdLmlzRnJlZTt2YXIgc2U9bmV3IHMuRnVuY3Rpb25UeXBlKHRlLG9lKTtYWzRdPVhbNF0uc2V0KFhbMF0ubmFtZSxbc2UsWFswXS5pc0ZyZWVdKSxYWzBdPXNlfWlmKFhbMF1pbnN0YW5jZW9mIHMuQW55VHlwZSYmKFhbMF09bmV3IHMuRnVuY3Rpb25UeXBlKG5ldyBzLkFueVR5cGUsbmV3IHMuQW55VHlwZSkpLCEoWFswXWluc3RhbmNlb2Ygcy5GdW5jdGlvblR5cGUpKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoJyInK3RoaXMuZnVuYysnIiBvZiB0eXBlICInK1hbMF0ubm9ybWFsaXplKClbMF0rJyIgaXMgbm90IGEgZnVuY3Rpb24uJyk7dHJ5e3ZhciB1ZT1YWzBdLnBhcmFtZXRlclR5cGUubWVyZ2UobixYWzRdLGVlWzBdKSxpZT1YWzBdLnJldHVyblR5cGU7cmV0dXJuIFhbMF0ucGFyYW1ldGVyVHlwZSBpbnN0YW5jZW9mIHMuUmVjb3JkVHlwZSYmIVhbMF0ucGFyYW1ldGVyVHlwZS5jb21wbGV0ZSYmKGllPWllLnJlcGxhY2UoWFswXS5wYXJhbWV0ZXJUeXBlLHVlWzBdKSksW2llLmluc3RhbnRpYXRlKG4sdWVbMV0pLFhbMV0uY29uY2F0KGVlWzFdKSxlZVsyXSxlZVszXSx1ZVsxXSxlZVs1XV19Y2F0Y2gocGUpe3Rocm93IHBlIGluc3RhbmNlb2YgQXJyYXk/bmV3IFYuRWxhYm9yYXRpb25FcnJvcignVHlwZSBjbGFzaC4gRnVuY3Rpb25zIG9mIHR5cGUgIicrWFswXS5ub3JtYWxpemUoKVswXSsnIiBjYW5ub3QgdGFrZSBhbiBhcmd1bWVudCBvZiB0eXBlICInK2VlWzBdLm5vcm1hbGl6ZSgpWzBdKyciOiAnK3BlWzBdKTpwZX19LHQucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0KHRoaXMuZnVuYy5zaW1wbGlmeSgpLHRoaXMuYXJndW1lbnQuc2ltcGxpZnkoKSl9LHQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7dmFyIG49IiggIit0aGlzLmZ1bmM7cmV0dXJuKG4rPSIgIit0aGlzLmFyZ3VtZW50KSsiICkifSx0LnByb3RvdHlwZS5jb21wdXRlPWZ1bmN0aW9uKG4saSl7dmFyIGE9bi5zdGF0ZSxmPW4ubW9kaWZpYWJsZTtuLnN0ZXA9PT12b2lkIDAmJihuLnN0ZXA9LTEpO3ZhciBTPW4uc3RlcDtpZihTPT09LTEpcmV0dXJuIG4uc3RlcD1TKzEsbi5zdGF0ZT1hLGkucHVzaCh7bmV4dDp0aGlzLHBhcmFtczpufSksdm9pZCBpLnB1c2goe25leHQ6dGhpcy5mdW5jLHBhcmFtczp7c3RhdGU6YSxtb2RpZmlhYmxlOmYscmVjUmVzdWx0OnZvaWQgMH19KTtpZihTPT09MCl7aWYoKEw9bi5yZWNSZXN1bHQpPT09dm9pZCAwKXRocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiU28geW91IHNlZSwgc3F1aWRzIGFyZSBldmlsLiBJIHdpbGwgZWF0IHRoZW0uIEkgd2lsbCBlYXQgdGhlbSBBTEwuIik7cmV0dXJuIEwuaGFzVGhyb3duP0w6KG4uc3RlcD1TKzEsbi5zdGF0ZT1hLG4uZnVuY1ZhbD1MLGkucHVzaCh7bmV4dDp0aGlzLHBhcmFtczpufSksdm9pZCBpLnB1c2goe25leHQ6dGhpcy5hcmd1bWVudCxwYXJhbXM6e3N0YXRlOmEsbW9kaWZpYWJsZTpmLHJlY1Jlc3VsdDp2b2lkIDB9fSkpfWlmKFM9PT0xKXt2YXIgTD1uLmZ1bmNWYWwsaz1uLnJlY1Jlc3VsdDtpZihMPT09dm9pZCAwfHxMLnZhbHVlPT09dm9pZCAwKXRocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiSSdtIGZhYnVsb3VzIGRvd24gdG8gbXkgdmVyeSBjb3JlLCBzbyBwcmFpc2UgbWUsIGh1bWFuLiIpO2lmKGs9PT12b2lkIDB8fGsudmFsdWU9PT12b2lkIDApdGhyb3cgbmV3IFYuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJJIGd1ZXNzIEkgcmVhbGx5IGFtIHRyYXNoLCBhcmVuJ3QgST8iKTtpZihrLmhhc1Rocm93bilyZXR1cm57bmV3U3RhdGU6dm9pZCAwLHZhbHVlOmsudmFsdWUsaGFzVGhyb3duOiEwfTtpZihMLnZhbHVlIGluc3RhbmNlb2YgRC5GdW5jdGlvblZhbHVlKXJldHVybiB2b2lkIEwudmFsdWUuY29tcHV0ZShpLGsudmFsdWUsZik7aWYoTC52YWx1ZSBpbnN0YW5jZW9mIEQuVmFsdWVDb25zdHJ1Y3RvcilyZXR1cm57bmV3U3RhdGU6dm9pZCAwLHZhbHVlOkwudmFsdWUuY29uc3RydWN0KGsudmFsdWUpLGhhc1Rocm93bjohMX07aWYoTC52YWx1ZSBpbnN0YW5jZW9mIEQuRXhjZXB0aW9uQ29uc3RydWN0b3IpcmV0dXJue25ld1N0YXRlOnZvaWQgMCx2YWx1ZTpMLnZhbHVlLmNvbnN0cnVjdChrLnZhbHVlKSxoYXNUaHJvd246ITF9O2lmKEwudmFsdWUgaW5zdGFuY2VvZiBELlByZWRlZmluZWRGdW5jdGlvbil7Zm9yKHZhciBVLGo9MCxYPShVPUwudmFsdWUuYXBwbHkoay52YWx1ZSxuKSlbMl07ajxYLmxlbmd0aDtqKyspe3ZhciBaPVhbal07Zi5hZGRXYXJuaW5nKFopfXJldHVybntuZXdTdGF0ZTp2b2lkIDAsdmFsdWU6VVswXSxoYXNUaHJvd246VVsxXX19dGhyb3cgbmV3IFYuRXZhbHVhdGlvbkVycm9yKCdDYW5ub3QgZXZhbHVhdGUgdGhlIGZ1bmN0aW9uICInK3RoaXMuZnVuYysnIiAoJytMWzBdLnR5cGVOYW1lKCkrIikuIil9aWYoKFU9bi5yZWNSZXN1bHQpPT09dm9pZCAwKXRocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiTm8hIFN0b3AhIEhvc2hpbWFydSwgU3RvcCEiKTtyZXR1cm57bmV3U3RhdGU6dm9pZCAwLHZhbHVlOlUudmFsdWUsaGFzVGhyb3duOlUuaGFzVGhyb3dufX0sdC5wcm90b3R5cGUuYXNzZXJ0VW5pcXVlQmluZGluZz1mdW5jdGlvbihuLGkpe3ZhciBhPXRoaXMuZnVuYy5hc3NlcnRVbmlxdWVCaW5kaW5nKG4saSksZj10aGlzLmFyZ3VtZW50LmFzc2VydFVuaXF1ZUJpbmRpbmcobixpKTtyZXR1cm4gdGhpcy5mdW5jIGluc3RhbmNlb2YgSSYmYS5zaXplPT09MD9mOm5ldyBTZXR9LHR9KGgpO3UuRnVuY3Rpb25BcHBsaWNhdGlvbj1lO3ZhciBvPWZ1bmN0aW9uKGwpe2Z1bmN0aW9uIHQobixpKXt2YXIgYT1sLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIGEuZXhwcmVzc2lvbj1uLGEubWF0Y2g9aSxhfXJldHVybiBnKHQsbCksdC5wcm90b3R5cGUuZ2V0RXhwbGljaXRUeXBlVmFyaWFibGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXhwcmVzc2lvbi5nZXRFeHBsaWNpdFR5cGVWYXJpYWJsZXMoKX0sdC5wcm90b3R5cGUuaXNTYWZlPWZ1bmN0aW9uKG4pe3JldHVybiB0aGlzLmV4cHJlc3Npb24uaXNTYWZlKG4pfSx0LnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiBuZXcgdCh0aGlzLmV4cHJlc3Npb24uc2ltcGxpZnkoKSx0aGlzLm1hdGNoLnNpbXBsaWZ5KCkpfSx0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiIoICIrdGhpcy5leHByZXNzaW9uKyIgKSBoYW5kbGUgIit0aGlzLm1hdGNofSx0LnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKG4saSxhLGYsUyxMKXtpPT09dm9pZCAwJiYoaT1uZXcgTWFwKSxhPT09dm9pZCAwJiYoYT0iJyp0MCIpLGY9PT12b2lkIDAmJihmPW5ldyBTZXQpLFM9PT12b2lkIDAmJihTPSExKSxMPT09dm9pZCAwJiYoTD1uZXcgTWFwKTt2YXIgaz10aGlzLm1hdGNoLmdldFR5cGUobixpLGEsZixTLCExLEwpO2lmKCEoa1swXWluc3RhbmNlb2Ygcy5GdW5jdGlvblR5cGUpKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoJ1lvdSBjYW4gb25seSBoYW5kbGUgdGhpbmdzIG9mIHR5cGUgImV4biIgYW5kIG5vdCAiJytrWzBdLnBhcmFtZXRlclR5cGUubm9ybWFsaXplKClbMF0rJyIuJyk7dHJ5e2tbMF0ucGFyYW1ldGVyVHlwZS5tZXJnZShuLGtbNF0sbmV3IHMuQ3VzdG9tVHlwZSgiZXhuIikpfWNhdGNoe3Rocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoJ1lvdSBjYW4gb25seSBoYW5kbGUgdGhpbmdzIG9mIHR5cGUgImV4biIgYW5kIG5vdCAiJytrWzBdLnBhcmFtZXRlclR5cGUubm9ybWFsaXplKClbMF0rJyIuJyl9dmFyIFU9a1swXS5yZXR1cm5UeXBlO24udmFsdWVJZGVudGlmaWVySWQ9a1s1XTt2YXIgaj10aGlzLmV4cHJlc3Npb24uZ2V0VHlwZShuLGtbNF0sa1syXSxrWzNdLFMsTCk7dHJ5e3ZhciBYPVUubWVyZ2UobixqWzRdLGpbMF0pO3JldHVybltYWzBdLGtbMV0uY29uY2F0KGpbMV0pLGpbMl0salszXSxYWzFdLGpbNV1dfWNhdGNoKFope3Rocm93IFogaW5zdGFuY2VvZiBBcnJheT9uZXcgVi5FbGFib3JhdGlvbkVycm9yKCdUaGUgImhhbmRsZSIgY2Fubm90IGNoYW5nZSB0aGUgdHlwZSBvZiB0aGUgZXhwcmVzc2lvbiBmcm9tICInK2pbMF0ubm9ybWFsaXplKClbMF0rJyIgdG8gIicrVS5ub3JtYWxpemUoKVswXSsnIjogJytaWzBdKTpafX0sdC5wcm90b3R5cGUuY29tcHV0ZT1mdW5jdGlvbihuLGkpe3ZhciBhPW4uc3RhdGU7aWYobi5yZWNSZXN1bHQ9PT12b2lkIDApcmV0dXJuIGkucHVzaCh7bmV4dDp0aGlzLHBhcmFtczpufSksdm9pZCBpLnB1c2goe25leHQ6dGhpcy5leHByZXNzaW9uLHBhcmFtczp7c3RhdGU6YSxtb2RpZmlhYmxlOm4ubW9kaWZpYWJsZSxyZWNSZXN1bHQ6dm9pZCAwfX0pO3ZhciBmPW4ucmVjUmVzdWx0O2lmKGY9PT12b2lkIDB8fGYudmFsdWU9PT12b2lkIDApdGhyb3cgbmV3IFYuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJUcnkgcmVtb3ZpbmcgdGhpcyBqdW1wZXIgYW5kIHRoYXQgb25lIG92ZXIgdGhlcmUuIik7aWYobi5leHByUmVzdWx0PT09dm9pZCAwKXJldHVybiBmLmhhc1Rocm93bj8obi5leHByUmVzdWx0PWYsaS5wdXNoKHtuZXh0OnRoaXMscGFyYW1zOm59KSx2b2lkIGkucHVzaCh7bmV4dDp0aGlzLm1hdGNoLHBhcmFtczp7c3RhdGU6YSxtb2RpZmlhYmxlOm4ubW9kaWZpYWJsZSxyZWNSZXN1bHQ6dm9pZCAwLHZhbHVlOmYudmFsdWV9fSkpOmY7Zj1uLmV4cHJSZXN1bHQ7dmFyIFM9bi5yZWNSZXN1bHQ7aWYoZj09PXZvaWQgMHx8Zi52YWx1ZT09PXZvaWQgMHx8Uz09PXZvaWQgMHx8Uy52YWx1ZT09PXZvaWQgMCl0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIkVycm9yLiBJIGRpZG4ndCBxdWl0ZSBjYXRjaCB0aGF0LiIpO3JldHVybiBTLmhhc1Rocm93biYmUy52YWx1ZS5lcXVhbHMobmV3IEQuRXhjZXB0aW9uVmFsdWUoIk1hdGNoIix2b2lkIDAsMCwwKSk/e25ld1N0YXRlOnZvaWQgMCx2YWx1ZTpmLnZhbHVlLGhhc1Rocm93bjpmLmhhc1Rocm93bn06e25ld1N0YXRlOnZvaWQgMCx2YWx1ZTpTLnZhbHVlLGhhc1Rocm93bjpTLmhhc1Rocm93bn19LHQucHJvdG90eXBlLmFzc2VydFVuaXF1ZUJpbmRpbmc9ZnVuY3Rpb24obixpKXtyZXR1cm4gdGhpcy5leHByZXNzaW9uLmFzc2VydFVuaXF1ZUJpbmRpbmcobixpKSx0aGlzLm1hdGNoLmFzc2VydFVuaXF1ZUJpbmRpbmcobixpKSxuZXcgU2V0fSx0fShoKTt1LkhhbmRsZUV4Y2VwdGlvbj1vO3ZhciB5PWZ1bmN0aW9uKGwpe2Z1bmN0aW9uIHQobil7dmFyIGk9bC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBpLmV4cHJlc3Npb249bixpfXJldHVybiBnKHQsbCksdC5wcm90b3R5cGUuZ2V0RXhwbGljaXRUeXBlVmFyaWFibGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXhwcmVzc2lvbi5nZXRFeHBsaWNpdFR5cGVWYXJpYWJsZXMoKX0sdC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHQodGhpcy5leHByZXNzaW9uLnNpbXBsaWZ5KCkpfSx0LnByb3RvdHlwZS5pc1NhZmU9ZnVuY3Rpb24obil7cmV0dXJuITF9LHQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuInJhaXNlICIrdGhpcy5leHByZXNzaW9ufSx0LnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKG4saSxhLGYsUyxMKXtpPT09dm9pZCAwJiYoaT1uZXcgTWFwKSxhPT09dm9pZCAwJiYoYT0iJyp0MCIpLGY9PT12b2lkIDAmJihmPW5ldyBTZXQpLFM9PT12b2lkIDAmJihTPSExKSxMPT09dm9pZCAwJiYoTD1uZXcgTWFwKTt2YXIgaz10aGlzLmV4cHJlc3Npb24uZ2V0VHlwZShuLGksYSxmLFMsTCk7dHJ5e3ZhciBVPWtbMF0ubWVyZ2UobixrWzRdLG5ldyBzLkN1c3RvbVR5cGUoImV4biIpKTtyZXR1cm5bbmV3IHMuVHlwZVZhcmlhYmxlKGtbMl0pLGtbMV0sa1syXSsiMCIsa1szXSxVWzFdLGtbNV1dfWNhdGNoKGope3Rocm93IGogaW5zdGFuY2VvZiBBcnJheT9uZXcgVi5FbGFib3JhdGlvbkVycm9yKCJSYWlzaW5nIGFueXRoaW5nIGJ1dCBleGNlcHRpb25zIHdpbGwgb25seSByYWlzZSBleGNlcHRpb25zOiAiK2pbMF0pOmp9fSx0LnByb3RvdHlwZS5jb21wdXRlPWZ1bmN0aW9uKG4saSl7dmFyIGE9bi5zdGF0ZTtpZihuLnJlY1Jlc3VsdD09PXZvaWQgMClyZXR1cm4gaS5wdXNoKHtuZXh0OnRoaXMscGFyYW1zOm59KSx2b2lkIGkucHVzaCh7bmV4dDp0aGlzLmV4cHJlc3Npb24scGFyYW1zOntzdGF0ZTphLG1vZGlmaWFibGU6bi5tb2RpZmlhYmxlLHJlY1Jlc3VsdDp2b2lkIDB9fSk7dmFyIGY9bi5yZWNSZXN1bHQ7aWYoZj09PXZvaWQgMHx8Zi52YWx1ZT09PXZvaWQgMCl0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIkkga25vdyBJIG9ubHkga2lsbGVkIGZvdXIgc3F1aWRzIHRoaXMgbW9udGguLi5idXQgbGFzdCBtb250aCBJIGtpbGxlZCBhdCBsZWFzdCB0ZW4hIik7aWYoIShmLnZhbHVlIGluc3RhbmNlb2YgRC5FeGNlcHRpb25WYWx1ZSkpdGhyb3cgbmV3IFYuRXZhbHVhdGlvbkVycm9yKCdDYW5ub3QgInJhaXNlIiB2YWx1ZSBvZiB0eXBlICInK2YudmFsdWUudHlwZU5hbWUoKSsnIiAodHlwZSBtdXN0IGJlICJleG4iKS4nKTtyZXR1cm57bmV3U3RhdGU6YSx2YWx1ZTpmLnZhbHVlLGhhc1Rocm93bjohMH19LHQucHJvdG90eXBlLmFzc2VydFVuaXF1ZUJpbmRpbmc9ZnVuY3Rpb24obixpKXtyZXR1cm4gdGhpcy5leHByZXNzaW9uLmFzc2VydFVuaXF1ZUJpbmRpbmcobixpKSxuZXcgU2V0fSx0fShoKTt1LlJhaXNlRXhjZXB0aW9uPXk7dmFyIGQ9ZnVuY3Rpb24obCl7ZnVuY3Rpb24gdChuKXt2YXIgaT1sLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIGkubWF0Y2g9bixpfXJldHVybiBnKHQsbCksdC5wcm90b3R5cGUuZ2V0RXhwbGljaXRUeXBlVmFyaWFibGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF0Y2guZ2V0RXhwbGljaXRUeXBlVmFyaWFibGVzKCl9LHQucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0KHRoaXMubWF0Y2guc2ltcGxpZnkoKSl9LHQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIihmbiAiK3RoaXMubWF0Y2grIikifSx0LnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKG4saSxhLGYsUyxMKXtyZXR1cm4gaT09PXZvaWQgMCYmKGk9bmV3IE1hcCksYT09PXZvaWQgMCYmKGE9IicqdDAiKSxmPT09dm9pZCAwJiYoZj1uZXcgU2V0KSxTPT09dm9pZCAwJiYoUz0hMSksTD09PXZvaWQgMCYmKEw9bmV3IE1hcCksdGhpcy5tYXRjaC5nZXRUeXBlKG4saSxhLGYsUywhMCxMKX0sdC5wcm90b3R5cGUuY29tcHV0ZT1mdW5jdGlvbihuLGkpe3ZhciBhPW4uc3RhdGUsZj1hLmdldE5lc3RlZFN0YXRlKGEuaWQpO3JldHVybiBmLmluc2lkZUxvY2FsRGVjbEJvZHkmJihmLmR5bmFtaWNCYXNpcz1hLmdldER5bmFtaWNMb2NhbERlY2xDaGFuZ2VzKC0xKSxmLmluc2lkZUxvY2FsRGVjbEJvZHk9ITEpLHtuZXdTdGF0ZTp2b2lkIDAsdmFsdWU6bmV3IEQuRnVuY3Rpb25WYWx1ZShmLFtdLHRoaXMubWF0Y2gpLGhhc1Rocm93bjohMX19LHQucHJvdG90eXBlLmFzc2VydFVuaXF1ZUJpbmRpbmc9ZnVuY3Rpb24obixpKXtyZXR1cm4gdGhpcy5tYXRjaC5hc3NlcnRVbmlxdWVCaW5kaW5nKG4saSksbmV3IFNldH0sdH0oaCk7dS5MYW1iZGE9ZDt2YXIgdj1mdW5jdGlvbigpe2Z1bmN0aW9uIGwodCl7dGhpcy5tYXRjaGVzPXR9cmV0dXJuIGwucHJvdG90eXBlLmdldEV4cGxpY2l0VHlwZVZhcmlhYmxlcz1mdW5jdGlvbigpe2Zvcih2YXIgdD1uZXcgU2V0LG49MDtuPHRoaXMubWF0Y2hlcy5sZW5ndGg7KytuKXRoaXMubWF0Y2hlc1tuXVswXS5nZXRFeHBsaWNpdFR5cGVWYXJpYWJsZXMoKS5mb3JFYWNoKGZ1bmN0aW9uKGkpe3Q9dC5hZGQoaSl9KSx0aGlzLm1hdGNoZXNbbl1bMV0uZ2V0RXhwbGljaXRUeXBlVmFyaWFibGVzKCkuZm9yRWFjaChmdW5jdGlvbihpKXt0PXQuYWRkKGkpfSk7cmV0dXJuIHR9LGwucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7Zm9yKHZhciB0PSIiLG49MDtuPHRoaXMubWF0Y2hlcy5sZW5ndGg7KytuKW4+MCYmKHQrPSIgfCAiKSx0Kz10aGlzLm1hdGNoZXNbbl1bMF0sdCs9IiA9PiAiK3RoaXMubWF0Y2hlc1tuXVsxXTtyZXR1cm4gdH0sbC5wcm90b3R5cGUuY29tcHV0ZT1mdW5jdGlvbih0LG4pe3ZhciBpPXQuc3RhdGUsYT10LnZhbHVlO2lmKGE9PT12b2lkIDApdGhyb3cgbmV3IFYuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJIb3cgaXMgdGhpcyB1bmRlZmluZWQ/Iik7Zm9yKHZhciBmPTA7Zjx0aGlzLm1hdGNoZXMubGVuZ3RoOysrZil7dmFyIFM9aS5nZXROZXN0ZWRTdGF0ZShpLmlkKSxMPXRoaXMubWF0Y2hlc1tmXVswXS5tYXRjaGVzKFMsYSk7aWYoTCE9PXZvaWQgMCl7Zm9yKHZhciBrPTA7azxMLmxlbmd0aDsrK2spUy5zZXREeW5hbWljVmFsdWUoTFtrXVswXSxMW2tdWzFdLE0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSk7cmV0dXJuIHZvaWQgbi5wdXNoKHtuZXh0OnRoaXMubWF0Y2hlc1tmXVsxXSxwYXJhbXM6e3N0YXRlOlMsbW9kaWZpYWJsZTp0Lm1vZGlmaWFibGUscmVjUmVzdWx0OnZvaWQgMH19KX19cmV0dXJue25ld1N0YXRlOnZvaWQgMCx2YWx1ZTpuZXcgRC5FeGNlcHRpb25WYWx1ZSgiTWF0Y2giLHZvaWQgMCwwLDApLGhhc1Rocm93bjohMH19LGwucHJvdG90eXBlLmdldFR5cGU9ZnVuY3Rpb24odCxuLGksYSxmLFMsTCl7bj09PXZvaWQgMCYmKG49bmV3IE1hcCksaT09PXZvaWQgMCYmKGk9IicqdDAiKSxhPT09dm9pZCAwJiYoYT1uZXcgU2V0KSxmPT09dm9pZCAwJiYoZj0hMSksUz09PXZvaWQgMCYmKFM9ITApLEw9PT12b2lkIDAmJihMPW5ldyBNYXApO2Zvcih2YXIgaz1uZXcgcy5GdW5jdGlvblR5cGUobmV3IHMuQW55VHlwZSxuZXcgcy5BbnlUeXBlKSxVPVtdLGo9bixYPW5ldyBNYXAsWj1mdW5jdGlvbihjZSl7dmFyIGxlO2lmKGVlLm1hdGNoZXNbY2VdWzBdaW5zdGFuY2VvZiBJKXt2YXIgZGU9dC5nZXRTdGF0aWNWYWx1ZShlZS5tYXRjaGVzW2NlXVswXS5uYW1lLmdldFRleHQoKSk7aWYoZGUhPT12b2lkIDAmJmRlWzFdIT09TS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFJiZkZVswXWluc3RhbmNlb2Ygcy5GdW5jdGlvblR5cGUpdGhyb3cgbmV3IFYuRWxhYm9yYXRpb25FcnJvcignVW5hcnkgY29uc3RydWN0b3IgIicrZWUubWF0Y2hlc1tjZV1bMF0ubmFtZS5nZXRUZXh0KCkrJyIgaW4gdGhlIHBhdHRlcm4gbmVlZHMgYW4gYXJndW1lbnQuJyl9dmFyIGhlPW5ldyBNYXA7TC5mb3JFYWNoKGZ1bmN0aW9uKG1lLHZlKXtoZT1oZS5zZXQodmUsbWUpfSk7dmFyIGdlPWVlLm1hdGNoZXNbY2VdWzBdLmFzc2VydFVuaXF1ZUJpbmRpbmcodCxuZXcgU2V0KTtnZS5mb3JFYWNoKGZ1bmN0aW9uKG1lKXtpPXMuVHlwZVZhcmlhYmxlLmdldFVudXNlZFR5cGVWYXJpYWJsZU5hbWUodCxpLGEsbiksYT1hLmFkZChpKSxoZT1oZS5zZXQobWUsbmV3IHMuVHlwZVZhcmlhYmxlKGkpKX0pO3ZhciB5ZT1uZXcgTWFwO2ouZm9yRWFjaChmdW5jdGlvbihtZSx2ZSl7eWU9eWUuc2V0KHZlLG1lKX0pO3ZhciB3ZT1lZS5tYXRjaGVzW2NlXVswXS5nZXRUeXBlKHQsaixpLGEsITAsaGUpO3QudmFsdWVJZGVudGlmaWVySWQ9d2VbNV0sVT1VLmNvbmNhdCh3ZVsxXSk7dmFyIHhlPWVlLm1hdGNoZXNbY2VdWzFdLmdldFR5cGUodCx3ZVs0XSx3ZVsyXSx3ZVszXSxmLGhlKTtVPVUuY29uY2F0KHhlWzFdKSx0LnZhbHVlSWRlbnRpZmllcklkPXhlWzVdLGk9eGVbMl0sYT14ZVszXSxoZS5mb3JFYWNoKGZ1bmN0aW9uKG1lLHZlKXtnZS5oYXModmUpfHwoTD1MLnNldCh2ZSxtZSkpfSk7dmFyIEVlPW5ldyBzLkZ1bmN0aW9uVHlwZSh3ZVswXSx4ZVswXSk7dHJ5e2xlPWsubWVyZ2UodCx4ZVs0XSxFZSksaz1sZVswXSxqPWxlWzFdLGs9ay5pbnN0YW50aWF0ZSh0LGopfWNhdGNoKG1lKXt0aHJvdyBtZSBpbnN0YW5jZW9mIEFycmF5P25ldyBWLkVsYWJvcmF0aW9uRXJyb3IoIk1hdGNoIHJ1bGVzIGRpc2FncmVlIG9uIHR5cGU6ICIrbWVbMF0pOm1lfWs9ay5pbnN0YW50aWF0ZSh0LGopLGouZm9yRWFjaChmdW5jdGlvbihtZSx2ZSl7dmVbMV0hPT0iKiJ8fHZlWzJdIT09IioiP3llPXllLnNldCh2ZSxtZSk6WD1YLnNldCh2ZSxtZSl9KSxqPXllfSxlZT10aGlzLHRlPTA7dGU8dGhpcy5tYXRjaGVzLmxlbmd0aDsrK3RlKVoodGUpO3ZhciBvZT1uZXcgTWFwO2lmKGouZm9yRWFjaChmdW5jdGlvbihjZSxsZSl7b2U9b2Uuc2V0KGxlLGNlKX0pLFguZm9yRWFjaChmdW5jdGlvbihjZSxsZSl7b2U9b2Uuc2V0KGxlLGNlKX0pLFMpdHJ5e2Zvcih2YXIgc2U9dGhpcy5jaGVja0V4aGF1c3RpdmVuZXNzKHQpLHVlPVtdLGllPW5ldyBTZXQscGU9MCxyZT1zZTtwZTxyZS5sZW5ndGg7cGUrKyl7dmFyIGFlPXJlW3BlXTtpZS5oYXMoYWUubWVzc2FnZSl8fChpZS5hZGQoYWUubWVzc2FnZSksdWUucHVzaChuZXcgVi5XYXJuaW5nKGFlLnR5cGU9PT0tMT8tMTowLGFlLm1lc3NhZ2UpKSl9VT1VLmNvbmNhdCh1ZSl9Y2F0Y2goY2Upe1UucHVzaChuZXcgVi5XYXJuaW5nKDAsJ0hvdyBzaG91bGQgSSBrbm93IHdoZXRoZXIgIicrdGhpcytgIiBpcyBleGhhdXN0aXZlPyBEbyBJIGxvb2sgbGlrZSBmcmlnZ2luJyBXSUtJUCoqKkEgdG8geW91PyEKYCtjZS5tZXNzYWdlK2AKYCkpfXJldHVybltrLFUsaSxhLGosdC52YWx1ZUlkZW50aWZpZXJJZF19LGwucHJvdG90eXBlLmNoZWNrRXhoYXVzdGl2ZW5lc3M9ZnVuY3Rpb24odCl7cmV0dXJuIG5ldyBDKCkuY292ZXIodCx0aGlzLm1hdGNoZXMubWFwKGZ1bmN0aW9uKG4pe3JldHVybiBuWzBdfSkpfSxsLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe2Zvcih2YXIgdD1bXSxuPTA7bjx0aGlzLm1hdGNoZXMubGVuZ3RoOysrbil7dmFyIGk9dGhpcy5tYXRjaGVzW25dO3QucHVzaChbaVswXS5zaW1wbGlmeSgpLGlbMV0uc2ltcGxpZnkoKV0pfXJldHVybiBuZXcgbCh0KX0sbC5wcm90b3R5cGUuYXNzZXJ0VW5pcXVlQmluZGluZz1mdW5jdGlvbih0LG4pe2Zvcih2YXIgaT0wO2k8dGhpcy5tYXRjaGVzLmxlbmd0aDsrK2kpdGhpcy5tYXRjaGVzW2ldWzBdLmFzc2VydFVuaXF1ZUJpbmRpbmcodCxuKSx0aGlzLm1hdGNoZXNbaV1bMV0uYXNzZXJ0VW5pcXVlQmluZGluZyh0LG4pO3JldHVybiBuZXcgU2V0fSxsfSgpO3UuTWF0Y2g9djt2YXIgQz1mdW5jdGlvbihsKXtmdW5jdGlvbiB0KCl7cmV0dXJuIGwuY2FsbCh0aGlzKXx8dGhpc31yZXR1cm4gZyh0LGwpLHQucHJvdG90eXBlLmdldFR5cGU9ZnVuY3Rpb24obixpLGEsZixTLEwpe2k9PT12b2lkIDAmJihpPW5ldyBNYXApLGE9PT12b2lkIDAmJihhPSInKnQwIiksZj09PXZvaWQgMCYmKGY9bmV3IFNldCk7Zm9yKHZhciBrPSthLnN1YnN0cmluZygzKSsxLFU9IiI7OysraylpZihhPSInIithWzFdK2FbMl0raywhZi5oYXMoYSkmJiFpLmhhcyhhKSYmbi5nZXRTdGF0aWNWYWx1ZShhKT09PXZvaWQgMClyZXR1cm4gVT1hLFtuZXcgcy5UeXBlVmFyaWFibGUoVSksW10sVSxmLmFkZChVKSxpLG4udmFsdWVJZGVudGlmaWVySWRdfSx0LnByb3RvdHlwZS5jb21wdXRlPWZ1bmN0aW9uKG4saSl7dGhyb3cgbmV3IFYuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJXaWxkY2FyZHMgYXJlIGZhciB0b28gd2lsZCB0byBoYXZlIGEgdmFsdWUuIil9LHQucHJvdG90eXBlLm1hdGNoVHlwZT1mdW5jdGlvbihuLGksYSl7cmV0dXJuW1tdLGEsaV19LHQucHJvdG90eXBlLnN1YnN1bWVzPWZ1bmN0aW9uKG4saSl7cmV0dXJuITB9LHQucHJvdG90eXBlLmNvdmVyPWZ1bmN0aW9uKG4saSl7Zm9yKHZhciBhPSExLGY9ITEsUz1bXSxMPW5ldyBTZXQsaz1bXSxVPW5ldyBNYXAsaj1uZXcgTWFwLFg9bmV3IFNldCxaPVtdLGVlPTA7ZWU8aS5sZW5ndGg7KytlZSl7Zm9yKHZhciB0ZT1pW2VlXTt0ZSBpbnN0YW5jZW9mIHI7KXRlPXRlLmV4cHJlc3Npb247aWYoTC5oYXModGUudG9TdHJpbmcoKSkmJlMucHVzaChuZXcgVi5XYXJuaW5nKDAsJ0R1cGxpY2F0ZSBydWxlIGZvciAiJyt0ZStgIiBpbiBwYXR0ZXJuIG1hdGNoaW5nLgpgKSksTC5hZGQodGUudG9TdHJpbmcoKSksdGUgaW5zdGFuY2VvZiBPKXtmb3IodmFyIG9lPTAsc2U9dGUuZW50cmllcztvZTxzZS5sZW5ndGg7b2UrKyl7dmFyIHVlPXNlW29lXTtYLmFkZCh1ZVswXSl9Wi5wdXNoKHRlKX1lbHNlIGlmKCEodGUgaW5zdGFuY2VvZiBBKSl7aWYodGUgaW5zdGFuY2VvZiB0KXthPSEwLGY9ITAsZWUrMTxpLmxlbmd0aCYmUy5wdXNoKG5ldyBWLldhcm5pbmcoZWUsJ1J1bGVzIGFmdGVyICInK3RlK2AiIHVudXNlZCBpbiBwYXR0ZXJuIG1hdGNoaW5nLgpgKSk7YnJlYWt9aWYodGUgaW5zdGFuY2VvZiBJKXtpZigoaWU9dGUuZ2V0Q29uc3RydWN0b3JOYW1lKG4pKT09PXZvaWQgMCl7YT0hMCxmPSEwLGVlKzE8aS5sZW5ndGgmJlMucHVzaChuZXcgVi5XYXJuaW5nKGVlLCdSdWxlcyBhZnRlciAiJyt0ZStgIiB1bnVzZWQgaW4gcGF0dGVybiBtYXRjaGluZy4KYCkpO2JyZWFrfWlmKGsubGVuZ3RoPT09MCl7aWYoKHJlPXRlLmdldENvbnN0cnVjdG9yTGlzdChuKSk9PT12b2lkIDApdGhyb3cgbmV3IFYuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJUaGVyZS4gSnVzdCBhbm90aGVyIHVuZm9ydHVuYXRlIGFjY2lkZW50LiIpO2s9cmV9VS5oYXMoaWUpP1MucHVzaChuZXcgVi5XYXJuaW5nKDAsJ0R1cGxpY2F0ZSBydWxlIGZvciAiJyt0ZStgIiBpbiBwYXR0ZXJuIG1hdGNoaW5nLgpgKSk6KFU9VS5zZXQoaWUsW3RlXSksaj1qLnNldChpZSx0ZSkpfWVsc2V7aWYodGUgaW5zdGFuY2VvZiBlKXt2YXIgaWUscGU9dGUuZnVuYztpZighKHBlIGluc3RhbmNlb2YgSSkpdGhyb3cgbmV3IFYuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJUaGVyZS4gSnVzdCBhbm90aGVyIHVuZm9ydHVuYXRlIGFjY2lkZW50LiIpO2lmKChpZT1wZS5nZXRDb25zdHJ1Y3Rvck5hbWUobikpPT09dm9pZCAwKXRocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiVGhlcmUuIEp1c3QgYW5vdGhlciB1bmZvcnR1bmF0ZSBhY2NpZGVudC4iKTtpZihrLmxlbmd0aD09PTApe3ZhciByZTtpZigocmU9cGUuZ2V0Q29uc3RydWN0b3JMaXN0KG4pKT09PXZvaWQgMCl0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIlRoZXJlLiBKdXN0IGFub3RoZXIgdW5mb3J0dW5hdGUgYWNjaWRlbnQuIik7az1yZX1pZihVLmhhcyhpZSkpe3ZhciBhZT1VLmdldChpZSk7YWUucHVzaCh0ZSksVT1VLnNldChpZSxhZSl9ZWxzZSBVPVUuc2V0KGllLFt0ZV0pLGo9ai5zZXQoaWUsbmV3IGUodGUuZnVuYyxuZXcgdCkpfWlmKHRlIGluc3RhbmNlb2YgWSl0aHJvdyBuZXcgVi5QYXR0ZXJuTWF0Y2hFcnJvcigiVmVjdG9yIHBhdHRlcm4gYXJlIG5vdCBjaGVja2VkIGZvciBleGhhdXN0aXZlbmVzcy4iKX19fWlmKGsubGVuZ3RoIT09MCl7aWYoIWYpZm9yKGE9ITAsZWU9MDtlZTxrLmxlbmd0aDsrK2VlKWouaGFzKGtbZWVdKT9TPVMuY29uY2F0KGouZ2V0KGtbZWVdKS5jb3ZlcihuLFUuZ2V0KGtbZWVdKSkpOmE9Zn1lbHNlIGlmKCFhJiZaLmxlbmd0aCE9PTApe3ZhciBjZT1bXTtyZXR1cm4gWC5mb3JFYWNoKGZ1bmN0aW9uKGxlKXtjZS5wdXNoKFtsZSxuZXcgdF0pfSksUy5jb25jYXQobmV3IE8oITAsY2UpLmNvdmVyKG4sWikpfXJldHVybiBhfHxTLnB1c2gobmV3IFYuV2FybmluZygtMSxgUGF0dGVybiBtYXRjaGluZyBpcyBub3QgZXhoYXVzdGl2ZS4KYCkpLFN9LHQucHJvdG90eXBlLm1hdGNoZXM9ZnVuY3Rpb24obixpKXtyZXR1cm5bXX0sdC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sdC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4iXyJ9LHQucHJvdG90eXBlLmFzc2VydFVuaXF1ZUJpbmRpbmc9ZnVuY3Rpb24obixpKXtyZXR1cm4gbmV3IFNldH0sdH0oaCk7dS5XaWxkY2FyZD1DO3ZhciBHPWZ1bmN0aW9uKGwpe2Z1bmN0aW9uIHQobixpLGEpe3ZhciBmPWwuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gZi5pZGVudGlmaWVyPW4sZi50eXBlQW5ub3RhdGlvbj1pLGYucGF0dGVybj1hLGZ9cmV0dXJuIGcodCxsKSx0LnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKG4saSxhLGYsUyxMKXtpZihpPT09dm9pZCAwJiYoaT1uZXcgTWFwKSxhPT09dm9pZCAwJiYoYT0iJyp0MCIpLGY9PT12b2lkIDAmJihmPW5ldyBTZXQpLFM9PT12b2lkIDAmJihTPSExKSxMPT09dm9pZCAwJiYoTD1uZXcgTWFwKSwhUyl0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIkxheWVyZWQgcGF0dGVybnMgYXJlIGZhciB0b28gbGF5ZXJlZCB0byBoYXZlIGEgdHlwZS4iKTt2YXIgaz1uZXcgSSh0aGlzLmlkZW50aWZpZXIpLmdldFR5cGUobixpLGEsZiwhMCxMKSxVPWtbMF07aWYodGhpcy50eXBlQW5ub3RhdGlvbiE9PXZvaWQgMCl0cnl7aT0oWD1VLm1lcmdlKG4sa1s0XSx0aGlzLnR5cGVBbm5vdGF0aW9uKSlbMV0sVT1YWzBdfWNhdGNoKFope3Rocm93IFogaW5zdGFuY2VvZiBBcnJheT9uZXcgVi5FbGFib3JhdGlvbkVycm9yKCJXcm9uZyB0eXBlIGFubm90YXRpb246ICIrWlswXSk6Wn12YXIgaj10aGlzLnBhdHRlcm4uZ2V0VHlwZShuLGksa1syXSxrWzNdLCEwLEwpO3RyeXt2YXIgWDtpPShYPVUubWVyZ2UobixqWzRdLGpbMF0pKVsxXSxVPVhbMF19Y2F0Y2goWil7dGhyb3cgWiBpbnN0YW5jZW9mIEFycmF5P25ldyBWLkVsYWJvcmF0aW9uRXJyb3IoIldyb25nIHR5cGUgYW5ub3RhdGlvbjogIitaWzBdKTpafXJldHVybltVLGtbMV0uY29uY2F0KGpbMV0pLGpbMl0salszXSxpLG4udmFsdWVJZGVudGlmaWVySWRdfSx0LnByb3RvdHlwZS5jb21wdXRlPWZ1bmN0aW9uKG4saSl7dGhyb3cgbmV3IFYuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJMYXllcmVkIHBhdHRlcm5zIGFyZSBmYXIgdG9vIGxheWVyZWQgdG8gaGF2ZSBhIHZhbHVlLiIpfSx0LnByb3RvdHlwZS5tYXRjaFR5cGU9ZnVuY3Rpb24obixpLGEpe3ZhciBmPWE7aWYodGhpcy50eXBlQW5ub3RhdGlvbiE9PXZvaWQgMCl0cnl7dmFyIFM9YS5tZXJnZShuLGksdGhpcy50eXBlQW5ub3RhdGlvbik7aT1TWzFdLGY9U1swXX1jYXRjaChrKXt0aHJvdyBrIGluc3RhbmNlb2YgQXJyYXk/bmV3IFYuRWxhYm9yYXRpb25FcnJvcigiV3JvbmcgdHlwZSBhbm5vdGF0aW9uOiAiK2tbMF0pOmt9dmFyIEw9dGhpcy5wYXR0ZXJuLm1hdGNoVHlwZShuLGksZik7cmV0dXJuW1tbdGhpcy5pZGVudGlmaWVyLmdldFRleHQoKSxmXV0uY29uY2F0KExbMF0pLGEsTFsyXV19LHQucHJvdG90eXBlLnN1YnN1bWVzPWZ1bmN0aW9uKG4saSl7dGhyb3cgbmV3IFYuUGF0dGVybk1hdGNoRXJyb3IoIkxheWVyZWQgcGF0dGVybnMgYXJlIG5vdCBjaGVja2VkIGZvciBleGhhdXN0aXZlbmVzcy4iKX0sdC5wcm90b3R5cGUuY292ZXI9ZnVuY3Rpb24obixpKXt0aHJvdyBuZXcgVi5QYXR0ZXJuTWF0Y2hFcnJvcigiTGF5ZXJlZCBwYXR0ZXJucyBhcmUgbm90IGNoZWNrZWQgZm9yIGV4aGF1c3RpdmVuZXNzLiIpfSx0LnByb3RvdHlwZS5tYXRjaGVzPWZ1bmN0aW9uKG4saSl7dmFyIGE9dGhpcy5wYXR0ZXJuLm1hdGNoZXMobixpKTtyZXR1cm4gYT09PXZvaWQgMD9hOltbdGhpcy5pZGVudGlmaWVyLmdldFRleHQoKSxpXV0uY29uY2F0KGEpfSx0LnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnR5cGVBbm5vdGF0aW9uP25ldyB0KHRoaXMuaWRlbnRpZmllcix0aGlzLnR5cGVBbm5vdGF0aW9uLnNpbXBsaWZ5KCksdGhpcy5wYXR0ZXJuLnNpbXBsaWZ5KCkpOm5ldyB0KHRoaXMuaWRlbnRpZmllcix2b2lkIDAsdGhpcy5wYXR0ZXJuLnNpbXBsaWZ5KCkpfSx0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlkZW50aWZpZXIuZ2V0VGV4dCgpKyIgYXMgIit0aGlzLnBhdHRlcm59LHQucHJvdG90eXBlLmFzc2VydFVuaXF1ZUJpbmRpbmc9ZnVuY3Rpb24obixpKXt2YXIgYT10aGlzLnBhdHRlcm4uYXNzZXJ0VW5pcXVlQmluZGluZyhuLGkpLGY9bi5nZXRTdGF0aWNWYWx1ZSh0aGlzLmlkZW50aWZpZXIuZ2V0VGV4dCgpKTtpZihmIT09dm9pZCAwJiZmWzFdIT09TS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKXJldHVybiBhO3ZhciBTPW4uZ2V0RHluYW1pY1ZhbHVlKHRoaXMuaWRlbnRpZmllci5nZXRUZXh0KCkpO2lmKFMhPT12b2lkIDAmJlNbMV0hPT1NLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpcmV0dXJuIGE7aWYoYS5oYXModGhpcy5pZGVudGlmaWVyLmdldFRleHQoKSkpdGhyb3cgbmV3IFYuUGFyc2VyRXJyb3IoJ05vIG1hdHRlciBmcm9tIHdoaWNoIGVuZCB5b3Ugc3RhcnQgZWF0aW5nIHRoaXMgcGF0dGVybixyZWJpbmRpbmcgIicrdGhpcy5pZGVudGlmaWVyLmdldFRleHQoKSsnIiBpcyBzdGlsbCBhIGJhZCBpZGVhLicpO3JldHVybiBhLmFkZCh0aGlzLmlkZW50aWZpZXIuZ2V0VGV4dCgpKX0sdH0oaCk7dS5MYXllcmVkUGF0dGVybj1HO3ZhciBZPWZ1bmN0aW9uKGwpe2Z1bmN0aW9uIHQobil7dmFyIGk9bC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBpLmV4cHJlc3Npb25zPW4saX1yZXR1cm4gZyh0LGwpLHQucHJvdG90eXBlLmdldFR5cGU9ZnVuY3Rpb24obixpLGEsZixTLEwpe2lmKGk9PT12b2lkIDAmJihpPW5ldyBNYXApLGE9PT12b2lkIDAmJihhPSInKnQwIiksZj09PXZvaWQgMCYmKGY9bmV3IFNldCksUz09PXZvaWQgMCYmKFM9ITEpLHRoaXMuZXhwcmVzc2lvbnMubGVuZ3RoPT09MClyZXR1cm5bbmV3IHMuQ3VzdG9tVHlwZSgidmVjdG9yIixbbmV3IHMuQW55VHlwZV0pLFtdLGEsZixpLG4udmFsdWVJZGVudGlmaWVySWRdO2Zvcih2YXIgaz10aGlzLmV4cHJlc3Npb25zWzBdLmdldFR5cGUobixpLGEsZixTKSxVPWtbMF0saj0wO2o8dGhpcy5leHByZXNzaW9ucy5sZW5ndGg7KytqKXtrPXRoaXMuZXhwcmVzc2lvbnNbal0uZ2V0VHlwZShuLGtbNF0sa1syXSxrWzNdLFMpO3RyeXt2YXIgWD1VLm1lcmdlKG4sa1s0XSxrWzBdKTtrWzRdPVhbMV0sVT1YWzBdfWNhdGNoKFope3Rocm93IFogaW5zdGFuY2VvZiBBcnJheT9uZXcgVi5FbGFib3JhdGlvbkVycm9yKCJUeXBlIGNsYXNoIGluIHZlY3RvciBlbnRyaWVzOiAiK1pbMF0pOlp9fXJldHVybltuZXcgcy5DdXN0b21UeXBlKCJ2ZWN0b3IiLFtVXSksa1sxXSxrWzJdLGtbM10sa1s0XSxrWzVdXX0sdC5wcm90b3R5cGUuY29tcHV0ZT1mdW5jdGlvbihuLGkpe2Zvcih2YXIgYT1bXSxmPTA7Zjx0aGlzLmV4cHJlc3Npb25zLmxlbmd0aDsrK2Ype3ZhciBTPXRoaXMuZXhwcmVzc2lvbnNbZl0uY29tcHV0ZShuLGkpO2lmKFM9PT12b2lkIDB8fFMudmFsdWU9PT12b2lkIDApdGhyb3cgbmV3IFYuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJORyIpO2EucHVzaChTLnZhbHVlKX1yZXR1cm57bmV3U3RhdGU6dm9pZCAwLHZhbHVlOm5ldyBELlZlY3RvclZhbHVlKGEpLGhhc1Rocm93bjohMX19LHQucHJvdG90eXBlLmdldEV4cGxpY2l0VHlwZVZhcmlhYmxlcz1mdW5jdGlvbigpe3JldHVybiBuZXcgU2V0fSx0LnByb3RvdHlwZS5tYXRjaFR5cGU9ZnVuY3Rpb24obixpLGEpe2lmKCEoYSBpbnN0YW5jZW9mIHMuQ3VzdG9tVHlwZSl8fGEubmFtZSE9PSJ2ZWN0b3IiKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoJ1ZlY3RvcnMgbGlrZSBvbmx5IHZlY3RvcnMsIG5vdCAiJythKyciLiBTdGF5IGNvb2wuJyk7Zm9yKHZhciBmPWEudHlwZUFyZ3VtZW50c1swXSxTPVtdLEw9MDtMPHRoaXMuZXhwcmVzc2lvbnMubGVuZ3RoOysrTCl7dmFyIGs9dGhpcy5leHByZXNzaW9uc1tMXS5tYXRjaFR5cGUobixpLGYpO2Y9a1sxXSxTPVMuY29uY2F0KGtbMF0pLGk9a1syXX1yZXR1cm5bUyxuZXcgcy5DdXN0b21UeXBlKCJ2ZWN0b3IiLFtmXSksaV19LHQucHJvdG90eXBlLnN1YnN1bWVzPWZ1bmN0aW9uKG4saSl7dGhyb3cgbmV3IFYuUGF0dGVybk1hdGNoRXJyb3IoIlZlY3RvciBwYXR0ZXJucyBhcmUgbm90IGNoZWNrZWQgZm9yIGV4aGF1c3RpdmVuZXNzLiIpfSx0LnByb3RvdHlwZS5jb3Zlcj1mdW5jdGlvbihuLGkpe3Rocm93IG5ldyBWLlBhdHRlcm5NYXRjaEVycm9yKCJWZWN0b3IgcGF0dGVybnMgYXJlIG5vdCBjaGVja2VkIGZvciBleGhhdXN0aXZlbmVzcy4iKX0sdC5wcm90b3R5cGUubWF0Y2hlcz1mdW5jdGlvbihuLGkpe2lmKCEoaSBpbnN0YW5jZW9mIEQuVmVjdG9yVmFsdWUpKXRocm93IG5ldyBWLkVsYWJvcmF0aW9uRXJyb3IoJ1ZlY3RvcnMgbGlrZSBvbmx5IHZlY3RvcnMsIG5vdCAiJytpKyciLiBTdGF5IGNvb2wuJyk7Zm9yKHZhciBhPVtdLGY9MDtmPHRoaXMuZXhwcmVzc2lvbnMubGVuZ3RoOysrZil7dmFyIFM9dGhpcy5leHByZXNzaW9uc1tmXS5tYXRjaGVzKG4saS5lbnRyaWVzW2ZdKTtTIT09dm9pZCAwJiYoYT1hLmNvbmNhdChTKSl9cmV0dXJuIGF9LHQucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7Zm9yKHZhciBuPVtdLGk9MDtpPHRoaXMuZXhwcmVzc2lvbnMubGVuZ3RoOysraSluLnB1c2godGhpcy5leHByZXNzaW9uc1tpXS5zaW1wbGlmeSgpKTtyZXR1cm4gbmV3IHQobil9LHQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7Zm9yKHZhciBuPSIjWyAiLGk9MDtpPHRoaXMuZXhwcmVzc2lvbnMubGVuZ3RoOysraSlpPjAmJihuKz0iLCAiKSxuKz10aGlzLmV4cHJlc3Npb25zW2ldO3JldHVybiBuKyIgXSJ9LHR9KGgpO3UuVmVjdG9yPVk7dmFyIEo9ZnVuY3Rpb24obCl7ZnVuY3Rpb24gdChuLGkpe3ZhciBhPWwuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gYS5sZWZ0PW4sYS5yaWdodD1pLGF9cmV0dXJuIGcodCxsKSx0LnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKG4saSxhLGYsUyxMKXtpPT09dm9pZCAwJiYoaT1uZXcgTWFwKSxhPT09dm9pZCAwJiYoYT0iJyp0MCIpLGY9PT12b2lkIDAmJihmPW5ldyBTZXQpLFM9PT12b2lkIDAmJihTPSExKTt2YXIgaz10aGlzLmxlZnQuZ2V0VHlwZShuLGksYSxmLFMpLFU9dGhpcy5yaWdodC5nZXRUeXBlKG4sa1s0XSxrWzJdLGtbM10sUyk7dHJ5e3ZhciBqPWtbMF0ubWVyZ2UobixVWzRdLFVbMF0pO3JldHVybltqWzBdLGtbMV0uY29uY2F0KFVbMV0pLFVbMl0sVVszXSxqWzFdLFVbNV1dfWNhdGNoKFgpe3Rocm93IFggaW5zdGFuY2VvZiBBcnJheT9uZXcgVi5FbGFib3JhdGlvbkVycm9yKCJCb3RoIHBhdHRlcm5zIG9mIGEgY29uanVuY3RpdmUgcGF0dGVybiBtdXN0IGhhdmUgdGhlIHNhbWUgdHlwZS4iKTpYfX0sdC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHQodGhpcy5sZWZ0LnNpbXBsaWZ5KCksdGhpcy5yaWdodC5zaW1wbGlmeSgpKX0sdC5wcm90b3R5cGUubWF0Y2hUeXBlPWZ1bmN0aW9uKG4saSxhKXt0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIlx1MzAwQ1x1MzBDQlx1MzBFM1x1RkYwRFx1MzAwMVx1MzBDQlx1MzBFM1x1RkYwRFx1MzAwRCIpfSx0LnByb3RvdHlwZS5zdWJzdW1lcz1mdW5jdGlvbihuLGkpe3Rocm93IG5ldyBWLlBhdHRlcm5NYXRjaEVycm9yKCJDb25qdWN0aXZlIHBhdHRlcm5zIGFyZSBub3QgY2hlY2tlZCBmb3IgZXhoYXVzdGl2ZW5lc3MuIil9LHQucHJvdG90eXBlLmNvdmVyPWZ1bmN0aW9uKG4saSl7dGhyb3cgbmV3IFYuUGF0dGVybk1hdGNoRXJyb3IoIkNvbmp1Y3RpdmUgcGF0dGVybnMgYXJlIG5vdCBjaGVja2VkIGZvciBleGhhdXN0aXZlbmVzcy4iKX0sdC5wcm90b3R5cGUubWF0Y2hlcz1mdW5jdGlvbihuLGkpe3ZhciBhPXRoaXMubGVmdC5tYXRjaGVzKG4saSk7aWYoYSE9PXZvaWQgMCl7Zm9yKHZhciBmPW4uZ2V0TmVzdGVkU3RhdGUobi5pZCksUz0wLEw9YTtTPEwubGVuZ3RoO1MrKyl7dmFyIGs9TFtTXTtmLnNldER5bmFtaWNWYWx1ZShrWzBdLGtbMV0sTS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKX12YXIgVT10aGlzLnJpZ2h0Lm1hdGNoZXMoZixpKTtpZihVIT09dm9pZCAwKXJldHVybiBhLmNvbmNhdChVKX19LHQucHJvdG90eXBlLmFzc2VydFVuaXF1ZUJpbmRpbmc9ZnVuY3Rpb24obixpKXtyZXR1cm4gbmV3IFNldH0sdH0oaCk7dS5Db25qdW5jdGl2ZVBhdHRlcm49Sjt2YXIgej1mdW5jdGlvbihsKXtmdW5jdGlvbiB0KG4saSl7dmFyIGE9bC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBhLmxlZnQ9bixhLnJpZ2h0PWksYX1yZXR1cm4gZyh0LGwpLHQucHJvdG90eXBlLmdldFR5cGU9ZnVuY3Rpb24obixpLGEsZixTLEwpe2k9PT12b2lkIDAmJihpPW5ldyBNYXApLGE9PT12b2lkIDAmJihhPSInKnQwIiksZj09PXZvaWQgMCYmKGY9bmV3IFNldCksUz09PXZvaWQgMCYmKFM9ITEpO3ZhciBrPXRoaXMubGVmdC5nZXRUeXBlKG4saSxhLGYsUyksVT10aGlzLnJpZ2h0LmdldFR5cGUobixrWzRdLGtbMl0sa1szXSxTKTt0cnl7dmFyIGo9a1swXS5tZXJnZShuLFVbNF0sVVswXSk7cmV0dXJuW2pbMF0sa1sxXS5jb25jYXQoVVsxXSksVVsyXSxVWzNdLGpbMV0sVVs1XV19Y2F0Y2goWCl7dGhyb3cgWCBpbnN0YW5jZW9mIEFycmF5P25ldyBWLkVsYWJvcmF0aW9uRXJyb3IoIkJvdGggcGF0dGVybnMgb2YgYSBkaXNqdW5jdGl2ZSBwYXR0ZXJuIG11c3QgaGF2ZSB0aGUgc2FtZSB0eXBlLiIpOlh9fSx0LnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiBuZXcgdCh0aGlzLmxlZnQuc2ltcGxpZnkoKSx0aGlzLnJpZ2h0LnNpbXBsaWZ5KCkpfSx0LnByb3RvdHlwZS5tYXRjaFR5cGU9ZnVuY3Rpb24obixpLGEpe3Rocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiXHUzMDBDXHUzMENCXHUzMEUzXHVGRjBEXHUzMDAxXHUzMENCXHUzMEUzXHVGRjBEXHUzMDBEIil9LHQucHJvdG90eXBlLnN1YnN1bWVzPWZ1bmN0aW9uKG4saSl7dGhyb3cgbmV3IFYuUGF0dGVybk1hdGNoRXJyb3IoIkRpc2p1bmN0aXZlIHBhdHRlcm5zIGFyZSBub3QgY2hlY2tlZCBmb3IgZXhoYXVzdGl2ZW5lc3MuIil9LHQucHJvdG90eXBlLmNvdmVyPWZ1bmN0aW9uKG4saSl7dGhyb3cgbmV3IFYuUGF0dGVybk1hdGNoRXJyb3IoIkRpc2p1bmN0aXZlIHBhdHRlcm5zIGFyZSBub3QgY2hlY2tlZCBmb3IgZXhoYXVzdGl2ZW5lc3MuIil9LHQucHJvdG90eXBlLm1hdGNoZXM9ZnVuY3Rpb24obixpKXt2YXIgYT10aGlzLmxlZnQubWF0Y2hlcyhuLGkpO3JldHVybiBhIT09dm9pZCAwP2E6dGhpcy5yaWdodC5tYXRjaGVzKG4saSl9LHQucHJvdG90eXBlLmFzc2VydFVuaXF1ZUJpbmRpbmc9ZnVuY3Rpb24obixpKXtyZXR1cm4gbmV3IFNldH0sdH0oaCk7dS5EaXNqdW5jdGl2ZVBhdHRlcm49ejt2YXIgcD1mdW5jdGlvbihsKXtmdW5jdGlvbiB0KG4saSxhKXt2YXIgZj1sLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIGYucGF0dGVybj1uLGYubmVzdGVkPWksZi5leHByZXNzaW9uPWEsZn1yZXR1cm4gZyh0LGwpLHQucHJvdG90eXBlLmdldFR5cGU9ZnVuY3Rpb24obixpLGEsZixTLEwpe3Rocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiXHUzMDBDXHUzMENCXHUzMEUzXHVGRjBEXHUzMDAxXHUzMENCXHUzMEUzXHVGRjBEXHUzMDBEIil9LHQucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyB0KHRoaXMucGF0dGVybi5zaW1wbGlmeSgpLHRoaXMubmVzdGVkLnNpbXBsaWZ5KCksdGhpcy5leHByZXNzaW9uLnNpbXBsaWZ5KCkpfSx0LnByb3RvdHlwZS5tYXRjaFR5cGU9ZnVuY3Rpb24obixpLGEpe3Rocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiXHUzMDBDXHUzMENCXHUzMEUzXHVGRjBEXHUzMDAxXHUzMENCXHUzMEUzXHVGRjBEXHUzMDBEIil9LHQucHJvdG90eXBlLnN1YnN1bWVzPWZ1bmN0aW9uKG4saSl7dGhyb3cgbmV3IFYuUGF0dGVybk1hdGNoRXJyb3IoIk5lc3RlZCBtYXRjaGVzIGFyZSBub3QgY2hlY2tlZCBmb3IgZXhoYXVzdGl2ZW5lc3MuIil9LHQucHJvdG90eXBlLmNvdmVyPWZ1bmN0aW9uKG4saSl7dGhyb3cgbmV3IFYuUGF0dGVybk1hdGNoRXJyb3IoIk5lc3RlZCBtYXRjaGVzIGFyZSBub3QgY2hlY2tlZCBmb3IgZXhoYXVzdGl2ZW5lc3MuIil9LHQucHJvdG90eXBlLm1hdGNoZXM9ZnVuY3Rpb24obixpKXtpZih0aGlzLnBhdHRlcm4ubWF0Y2hlcyhuLGkpIT09dm9pZCAwKXRocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiXHUzMDBDXHUzMENCXHUzMEUzXHVGRjBEXHUzMDAxXHUzMENCXHUzMEUzXHVGRjBEXHUzMDBEIil9LHQucHJvdG90eXBlLmFzc2VydFVuaXF1ZUJpbmRpbmc9ZnVuY3Rpb24obixpKXtyZXR1cm4gbmV3IFNldH0sdC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4iKCAiK3RoaXMucGF0dGVybisiIHdpdGggIit0aGlzLm5lc3RlZCsiID0gIit0aGlzLmV4cHJlc3Npb24rIiApIn0sdH0oaCk7dS5OZXN0ZWRNYXRjaD1wO3ZhciBjPWZ1bmN0aW9uKGwpe2Z1bmN0aW9uIHQobixpKXt2YXIgYT1sLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIGEuZXhwcmVzc2lvbnM9bixhLm9wZXJhdG9ycz1pLGF9cmV0dXJuIGcodCxsKSx0LnByb3RvdHlwZS5tYXRjaFR5cGU9ZnVuY3Rpb24obixpLGEpe3JldHVybiB0aGlzLnJlUGFyc2UobikubWF0Y2hUeXBlKG4saSxhKX0sdC5wcm90b3R5cGUuc3Vic3VtZXM9ZnVuY3Rpb24obixpKXt0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIlx1NEUwMFx1NjYyOFx1NjVFNVx1Njc2NVx1MzA4NFx1MzA0Q1x1MzA4Q1x1MzAwMiIpfSx0LnByb3RvdHlwZS5jb3Zlcj1mdW5jdGlvbihuLGkpe3Rocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiXHU0RTAwXHU2NjI4XHU2NUU1XHU2NzY1XHUzMDg0XHUzMDRDXHUzMDhDXHUzMDAyIil9LHQucHJvdG90eXBlLm1hdGNoZXM9ZnVuY3Rpb24obixpKXtyZXR1cm4gdGhpcy5yZVBhcnNlKG4pLm1hdGNoZXMobixpKX0sdC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIk91Y2gsIEknbSBub3QgZnVsbHkgcGFyc2VkLiIpfSx0LnByb3RvdHlwZS5yZVBhcnNlPWZ1bmN0aW9uKG4pe2Zvcih2YXIgaT10aGlzLm9wZXJhdG9ycyxhPXRoaXMuZXhwcmVzc2lvbnMsZj1bXSxTPTA7UzxhLmxlbmd0aDsrK1MpZi5wdXNoKFtTXSk7Zm9yKGkuc29ydChmdW5jdGlvbihpZSxwZSl7dmFyIHJlPWllWzBdLGFlPWllWzFdLGNlPXBlWzBdLGxlPXBlWzFdLGRlPW4uZ2V0SW5maXhTdGF0dXMocmUpLGhlPW4uZ2V0SW5maXhTdGF0dXMoY2UpO2lmKGRlLnByZWNlZGVuY2U+aGUucHJlY2VkZW5jZSlyZXR1cm4tMTtpZihkZS5wcmVjZWRlbmNlPGhlLnByZWNlZGVuY2UpcmV0dXJuIDE7aWYoZGUucmlnaHRBc3NvY2lhdGl2ZSl7aWYoYWU+bGUpcmV0dXJuLTE7aWYoYWU8bGUpcmV0dXJuIDF9ZWxzZXtpZihhZT5sZSlyZXR1cm4gMTtpZihhZTxsZSlyZXR1cm4tMX1yZXR1cm4gMH0pLFM9MDtTPGkubGVuZ3RoOysrUyl7aWYoUz4wKXt2YXIgTD1uLmdldEluZml4U3RhdHVzKGlbU11bMF0pLGs9bi5nZXRJbmZpeFN0YXR1cyhpW1MtMV1bMF0pO2lmKEwucHJlY2VkZW5jZT09PWsucHJlY2VkZW5jZSYmTC5yaWdodEFzc29jaWF0aXZlIT09ay5yaWdodEFzc29jaWF0aXZlJiYoZltpW1MtMV1bMV0rMV09PT1mW2lbU11bMV1dfHxmW2lbUy0xXVsxXV09PT1mW2lbU11bMV0rMV0pKXRocm93IG5ldyBWLlBhcnNlckVycm9yKCJDb3VsZCB5b3UgZXZlciBpbWFnaW5lIGxlZnQgYXNzb2NpYXRpdmVzIGFuZCByaWdodCBhc3NvY2lhdGl2ZXMgbGl2aW5nIHRvZ2V0aGVyIGluIHBlYWNlPyIpfWZvcih2YXIgVT1hW2lbU11bMV1dLGo9YVtpW1NdWzFdKzFdLFg9bmV3IGUobmV3IEkoaVtTXVswXSksbmV3IHgoW1Usal0pKSxaPWZbaVtTXVsxXV0sZWU9MCx0ZT1mW2lbU11bMV0rMV07ZWU8dGUubGVuZ3RoO2VlKyspe3ZhciBvZT10ZVtlZV07Wi5wdXNoKG9lKX1mb3IodmFyIHNlPTAsdWU9WjtzZTx1ZS5sZW5ndGg7c2UrKylmW29lPXVlW3NlXV09WixhW29lXT1YfXJldHVybiBhWzBdfSx0fShoKTt1LkluZml4RXhwcmVzc2lvbj1jO3ZhciB3PW5ldyBJKG5ldyBCLklkZW50aWZpZXJUb2tlbigiZmFsc2UiKSksVD1uZXcgSShuZXcgQi5JZGVudGlmaWVyVG9rZW4oInRydWUiKSksTj1uZXcgSShuZXcgQi5JZGVudGlmaWVyVG9rZW4oIm5pbCIpKSwkPW5ldyBJKG5ldyBCLklkZW50aWZpZXJUb2tlbigiOjoiKSksSD1mdW5jdGlvbihsKXtmdW5jdGlvbiB0KG4saSl7dmFyIGE9bC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBhLmxlZnRPcGVyYW5kPW4sYS5yaWdodE9wZXJhbmQ9aSxhfXJldHVybiBnKHQsbCksdC5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG5lKHRoaXMubGVmdE9wZXJhbmQsdGhpcy5yaWdodE9wZXJhbmQsdykuc2ltcGxpZnkoKX0sdC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4iKCAiK3RoaXMubGVmdE9wZXJhbmQrIiBhbmRhbHNvICIrdGhpcy5yaWdodE9wZXJhbmQrIiApIn0sdH0oaCk7dS5Db25qdW5jdGlvbj1IO3ZhciBQPWZ1bmN0aW9uKGwpe2Z1bmN0aW9uIHQobixpKXt2YXIgYT1sLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIGEubGVmdE9wZXJhbmQ9bixhLnJpZ2h0T3BlcmFuZD1pLGF9cmV0dXJuIGcodCxsKSx0LnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiBuZXcgbmUodGhpcy5sZWZ0T3BlcmFuZCxULHRoaXMucmlnaHRPcGVyYW5kKS5zaW1wbGlmeSgpfSx0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiIoICIrdGhpcy5sZWZ0T3BlcmFuZCsiIG9yZWxzZSAiK3RoaXMucmlnaHRPcGVyYW5kKyIgKSJ9LHR9KGgpO3UuRGlzanVuY3Rpb249UDt2YXIgeD1mdW5jdGlvbihsKXtmdW5jdGlvbiB0KG4pe3ZhciBpPWwuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gaS5leHByZXNzaW9ucz1uLGl9cmV0dXJuIGcodCxsKSx0LnByb3RvdHlwZS5tYXRjaFR5cGU9ZnVuY3Rpb24obixpLGEpe3JldHVybiB0aGlzLnNpbXBsaWZ5KCkubWF0Y2hUeXBlKG4saSxhKX0sdC5wcm90b3R5cGUuc3Vic3VtZXM9ZnVuY3Rpb24obixpKXtyZXR1cm4gdGhpcy5zaW1wbGlmeSgpLnN1YnN1bWVzKG4saSl9LHQucHJvdG90eXBlLmNvdmVyPWZ1bmN0aW9uKG4saSl7cmV0dXJuIHRoaXMuc2ltcGxpZnkoKS5jb3ZlcihuLGkpfSx0LnByb3RvdHlwZS5tYXRjaGVzPWZ1bmN0aW9uKG4saSl7cmV0dXJuIHRoaXMuc2ltcGxpZnkoKS5tYXRjaGVzKG4saSl9LHQucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7Zm9yKHZhciBuPVtdLGk9MDtpPHRoaXMuZXhwcmVzc2lvbnMubGVuZ3RoOysraSluLnB1c2goWyIiKyhpKzEpLHRoaXMuZXhwcmVzc2lvbnNbaV0uc2ltcGxpZnkoKV0pO3JldHVybiBuZXcgTyghMCxuKX0sdC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtmb3IodmFyIG49IiggIixpPTA7aTx0aGlzLmV4cHJlc3Npb25zLmxlbmd0aDsrK2kpaT4wJiYobis9IiwgIiksbis9dGhpcy5leHByZXNzaW9uc1tpXTtyZXR1cm4gbisiICkifSx0fShoKTt1LlR1cGxlPXg7dmFyIFI9ZnVuY3Rpb24obCl7ZnVuY3Rpb24gdChuKXt2YXIgaT1sLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIGkuZXhwcmVzc2lvbnM9bixpfXJldHVybiBnKHQsbCksdC5wcm90b3R5cGUubWF0Y2hUeXBlPWZ1bmN0aW9uKG4saSxhKXtyZXR1cm4gdGhpcy5zaW1wbGlmeSgpLm1hdGNoVHlwZShuLGksYSl9LHQucHJvdG90eXBlLnN1YnN1bWVzPWZ1bmN0aW9uKG4saSl7cmV0dXJuIHRoaXMuc2ltcGxpZnkoKS5zdWJzdW1lcyhuLGkpfSx0LnByb3RvdHlwZS5jb3Zlcj1mdW5jdGlvbihuLGkpe3JldHVybiB0aGlzLnNpbXBsaWZ5KCkuY292ZXIobixpKX0sdC5wcm90b3R5cGUubWF0Y2hlcz1mdW5jdGlvbihuLGkpe3JldHVybiB0aGlzLnNpbXBsaWZ5KCkubWF0Y2hlcyhuLGkpfSx0LnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe2Zvcih2YXIgbj1OLGk9dGhpcy5leHByZXNzaW9ucy5sZW5ndGgtMTtpPj0wOy0taSl7dmFyIGE9bmV3IHgoW3RoaXMuZXhwcmVzc2lvbnNbaV0sbl0pLnNpbXBsaWZ5KCk7bj1uZXcgZSgkLGEpfXJldHVybiBufSx0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe2Zvcih2YXIgbj0iWyAiLGk9MDtpPHRoaXMuZXhwcmVzc2lvbnMubGVuZ3RoOysraSlpPjAmJihuKz0iLCAiKSxuKz10aGlzLmV4cHJlc3Npb25zW2ldO3JldHVybiBuKyIgXSJ9LHR9KGgpO3UuTGlzdD1SO3ZhciBfPWZ1bmN0aW9uKGwpe2Z1bmN0aW9uIHQobil7dmFyIGk9bC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBpLmV4cHJlc3Npb25zPW4saX1yZXR1cm4gZyh0LGwpLHQucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7Zm9yKHZhciBuPXRoaXMuZXhwcmVzc2lvbnMubGVuZ3RoLTEsaT1uZXcgdihbW25ldyBDLHRoaXMuZXhwcmVzc2lvbnNbbl1dXSksYT1uZXcgUSh0aGlzLmV4cHJlc3Npb25zW24tMV0saSksZj1uLTI7Zj49MDstLWYpaT1uZXcgdihbW25ldyBDLGFdXSksYT1uZXcgUSh0aGlzLmV4cHJlc3Npb25zW2ZdLGkpO3JldHVybiBhLnNpbXBsaWZ5KCl9LHQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7Zm9yKHZhciBuPSIoICIsaT0wO2k8dGhpcy5leHByZXNzaW9ucy5sZW5ndGg7KytpKWk+MCYmKG4rPSI7ICIpLG4rPXRoaXMuZXhwcmVzc2lvbnNbaV07cmV0dXJuIG4rIiApIn0sdH0oaCk7dS5TZXF1ZW5jZT1fO3ZhciBXPWZ1bmN0aW9uKGwpe2Z1bmN0aW9uIHQobil7dmFyIGk9bC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBpLmxhYmVsPW4saX1yZXR1cm4gZyh0LGwpLHQucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBkKG5ldyB2KFtbbmV3IE8oITEsW1t0aGlzLmxhYmVsLnRleHQsbmV3IEkobmV3IEIuSWRlbnRpZmllclRva2VuKCJfX3JzIikpXV0pLG5ldyBJKG5ldyBCLklkZW50aWZpZXJUb2tlbigiX19ycyIpKV1dKSl9LHQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIiMiK3RoaXMubGFiZWwuZ2V0VGV4dCgpfSx0fShoKTt1LlJlY29yZFNlbGVjdG9yPVc7dmFyIFE9ZnVuY3Rpb24obCl7ZnVuY3Rpb24gdChuLGkpe3ZhciBhPWwuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gYS5leHByZXNzaW9uPW4sYS5tYXRjaD1pLGF9cmV0dXJuIGcodCxsKSx0LnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiBuZXcgZShuZXcgZCh0aGlzLm1hdGNoLnNpbXBsaWZ5KCkpLHRoaXMuZXhwcmVzc2lvbi5zaW1wbGlmeSgpKX0sdC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4iY2FzZSAiK3RoaXMuZXhwcmVzc2lvbisiIG9mICIrdGhpcy5tYXRjaH0sdH0oaCk7dS5DYXNlQW5hbHlzaXM9UTt2YXIgbmU9ZnVuY3Rpb24obCl7ZnVuY3Rpb24gdChuLGksYSl7dmFyIGY9bC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBmLmNvbmRpdGlvbj1uLGYuY29uc2VxdWVuY2U9aSxmLmFsdGVybmF0aXZlPWEsZn1yZXR1cm4gZyh0LGwpLHQucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7dmFyIG49bmV3IHYoW1tULHRoaXMuY29uc2VxdWVuY2VdLFt3LHRoaXMuYWx0ZXJuYXRpdmVdXSk7cmV0dXJuIG5ldyBRKHRoaXMuY29uZGl0aW9uLG4pLnNpbXBsaWZ5KCl9LHQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuImlmICIrdGhpcy5jb25kaXRpb24rIiB0aGVuICIrdGhpcy5jb25zZXF1ZW5jZSsiIGVsc2UgIit0aGlzLmFsdGVybmF0aXZlfSx0fShoKTt1LkNvbmRpdGlvbmFsPW5lO3ZhciBGPWZ1bmN0aW9uKGwpe2Z1bmN0aW9uIHQobixpKXt2YXIgYT1sLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIGEuY29uZGl0aW9uPW4sYS5ib2R5PWksYX1yZXR1cm4gZyh0LGwpLHQucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7dmFyIG49bmV3IEkobmV3IEIuSWRlbnRpZmllclRva2VuKCJfX3dobCIpKSxpPW5ldyBlKG4sbmV3IHgoW10pKSxhPW5ldyBuZSh0aGlzLmNvbmRpdGlvbixuZXcgXyhbdGhpcy5ib2R5LGldKSxuZXcgeChbXSkpLGY9bmV3IHEuVmFsdWVCaW5kaW5nKCEwLG4sbmV3IGQobmV3IHYoW1tuZXcgeChbXSksYV1dKSkpLFM9bmV3IHEuVmFsdWVEZWNsYXJhdGlvbihbXSxbZl0pO3JldHVybiBuZXcgRShTLGkpLnNpbXBsaWZ5KCl9LHQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIiggd2hpbGUgIit0aGlzLmNvbmRpdGlvbisiIGRvICIrdGhpcy5ib2R5KyIgKSJ9LHR9KGgpO3UuV2hpbGU9Rjt2YXIgYj1mdW5jdGlvbihsKXtmdW5jdGlvbiB0KG4saSl7dmFyIGE9bC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBhLnBhdHRlcm49bixhLmNvbmRpdGlvbj1pLGF9cmV0dXJuIGcodCxsKSx0LnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiBuZXcgcCh0aGlzLnBhdHRlcm4uc2ltcGxpZnkoKSxULHRoaXMuY29uZGl0aW9uLnNpbXBsaWZ5KCkpfSx0LnByb3RvdHlwZS5tYXRjaFR5cGU9ZnVuY3Rpb24obixpLGEpe3Rocm93IG5ldyBWLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiXHUzMDBDXHUzMENCXHUzMEUzXHVGRjBEXHUzMDAxXHUzMENCXHUzMEUzXHVGRjBEXHUzMDBEIil9LHQucHJvdG90eXBlLnN1YnN1bWVzPWZ1bmN0aW9uKG4saSl7dGhyb3cgbmV3IFYuUGF0dGVybk1hdGNoRXJyb3IoIlBhdHRlcm5zIHdpdGggYSBwYXR0ZXJuIGd1YXJkIGFyZSBub3QgY2hlY2tlZCBmb3IgZXhoYXVzdGl2ZW5lc3MuIil9LHQucHJvdG90eXBlLmNvdmVyPWZ1bmN0aW9uKG4saSl7dGhyb3cgbmV3IFYuUGF0dGVybk1hdGNoRXJyb3IoIlBhdHRlcm5zIHdpdGggYSBwYXR0ZXJuIGd1YXJkIGFyZSBub3QgY2hlY2tlZCBmb3IgZXhoYXVzdGl2ZW5lc3MuIil9LHQucHJvdG90eXBlLm1hdGNoZXM9ZnVuY3Rpb24obixpKXt0aHJvdyBuZXcgVi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIlx1MzAwQ1x1MzBDQlx1MzBFM1x1RkYwRFx1MzAwMVx1MzBDQlx1MzBFM1x1RkYwRFx1MzAwRCIpfSx0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiIoICIrdGhpcy5wYXR0ZXJuKyIgaWYgIit0aGlzLmNvbmRpdGlvbisiICkifSx0fShoKTt1LlBhdHRlcm5HdWFyZD1ifSw0NjU6KGZlLHUsSyk9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdS5nZXRJbml0aWFsU3RhdGU9dm9pZCAwO3ZhciBtPUsoMzY3KSxnPUsoNjk5KSxzPUsoMTA2KSxxPUsoNzU4KSxCPW5ldyBnLkN1c3RvbVR5cGUoInJlYWwiKSxNPW5ldyBnLkN1c3RvbVR5cGUoImJvb2wiKSxWPW5ldyBnLkN1c3RvbVR5cGUoInN0cmluZyIpLEQ9bmV3IGcuQ3VzdG9tVHlwZSgiY2hhciIpO2Z1bmN0aW9uIGgoYyl7cmV0dXJuIG5ldyBnLkZ1bmN0aW9uVHlwZShuZXcgZy5UdXBsZVR5cGUoW2MsY10pLGMpLnNpbXBsaWZ5KCl9ZnVuY3Rpb24gQShjKXtyZXR1cm4gbmV3IGcuRnVuY3Rpb25UeXBlKG5ldyBnLlR1cGxlVHlwZShbYyxjXSksTSkuc2ltcGxpZnkoKX12YXIgST1uZXcgZy5UeXBlVmFyaWFibGUoIidhIiksTz1uZXcgZy5UeXBlVmFyaWFibGUoIicnYiIpLEU9bmV3IGcuVHlwZVZhcmlhYmxlKCInaXciKSxyPW5ldyBnLlR5cGVWYXJpYWJsZSgiJ2lyIiksZT1uZXcgZy5UeXBlVmFyaWFibGUoIidpd3IiKSxvPW5ldyBnLlR5cGVWYXJpYWJsZSgiJ2FueSIpLHk9bmV3IHMuRXhjZXB0aW9uQ29uc3RydWN0b3IoIk1hdGNoIiwwLDAsMCksZD1uZXcgcy5FeGNlcHRpb25Db25zdHJ1Y3RvcigiQmluZCIsMCwwLDEpLHY9bmV3IHMuRXhjZXB0aW9uQ29uc3RydWN0b3IoIkRpdiIsMCwwLDIpLEM9bmV3IHMuRXhjZXB0aW9uQ29uc3RydWN0b3IoIk92ZXJmbG93IiwwLDAsMyk7ZnVuY3Rpb24gRyhjKXtyZXR1cm4gbmV3IGcuVHlwZVZhcmlhYmxlQmluZCgiJ2l3IixjLFtuZXcgZy5DdXN0b21UeXBlKCJpbnQiKSxuZXcgZy5DdXN0b21UeXBlKCJ3b3JkIildKS5wcm9wYWdhdGUoKX1mdW5jdGlvbiBZKGMpe3JldHVybiBuZXcgZy5UeXBlVmFyaWFibGVCaW5kKCInaXIiLGMsW25ldyBnLkN1c3RvbVR5cGUoImludCIpLEJdKS5wcm9wYWdhdGUoKX1mdW5jdGlvbiBKKGMpe3JldHVybiBuZXcgZy5UeXBlVmFyaWFibGVCaW5kKCInaXdyIixjLFtuZXcgZy5DdXN0b21UeXBlKCJpbnQiKSxuZXcgZy5DdXN0b21UeXBlKCJ3b3JkIiksQl0pLnByb3BhZ2F0ZSgpfWZ1bmN0aW9uIHooYyl7cmV0dXJuIG5ldyBnLlR5cGVWYXJpYWJsZUJpbmQoIidhbnkiLGMsW25ldyBnLkN1c3RvbVR5cGUoImludCIpLG5ldyBnLkN1c3RvbVR5cGUoIndvcmQiKSxCLG5ldyBnLkN1c3RvbVR5cGUoInN0cmluZyIpLG5ldyBnLkN1c3RvbVR5cGUoImNoYXIiKV0pLnByb3BhZ2F0ZSgpfXZhciBwPW5ldyBtLlN0YXRlKDAsdm9pZCAwLG5ldyBtLlN0YXRpY0Jhc2lzKHt1bml0Om5ldyBtLlR5cGVJbmZvcm1hdGlvbihuZXcgZy5GdW5jdGlvblR5cGUobmV3IGcuQ3VzdG9tVHlwZSgidW5pdCIpLG5ldyBnLlR1cGxlVHlwZShbXSkpLnNpbXBsaWZ5KCksW10sMCwhMCksYm9vbDpuZXcgbS5UeXBlSW5mb3JtYXRpb24obmV3IGcuQ3VzdG9tVHlwZSgiYm9vbCIpLFsidHJ1ZSIsImZhbHNlIl0sMCwhMCksaW50Om5ldyBtLlR5cGVJbmZvcm1hdGlvbihuZXcgZy5DdXN0b21UeXBlKCJpbnQiKSxbXSwwLCEwKSx3b3JkOm5ldyBtLlR5cGVJbmZvcm1hdGlvbihuZXcgZy5DdXN0b21UeXBlKCJ3b3JkIiksW10sMCwhMCkscmVhbDpuZXcgbS5UeXBlSW5mb3JtYXRpb24oQixbXSwwLCExKSxzdHJpbmc6bmV3IG0uVHlwZUluZm9ybWF0aW9uKG5ldyBnLkN1c3RvbVR5cGUoInN0cmluZyIpLFtdLDAsITApLGNoYXI6bmV3IG0uVHlwZUluZm9ybWF0aW9uKG5ldyBnLkN1c3RvbVR5cGUoImNoYXIiKSxbXSwwLCEwKSxsaXN0Om5ldyBtLlR5cGVJbmZvcm1hdGlvbihuZXcgZy5DdXN0b21UeXBlKCJsaXN0IixbSV0pLFsibmlsIiwiOjoiXSwxLCEwKSxhcnJheTpuZXcgbS5UeXBlSW5mb3JtYXRpb24obmV3IGcuQ3VzdG9tVHlwZSgiYXJyYXkiLFtJXSksW10sMSwhMCksdmVjdG9yOm5ldyBtLlR5cGVJbmZvcm1hdGlvbihuZXcgZy5DdXN0b21UeXBlKCJ2ZWN0b3IiLFtJXSksW10sMSwhMCkscmVmOm5ldyBtLlR5cGVJbmZvcm1hdGlvbihuZXcgZy5DdXN0b21UeXBlKCJyZWYiLFtJXSksWyJyZWYiXSwxLCEwKSxleG46bmV3IG0uVHlwZUluZm9ybWF0aW9uKG5ldyBnLkN1c3RvbVR5cGUoImV4biIpLFtdLDAsITEpfSx7ZGl2OltHKGgoRSkpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0sbW9kOltHKGgoRSkpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0sIioiOltKKGgoZSkpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0sIi8iOltoKEIpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0sIisiOltKKGgoZSkpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0sIi0iOltKKGgoZSkpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0sIjwiOlt6KEEobykpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0sIjw9IjpbeihBKG8pKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEVdLCI+IjpbeihBKG8pKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEVdLCI+PSI6W3ooQShvKSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXSwiPSI6W25ldyBnLlR5cGVWYXJpYWJsZUJpbmQoIicnYiIsbmV3IGcuRnVuY3Rpb25UeXBlKG5ldyBnLlR1cGxlVHlwZShbTyxPXSksTSkpLnNpbXBsaWZ5KCksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXSwiPD4iOltuZXcgZy5UeXBlVmFyaWFibGVCaW5kKCInJ2IiLG5ldyBnLkZ1bmN0aW9uVHlwZShuZXcgZy5UdXBsZVR5cGUoW08sT10pLE0pKS5zaW1wbGlmeSgpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0sdHJ1ZTpbbmV3IGcuQ3VzdG9tVHlwZSgiYm9vbCIpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9DT05TVFJVQ1RPUl0sZmFsc2U6W25ldyBnLkN1c3RvbVR5cGUoImJvb2wiKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfQ09OU1RSVUNUT1JdLG5pbDpbbmV3IGcuVHlwZVZhcmlhYmxlQmluZCgiJ2EiLG5ldyBnLkN1c3RvbVR5cGUoImxpc3QiLFtJXSkpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9DT05TVFJVQ1RPUl0sIjo6IjpbbmV3IGcuVHlwZVZhcmlhYmxlQmluZCgiJ2EiLG5ldyBnLkZ1bmN0aW9uVHlwZShuZXcgZy5UdXBsZVR5cGUoW0ksbmV3IGcuQ3VzdG9tVHlwZSgibGlzdCIsW0ldKV0pLG5ldyBnLkN1c3RvbVR5cGUoImxpc3QiLFtJXSkpKS5zaW1wbGlmeSgpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9DT05TVFJVQ1RPUl0sTWF0Y2g6W25ldyBnLkN1c3RvbVR5cGUoImV4biIpLG0uSWRlbnRpZmllclN0YXR1cy5FWENFUFRJT05fQ09OU1RSVUNUT1JdLEJpbmQ6W25ldyBnLkN1c3RvbVR5cGUoImV4biIpLG0uSWRlbnRpZmllclN0YXR1cy5FWENFUFRJT05fQ09OU1RSVUNUT1JdLERpdjpbbmV3IGcuQ3VzdG9tVHlwZSgiZXhuIiksbS5JZGVudGlmaWVyU3RhdHVzLkVYQ0VQVElPTl9DT05TVFJVQ1RPUl0sT3ZlcmZsb3c6W25ldyBnLkN1c3RvbVR5cGUoImV4biIpLG0uSWRlbnRpZmllclN0YXR1cy5FWENFUFRJT05fQ09OU1RSVUNUT1JdLCJeIjpbaChWKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEVdLGV4cGxvZGU6W25ldyBnLkZ1bmN0aW9uVHlwZShWLG5ldyBnLkN1c3RvbVR5cGUoImxpc3QiLFtEXSkpLnNpbXBsaWZ5KCksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXSxpbXBsb2RlOltuZXcgZy5GdW5jdGlvblR5cGUobmV3IGcuQ3VzdG9tVHlwZSgibGlzdCIsW0RdKSxWKS5zaW1wbGlmeSgpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0sIn4iOltZKG5ldyBnLkZ1bmN0aW9uVHlwZShyLHIpKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEVdLGFiczpbWShuZXcgZy5GdW5jdGlvblR5cGUocixyKSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXSxwcmludDpbbmV3IGcuVHlwZVZhcmlhYmxlQmluZCgiJ2EiLG5ldyBnLkZ1bmN0aW9uVHlwZShJLG5ldyBnLlR1cGxlVHlwZShbXSkpKS5zaW1wbGlmeSgpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0scHJpbnRMbjpbbmV3IGcuVHlwZVZhcmlhYmxlQmluZCgiJ2EiLG5ldyBnLkZ1bmN0aW9uVHlwZShJLG5ldyBnLlR1cGxlVHlwZShbXSkpKS5zaW1wbGlmeSgpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0sIjo9IjpbbmV3IGcuVHlwZVZhcmlhYmxlQmluZCgiJ2EiLG5ldyBnLkZ1bmN0aW9uVHlwZShuZXcgZy5UdXBsZVR5cGUoW25ldyBnLkN1c3RvbVR5cGUoInJlZiIsW0ldKSxJXSksbmV3IGcuVHVwbGVUeXBlKFtdKSkpLnNpbXBsaWZ5KCksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXSxyZWY6W25ldyBnLlR5cGVWYXJpYWJsZUJpbmQoIidhIixuZXcgZy5GdW5jdGlvblR5cGUoSSxuZXcgZy5DdXN0b21UeXBlKCJyZWYiLFtJXSkpKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfQ09OU1RSVUNUT1JdLCIhIjpbbmV3IGcuVHlwZVZhcmlhYmxlQmluZCgiJ2EiLG5ldyBnLkZ1bmN0aW9uVHlwZShuZXcgZy5DdXN0b21UeXBlKCJyZWYiLFtJXSksSSkpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV19LHt9LHt9LHt9KSxuZXcgbS5EeW5hbWljQmFzaXMoe3VuaXQ6W10sYm9vbDpbInRydWUiLCJmYWxzZSJdLGludDpbXSx3b3JkOltdLHJlYWw6W10sc3RyaW5nOltdLGNoYXI6W10sbGlzdDpbIm5pbCIsIjo6Il0sYXJyYXk6W10sdmVjdG9yOltdLHJlZjpbInJlZiJdLGV4bjpbXX0se2RpdjpbbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCJkaXYiLGZ1bmN0aW9uKGMsdyl7aWYoYyBpbnN0YW5jZW9mIHMuUmVjb3JkVmFsdWUpe3ZhciBUPWMuZ2V0VmFsdWUoIjEiKSxOPWMuZ2V0VmFsdWUoIjIiKTtpZihUIGluc3RhbmNlb2Ygcy5JbnRlZ2VyJiZOIGluc3RhbmNlb2Ygcy5JbnRlZ2VyKXJldHVybiBOLnZhbHVlPT09MD9bdi5jb25zdHJ1Y3QoKSwhMCxbXV06W1QuZGl2aWRlKE4pLCExLFtdXTtpZihUIGluc3RhbmNlb2Ygcy5Xb3JkJiZOIGluc3RhbmNlb2Ygcy5Xb3JkKXJldHVybiBOLnZhbHVlPT09MD9bdi5jb25zdHJ1Y3QoKSwhMCxbXV06W1QuZGl2aWRlKE4pLCExLFtdXX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ0NhbGxlZCAiZGl2IiBvbiB2YWx1ZSBvZiB0aGUgd3JvbmcgdHlwZSAoJytjLnR5cGVOYW1lKCkrIikuIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEVdLG1vZDpbbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCJtb2QiLGZ1bmN0aW9uKGMsdyl7aWYoYyBpbnN0YW5jZW9mIHMuUmVjb3JkVmFsdWUpe3ZhciBUPWMuZ2V0VmFsdWUoIjEiKSxOPWMuZ2V0VmFsdWUoIjIiKTtpZihUIGluc3RhbmNlb2Ygcy5JbnRlZ2VyJiZOIGluc3RhbmNlb2Ygcy5JbnRlZ2VyKXJldHVybiBOLnZhbHVlPT09MD9bdi5jb25zdHJ1Y3QoKSwhMCxbXV06W1QubW9kdWxvKE4pLCExLFtdXTtpZihUIGluc3RhbmNlb2Ygcy5Xb3JkJiZOIGluc3RhbmNlb2Ygcy5Xb3JkKXJldHVybiBOLnZhbHVlPT09MD9bdi5jb25zdHJ1Y3QoKSwhMCxbXV06W1QubW9kdWxvKE4pLCExLFtdXX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ0NhbGxlZCAibW9kIiBvbiB2YWx1ZSBvZiB0aGUgd3JvbmcgdHlwZSAoJytjLnR5cGVOYW1lKCkrIikuIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEVdLCIqIjpbbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCIqIixmdW5jdGlvbihjLHcpe2lmKGMgaW5zdGFuY2VvZiBzLlJlY29yZFZhbHVlKXt2YXIgVCxOPWMuZ2V0VmFsdWUoIjEiKSwkPWMuZ2V0VmFsdWUoIjIiKTtpZihOIGluc3RhbmNlb2Ygcy5JbnRlZ2VyJiYkIGluc3RhbmNlb2Ygcy5JbnRlZ2VyKXJldHVybihUPU4ubXVsdGlwbHkoJCkpLmhhc092ZXJmbG93KCk/W0MuY29uc3RydWN0KCksITAsW11dOltULCExLFtdXTtpZihOIGluc3RhbmNlb2Ygcy5Xb3JkJiYkIGluc3RhbmNlb2Ygcy5Xb3JkKXJldHVybihUPU4ubXVsdGlwbHkoJCkpLmhhc092ZXJmbG93KCk/W0MuY29uc3RydWN0KCksITAsW11dOltULCExLFtdXTtpZihOIGluc3RhbmNlb2Ygcy5SZWFsJiYkIGluc3RhbmNlb2Ygcy5SZWFsKXJldHVybihUPU4ubXVsdGlwbHkoJCkpLmhhc092ZXJmbG93KCk/W0MuY29uc3RydWN0KCksITAsW11dOltULCExLFtdXX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ0NhbGxlZCAiKiIgb24gdmFsdWUgb2YgdGhlIHdyb25nIHR5cGUgKCcrYy50eXBlTmFtZSgpKyIpLiIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXSwiLyI6W25ldyBzLlByZWRlZmluZWRGdW5jdGlvbigiLyIsZnVuY3Rpb24oYyx3KXtpZihjIGluc3RhbmNlb2Ygcy5SZWNvcmRWYWx1ZSl7dmFyIFQ9Yy5nZXRWYWx1ZSgiMSIpLE49Yy5nZXRWYWx1ZSgiMiIpO2lmKFQgaW5zdGFuY2VvZiBzLlJlYWwmJk4gaW5zdGFuY2VvZiBzLlJlYWwpcmV0dXJuIE4udmFsdWU9PT0wP1t2LmNvbnN0cnVjdCgpLCEwLFtdXTpbVC5kaXZpZGUoTiksITEsW11dfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignQ2FsbGVkICIvIiBvbiB2YWx1ZSBvZiB0aGUgd3JvbmcgdHlwZSAoJytjLnR5cGVOYW1lKCkrIikuIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEVdLCIrIjpbbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCIrIixmdW5jdGlvbihjLHcpe2lmKGMgaW5zdGFuY2VvZiBzLlJlY29yZFZhbHVlKXt2YXIgVCxOPWMuZ2V0VmFsdWUoIjEiKSwkPWMuZ2V0VmFsdWUoIjIiKTtpZihOIGluc3RhbmNlb2Ygcy5JbnRlZ2VyJiYkIGluc3RhbmNlb2Ygcy5JbnRlZ2VyKXJldHVybihUPU4uYWRkKCQpKS5oYXNPdmVyZmxvdygpP1tDLmNvbnN0cnVjdCgpLCEwLFtdXTpbVCwhMSxbXV07aWYoTiBpbnN0YW5jZW9mIHMuV29yZCYmJCBpbnN0YW5jZW9mIHMuV29yZClyZXR1cm4oVD1OLmFkZCgkKSkuaGFzT3ZlcmZsb3coKT9bQy5jb25zdHJ1Y3QoKSwhMCxbXV06W1QsITEsW11dO2lmKE4gaW5zdGFuY2VvZiBzLlJlYWwmJiQgaW5zdGFuY2VvZiBzLlJlYWwpcmV0dXJuKFQ9Ti5hZGQoJCkpLmhhc092ZXJmbG93KCk/W0MuY29uc3RydWN0KCksITAsW11dOltULCExLFtdXX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ0NhbGxlZCAiKyIgb24gdmFsdWUgb2YgdGhlIHdyb25nIHR5cGUgKCcrYy50eXBlTmFtZSgpKyIpLiIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXSwiLSI6W25ldyBzLlByZWRlZmluZWRGdW5jdGlvbigiLSIsZnVuY3Rpb24oYyx3KXtpZihjIGluc3RhbmNlb2Ygcy5SZWNvcmRWYWx1ZSl7dmFyIFQsTj1jLmdldFZhbHVlKCIxIiksJD1jLmdldFZhbHVlKCIyIik7aWYoTiBpbnN0YW5jZW9mIHMuSW50ZWdlciYmJCBpbnN0YW5jZW9mIHMuSW50ZWdlcilyZXR1cm4oVD1OLmFkZCgkLm5lZ2F0ZSgpKSkuaGFzT3ZlcmZsb3coKT9bQy5jb25zdHJ1Y3QoKSwhMCxbXV06W1QsITEsW11dO2lmKE4gaW5zdGFuY2VvZiBzLldvcmQmJiQgaW5zdGFuY2VvZiBzLldvcmQpcmV0dXJuKFQ9Ti5hZGQoJC5uZWdhdGUoKSkpLmhhc092ZXJmbG93KCk/W0MuY29uc3RydWN0KCksITAsW11dOltULCExLFtdXTtpZihOIGluc3RhbmNlb2Ygcy5SZWFsJiYkIGluc3RhbmNlb2Ygcy5SZWFsKXJldHVybihUPU4uYWRkKCQubmVnYXRlKCkpKS5oYXNPdmVyZmxvdygpP1tDLmNvbnN0cnVjdCgpLCEwLFtdXTpbVCwhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCdDYWxsZWQgIi0iIG9uIHZhbHVlIG9mIHRoZSB3cm9uZyB0eXBlICgnK2MudHlwZU5hbWUoKSsiKS4iKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0sIjwiOltuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oIjwiLGZ1bmN0aW9uKGMsdyl7aWYoYyBpbnN0YW5jZW9mIHMuUmVjb3JkVmFsdWUpe3ZhciBUPWMuZ2V0VmFsdWUoIjEiKSxOPWMuZ2V0VmFsdWUoIjIiKTtpZihUIGluc3RhbmNlb2Ygcy5JbnRlZ2VyJiZOIGluc3RhbmNlb2Ygcy5JbnRlZ2VyKXJldHVybltuZXcgcy5Cb29sVmFsdWUoVC5jb21wYXJlVG8oTik8MCksITEsW11dO2lmKFQgaW5zdGFuY2VvZiBzLldvcmQmJk4gaW5zdGFuY2VvZiBzLldvcmQpcmV0dXJuW25ldyBzLkJvb2xWYWx1ZShULmNvbXBhcmVUbyhOKTwwKSwhMSxbXV07aWYoVCBpbnN0YW5jZW9mIHMuUmVhbCYmTiBpbnN0YW5jZW9mIHMuUmVhbClyZXR1cm5bbmV3IHMuQm9vbFZhbHVlKFQuY29tcGFyZVRvKE4pPDApLCExLFtdXTtpZihUIGluc3RhbmNlb2Ygcy5TdHJpbmdWYWx1ZSYmTiBpbnN0YW5jZW9mIHMuU3RyaW5nVmFsdWUpcmV0dXJuW25ldyBzLkJvb2xWYWx1ZShULmNvbXBhcmVUbyhOKTwwKSwhMSxbXV07aWYoVCBpbnN0YW5jZW9mIHMuQ2hhclZhbHVlJiZOIGluc3RhbmNlb2Ygcy5DaGFyVmFsdWUpcmV0dXJuW25ldyBzLkJvb2xWYWx1ZShULmNvbXBhcmVUbyhOKTwwKSwhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCdDYWxsZWQgIjwiIG9uIHZhbHVlIG9mIHRoZSB3cm9uZyB0eXBlICgnK2MudHlwZU5hbWUoKSsiKS4iKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0sIj4iOltuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oIjwiLGZ1bmN0aW9uKGMsdyl7aWYoYyBpbnN0YW5jZW9mIHMuUmVjb3JkVmFsdWUpe3ZhciBUPWMuZ2V0VmFsdWUoIjEiKSxOPWMuZ2V0VmFsdWUoIjIiKTtpZihUIGluc3RhbmNlb2Ygcy5JbnRlZ2VyJiZOIGluc3RhbmNlb2Ygcy5JbnRlZ2VyKXJldHVybltuZXcgcy5Cb29sVmFsdWUoVC5jb21wYXJlVG8oTik+MCksITEsW11dO2lmKFQgaW5zdGFuY2VvZiBzLldvcmQmJk4gaW5zdGFuY2VvZiBzLldvcmQpcmV0dXJuW25ldyBzLkJvb2xWYWx1ZShULmNvbXBhcmVUbyhOKT4wKSwhMSxbXV07aWYoVCBpbnN0YW5jZW9mIHMuUmVhbCYmTiBpbnN0YW5jZW9mIHMuUmVhbClyZXR1cm5bbmV3IHMuQm9vbFZhbHVlKFQuY29tcGFyZVRvKE4pPjApLCExLFtdXTtpZihUIGluc3RhbmNlb2Ygcy5TdHJpbmdWYWx1ZSYmTiBpbnN0YW5jZW9mIHMuU3RyaW5nVmFsdWUpcmV0dXJuW25ldyBzLkJvb2xWYWx1ZShULmNvbXBhcmVUbyhOKT4wKSwhMSxbXV07aWYoVCBpbnN0YW5jZW9mIHMuQ2hhclZhbHVlJiZOIGluc3RhbmNlb2Ygcy5DaGFyVmFsdWUpcmV0dXJuW25ldyBzLkJvb2xWYWx1ZShULmNvbXBhcmVUbyhOKT4wKSwhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCdDYWxsZWQgIj4iIG9uIHZhbHVlIG9mIHRoZSB3cm9uZyB0eXBlICgnK2MudHlwZU5hbWUoKSsiKS4iKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0sIjw9IjpbbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCI8IixmdW5jdGlvbihjLHcpe2lmKGMgaW5zdGFuY2VvZiBzLlJlY29yZFZhbHVlKXt2YXIgVD1jLmdldFZhbHVlKCIxIiksTj1jLmdldFZhbHVlKCIyIik7aWYoVCBpbnN0YW5jZW9mIHMuSW50ZWdlciYmTiBpbnN0YW5jZW9mIHMuSW50ZWdlcilyZXR1cm5bbmV3IHMuQm9vbFZhbHVlKFQuY29tcGFyZVRvKE4pPD0wKSwhMSxbXV07aWYoVCBpbnN0YW5jZW9mIHMuV29yZCYmTiBpbnN0YW5jZW9mIHMuV29yZClyZXR1cm5bbmV3IHMuQm9vbFZhbHVlKFQuY29tcGFyZVRvKE4pPD0wKSwhMSxbXV07aWYoVCBpbnN0YW5jZW9mIHMuUmVhbCYmTiBpbnN0YW5jZW9mIHMuUmVhbClyZXR1cm5bbmV3IHMuQm9vbFZhbHVlKFQuY29tcGFyZVRvKE4pPD0wKSwhMSxbXV07aWYoVCBpbnN0YW5jZW9mIHMuU3RyaW5nVmFsdWUmJk4gaW5zdGFuY2VvZiBzLlN0cmluZ1ZhbHVlKXJldHVybltuZXcgcy5Cb29sVmFsdWUoVC5jb21wYXJlVG8oTik8PTApLCExLFtdXTtpZihUIGluc3RhbmNlb2Ygcy5DaGFyVmFsdWUmJk4gaW5zdGFuY2VvZiBzLkNoYXJWYWx1ZSlyZXR1cm5bbmV3IHMuQm9vbFZhbHVlKFQuY29tcGFyZVRvKE4pPD0wKSwhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCdDYWxsZWQgIjw9IiBvbiB2YWx1ZSBvZiB0aGUgd3JvbmcgdHlwZSAoJytjLnR5cGVOYW1lKCkrIikuIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEVdLCI+PSI6W25ldyBzLlByZWRlZmluZWRGdW5jdGlvbigiPCIsZnVuY3Rpb24oYyx3KXtpZihjIGluc3RhbmNlb2Ygcy5SZWNvcmRWYWx1ZSl7dmFyIFQ9Yy5nZXRWYWx1ZSgiMSIpLE49Yy5nZXRWYWx1ZSgiMiIpO2lmKFQgaW5zdGFuY2VvZiBzLkludGVnZXImJk4gaW5zdGFuY2VvZiBzLkludGVnZXIpcmV0dXJuW25ldyBzLkJvb2xWYWx1ZShULmNvbXBhcmVUbyhOKT49MCksITEsW11dO2lmKFQgaW5zdGFuY2VvZiBzLldvcmQmJk4gaW5zdGFuY2VvZiBzLldvcmQpcmV0dXJuW25ldyBzLkJvb2xWYWx1ZShULmNvbXBhcmVUbyhOKT49MCksITEsW11dO2lmKFQgaW5zdGFuY2VvZiBzLlJlYWwmJk4gaW5zdGFuY2VvZiBzLlJlYWwpcmV0dXJuW25ldyBzLkJvb2xWYWx1ZShULmNvbXBhcmVUbyhOKT49MCksITEsW11dO2lmKFQgaW5zdGFuY2VvZiBzLlN0cmluZ1ZhbHVlJiZOIGluc3RhbmNlb2Ygcy5TdHJpbmdWYWx1ZSlyZXR1cm5bbmV3IHMuQm9vbFZhbHVlKFQuY29tcGFyZVRvKE4pPj0wKSwhMSxbXV07aWYoVCBpbnN0YW5jZW9mIHMuQ2hhclZhbHVlJiZOIGluc3RhbmNlb2Ygcy5DaGFyVmFsdWUpcmV0dXJuW25ldyBzLkJvb2xWYWx1ZShULmNvbXBhcmVUbyhOKT49MCksITEsW11dfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignQ2FsbGVkICI+PSIgb24gdmFsdWUgb2YgdGhlIHdyb25nIHR5cGUgKCcrYy50eXBlTmFtZSgpKyIpLiIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXSwiPSI6W25ldyBzLlByZWRlZmluZWRGdW5jdGlvbigiPSIsZnVuY3Rpb24oYyx3KXtpZihjIGluc3RhbmNlb2Ygcy5SZWNvcmRWYWx1ZSl7dmFyIFQ9Yy5nZXRWYWx1ZSgiMSIpLE49Yy5nZXRWYWx1ZSgiMiIpO3JldHVybltuZXcgcy5Cb29sVmFsdWUoVC5lcXVhbHMoTikpLCExLFtdXX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ0NhbGxlZCAiPSIgb24gdmFsdWUgb2YgdGhlIHdyb25nIHR5cGUgKCcrYy50eXBlTmFtZSgpKyIpLiIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXSwiPD4iOltuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oIj0iLGZ1bmN0aW9uKGMsdyl7aWYoYyBpbnN0YW5jZW9mIHMuUmVjb3JkVmFsdWUpe3ZhciBUPWMuZ2V0VmFsdWUoIjEiKSxOPWMuZ2V0VmFsdWUoIjIiKTtyZXR1cm5bbmV3IHMuQm9vbFZhbHVlKCFULmVxdWFscyhOKSksITEsW11dfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignQ2FsbGVkICI8PiIgb24gdmFsdWUgb2YgdGhlIHdyb25nIHR5cGUgKCcrYy50eXBlTmFtZSgpKyIpLiIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXSx0cnVlOltuZXcgcy5Cb29sVmFsdWUoITApLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9DT05TVFJVQ1RPUl0sZmFsc2U6W25ldyBzLkJvb2xWYWx1ZSghMSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX0NPTlNUUlVDVE9SXSxuaWw6W25ldyBzLlZhbHVlQ29uc3RydWN0b3IoIm5pbCIpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9DT05TVFJVQ1RPUl0sIjo6IjpbbmV3IHMuVmFsdWVDb25zdHJ1Y3RvcigiOjoiLDEpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9DT05TVFJVQ1RPUl0sTWF0Y2g6W3ksbS5JZGVudGlmaWVyU3RhdHVzLkVYQ0VQVElPTl9DT05TVFJVQ1RPUl0sQmluZDpbZCxtLklkZW50aWZpZXJTdGF0dXMuRVhDRVBUSU9OX0NPTlNUUlVDVE9SXSxEaXY6W3YsbS5JZGVudGlmaWVyU3RhdHVzLkVYQ0VQVElPTl9DT05TVFJVQ1RPUl0sT3ZlcmZsb3c6W0MsbS5JZGVudGlmaWVyU3RhdHVzLkVYQ0VQVElPTl9DT05TVFJVQ1RPUl0sIl4iOltuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oIl4iLGZ1bmN0aW9uKGMsdyl7aWYoYyBpbnN0YW5jZW9mIHMuUmVjb3JkVmFsdWUpe3ZhciBUPWMuZ2V0VmFsdWUoIjEiKSxOPWMuZ2V0VmFsdWUoIjIiKTtpZihUIGluc3RhbmNlb2Ygcy5TdHJpbmdWYWx1ZSYmTiBpbnN0YW5jZW9mIHMuU3RyaW5nVmFsdWUpcmV0dXJuW1QuY29uY2F0KE4pLCExLFtdXX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ0NhbGxlZCAiXiIgb24gdmFsdWUgb2YgdGhlIHdyb25nIHR5cGUgKCcrYy50eXBlTmFtZSgpKyIpLiIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXSxleHBsb2RlOltuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oImV4cGxvZGUiLGZ1bmN0aW9uKGMsdyl7aWYoYyBpbnN0YW5jZW9mIHMuU3RyaW5nVmFsdWUpcmV0dXJuW2MuZXhwbG9kZSgpLCExLFtdXTt0aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ0NhbGxlZCAiZXhwbG9kZSIgb24gdmFsdWUgb2YgdGhlIHdyb25nIHR5cGUgKCcrYy50eXBlTmFtZSgpKyIpLiIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXSxpbXBsb2RlOltuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oImltcGxvZGUiLGZ1bmN0aW9uKGMsdyl7aWYoYyBpbnN0YW5jZW9mIHMuQ29uc3RydWN0ZWRWYWx1ZSlyZXR1cm5bcy5TdHJpbmdWYWx1ZS5pbXBsb2RlKGMpLCExLFtdXTt0aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ0NhbGxlZCAiaW1wbG9kZSIgb24gdmFsdWUgb2YgdGhlIHdyb25nIHR5cGUgKCcrYy50eXBlTmFtZSgpKyIpLiIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXSwifiI6W25ldyBzLlByZWRlZmluZWRGdW5jdGlvbigifiIsZnVuY3Rpb24oYyx3KXt2YXIgVDtpZihjIGluc3RhbmNlb2Ygcy5JbnRlZ2VyKXJldHVybihUPWMubmVnYXRlKCkpLmhhc092ZXJmbG93KCk/W0MuY29uc3RydWN0KCksITAsW11dOltULCExLFtdXTtpZihjIGluc3RhbmNlb2Ygcy5SZWFsKXJldHVybihUPWMubmVnYXRlKCkpLmhhc092ZXJmbG93KCk/W0MuY29uc3RydWN0KCksITAsW11dOltULCExLFtdXTt0aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ0NhbGxlZCAifiIgb24gc29tZXRoaW5nIHdlaXJkLicpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXSxhYnM6W25ldyBzLlByZWRlZmluZWRGdW5jdGlvbigifiIsZnVuY3Rpb24oYyx3KXt2YXIgVDtpZihjIGluc3RhbmNlb2Ygcy5JbnRlZ2VyKXJldHVybiBjLnZhbHVlPj0wP1tjLCExLFtdXTooVD1jLm5lZ2F0ZSgpKS5oYXNPdmVyZmxvdygpP1tDLmNvbnN0cnVjdCgpLCEwLFtdXTpbVCwhMSxbXV07aWYoYyBpbnN0YW5jZW9mIHMuUmVhbClyZXR1cm4gYy52YWx1ZT49MD9bYywhMSxbXV06KFQ9Yy5uZWdhdGUoKSkuaGFzT3ZlcmZsb3coKT9bQy5jb25zdHJ1Y3QoKSwhMCxbXV06W1QsITEsW11dO3Rocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignQ2FsbGVkICJ+IiBvbiBzb21ldGhpbmcgd2VpcmQuJyl9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEVdLHByaW50OltuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oInByaW50IixmdW5jdGlvbihjLHcpe3ZhciBUPVtdO3JldHVybiBjIGluc3RhbmNlb2Ygcy5TdHJpbmdWYWx1ZT9ULnB1c2gobmV3IHEuV2FybmluZygtMixjLnZhbHVlKSk6VC5wdXNoKG5ldyBxLldhcm5pbmcoLTIsYy50b1N0cmluZyh2b2lkIDAsMWUxOCkpKSxbbmV3IHMuUmVjb3JkVmFsdWUsITEsVF19KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEVdLHByaW50TG46W25ldyBzLlByZWRlZmluZWRGdW5jdGlvbigicHJpbnRMbiIsZnVuY3Rpb24oYyx3KXt2YXIgVD1bXTtyZXR1cm4gYyBpbnN0YW5jZW9mIHMuU3RyaW5nVmFsdWU/VC5wdXNoKG5ldyBxLldhcm5pbmcoLTIsYy52YWx1ZStgCmApKTpULnB1c2gobmV3IHEuV2FybmluZygtMixjLnRvU3RyaW5nKHZvaWQgMCwxZTE4KStgCmApKSxbbmV3IHMuUmVjb3JkVmFsdWUsITEsVF19KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEVdLCI6PSI6W25ldyBzLlByZWRlZmluZWRGdW5jdGlvbigiOj0iLGZ1bmN0aW9uKGMsdyl7aWYoYyBpbnN0YW5jZW9mIHMuUmVjb3JkVmFsdWUpe3ZhciBUPWMuZ2V0VmFsdWUoIjEiKSxOPWMuZ2V0VmFsdWUoIjIiKTtpZihUIGluc3RhbmNlb2Ygcy5SZWZlcmVuY2VWYWx1ZSlyZXR1cm4gdy5tb2RpZmlhYmxlLnNldENlbGwoVC5hZGRyZXNzLE4pLFtuZXcgcy5SZWNvcmRWYWx1ZSwhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCdDYWxsZWQgIjo9IiBvbiB2YWx1ZSBvZiB0aGUgd3JvbmcgdHlwZSAoJytjLnR5cGVOYW1lKCkrIikuIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEVdLHJlZjpbbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCJyZWYiLGZ1bmN0aW9uKGMsdyl7cmV0dXJuW3cubW9kaWZpYWJsZS5zZXROZXdDZWxsKGMpLCExLFtdXX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRV0sIiEiOltuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oIiEiLGZ1bmN0aW9uKGMsdyl7aWYoYyBpbnN0YW5jZW9mIHMuUmVmZXJlbmNlVmFsdWUpe3ZhciBUPXcubW9kaWZpYWJsZS5nZXRDZWxsKGMuYWRkcmVzcyk7aWYoVD09PXZvaWQgMCl0aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIk5la28tc2VtcGFpLCBJIHRoaW5rIHRoYXQgSSBjcmFzaGVkLiBXaGF0IHNoYWxsIEkgZG8gbm93PyIpO3JldHVybltULCExLFtdXX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ0NhbGxlZCAiISIgb24gdmFsdWUgb2YgdGhlIHdyb25nIHR5cGUgKCcrYy50eXBlTmFtZSgpKyIpLiIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFXX0se30se30se30pLFswLHt9XSw0LFswLG5ldyBNYXBdLHtkaXY6bmV3IG0uSW5maXhTdGF0dXMoITAsNywhMSksbW9kOm5ldyBtLkluZml4U3RhdHVzKCEwLDcsITEpLCIqIjpuZXcgbS5JbmZpeFN0YXR1cyghMCw3LCExKSwiLyI6bmV3IG0uSW5maXhTdGF0dXMoITAsNywhMSksIisiOm5ldyBtLkluZml4U3RhdHVzKCEwLDYsITEpLCItIjpuZXcgbS5JbmZpeFN0YXR1cyghMCw2LCExKSwiPCI6bmV3IG0uSW5maXhTdGF0dXMoITAsNCwhMSksIj4iOm5ldyBtLkluZml4U3RhdHVzKCEwLDQsITEpLCI8PSI6bmV3IG0uSW5maXhTdGF0dXMoITAsNCwhMSksIj49IjpuZXcgbS5JbmZpeFN0YXR1cyghMCw0LCExKSwiOjoiOm5ldyBtLkluZml4U3RhdHVzKCEwLDUsITApLCI9IjpuZXcgbS5JbmZpeFN0YXR1cyghMCw0LCExKSwiPD4iOm5ldyBtLkluZml4U3RhdHVzKCEwLDQsITEpLCI6PSI6bmV3IG0uSW5maXhTdGF0dXMoITAsMywhMSksIl4iOm5ldyBtLkluZml4U3RhdHVzKCEwLDYsITEpfSx7TWF0Y2g6MSxCaW5kOjEsRGl2OjEsT3ZlcmZsb3c6MSxpbnQ6MSxyZWFsOjEsc3RyaW5nOjEsY2hhcjoxLHVuaXQ6MSx3b3JkOjEsbGlzdDoxLGJvb2w6MX0pO3UuZ2V0SW5pdGlhbFN0YXRlPWZ1bmN0aW9uKGMpe2M9PT12b2lkIDAmJihjPXt9KTt2YXIgdz1wLmdldE5lc3RlZFN0YXRlKCk7cmV0dXJuIGMucmVhbEVxdWFsaXR5PT09ITAmJncuc2V0U3RhdGljVHlwZSgicmVhbCIsQixbXSwwLCEwKSx3fX0sNDAzOihmZSx1LEspPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHUsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHUubGV4PXUubGV4U3RyZWFtPXUubmV4dFRva2VuPXUubGV4TG9uZ0lkZW50aWZpZXJPcktleXdvcmQ9dS5sZXhJZGVudGlmaWVyT3JLZXl3b3JkPXUubGV4Q2hhcmFjdGVyPXUubGV4U3RyaW5nPXUubGV4TnVtYmVyPXUubGV4Q29tbWVudD11LmlzTnVtYmVyPXUuaXNXaGl0ZXNwYWNlPXUuaXNTeW1ib2xpYz11LmlzQWxwaGFudW1lcmljPXUucmVzb2x2ZVVuaWNvZGVUeXBlVmFyaWFibGU9dS5yZXNvbHZlVW5pY29kZUtleXdvcmQ9dm9pZCAwO3ZhciBtPUsoNzU4KSxnPUsoNTM0KSxzPUsoMTA2KSxxPW5ldyBTZXQoWyJhYnN0eXBlIiwiYW5kIiwiYW5kYWxzbyIsImFzIiwiY2FzZSIsImRhdGF0eXBlIiwiZG8iLCJlbHNlIiwiZW5kIiwiZXhjZXB0aW9uIiwiZm4iLCJmdW4iLCJoYW5kbGUiLCJpZiIsImluIiwiaW5maXgiLCJpbmZpeHIiLCJsZXQiLCJsb2NhbCIsIm5vbmZpeCIsIm9mIiwib3AiLCJvcGVuIiwib3JlbHNlIiwicmFpc2UiLCJyZWMiLCJ0aGVuIiwidHlwZSIsInZhbCIsIndpdGgiLCJ3aXRodHlwZSIsIndoaWxlIiwiKCIsIikiLCJbIiwiXSIsInsiLCJ9IiwiLCIsIjoiLCI7IiwiLi4uIiwiXyIsInwiLCI9IiwiPT4iLCItPiIsIiMiLCJlcXR5cGUiLCJmdW5jdG9yIiwic2lnbmF0dXJlIiwic3RydWN0IiwiaW5jbHVkZSIsInNoYXJpbmciLCJzdHJ1Y3R1cmUiLCJ3aGVyZSIsInNpZyIsIjo+Il0pLEI9bmV3IFNldChbIiEiLCIlIiwiJiIsIiQiLCIjIiwiKyIsIi0iLCIvIiwiOiIsIjwiLCI9IiwiPiIsIj8iLCJAIiwiXFwiLCJ+IiwiYCIsIl4iLCJ8IiwiKiJdKSxNPW5ldyBNYXAoW1siXHUyMTkyIiwiLT4iXSxbIlx1MDM5QiIsImZuIl1dKSxWPW5ldyBNYXAoW1siXHUwM0IxIiwiJ2EiXSxbIlx1MDNCMiIsIidiIl0sWyJcdTAzQjMiLCInYyJdLFsiXHUwM0I0IiwiJ2QiXSxbIlx1MDNCNSIsIidlIl0sWyJcdTAzQjYiLCInZiJdLFsiXHUwM0I3IiwiJ2ciXSxbIlx1MDNCOCIsIidoIl0sWyJcdTAzQjkiLCInaSJdLFsiXHUwM0JBIiwiJ2siXSxbIlx1MDNCQiIsIidsIl0sWyJcdTAzQkMiLCInbSJdLFsiXHUwM0JEIiwiJ24iXSxbIlx1MDNCRSIsIidqIl0sWyJcdTAzQkYiLCInbyJdLFsiXHUwM0MwIiwiJ3AiXSxbIlx1MDNDMSIsIidyIl0sWyJcdTAzQzMiLCIncyJdLFsiXHUwM0M0IiwiJ3QiXSxbIlx1MDNDNSIsIid1Il0sWyJcdTAzQzYiLCIndiJdLFsiXHUwM0M3IiwiJ3giXSxbIlx1MDNDOCIsIidxIl0sWyJcdTAzQzkiLCIndyJdXSk7ZnVuY3Rpb24gRChwKXtyZXR1cm4gcCE9PXZvaWQgMCYmTS5oYXMocCk/TS5nZXQocCk6cH1mdW5jdGlvbiBoKHApe3JldHVybiBwIT09dm9pZCAwJiZWLmhhcyhwKT9WLmdldChwKTpwfWZ1bmN0aW9uIEEocCxjKXtpZihjPT09dm9pZCAwJiYoYz17fSkscD09PXZvaWQgMClyZXR1cm4hMTtpZihwPj0iYSImJnA8PSJ6Inx8cD49IkEiJiZwPD0iWiJ8fHA+PSIwIiYmcDw9IjkifHxwPT09IicifHxwPT09Il8iKXJldHVybiEwO2lmKGMuYWxsb3dVbmljb2RlPT09ITApe2lmKEIuaGFzKHApfHxxLmhhcyhwKXx8cD09PSIuIilyZXR1cm4hMTtpZihjLmFsbG93VW5pY29kZVR5cGVWYXJpYWJsZXMhPT0hMHx8aChwKT09PXApcmV0dXJuL15bXFNdJC91LnRlc3QocCl9cmV0dXJuITF9ZnVuY3Rpb24gSShwLGMpe3JldHVybiBwIT09dm9pZCAwJiZCLmhhcyhwKX1mdW5jdGlvbiBPKHAsYyl7cmV0dXJuIHAhPT12b2lkIDAmJihwPT09IiAifHxwPT09IgkifHxwPT09YApgfHxwPT09IlxmIil9ZnVuY3Rpb24gRShwLGMsdyl7cmV0dXJuIHAhPT12b2lkIDAmJihwPj0iMCImJnA8PSI5Inx8YyYmKHA+PSJhIiYmcDw9ImYifHxwPj0iQSImJnA8PSJGIikpfWZ1bmN0aW9uIHIocCl7Zm9yKHZhciBjPSIiO08ocC5wZWVrKCkpOyljKz1wLm5leHQoKTtyZXR1cm4gY31mdW5jdGlvbiBlKHAsYyl7dmFyIHc9IiI7aWYocC5wZWVrKCk9PT0iKCImJnAucGVlaygxKT09PSIqIil7dys9cC5uZXh0KCkrcC5uZXh0KCk7Zm9yKHZhciBUPTE7VD4wOyl7dmFyIE49IiIrcC5wZWVrKCkrcC5wZWVrKDEpO2lmKHAucGVlaygpPT09dm9pZCAwfHxwLnBlZWsoMSk9PT12b2lkIDApdGhyb3cgbmV3IG0uSW5jb21wbGV0ZUVycm9yKCJBbmQgaXQncyBqdXN0IG5vdCBlbm91Z2guIik7Tj09PSIoKiI/KCsrVCx3Kz1wLm5leHQoKSk6Tj09PSIqKSImJigtLVQsdys9cC5uZXh0KCkpLHcrPXAubmV4dCgpfXJldHVybiBuZXcgZy5Db21tZW50VG9rZW4odyl9dGhyb3cgbmV3IG0uSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJUaGF0IHdhcyBhIGJhZCBjb21tZW50Li4uIil9ZnVuY3Rpb24gbyhwLGMsdyl7dz09PXZvaWQgMCYmKHc9LTEpO2Zvcih2YXIgVD0iIjtFKHAucGVlaygpLGMpJiZULmxlbmd0aCE9PXc7KVQrPXAubmV4dCgpO3JldHVybiBUfWZ1bmN0aW9uIHkocCxjLHcsVCxOKXtpZih3PT09dm9pZCAwJiYodz0hMSksVD09PXZvaWQgMCYmKFQ9ITEpLE49PT12b2lkIDAmJihOPSExKSx3JiZUKXRocm93IG5ldyBtLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiVGhlcmUgaXMgbm8gc3VjaCB0aGluZyBhcyBhIHJlYWwgd29yZC4iKTtpZih3KXJldHVybiBuZXcgZy5SZWFsQ29uc3RhbnRUb2tlbihwLHBhcnNlRmxvYXQoYykpO3ZhciAkPXBhcnNlSW50KGMsTj8xNjoxMCk7aWYoJD5zLk1BWElOVCl0aHJvdyBuZXcgbS5MZXhlckVycm9yKCciJyskK2AiLCB3aG9hLCBpdCdzIG92ZXIgImArcy5NQVhJTlQrJyIuJyk7aWYoJDxzLk1JTklOVCl0aHJvdyBuZXcgbS5MZXhlckVycm9yKCciJyskK2AiLCB3aG9hLCBpdCdzIHVuZGVyICJgK3MuTUlOSU5UKyciLicpO2lmKFQpcmV0dXJuIG5ldyBnLldvcmRDb25zdGFudFRva2VuKHAsJCk7dmFyIEg9cC5jaGFyQXQoMCk7cmV0dXJuIEUoSCwhMSkmJkghPT0iMCI/bmV3IGcuTnVtZXJpY1Rva2VuKHAsJCk6bmV3IGcuSW50ZWdlckNvbnN0YW50VG9rZW4ocCwkKX1mdW5jdGlvbiBkKHAsYyl7dmFyIHc9IiIsVD0iIixOPSExLCQ9ITEsSD0hMSxQPSExO2lmKHAucGVlaygpPT09In4iJiYodys9cC5uZXh0KCksUD0hMCxUKz0iLSIpLHAucGVlaygpPT09IjAiJiYocC5wZWVrKDEpPT09IncifHxwLnBlZWsoMSk9PT0ieCIpKXt3Kz1wLm5leHQoKSxwLnBlZWsoKT09PSJ3IiYmKCQ9ITApLHAucGVlaygkPzE6MCk9PT0ieCImJihOPSEwKTt2YXIgeD0kJiZOPzI6MTtpZihQJiYkfHwhRShwLnBlZWsoeCksTikpcmV0dXJuIHkodyxUKz0iMCIsITEsITEsITEpO2Zvcih2YXIgUj0wO1I8eDsrK1Ipdys9cC5uZXh0KCl9dmFyIF89byhwLE4pO2lmKFQrPV8sdys9XyxOfHwkKXJldHVybiB5KHcsVCwhMSwkLE4pO2lmKHAucGVlaygpPT09Ii4iKXtpZighRShwLnBlZWsoMSksITEpKXJldHVybiB5KHcsVCk7dys9cC5wZWVrKCksVCs9cC5uZXh0KCksdys9Xz1vKHAsITEpLFQrPV8sSD0hMH1pZihwLnBlZWsoKT09PSJlInx8cC5wZWVrKCk9PT0iRSIpe2lmKEUocC5wZWVrKDEpLCExKSl3Kz1wLm5leHQoKSxUKz0iZSIsdys9Xz1vKHAsITEpLFQrPV87ZWxzZXtpZihwLnBlZWsoMSkhPT0ifiJ8fCFFKHAucGVlaygyKSwhMSkpcmV0dXJuIHkodyxULEgpO1QrPSJlLSIsdys9cC5uZXh0KCkrcC5uZXh0KCksdys9Xz1vKHAsITEpLFQrPV99SD0hMH1yZXR1cm4geSh3LFQsSCl9ZnVuY3Rpb24gdihwLGMpe2lmKHAubmV4dCgpIT09JyInKXRocm93IG5ldyBtLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiVGhhdCB3YXMgbm90IGEgc3RyaW5nLiIpO2Zvcih2YXIgdz0nIicsVD0iIjtwLnBlZWsoKSE9PSciJzspaWYocC5wZWVrKCk9PT0iXFwiKWlmKHcrPXAubmV4dCgpLE8ocC5wZWVrKCkpKXtpZih3Kz1yKHApLHAucGVlaygpIT09IlxcIil7dmFyIE49cC5uZXh0KCk7dGhyb3cgbmV3IG0uTGV4ZXJFcnJvcignRm91bmQgbm9uLXdoaXRlc3BhY2UgY2hhcmFjdGVyICInK04rJyIgaW4gd2hpdGVzcGFjZSBlc2NhcGUgc2VxdWVuY2UuJyl9dys9cC5uZXh0KCl9ZWxzZSBzd2l0Y2goUj1wLnBlZWsoKSl7Y2FzZSJhIjp3Kz1wLm5leHQoKSxUKz0iXHgwNyI7YnJlYWs7Y2FzZSJiIjp3Kz1wLm5leHQoKSxUKz0iXGIiO2JyZWFrO2Nhc2UidCI6dys9cC5uZXh0KCksVCs9IgkiO2JyZWFrO2Nhc2UibiI6dys9cC5uZXh0KCksVCs9YApgO2JyZWFrO2Nhc2UidiI6dys9cC5uZXh0KCksVCs9Ilx2IjticmVhaztjYXNlImYiOncrPXAubmV4dCgpLFQrPSJcZiI7YnJlYWs7Y2FzZSJyIjp3Kz1wLm5leHQoKSxUKz0iXHIiO2JyZWFrO2Nhc2UnIic6dys9cC5uZXh0KCksVCs9JyInO2JyZWFrO2Nhc2UiXFwiOncrPXAubmV4dCgpLFQrPSJcXCI7YnJlYWs7Y2FzZSJeIjp3Kz1wLm5leHQoKTt2YXIgJD0oeD1wLm5leHQoKSkuY2hhckNvZGVBdCgwKTtpZigkPDY0fHwkPjk1KXRocm93IG5ldyBtLkxleGVyRXJyb3IoJyInK1N0cmluZy5mcm9tQ2hhckNvZGUoJCkrJyIgZG9lcyBub3QgcmVwcmVzZW50IGEgdmFsaWQgY29udHJvbCBjaGFyYWN0ZXIuJyk7dys9eCxUKz1TdHJpbmcuZnJvbUNoYXJDb2RlKCQtNjQpO2JyZWFrO2Nhc2UidSI6aWYodys9cC5uZXh0KCksKFA9byhwLCEwLDQpKS5sZW5ndGghPT00KXRocm93IG5ldyBtLkxleGVyRXJyb3IoIkEgVW5pY29kZSBlc2NhcGUgc2VxdWVuY2UgbXVzdCBjb25zaXN0IG9mIGZvdXIgZGlnaXRzLiIpO3ZhciBIPXBhcnNlSW50KFAsMTYpO3crPVAsVCs9U3RyaW5nLmZyb21DaGFyQ29kZShIKTticmVhaztkZWZhdWx0OmlmKCFFKFIsITEpKXRocm93IFI9cC5uZXh0KCksbmV3IG0uTGV4ZXJFcnJvcignSW52YWxpZCBlc2NhcGUgc2VxdWVuY2UgIlxcJytSKyciLicpO3ZhciBQO2lmKChQPW8ocCwhMSwzKSkubGVuZ3RoIT09Myl0aHJvdyBuZXcgbS5MZXhlckVycm9yKCJBIG51bWVyaWMgZXNjYXBlIHNlcXVlbmNlIG11c3QgY29uc2lzdCBvZiB0aHJlZSBkaWdpdHMuIik7SD1wYXJzZUludChQLDEwKSx3Kz1QLFQrPVN0cmluZy5mcm9tQ2hhckNvZGUoSCl9ZWxzZXt2YXIgeCxSPSh4PXAubmV4dCgpKS5jaGFyQ29kZUF0KDApO2lmKHcrPXgsKFI8MzN8fFI+MTI2KSYmUiE9PTMyJiZSPDEyOCl7dmFyIF89IiI7dGhyb3cgUj09PTkmJihfPSIgKHRhYikiKSxSPT09MTAmJihfPSIgKG5ld2xpbmUpIiksUj09PTEzJiYoXz0iIChjYXJyaWFnZSByZXR1cm4pIiksbmV3IG0uTGV4ZXJFcnJvcignQSBzdHJpbmcgbWF5IG5vdCBjb250YWluIHRoZSBjaGFyYWN0ZXIgIicrUisnIicrXysiLiIpfVQrPVN0cmluZy5mcm9tQ2hhckNvZGUoUil9aWYocC5uZXh0KCkhPT0nIicpdGhyb3cgbmV3IG0uSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJUaGlzIHN0cmluZyB3aWxsIG5ldmVyIGVuZC4iKTtyZXR1cm4gbmV3IGcuU3RyaW5nQ29uc3RhbnRUb2tlbih3KyciJyxUKX1mdW5jdGlvbiBDKHAsYyl7aWYocC5uZXh0KCkhPT0iIyIpdGhyb3cgbmV3IG0uSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJUaGF0IHdhcyBub3QgYSBjaGFyYWN0ZXIuIik7dmFyIHc9dihwKTtpZih3LnZhbHVlLmxlbmd0aCE9PTEpdGhyb3cgbmV3IG0uTGV4ZXJFcnJvcignIicrdy52YWx1ZSsnIiBpcyBub3QgYSB2YWxpZCBjaGFyYWN0ZXIgY29uc3RhbnQsIGFzIGl0cyBsZW5ndGggJyt3LnZhbHVlLmxlbmd0aCsiIGlzIGxhcmdlciB0aGFuIHRoZSBleHBlY3RlZCBsZW5ndGggMS4iKTtyZXR1cm4gbmV3IGcuQ2hhcmFjdGVyQ29uc3RhbnRUb2tlbigiIyIrdy50ZXh0LHcudmFsdWUpfWZ1bmN0aW9uIEcocCxjKXtjPT09dm9pZCAwJiYoYz17fSk7dmFyIHcsVD0iIixOPXAucGVlaygpO2lmKGMuYWxsb3dVbmljb2RlVHlwZVZhcmlhYmxlcz09PSEwJiZoKE4pIT09TilyZXR1cm4gcC5uZXh0KCksbmV3IGcuVHlwZVZhcmlhYmxlVG9rZW4oaChOKSk7aWYoYy5hbGxvd1VuaWNvZGU9PT0hMCYmRChOKSE9PU4pcmV0dXJuIHAubmV4dCgpLG5ldyBnLktleXdvcmRUb2tlbihEKE4pKTtpZihJKE4pKXc9STtlbHNle2lmKCFBKE4sYyl8fEUoTiwhMSl8fE49PT0iXyIpe2lmKE4hPT12b2lkIDAmJnEuaGFzKE4pKXJldHVybiBuZXcgZy5LZXl3b3JkVG9rZW4ocC5uZXh0KCkpO2lmKE49PT0iLiImJnAucGVlaygxKT09PSIuIiYmcC5wZWVrKDIpPT09Ii4iKXJldHVybiBwLm5leHQoKSxwLm5leHQoKSxwLm5leHQoKSxuZXcgZy5LZXl3b3JkVG9rZW4oIi4uLiIpO3Rocm93IE49cC5uZXh0KCksbmV3IG0uTGV4ZXJFcnJvcignSW52YWxpZCB0b2tlbiAiJytOKyciIChcXHUnK04uY2hhckNvZGVBdCgwKS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKSsiKS4iKX13PUF9ZG8gVCs9cC5uZXh0KCk7d2hpbGUodyhwLnBlZWsoKSxjKSk7aWYoVD09PSIqIilyZXR1cm4gbmV3IGcuU3RhclRva2VuO2lmKFQ9PT0iPSIpcmV0dXJuIG5ldyBnLkVxdWFsc1Rva2VuO2lmKHEuaGFzKFQpKXJldHVybiBuZXcgZy5LZXl3b3JkVG9rZW4oVCk7aWYoTj09PSInIil7aWYoVC5jaGFyQXQoMSk9PT0iJyIpe2lmKFQubGVuZ3RoPT09Mil0aHJvdyBuZXcgbS5MZXhlckVycm9yKCdJbnZhbGlkIHR5cGUgdmFyaWFibGUgIicrVCsnIi4gRGVsZXRlIEhlci4nKTtyZXR1cm4gbmV3IGcuRXF1YWxpdHlUeXBlVmFyaWFibGVUb2tlbihUKX1pZihULmxlbmd0aD49MilyZXR1cm4gbmV3IGcuVHlwZVZhcmlhYmxlVG9rZW4oVCk7aWYoYy5hbGxvd1VuaWNvZGVUeXBlVmFyaWFibGVzPT09ITAmJmgocC5wZWVrKCkpIT09cC5wZWVrKCkpcmV0dXJuIG5ldyBnLkVxdWFsaXR5VHlwZVZhcmlhYmxlVG9rZW4oIiciK2gocC5uZXh0KCkpKTt0aHJvdyBuZXcgbS5MZXhlckVycm9yKGBUaGUgbm9pc2UsIGl0IHdvbid0IFNUT1A6IEludmFsaWQgdHlwZSB2YXJpYWJsZSAiYCtUKyciLicpfXJldHVybiBBKE4sYyk/bmV3IGcuQWxwaGFudW1lcmljSWRlbnRpZmllclRva2VuKFQpOm5ldyBnLklkZW50aWZpZXJUb2tlbihUKX1mdW5jdGlvbiBZKHAsYyl7Yz09PXZvaWQgMCYmKGM9e30pO3ZhciB3PUcocCxjKSxUPXcudGV4dDtpZihwLnBlZWsoKT09PSIuIiYmcC5wZWVrKDEpPT09Ii4iJiZwLnBlZWsoMik9PT0iLiJ8fHAucGVlaygpIT09Ii4iKXJldHVybiB3O3ZhciBOPVtdO2Rve2lmKCEodyBpbnN0YW5jZW9mIGcuQWxwaGFudW1lcmljSWRlbnRpZmllclRva2VuKSl0aHJvdyBuZXcgbS5MZXhlckVycm9yKCdFeHBlY3RlZCBhIHN0cnVjdHVyZSBuYW1lIGJlZm9yZSAiLiIgKGdvdCAiJyt3LnR5cGVOYW1lKCkrJyIuJyk7aWYocC5wZWVrKCk9PT0iLiImJnAucGVlaygxKT09PSIuIiYmcC5wZWVrKDIpPT09Ii4iKXJldHVybiBuZXcgZy5Mb25nSWRlbnRpZmllclRva2VuKFQsTix3KTtUKz1wLm5leHQoKSxOLnB1c2godyksVCs9KHc9RyhwLGMpKS50ZXh0fXdoaWxlKHAucGVlaygpPT09Ii4iKTtpZighKHcgaW5zdGFuY2VvZiBnLklkZW50aWZpZXJUb2tlbnx8dyBpbnN0YW5jZW9mIGcuU3RhclRva2VuKXx8dyBpbnN0YW5jZW9mIGcuVHlwZVZhcmlhYmxlVG9rZW4pdGhyb3cgbmV3IG0uTGV4ZXJFcnJvcignIicrdy50ZXh0KyciIGlzIG5vdCBhbGxvd2VkIGluIGEgbG9uZyBpZGVudGlmaWVyLicpO3JldHVybiBuZXcgZy5Mb25nSWRlbnRpZmllclRva2VuKFQsTix3KX1mdW5jdGlvbiBKKHAsYyl7aWYoYz09PXZvaWQgMCYmKGM9e30pLHIocCksIXAuZW9zKCkpcmV0dXJuIEUocC5wZWVrKCksITEpfHxwLnBlZWsoKT09PSJ+IiYmRShwLnBlZWsoMSksITEpP2QocCk6cC5wZWVrKCk9PT0nIic/dihwKTpwLnBlZWsoKT09PSIjIiYmcC5wZWVrKDEpPT09JyInP0MocCk6cC5wZWVrKCk9PT0iKCImJnAucGVlaygxKT09PSIqIj9lKHApOlkocCxjKX1mdW5jdGlvbiB6KHAsYyl7Yz09PXZvaWQgMCYmKGM9e30pO2Zvcih2YXIgdz1bXTshcC5lb3MoKTspe3ZhciBUPUoocCxjKTtpZihUPT09dm9pZCAwKWJyZWFrO2MuYWxsb3dDb21tZW50VG9rZW4hPT0hMCYmVCBpbnN0YW5jZW9mIGcuQ29tbWVudFRva2VufHx3LnB1c2goVCl9cmV0dXJuIHd9dS5yZXNvbHZlVW5pY29kZUtleXdvcmQ9RCx1LnJlc29sdmVVbmljb2RlVHlwZVZhcmlhYmxlPWgsdS5pc0FscGhhbnVtZXJpYz1BLHUuaXNTeW1ib2xpYz1JLHUuaXNXaGl0ZXNwYWNlPU8sdS5pc051bWJlcj1FLHUubGV4Q29tbWVudD1lLHUubGV4TnVtYmVyPWQsdS5sZXhTdHJpbmc9dix1LmxleENoYXJhY3Rlcj1DLHUubGV4SWRlbnRpZmllck9yS2V5d29yZD1HLHUubGV4TG9uZ0lkZW50aWZpZXJPcktleXdvcmQ9WSx1Lm5leHRUb2tlbj1KLHUubGV4U3RyZWFtPXosdS5sZXg9ZnVuY3Rpb24ocCxjKXtjPT09dm9pZCAwJiYoYz17fSk7dmFyIHc9MDtyZXR1cm4geih7cGVlazpmdW5jdGlvbihUKXtpZihUPT09dm9pZCAwJiYoVD0wKSwhKHcrVD49cC5sZW5ndGgpKXJldHVybiBwLmNoYXJBdCh3K1QpfSxuZXh0OmZ1bmN0aW9uKCl7aWYodz49cC5sZW5ndGgpdGhyb3cgbmV3IG0uSW5jb21wbGV0ZUVycm9yKCJcdTI2NkEgRGF+YW5nbywgZGFuZ28sIGRhbmdvLCBkYW5nbywgZGF+YW5nbyBkYWlrYXpva3V+IFx1MjY2QSIpO3JldHVybiB3KysscC5jaGFyQXQody0xKX0sZW9zOmZ1bmN0aW9uKCl7cmV0dXJuIHc+PXAubGVuZ3RofX0sYyl9fSw1MTk6ZnVuY3Rpb24oZmUsdSxLKXt2YXIgbT10aGlzJiZ0aGlzLl9fY3JlYXRlQmluZGluZ3x8KE9iamVjdC5jcmVhdGU/ZnVuY3Rpb24oeSxkLHYsQyl7Qz09PXZvaWQgMCYmKEM9diksT2JqZWN0LmRlZmluZVByb3BlcnR5KHksQyx7ZW51bWVyYWJsZTohMCxnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gZFt2XX19KX06ZnVuY3Rpb24oeSxkLHYsQyl7Qz09PXZvaWQgMCYmKEM9dikseVtDXT1kW3ZdfSksZz10aGlzJiZ0aGlzLl9fZXhwb3J0U3Rhcnx8ZnVuY3Rpb24oeSxkKXtmb3IodmFyIHYgaW4geSl2PT09ImRlZmF1bHQifHxPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZCx2KXx8bShkLHksdil9O09iamVjdC5kZWZpbmVQcm9wZXJ0eSh1LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx1LmdldEZpcnN0U3RhdGU9dS5nZXRBdmFpbGFibGVNb2R1bGVzPXUuaW50ZXJwcmV0PXUuVmVyc2lvbj11LlZhbHVlcz11LlR5cGVzPXUuVG9rZW5zPXUuRXhwcmVzc2lvbnM9dS5FcnJvcnM9dS5EZWNsYXJhdGlvbnM9dS5FdmFsdWF0b3I9dS5QYXJzZXI9dS5MZXhlcj12b2lkIDA7dmFyIHM9Syg0NjUpLHE9SygxOTcpLEI9Syg3NTgpLE09Syg0MDMpO3UuTGV4ZXI9TTt2YXIgVj1LKDIxNSk7dS5QYXJzZXI9Vjt2YXIgRD1LKDg1OSk7dS5FdmFsdWF0b3I9RDt2YXIgaD1LKDY1NSk7dS5EZWNsYXJhdGlvbnM9aDt2YXIgQT1LKDc1OCk7dS5FcnJvcnM9QTt2YXIgST1LKDQ5NCk7dS5FeHByZXNzaW9ucz1JO3ZhciBPPUsoNTM0KTt1LlRva2Vucz1PO3ZhciBFPUsoNjk5KTt1LlR5cGVzPUU7dmFyIHI9SygxMDYpO3UuVmFsdWVzPXI7dmFyIGU9Syg0MTIpO2Z1bmN0aW9uIG8oKXt2YXIgeT1bXTtmb3IodmFyIGQgaW4gcS5TVERMSUIpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHEuU1RETElCLGQpJiZkWzBdIT09Il8iJiZ5LnB1c2goZCk7cmV0dXJuIHl9dS5WZXJzaW9uPWUsZyhLKDM2NyksdSksdS5pbnRlcnByZXQ9ZnVuY3Rpb24oeSxkLHYpe2Q9PT12b2lkIDAmJihkPXMuZ2V0SW5pdGlhbFN0YXRlKCkpLHY9PT12b2lkIDAmJih2PXthbGxvd1N1Y2Nlc3Nvck1MOiExLGRpc2FibGVFbGFib3JhdGlvbjohMSxhbGxvd1ZlY3RvcjohMCxzdHJpY3RNb2RlOiEwLHJlYWxFcXVhbGl0eTohMX0pO3ZhciBDPWQuZ2V0TmVzdGVkU3RhdGUoKSxHPU0ubGV4KHksdiksWT1WLnBhcnNlKEcsQyx2KTtpZihZPVkuc2ltcGxpZnkoKSxDPWQuZ2V0TmVzdGVkU3RhdGUoKSx2LmRpc2FibGVFbGFib3JhdGlvbj09PSEwKXt2YXIgSj1ELmV2YWx1YXRlKGQuZ2V0TmVzdGVkU3RhdGUoKSxZKTtpZihKPT09dm9pZCAwfHxKLm5ld1N0YXRlPT09dm9pZCAwKXRocm93IG5ldyBCLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiSG93IGlzIHRoaXMgdW5kZWZpbmVkPyIpO3JldHVybntzdGF0ZTpKLm5ld1N0YXRlLGV2YWx1YXRpb25FcnJvcmVkOkouaGFzVGhyb3duLGVycm9yOkoudmFsdWUsd2FybmluZ3M6Si5uZXdTdGF0ZS5nZXRXYXJuaW5ncygpfX12YXIgej1ZLmVsYWJvcmF0ZShDLG5ldyBNYXAsIicqdDAiLG5ldyBNYXAsITAsdik7aWYoQz16WzBdLHYuZGlzYWJsZUV2YWx1YXRpb249PT0hMClyZXR1cm57c3RhdGU6QyxldmFsdWF0aW9uRXJyb3JlZDohMSxlcnJvcjp2b2lkIDAsd2FybmluZ3M6elsxXX07dmFyIHA9RC5ldmFsdWF0ZShkLmdldE5lc3RlZFN0YXRlKCksWSk7aWYocD09PXZvaWQgMHx8cC5uZXdTdGF0ZT09PXZvaWQgMCl0aHJvdyBuZXcgQi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIkhvdyBpcyB0aGlzIHVuZGVmaW5lZD8iKTtmb3IodmFyIGM9MDtjPHpbMV0ubGVuZ3RoOysrYylwLm5ld1N0YXRlLmFkZFdhcm5pbmcoelsxXVtjXSk7aWYocC5oYXNUaHJvd24pcmV0dXJue3N0YXRlOnAubmV3U3RhdGUsZXZhbHVhdGlvbkVycm9yZWQ6ITAsZXJyb3I6cC52YWx1ZSx3YXJuaW5nczpwLm5ld1N0YXRlLmdldFdhcm5pbmdzKCl9O2Zvcih2YXIgdz1wLm5ld1N0YXRlO3cuaWQ+ZC5pZDspe2lmKHcuZHluYW1pY0Jhc2lzIT09dm9pZCAwKXtmb3IodmFyIGMgaW4gdy5mcmVlVHlwZVZhcmlhYmxlcz1DLmdldFR5cGVWYXJpYWJsZUJpbmRzKHcuaWQpLHcuZHluYW1pY0Jhc2lzLnZhbHVlRW52aXJvbm1lbnQpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHcuZHluYW1pY0Jhc2lzLnZhbHVlRW52aXJvbm1lbnQsYykmJihUPUMuZ2V0U3RhdGljVmFsdWUoYyx3LmlkKSkhPT12b2lkIDAmJncuc2V0U3RhdGljVmFsdWUoYyxUWzBdLFRbMV0pO2Zvcih2YXIgYyBpbiB3LmR5bmFtaWNCYXNpcy50eXBlRW52aXJvbm1lbnQpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHcuZHluYW1pY0Jhc2lzLnR5cGVFbnZpcm9ubWVudCxjKSYmKFQ9Qy5nZXRTdGF0aWNUeXBlKGMsdy5pZCkpIT09dm9pZCAwJiZ3LnNldFN0YXRpY1R5cGUoYyxULnR5cGUsVC5jb25zdHJ1Y3RvcnMsVC5hcml0eSxULmFsbG93c0VxdWFsaXR5KTtmb3IodmFyIGMgaW4gdy5keW5hbWljQmFzaXMuc3RydWN0dXJlRW52aXJvbm1lbnQpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHcuZHluYW1pY0Jhc2lzLnN0cnVjdHVyZUVudmlyb25tZW50LGMpJiYoVD1DLmdldFN0YXRpY1N0cnVjdHVyZShjLHcuaWQpKSE9PXZvaWQgMCYmdy5zZXRTdGF0aWNTdHJ1Y3R1cmUoYyxUKTtmb3IodmFyIGMgaW4gdy5keW5hbWljQmFzaXMuc2lnbmF0dXJlRW52aXJvbm1lbnQpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHcuZHluYW1pY0Jhc2lzLnNpZ25hdHVyZUVudmlyb25tZW50LGMpJiYoVD1DLmdldFN0YXRpY1NpZ25hdHVyZShjLHcuaWQpKSE9PXZvaWQgMCYmdy5zZXRTdGF0aWNTaWduYXR1cmUoYyxUKTtmb3IodmFyIGMgaW4gdy5keW5hbWljQmFzaXMuZnVuY3RvckVudmlyb25tZW50KXt2YXIgVDtPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwody5keW5hbWljQmFzaXMuZnVuY3RvckVudmlyb25tZW50LGMpJiYoVD1DLmdldFN0YXRpY0Z1bmN0b3IoYyx3LmlkKSkhPT12b2lkIDAmJncuc2V0U3RhdGljRnVuY3RvcihjLFtUWzBdLFRbMV0sVFsyXV0sVFszXSl9fWlmKEMucGFyZW50PT09dm9pZCAwKWJyZWFrO2Zvcih3PXcucGFyZW50O0MuaWQ+dy5pZCYmQy5wYXJlbnQhPT12b2lkIDA7KUM9Qy5wYXJlbnR9cmV0dXJue3N0YXRlOnAubmV3U3RhdGUsZXZhbHVhdGlvbkVycm9yZWQ6ITEsZXJyb3I6cC52YWx1ZSx3YXJuaW5nczpwLm5ld1N0YXRlLmdldFdhcm5pbmdzKCl9fSx1LmdldEF2YWlsYWJsZU1vZHVsZXM9byx1LmdldEZpcnN0U3RhdGU9ZnVuY3Rpb24oeSxkKXtpZih5PT09dm9pZCAwJiYoeT1vKCkpLGQ9PT12b2lkIDAmJihkPXt9KSxkLm5vTW9kdWxlcz09PSEwKXJldHVybiBzLmdldEluaXRpYWxTdGF0ZShkKTtmb3IodmFyIHY9cS5sb2FkTW9kdWxlKHMuZ2V0SW5pdGlhbFN0YXRlKGQpLCJfX0Jhc2UiLGQpLEM9MCxHPXk7QzxHLmxlbmd0aDtDKyspe3ZhciBZPUdbQ107dj1xLmxvYWRNb2R1bGUodixZLGQpfXJldHVybiB2fX0sNjc3OmZ1bmN0aW9uKGZlLHUsSyl7dmFyIG0sZz10aGlzJiZ0aGlzLl9fZXh0ZW5kc3x8KG09ZnVuY3Rpb24oRixiKXtyZXR1cm4obT1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24obCx0KXtsLl9fcHJvdG9fXz10fXx8ZnVuY3Rpb24obCx0KXtmb3IodmFyIG4gaW4gdClPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxuKSYmKGxbbl09dFtuXSl9KShGLGIpfSxmdW5jdGlvbihGLGIpe2lmKHR5cGVvZiBiIT0iZnVuY3Rpb24iJiZiIT09bnVsbCl0aHJvdyBuZXcgVHlwZUVycm9yKCJDbGFzcyBleHRlbmRzIHZhbHVlICIrU3RyaW5nKGIpKyIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbCIpO2Z1bmN0aW9uIGwoKXt0aGlzLmNvbnN0cnVjdG9yPUZ9bShGLGIpLEYucHJvdG90eXBlPWI9PT1udWxsP09iamVjdC5jcmVhdGUoYik6KGwucHJvdG90eXBlPWIucHJvdG90eXBlLG5ldyBsKX0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh1LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx1LlR5cGVBbGlhc1NwZWNpZmljYXRpb249dS5TaGFyaW5nU3BlY2lmaWNhdGlvbj11LlNlcXVlbnRpYWxTcGVjaWZpY2F0aW9uPXUuRW1wdHlTcGVjaWZpY2F0aW9uPXUuSW5jbHVkZVNwZWNpZmljYXRpb249dS5TdHJ1Y3R1cmVTcGVjaWZpY2F0aW9uPXUuRXhjZXB0aW9uU3BlY2lmaWNhdGlvbj11LkRhdGF0eXBlUmVwbGljYXRpb25TcGVjaWZpY2F0aW9uPXUuRGF0YXR5cGVTcGVjaWZpY2F0aW9uPXUuRXF1YWxpdHlUeXBlU3BlY2lmaWNhdGlvbj11LlR5cGVTcGVjaWZpY2F0aW9uPXUuVmFsdWVTcGVjaWZpY2F0aW9uPXUuU3BlY2lmaWNhdGlvbj11LkZ1bmN0b3JCaW5kaW5nPXUuU2lnbmF0dXJlQmluZGluZz11LlN0cnVjdHVyZUJpbmRpbmc9dS5GdW5jdG9yRGVjbGFyYXRpb249dS5TaWduYXR1cmVEZWNsYXJhdGlvbj11LlN0cnVjdHVyZURlY2xhcmF0aW9uPXUuVHlwZVJlYWxpc2F0aW9uPXUuU2lnbmF0dXJlSWRlbnRpZmllcj11LlNpZ25hdHVyZUV4cHJlc3Npb249dS5Mb2NhbERlY2xhcmF0aW9uU3RydWN0dXJlRXhwcmVzc2lvbj11LkZ1bmN0b3JBcHBsaWNhdGlvbj11Lk9wYXF1ZUNvbnN0cmFpbnQ9dS5UcmFuc3BhcmVudENvbnN0cmFpbnQ9dS5TdHJ1Y3R1cmVJZGVudGlmaWVyPXUuU3RydWN0dXJlRXhwcmVzc2lvbj12b2lkIDA7dmFyIHM9Syg0OTQpLHE9Syg2NTUpLEI9Syg1MzQpLE09Syg2OTkpLFY9SygzNjcpLEQ9Syg3NTgpLGg9SygxMDYpLEE9Syg0NjUpLEk9ZnVuY3Rpb24oRil7ZnVuY3Rpb24gYihsKXt2YXIgdD1GLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIHQuc3RydWN0dXJlRGVjbGFyYXRpb249bCx0fXJldHVybiBnKGIsRiksYi5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGIodGhpcy5zdHJ1Y3R1cmVEZWNsYXJhdGlvbi5zaW1wbGlmeSgpKX0sYi5wcm90b3R5cGUuZWxhYm9yYXRlPWZ1bmN0aW9uKGwsdCxuLGkpe3ZhciBhPWwuZ2V0TmVzdGVkU3RhdGUoMCkuZ2V0TmVzdGVkU3RhdGUobC5pZCksZj10aGlzLnN0cnVjdHVyZURlY2xhcmF0aW9uLmVsYWJvcmF0ZShhLHQsbixpLCEwKTtyZXR1cm4gbC52YWx1ZUlkZW50aWZpZXJJZD1mWzBdLnZhbHVlSWRlbnRpZmllcklkLFtmWzBdLmdldFN0YXRpY0NoYW5nZXMoMCksZlsxXSxmWzJdLGZbM11dfSxiLnByb3RvdHlwZS5jb21wdXRlU3RydWN0dXJlPWZ1bmN0aW9uKGwsdCxuKXtpZihsLnJlY1Jlc3VsdD09PXZvaWQgMCl7dmFyIGk9bC5zdGF0ZSxhPWkuZ2V0TmVzdGVkU3RhdGUoMCkuZ2V0TmVzdGVkU3RhdGUoaS5pZCk7cmV0dXJuIHQucHVzaCh7bmV4dDpuLHBhcmFtczpsfSksdm9pZCB0LnB1c2goe25leHQ6dGhpcy5zdHJ1Y3R1cmVEZWNsYXJhdGlvbixwYXJhbXM6e3N0YXRlOmEsbW9kaWZpYWJsZTpsLm1vZGlmaWFibGUscmVjUmVzdWx0OnZvaWQgMH19KX12YXIgZj1sLnJlY1Jlc3VsdDtpZihmPT09dm9pZCAwfHxmLm5ld1N0YXRlPT09dm9pZCAwKXRocm93IG5ldyBELkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiUkFJTkJPVyEiKTtyZXR1cm4gYT1mLm5ld1N0YXRlLGYuaGFzVGhyb3duP2YudmFsdWU6YS5nZXREeW5hbWljQ2hhbmdlcygwKX0sYi5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4ic3RydWN0ICIrdGhpcy5zdHJ1Y3R1cmVEZWNsYXJhdGlvbisiIGVuZCJ9LGJ9KHMuRXhwcmVzc2lvbik7dS5TdHJ1Y3R1cmVFeHByZXNzaW9uPUk7dmFyIE89ZnVuY3Rpb24oRil7ZnVuY3Rpb24gYihsKXt2YXIgdD1GLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIHQuaWRlbnRpZmllcj1sLHR9cmV0dXJuIGcoYixGKSxiLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiB0aGlzfSxiLnByb3RvdHlwZS5lbGFib3JhdGU9ZnVuY3Rpb24obCx0LG4saSl7dmFyIGE9dm9pZCAwO2lmKHRoaXMuaWRlbnRpZmllciBpbnN0YW5jZW9mIEIuTG9uZ0lkZW50aWZpZXJUb2tlbil7dmFyIGY9bC5nZXRBbmRSZXNvbHZlU3RhdGljU3RydWN0dXJlKHRoaXMuaWRlbnRpZmllcik7ZiE9PXZvaWQgMCYmKGE9Zi5nZXRTdHJ1Y3R1cmUodGhpcy5pZGVudGlmaWVyLmlkLmdldFRleHQoKSkpfWVsc2UgYT1sLmdldFN0YXRpY1N0cnVjdHVyZSh0aGlzLmlkZW50aWZpZXIuZ2V0VGV4dCgpKTtpZihhPT09dm9pZCAwKXRocm93IG5ldyBELkVsYWJvcmF0aW9uRXJyb3IoJ1VuZGVmaW5lZCBtb2R1bGUgIicrdGhpcy5pZGVudGlmaWVyLmdldFRleHQoKSsnIi4nKTtyZXR1cm5bYSxbXSx0LG5dfSxiLnByb3RvdHlwZS5jb21wdXRlU3RydWN0dXJlPWZ1bmN0aW9uKGwsdCxuKXt2YXIgaT1sLnN0YXRlLGE9dm9pZCAwO2lmKHRoaXMuaWRlbnRpZmllciBpbnN0YW5jZW9mIEIuTG9uZ0lkZW50aWZpZXJUb2tlbil7dmFyIGY9aS5nZXRBbmRSZXNvbHZlRHluYW1pY1N0cnVjdHVyZSh0aGlzLmlkZW50aWZpZXIpO2YhPT12b2lkIDAmJihhPWYuZ2V0U3RydWN0dXJlKHRoaXMuaWRlbnRpZmllci5pZC5nZXRUZXh0KCkpKX1lbHNlIGE9aS5nZXREeW5hbWljU3RydWN0dXJlKHRoaXMuaWRlbnRpZmllci5nZXRUZXh0KCkpO2lmKGE9PT12b2lkIDApdGhyb3cgbmV3IEQuRXZhbHVhdGlvbkVycm9yKCdVbmRlZmluZWQgbW9kdWxlICInK3RoaXMuaWRlbnRpZmllci5nZXRUZXh0KCkrJyIuJyk7cmV0dXJuIGF9LGIucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaWRlbnRpZmllci5nZXRUZXh0KCl9LGJ9KHMuRXhwcmVzc2lvbik7dS5TdHJ1Y3R1cmVJZGVudGlmaWVyPU87dmFyIEU9ZnVuY3Rpb24oRil7ZnVuY3Rpb24gYihsLHQpe3ZhciBuPUYuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gbi5zdHJ1Y3R1cmVFeHByZXNzaW9uPWwsbi5zaWduYXR1cmVFeHByZXNzaW9uPXQsbn1yZXR1cm4gZyhiLEYpLGIucmVzdHJpY3Q9ZnVuY3Rpb24obCx0LG4saSxhKXt2YXIgZj1uZXcgVi5TdGF0aWNCYXNpcyh7fSx7fSx7fSx7fSx7fSksUz1uLmdldE5lc3RlZFN0YXRlKG4uaWQpO1Muc3RhdGljQmFzaXM9dDt2YXIgTD1uLmdldE5lc3RlZFN0YXRlKG4uaWQpO2Zvcih2YXIgayBpbiBMLnN0YXRpY0Jhc2lzPWwsbC50eXBlRW52aXJvbm1lbnQpaWYobC50eXBlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkoaykpe2lmKCF0LnR5cGVFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShrKSl0aHJvdyBuZXcgRC5FbGFib3JhdGlvbkVycm9yKCdTaWduYXR1cmUgbWlzbWF0Y2g6IFVuaW1wbGVtZW50ZWQgdHlwZSAiJytrKyciLicpO3ZhciBVPWwudHlwZUVudmlyb25tZW50W2tdLGo9dC50eXBlRW52aXJvbm1lbnRba107aWYoVS5hcml0eSE9PWouYXJpdHkpdGhyb3cgbmV3IEQuRWxhYm9yYXRpb25FcnJvcignU2lnbmF0dXJlIG1pc21hdGNoOiBJbXBsZW1lbnRhdGlvbiBvZiB0eXBlICInK2srJyIgaGFzIHRoZSB3cm9uZyBhcml0eS4nKTt0cnl7dmFyIFg9VS50eXBlLFo9ai50eXBlLGVlPWoudHlwZTshKFUudHlwZSBpbnN0YW5jZW9mIE0uRnVuY3Rpb25UeXBlKSYmai50eXBlIGluc3RhbmNlb2YgTS5GdW5jdGlvblR5cGUmJihlZT1qLnR5cGUucmV0dXJuVHlwZSxaPWoudHlwZS5wYXJhbWV0ZXJUeXBlKTt2YXIgdGU9WC5tZXJnZShTLGksWik7aWYoVS5hbGxvd3NFcXVhbGl0eSYmIWVlLmFkbWl0c0VxdWFsaXR5KFMpKXRocm93IG5ldyBELkVsYWJvcmF0aW9uRXJyb3IoJ1NpZ25hdHVyZSBtaXNtYXRjaDogSW1wbGVtZW50YXRpb24gb2YgdHlwZSAiJytrKyciIHNob3VsZCBhZG1pdCBlcXVhbGl0eS4nKTtaLmluc3RhbnRpYXRlKEwsdGVbMV0paW5zdGFuY2VvZiBNLkZ1bmN0aW9uVHlwZT9mLnNldFR5cGUoayxaLFUuY29uc3RydWN0b3JzLFUuYXJpdHksITApOmYuc2V0VHlwZShrLGoudHlwZS5pbnN0YW50aWF0ZShMLHRlWzFdKSxVLmNvbnN0cnVjdG9ycyxVLmFyaXR5LCEwKSxpPXRlWzFdfWNhdGNoKGxlKXt0aHJvdyBsZSBpbnN0YW5jZW9mIEFycmF5P25ldyBELkVsYWJvcmF0aW9uRXJyb3IoJ1NpZ25hdHVyZSBtaXNtYXRjaDogV3JvbmcgaW1wbGVtZW50YXRpb24gb2YgdHlwZSAiJytrKyciOiAnK2xlWzBdKTpsZX19Zm9yKHZhciBrIGluIGwudmFsdWVFbnZpcm9ubWVudClpZihsLnZhbHVlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkoaykpe2lmKCF0LnZhbHVlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkoaykpdGhyb3cgbmV3IEQuRWxhYm9yYXRpb25FcnJvcignU2lnbmF0dXJlIG1pc21hdGNoOiBVbmltcGxlbWVudGVkIHZhbHVlICInK2srJyIuJyk7VT1sLnZhbHVlRW52aXJvbm1lbnRba10saj10LnZhbHVlRW52aXJvbm1lbnRba107Zm9yKHZhciBvZT1uZXcgTWFwLHNlPVVbMF0uZ2V0VHlwZVZhcmlhYmxlcygpLHVlPWpbMF0uZ2V0VHlwZVZhcmlhYmxlcygpO2pbMF1pbnN0YW5jZW9mIE0uVHlwZVZhcmlhYmxlQmluZDspe2Zvcig7Oyl7dmFyIGllPSthLnN1YnN0cmluZygzKTtpZihhPXJlPSInIithWzFdK2FbMl0rKGllKzEpLCFpLmhhcyhyZSkmJiFzZS5oYXMocmUpJiYhdWUuaGFzKHJlKSl7alswXS5uYW1lWzFdPT09IiciJiYocmU9IiciK3JlKSxvZT1vZS5zZXQoalswXS5uYW1lLHJlKTticmVha319alswXT1qWzBdLnR5cGV9alswXT1qWzBdLnJlcGxhY2VUeXBlVmFyaWFibGVzKG9lKTtmb3IodmFyIHBlPVVbMF07cGUgaW5zdGFuY2VvZiBNLlR5cGVWYXJpYWJsZUJpbmQ7KXtmb3IoOzspe3ZhciByZTtpZihpZT0rYS5zdWJzdHJpbmcoMyksYT1yZT0iJyIrYVsxXSthWzJdKyhpZSsxKSwhaS5oYXMocmUpJiYhc2UuaGFzKHJlKSYmIXVlLmhhcyhyZSkpe3BlLm5hbWVbMV09PT0iJyImJihyZT0iJyIrcmUpLG9lPW9lLnNldChwZS5uYW1lLHJlKTticmVha319cGU9cGUudHlwZX1wZT1wZS5yZXBsYWNlVHlwZVZhcmlhYmxlcyhvZSk7dHJ5e3ZhciBhZT1wZS5tZXJnZShTLGksalswXSk7aWYoYWVbMF0uZ2V0VHlwZVZhcmlhYmxlcygpLnNpemU8cGUuZ2V0VHlwZVZhcmlhYmxlcygpLnNpemUpdGhyb3cgbmV3IEQuRWxhYm9yYXRpb25FcnJvcignU2lnbmF0dXJlIG1pc21hdGNoOiBJbXBsZW1lbnRhdGlvbiBvZiB2YWx1ZSAiJytrKyciIGhhcyB0eXBlICInK2FlWzBdLm5vcm1hbGl6ZSgpWzBdKyciIHdoaWNoIGlzIGxlc3MgZ2VuZXJhbCB0aGFuIHRoZSByZXF1aXJlZCB0eXBlICInK3BlLm5vcm1hbGl6ZSgpWzBdKyciLicpO2Yuc2V0VmFsdWUoayxVWzBdLmluc3RhbnRpYXRlKFMsYWVbMV0pLFVbMV0pfWNhdGNoKGRlKXt0aHJvdyBkZSBpbnN0YW5jZW9mIEFycmF5P25ldyBELkVsYWJvcmF0aW9uRXJyb3IoJ1NpZ25hdHVyZSBtaXNtYXRjaDogV3JvbmcgaW1wbGVtZW50YXRpb24gb2YgdmFsdWUgIicraysnIjogJytkZVswXSk6ZGV9fWZvcih2YXIgayBpbiBsLnN0cnVjdHVyZUVudmlyb25tZW50KWlmKGwuc3RydWN0dXJlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkoaykpe2lmKCF0LnN0cnVjdHVyZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KGspKXRocm93IG5ldyBELkVsYWJvcmF0aW9uRXJyb3IoJ1VuaW1wbGVtZW50ZWQgc3RydWN0dXJlICInK2srJyIuJyk7dHJ5e3ZhciBjZT1iLnJlc3RyaWN0KGwuZ2V0U3RydWN0dXJlKGspLHQuZ2V0U3RydWN0dXJlKGspLFMsaSxhKTtmLnNldFN0cnVjdHVyZShrLGNlWzBdKSxpPWNlWzJdLGE9Y2VbM119Y2F0Y2goZGUpe3Rocm93IG5ldyBELkVsYWJvcmF0aW9uRXJyb3IoJ1NpZ25hdHVyZSBNaXNtYXRjaDogV3JvbmcgaW1wbGVtZW50YXRpb24gb2Ygc3RydWN0dXJlICInK2srJyI6ICcrZGUubWVzc2FnZSl9fXJldHVybltmLFtdLGksYV19LGIucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBiKHRoaXMuc3RydWN0dXJlRXhwcmVzc2lvbi5zaW1wbGlmeSgpLHRoaXMuc2lnbmF0dXJlRXhwcmVzc2lvbi5zaW1wbGlmeSgpKX0sYi5wcm90b3R5cGUuZWxhYm9yYXRlPWZ1bmN0aW9uKGwsdCxuLGkpe3ZhciBhPXRoaXMuc3RydWN0dXJlRXhwcmVzc2lvbi5lbGFib3JhdGUobCx0LG4saSksZj10aGlzLnNpZ25hdHVyZUV4cHJlc3Npb24uZWxhYm9yYXRlKGwsYVsyXSxhWzNdLGkpO3JldHVybiBiLnJlc3RyaWN0KGZbMF0sYVswXSxsLGZbMl0sZlszXSl9LGIucHJvdG90eXBlLmNvbXB1dGVTdHJ1Y3R1cmU9ZnVuY3Rpb24obCx0LG4pe3ZhciBpPXRoaXMuc3RydWN0dXJlRXhwcmVzc2lvbi5jb21wdXRlU3RydWN0dXJlKGwsdCxuKTtpZihpIT09dm9pZCAwKXtpZihpIGluc3RhbmNlb2YgaC5WYWx1ZSlyZXR1cm4gaTt2YXIgYT10aGlzLnNpZ25hdHVyZUV4cHJlc3Npb24uY29tcHV0ZUludGVyZmFjZShsLnN0YXRlKTtyZXR1cm4gaS5yZXN0cmljdChhKX19LGIucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RydWN0dXJlRXhwcmVzc2lvbisiIDogIit0aGlzLnNpZ25hdHVyZUV4cHJlc3Npb259LGJ9KHMuRXhwcmVzc2lvbik7dS5UcmFuc3BhcmVudENvbnN0cmFpbnQ9RTt2YXIgcj1mdW5jdGlvbihGKXtmdW5jdGlvbiBiKGwsdCl7dmFyIG49Ri5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBuLnN0cnVjdHVyZUV4cHJlc3Npb249bCxuLnNpZ25hdHVyZUV4cHJlc3Npb249dCxufXJldHVybiBnKGIsRiksYi5yZXN0cmljdD1mdW5jdGlvbihsLHQsbixpLGEpe3ZhciBmPW5ldyBWLlN0YXRpY0Jhc2lzKHt9LHt9LHt9LHt9LHt9KSxTPW4uZ2V0TmVzdGVkU3RhdGUobi5pZCk7Uy5zdGF0aWNCYXNpcz10O3ZhciBMPW4uZ2V0TmVzdGVkU3RhdGUobi5pZCk7Zm9yKHZhciBrIGluIEwuc3RhdGljQmFzaXM9bCxMPUwuZ2V0TmVzdGVkU3RhdGUobi5pZCksbC50eXBlRW52aXJvbm1lbnQpaWYobC50eXBlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkoaykpe2lmKCF0LnR5cGVFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShrKSl0aHJvdyBuZXcgRC5FbGFib3JhdGlvbkVycm9yKCdTaWduYXR1cmUgbWlzbWF0Y2g6IFVuaW1wbGVtZW50ZWQgdHlwZSAiJytrKyciLicpO3ZhciBVPWwudHlwZUVudmlyb25tZW50W2tdLGo9dC50eXBlRW52aXJvbm1lbnRba107aWYoVS5hcml0eSE9PWouYXJpdHkpdGhyb3cgbmV3IEQuRWxhYm9yYXRpb25FcnJvcignU2lnbmF0dXJlIG1pc21hdGNoOiBJbXBsZW1lbnRhdGlvbiBvZiB0eXBlICInK2srJyIgaGFzIHRoZSB3cm9uZyBhcml0eS4nKTt0cnl7dmFyIFg9VS50eXBlLFo9ai50eXBlLGVlPWoudHlwZTshKFUudHlwZSBpbnN0YW5jZW9mIE0uRnVuY3Rpb25UeXBlKSYmai50eXBlIGluc3RhbmNlb2YgTS5GdW5jdGlvblR5cGUmJihlZT1qLnR5cGUucmV0dXJuVHlwZSxaPWoudHlwZS5wYXJhbWV0ZXJUeXBlKTt2YXIgdGU9WC5tZXJnZShTLGksWik7aWYoWD1uZXcgTS5DdXN0b21UeXBlKFgubmFtZSxYLnR5cGVBcmd1bWVudHMsWC5xdWFsaWZpZWROYW1lLCEwKSxVLmFsbG93c0VxdWFsaXR5JiYhZWUuYWRtaXRzRXF1YWxpdHkoUykpdGhyb3cgbmV3IEQuRWxhYm9yYXRpb25FcnJvcignU2lnbmF0dXJlIG1pc21hdGNoOiBJbXBsZW1lbnRhdGlvbiBvZiB0eXBlICInK2srJyIgc2hvdWxkIGFkbWl0IGVxdWFsaXR5LicpO1ogaW5zdGFuY2VvZiBNLkZ1bmN0aW9uVHlwZT8oZi5zZXRUeXBlKGssWixVLmNvbnN0cnVjdG9ycyxVLmFyaXR5LCEwKSxMLnN0YXRpY0Jhc2lzLnNldFR5cGUoayxaLFUuY29uc3RydWN0b3JzLFUuYXJpdHksITApKTooZi5zZXRUeXBlKGssWCxbXSxVLmFyaXR5LFUuYWxsb3dzRXF1YWxpdHkpLEwuc3RhdGljQmFzaXMuc2V0VHlwZShrLFgsVS5jb25zdHJ1Y3RvcnMsVS5hcml0eSxVLmFsbG93c0VxdWFsaXR5KSksaT10ZVsxXX1jYXRjaChkZSl7dGhyb3cgZGUgaW5zdGFuY2VvZiBBcnJheT9uZXcgRC5FbGFib3JhdGlvbkVycm9yKCdTaWduYXR1cmUgbWlzbWF0Y2g6IFdyb25nIGltcGxlbWVudGF0aW9uIG9mIHR5cGUgIicraysnIjogJytkZVswXSk6ZGV9fWZvcih2YXIgayBpbiBsLnZhbHVlRW52aXJvbm1lbnQpaWYobC52YWx1ZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KGspKXtpZighdC52YWx1ZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KGspKXRocm93IG5ldyBELkVsYWJvcmF0aW9uRXJyb3IoJ1NpZ25hdHVyZSBtaXNtYXRjaDogVW5pbXBsZW1lbnRlZCB2YWx1ZSAiJytrKyciLicpO1U9bC52YWx1ZUVudmlyb25tZW50W2tdLGo9dC52YWx1ZUVudmlyb25tZW50W2tdO2Zvcih2YXIgb2U9bmV3IE1hcCxzZT1VWzBdLmdldFR5cGVWYXJpYWJsZXMoKSx1ZT1qWzBdLmdldFR5cGVWYXJpYWJsZXMoKSxpZT1qWzBdO2llIGluc3RhbmNlb2YgTS5UeXBlVmFyaWFibGVCaW5kOyl7Zm9yKDs7KXt2YXIgcGU9K2Euc3Vic3RyaW5nKDMpO2lmKGE9YWU9IiciK2FbMV0rYVsyXSsocGUrMSksIWkuaGFzKGFlKSYmIXNlLmhhcyhhZSkmJiF1ZS5oYXMoYWUpKXtpZS5uYW1lWzFdPT09IiciJiYoYWU9IiciK2FlKSxvZT1vZS5zZXQoaWUubmFtZSxhZSk7YnJlYWt9fWllPWllLnR5cGV9aWU9aWUucmVwbGFjZVR5cGVWYXJpYWJsZXMob2UpO2Zvcih2YXIgcmU9VVswXTtyZSBpbnN0YW5jZW9mIE0uVHlwZVZhcmlhYmxlQmluZDspe2Zvcig7Oyl7dmFyIGFlO2lmKHBlPSthLnN1YnN0cmluZygzKSxhPWFlPSInIithWzFdK2FbMl0rKHBlKzEpLCFpLmhhcyhhZSkmJiFzZS5oYXMoYWUpJiYhdWUuaGFzKGFlKSl7cmUubmFtZVsxXT09PSInIiYmKGFlPSInIithZSksb2U9b2Uuc2V0KHJlLm5hbWUsYWUpO2JyZWFrfX1yZT1yZS50eXBlfXJlPXJlLnJlcGxhY2VUeXBlVmFyaWFibGVzKG9lKTt0cnl7dmFyIGNlPXJlLm1lcmdlKFMsaSxpZSk7aWYoY2VbMF0uZ2V0VHlwZVZhcmlhYmxlcygpLnNpemU8cmUuZ2V0VHlwZVZhcmlhYmxlcygpLnNpemUpdGhyb3cgbmV3IEQuRWxhYm9yYXRpb25FcnJvcignU2lnbmF0dXJlIG1pc21hdGNoOiBJbXBsZW1lbnRhdGlvbiBvZiB2YWx1ZSAiJytrKyciIGhhcyB0eXBlICInK2NlWzBdLm5vcm1hbGl6ZSgpWzBdKyciIHdoaWNoIGlzIGxlc3MgZ2VuZXJhbCB0aGFuIHRoZSByZXF1aXJlZCB0eXBlICInK1VbMF0rJyIuJyk7Zi5zZXRWYWx1ZShrLFVbMF0uaW5zdGFudGlhdGUoTCxpKSxVWzFdKX1jYXRjaChoZSl7dGhyb3cgaGUgaW5zdGFuY2VvZiBBcnJheT9uZXcgRC5FbGFib3JhdGlvbkVycm9yKCdTaWduYXR1cmUgbWlzbWF0Y2g6IFdyb25nIGltcGxlbWVudGF0aW9uIG9mIHR5cGUgIicraysnIjogJytoZVswXSk6aGV9fWZvcih2YXIgayBpbiBsLnN0cnVjdHVyZUVudmlyb25tZW50KWlmKGwuc3RydWN0dXJlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkoaykpe2lmKCF0LnN0cnVjdHVyZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KGspKXRocm93IG5ldyBELkVsYWJvcmF0aW9uRXJyb3IoJ1VuaW1wbGVtZW50ZWQgc3RydWN0dXJlICInK2srJyIuJyk7dHJ5e3ZhciBsZT1iLnJlc3RyaWN0KGwuZ2V0U3RydWN0dXJlKGspLHQuZ2V0U3RydWN0dXJlKGspLFMsaSxhKTtmLnNldFN0cnVjdHVyZShrLGxlWzBdKSxpPWxlWzJdLGE9bGVbM119Y2F0Y2goaGUpe3Rocm93IG5ldyBELkVsYWJvcmF0aW9uRXJyb3IoJ1NpZ25hdHVyZSBNaXNtYXRjaDogV3JvbmcgaW1wbGVtZW50YXRpb24gb2Ygc3RydWN0dXJlICInK2srJyI6ICcraGUubWVzc2FnZSl9fXJldHVybltmLFtdLGksYV19LGIucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBiKHRoaXMuc3RydWN0dXJlRXhwcmVzc2lvbi5zaW1wbGlmeSgpLHRoaXMuc2lnbmF0dXJlRXhwcmVzc2lvbi5zaW1wbGlmeSgpKX0sYi5wcm90b3R5cGUuZWxhYm9yYXRlPWZ1bmN0aW9uKGwsdCxuLGkpe3ZhciBhPXRoaXMuc3RydWN0dXJlRXhwcmVzc2lvbi5lbGFib3JhdGUobCx0LG4saSksZj10aGlzLnNpZ25hdHVyZUV4cHJlc3Npb24uZWxhYm9yYXRlKGwsYVsyXSxhWzNdLGkpO3JldHVybiBiLnJlc3RyaWN0KGZbMF0sYVswXSxsLGZbMl0sZlszXSl9LGIucHJvdG90eXBlLmNvbXB1dGVTdHJ1Y3R1cmU9ZnVuY3Rpb24obCx0LG4pe3ZhciBpPXRoaXMuc3RydWN0dXJlRXhwcmVzc2lvbi5jb21wdXRlU3RydWN0dXJlKGwsdCxuKTtpZihpIT09dm9pZCAwKXtpZihpIGluc3RhbmNlb2YgaC5WYWx1ZSlyZXR1cm4gaTt2YXIgYT10aGlzLnNpZ25hdHVyZUV4cHJlc3Npb24uY29tcHV0ZUludGVyZmFjZShsLnN0YXRlKTtyZXR1cm4gaS5yZXN0cmljdChhKX19LGIucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuc3RydWN0dXJlRXhwcmVzc2lvbisiIDo+ICIrdGhpcy5zaWduYXR1cmVFeHByZXNzaW9ufSxifShzLkV4cHJlc3Npb24pO3UuT3BhcXVlQ29uc3RyYWludD1yO3ZhciBlPWZ1bmN0aW9uKEYpe2Z1bmN0aW9uIGIobCx0KXt2YXIgbj1GLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIG4uZnVuY3RvcklkPWwsbi5zdHJ1Y3R1cmVFeHByZXNzaW9uPXQsbn1yZXR1cm4gZyhiLEYpLGIucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBiKHRoaXMuZnVuY3RvcklkLHRoaXMuc3RydWN0dXJlRXhwcmVzc2lvbi5zaW1wbGlmeSgpKX0sYi5wcm90b3R5cGUuZWxhYm9yYXRlPWZ1bmN0aW9uKGwsdCxuLGkpe3ZhciBhPXRoaXMuc3RydWN0dXJlRXhwcmVzc2lvbi5lbGFib3JhdGUobCx0LG4saSksZj1sLmdldFN0YXRpY0Z1bmN0b3IodGhpcy5mdW5jdG9ySWQuZ2V0VGV4dCgpKTtpZihmPT09dm9pZCAwKXRocm93IG5ldyBELkV2YWx1YXRpb25FcnJvcignVW5kZWZpbmVkIGZ1bmN0b3IgIicrdGhpcy5mdW5jdG9ySWQuZ2V0VGV4dCgpKyciLicpO3ZhciBTPWwuZ2V0TmVzdGVkU3RhdGUobC5pZCksTD1uZXcgVi5TdGF0aWNCYXNpcyh7fSx7fSx7fSx7fSx7fSksaz1bXTtmb3IodmFyIFUgaW4gZlszXSYmKFMuc3RhdGljQmFzaXM9Uy5zdGF0aWNCYXNpcy5leHRlbmQoYVswXSksay5wdXNoKG5ldyBELldhcm5pbmcoMCwnVXNpbmcgYXBwcm94aW1hdGVseSBlbGFib3JhdGVkIGZ1bmN0b3IgIicrdGhpcy5mdW5jdG9ySWQuZ2V0VGV4dCgpK2AiLgpgKSkpLFMuc2V0U3RhdGljU3RydWN0dXJlKGZbMl0sRS5yZXN0cmljdChmWzBdLGFbMF0sbCx0LG4pWzBdKSxMPUwuZXh0ZW5kKGZbMV0pLFMuc3RhdGljQmFzaXM9Uy5zdGF0aWNCYXNpcy5leHRlbmQoZlsxXSksTC52YWx1ZUVudmlyb25tZW50KWlmKEwudmFsdWVFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShVKSl7dmFyIGo9TC52YWx1ZUVudmlyb25tZW50W1VdO2ohPT12b2lkIDAmJmpbMF0hPT12b2lkIDAmJihMLnZhbHVlRW52aXJvbm1lbnRbVV09W2pbMF0uaW5zdGFudGlhdGUoUyxhWzJdKSxqWzFdXSl9Zm9yKHZhciBVIGluIEwudHlwZUVudmlyb25tZW50KWlmKEwudHlwZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KFUpJiZMLnR5cGVFbnZpcm9ubWVudFtVXS50eXBlIGluc3RhbmNlb2YgTS5GdW5jdGlvblR5cGUpe3ZhciBYPUwudHlwZUVudmlyb25tZW50W1VdLnR5cGU7TC50eXBlRW52aXJvbm1lbnRbVV0udHlwZT1uZXcgTS5GdW5jdGlvblR5cGUoWC5wYXJhbWV0ZXJUeXBlLFgucmV0dXJuVHlwZS5pbnN0YW50aWF0ZShTLGFbMl0pKX1yZXR1cm5bTCxhWzFdLmNvbmNhdChrKSxhWzJdLGFbM11dfSxiLnByb3RvdHlwZS5jb21wdXRlU3RydWN0dXJlPWZ1bmN0aW9uKGwsdCxuKXt2YXIgaT1sLnN0YXRlLGE9aS5nZXREeW5hbWljRnVuY3Rvcih0aGlzLmZ1bmN0b3JJZC5nZXRUZXh0KCkpO2lmKGE9PT12b2lkIDApdGhyb3cgbmV3IEQuRXZhbHVhdGlvbkVycm9yKCdVbmRlZmluZWQgZnVuY3RvciAiJyt0aGlzLmZ1bmN0b3JJZC5nZXRUZXh0KCkrJyIuJyk7dmFyIGY9dGhpcy5zdHJ1Y3R1cmVFeHByZXNzaW9uLmNvbXB1dGVTdHJ1Y3R1cmUobCx0LG4pO2lmKGY9PT12b2lkIDB8fGYgaW5zdGFuY2VvZiBoLlZhbHVlKXJldHVybiBmO3ZhciBTPWEuc3RhdGUuZ2V0TmVzdGVkU3RhdGUoYS5zdGF0ZS5pZCk7Uy5keW5hbWljQmFzaXM9Uy5keW5hbWljQmFzaXMuZXh0ZW5kKGYpLFMuc2V0RHluYW1pY1N0cnVjdHVyZShhLnBhcmFtTmFtZS5nZXRUZXh0KCksZi5yZXN0cmljdChhLnBhcmFtKSksbFt0aGlzKyIiXT09PXZvaWQgMCYmKGwucmVjUmVzdWx0PXZvaWQgMCxsW3RoaXMrIiJdPSEwKSxsLnN0YXRlPVM7dmFyIEw9YS5ib2R5LmNvbXB1dGVTdHJ1Y3R1cmUobCx0LG4pO3JldHVybiBsLnN0YXRlPWksTH0sYi5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5mdW5jdG9ySWQuZ2V0VGV4dCgpKyIoICIrdGhpcy5zdHJ1Y3R1cmVFeHByZXNzaW9uKyIgKSJ9LGJ9KHMuRXhwcmVzc2lvbik7dS5GdW5jdG9yQXBwbGljYXRpb249ZTt2YXIgbz1mdW5jdGlvbihGKXtmdW5jdGlvbiBiKGwsdCl7dmFyIG49Ri5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBuLmRlY2xhcmF0aW9uPWwsbi5leHByZXNzaW9uPXQsbn1yZXR1cm4gZyhiLEYpLGIucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBiKHRoaXMuZGVjbGFyYXRpb24uc2ltcGxpZnkoKSx0aGlzLmV4cHJlc3Npb24uc2ltcGxpZnkoKSl9LGIucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbihsLHQsbixpKXt2YXIgYT1sLmdldE5lc3RlZFN0YXRlKGwuaWQpO3QuZm9yRWFjaChmdW5jdGlvbihrLFUpe1VbMV09PT0iKiImJlVbMl09PT0iKiImJmEuc2V0U3RhdGljVmFsdWUoVS5zdWJzdHJpbmcoMyksa1swXS5pbnN0YW50aWF0ZShsLHQpLFYuSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSl9KTt2YXIgZj10aGlzLmRlY2xhcmF0aW9uLmVsYWJvcmF0ZShhLHQsbixpKTtuPWZbM107dmFyIFM9bmV3IE1hcDt0LmZvckVhY2goZnVuY3Rpb24oayxVKXtTPVMuc2V0KFUsW2tbMF0uaW5zdGFudGlhdGUoZlswXSxmWzJdKSxrWzFdXSl9KTt2YXIgTD10aGlzLmV4cHJlc3Npb24uZWxhYm9yYXRlKGZbMF0sZlsyXSxuLGkpO3JldHVybltMWzBdLGZbMV0uY29uY2F0KExbMV0pLExbMl0sTFszXV19LGIucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuImxldCAiK3RoaXMuZGVjbGFyYXRpb24rIiBpbiAiK3RoaXMuZXhwcmVzc2lvbisiIGVuZCJ9LGIucHJvdG90eXBlLmNvbXB1dGVTdHJ1Y3R1cmU9ZnVuY3Rpb24obCx0LG4pe3ZhciBpPWwuc3RhdGU7aWYobC5sZHNlUmVzPT09dm9pZCAwKXtpZihsLnJlY1Jlc3VsdD09PXZvaWQgMCl7dmFyIGE9aS5nZXROZXN0ZWRTdGF0ZSgwKS5nZXROZXN0ZWRTdGF0ZShpLmlkKTtyZXR1cm4gdC5wdXNoKHtuZXh0Om4scGFyYW1zOmx9KSx2b2lkIHQucHVzaCh7bmV4dDp0aGlzLmRlY2xhcmF0aW9uLHBhcmFtczp7c3RhdGU6YSxtb2RpZmlhYmxlOmwubW9kaWZpYWJsZSxyZWNSZXN1bHQ6dm9pZCAwfX0pfWwubGRzZVJlcz1sLnJlY1Jlc3VsdCxsLnJlY1Jlc3VsdD12b2lkIDB9dmFyIGY9bC5sZHNlUmVzO2lmKGY9PT12b2lkIDB8fGYubmV3U3RhdGU9PT12b2lkIDApdGhyb3cgbmV3IEQuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJBbnBhbi4iKTtpZihhPWYubmV3U3RhdGUsZi5oYXNUaHJvd24pcmV0dXJuIGYudmFsdWU7bC5zdGF0ZT1hO3ZhciBTPXRoaXMuZXhwcmVzc2lvbi5jb21wdXRlU3RydWN0dXJlKGwsdCxuKTtyZXR1cm4gbC5zdGF0ZT1pLFN9LGJ9KHMuRXhwcmVzc2lvbik7dS5Mb2NhbERlY2xhcmF0aW9uU3RydWN0dXJlRXhwcmVzc2lvbj1vO3ZhciB5PWZ1bmN0aW9uKEYpe2Z1bmN0aW9uIGIobCl7dmFyIHQ9Ri5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiB0LnNwZWNpZmljYXRpb249bCx0fXJldHVybiBnKGIsRiksYi5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IGIodGhpcy5zcGVjaWZpY2F0aW9uLnNpbXBsaWZ5KCkpfSxiLnByb3RvdHlwZS5lbGFib3JhdGU9ZnVuY3Rpb24obCx0LG4saSl7cmV0dXJuIHRoaXMuc3BlY2lmaWNhdGlvbi5lbGFib3JhdGUobCx0LG4saSl9LGIucHJvdG90eXBlLmNvbXB1dGVJbnRlcmZhY2U9ZnVuY3Rpb24obCl7cmV0dXJuIHRoaXMuc3BlY2lmaWNhdGlvbi5jb21wdXRlSW50ZXJmYWNlKGwpfSxiLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiJzaWcgIit0aGlzLnNwZWNpZmljYXRpb24rIiBlbmQifSxifShzLkV4cHJlc3Npb24pO3UuU2lnbmF0dXJlRXhwcmVzc2lvbj15O3ZhciBkPWZ1bmN0aW9uKEYpe2Z1bmN0aW9uIGIobCl7dmFyIHQ9Ri5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiB0LmlkZW50aWZpZXI9bCx0fXJldHVybiBnKGIsRiksYi5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30sYi5wcm90b3R5cGUuZWxhYm9yYXRlPWZ1bmN0aW9uKGwsdCxuLGkpe3ZhciBhPXZvaWQgMDtpZih0aGlzLmlkZW50aWZpZXIgaW5zdGFuY2VvZiBCLkxvbmdJZGVudGlmaWVyVG9rZW4pe3ZhciBmPWwuZ2V0QW5kUmVzb2x2ZVN0YXRpY1N0cnVjdHVyZSh0aGlzLmlkZW50aWZpZXIpO2YhPT12b2lkIDAmJihhPWYuZ2V0U2lnbmF0dXJlKHRoaXMuaWRlbnRpZmllci5pZC5nZXRUZXh0KCkpKX1lbHNlIGE9bC5nZXRTdGF0aWNTaWduYXR1cmUodGhpcy5pZGVudGlmaWVyLmdldFRleHQoKSk7aWYoYT09PXZvaWQgMCl0aHJvdyBuZXcgRC5FdmFsdWF0aW9uRXJyb3IoJ1VuZGVmaW5lZCBzaWduYXR1cmUgIicrdGhpcy5pZGVudGlmaWVyLmdldFRleHQoKSsnIi4nKTtyZXR1cm5bYSxbXSx0LG5dfSxiLnByb3RvdHlwZS5jb21wdXRlSW50ZXJmYWNlPWZ1bmN0aW9uKGwpe3ZhciB0PXZvaWQgMDtpZih0aGlzLmlkZW50aWZpZXIgaW5zdGFuY2VvZiBCLkxvbmdJZGVudGlmaWVyVG9rZW4pe3ZhciBuPWwuZ2V0QW5kUmVzb2x2ZUR5bmFtaWNTdHJ1Y3R1cmUodGhpcy5pZGVudGlmaWVyKTtuIT09dm9pZCAwJiYodD1uLmdldFNpZ25hdHVyZSh0aGlzLmlkZW50aWZpZXIuaWQuZ2V0VGV4dCgpKSl9ZWxzZSB0PWwuZ2V0RHluYW1pY1NpZ25hdHVyZSh0aGlzLmlkZW50aWZpZXIuZ2V0VGV4dCgpKTtpZih0PT09dm9pZCAwKXRocm93IG5ldyBELkV2YWx1YXRpb25FcnJvcignVW5kZWZpbmVkIHNpZ25hdHVyZSAiJyt0aGlzLmlkZW50aWZpZXIuZ2V0VGV4dCgpKyciLicpO3JldHVybiB0fSxiLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlkZW50aWZpZXIuZ2V0VGV4dCgpfSxifShzLkV4cHJlc3Npb24pO3UuU2lnbmF0dXJlSWRlbnRpZmllcj1kO3ZhciB2PWZ1bmN0aW9uKEYpe2Z1bmN0aW9uIGIobCx0LG4saSl7dmFyIGE9Ri5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBhLnNpZ25hdHVyZUV4cHJlc3Npb249bCxhLnR5dmFyc2VxPXQsYS5uYW1lPW4sYS50eXBlPWksYX1yZXR1cm4gZyhiLEYpLGIucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBiKHRoaXMuc2lnbmF0dXJlRXhwcmVzc2lvbi5zaW1wbGlmeSgpLHRoaXMudHl2YXJzZXEsdGhpcy5uYW1lLHRoaXMudHlwZS5zaW1wbGlmeSgpKX0sYi5wcm90b3R5cGUuZWxhYm9yYXRlPWZ1bmN0aW9uKGwsdCxuLGkpe3ZhciBhPXRoaXMuc2lnbmF0dXJlRXhwcmVzc2lvbi5lbGFib3JhdGUobCx0LG4saSksZj1sLmdldE5lc3RlZFN0YXRlKDApO2Yuc3RhdGljQmFzaXM9YVswXTt2YXIgUz12b2lkIDAsTD1hWzBdLGs9dGhpcy5uYW1lLmdldFRleHQoKTtpZih0aGlzLm5hbWUgaW5zdGFuY2VvZiBCLkxvbmdJZGVudGlmaWVyVG9rZW4/KEw9Zi5nZXRBbmRSZXNvbHZlU3RhdGljU3RydWN0dXJlKHRoaXMubmFtZSkpIT09dm9pZCAwJiYoUz1MLmdldFR5cGUodGhpcy5uYW1lLmlkLmdldFRleHQoKSksaz10aGlzLm5hbWUuaWQuZ2V0VGV4dCgpKTpTPWYuZ2V0U3RhdGljVHlwZSh0aGlzLm5hbWUuZ2V0VGV4dCgpKSxTPT09dm9pZCAwfHxMPT09dm9pZCAwKXRocm93IG5ldyBELkVsYWJvcmF0aW9uRXJyb3IoJ1VuZGVmaW5lZCB0eXBlICInK3RoaXMubmFtZS5nZXRUZXh0KCkrJyIuJyk7cmV0dXJuIEwuc2V0VHlwZShrLG5ldyBNLkZ1bmN0aW9uVHlwZShTLnR5cGUsdGhpcy50eXBlKSxbXSx0aGlzLnR5dmFyc2VxLmxlbmd0aCxTLmFsbG93c0VxdWFsaXR5KSxhfSxiLnByb3RvdHlwZS5jb21wdXRlSW50ZXJmYWNlPWZ1bmN0aW9uKGwpe3JldHVybiB0aGlzLnNpZ25hdHVyZUV4cHJlc3Npb24uY29tcHV0ZUludGVyZmFjZShsKX0sYi5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zaWduYXR1cmVFeHByZXNzaW9uKyIgd2hlcmUgdHlwZSA8c3R1ZmY+ICIrdGhpcy5uYW1lLmdldFRleHQoKSsiID0gIit0aGlzLnR5cGV9LGJ9KHMuRXhwcmVzc2lvbik7dS5UeXBlUmVhbGlzYXRpb249djt2YXIgQz1mdW5jdGlvbihGKXtmdW5jdGlvbiBiKGwpe3ZhciB0PUYuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gdC5zdHJ1Y3R1cmVCaW5kaW5nPWwsdH1yZXR1cm4gZyhiLEYpLGIucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbihsLHQsbixpLGEpe2Zvcih2YXIgZj1bXSxTPTA7Uzx0aGlzLnN0cnVjdHVyZUJpbmRpbmcubGVuZ3RoOysrUyl7dmFyIEw9dGhpcy5zdHJ1Y3R1cmVCaW5kaW5nW1NdLmVsYWJvcmF0ZShsLHQsbixpKTtsPUxbMF0sZj1mLmNvbmNhdChMWzFdKSx0PUxbMl0sbj1MWzNdfXJldHVybltsLGYsdCxuXX0sYi5wcm90b3R5cGUuZXZhbHVhdGU9ZnVuY3Rpb24obCx0KXtsLndoaWNoQmluZD09PXZvaWQgMCYmKGwud2hpY2hCaW5kPTApO3ZhciBuPWwud2hpY2hCaW5kLGk9dGhpcy5zdHJ1Y3R1cmVCaW5kaW5nW25dLmV2YWx1YXRlKGwsdCx0aGlzKTtpZihpIT09dm9pZCAwKXtpZihpLmhhc1Rocm93bilyZXR1cm4gaTtpZihsLnN0YXRlPWkubmV3U3RhdGUsbC53aGljaEJpbmQ9bC53aGljaEJpbmQrMSxsLnJlY1Jlc3VsdD12b2lkIDAsbC53aGljaEJpbmQ9PT10aGlzLnN0cnVjdHVyZUJpbmRpbmcubGVuZ3RoKXJldHVybntuZXdTdGF0ZTpsLnN0YXRlLHZhbHVlOnZvaWQgMCxoYXNUaHJvd246ITF9O3QucHVzaCh7bmV4dDp0aGlzLHBhcmFtczpsfSl9fSxiLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe2Zvcih2YXIgbD1bXSx0PTA7dDx0aGlzLnN0cnVjdHVyZUJpbmRpbmcubGVuZ3RoOysrdClsLnB1c2godGhpcy5zdHJ1Y3R1cmVCaW5kaW5nW3RdLnNpbXBsaWZ5KCkpO3JldHVybiBuZXcgYihsKX0sYi5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtmb3IodmFyIGw9InN0cnVjdHVyZSIsdD0wO3Q8dGhpcy5zdHJ1Y3R1cmVCaW5kaW5nLmxlbmd0aDsrK3QpbCs9IiAiK3RoaXMuc3RydWN0dXJlQmluZGluZ1t0XTtyZXR1cm4gbCsiOyJ9LGJ9KHEuRGVjbGFyYXRpb24pO3UuU3RydWN0dXJlRGVjbGFyYXRpb249Qzt2YXIgRz1mdW5jdGlvbihGKXtmdW5jdGlvbiBiKGwpe3ZhciB0PUYuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gdC5zaWduYXR1cmVCaW5kaW5nPWwsdH1yZXR1cm4gZyhiLEYpLGIucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbihsLHQsbixpKXt0PT09dm9pZCAwJiYodD1uZXcgTWFwKSxuPT09dm9pZCAwJiYobj0iJyp0MCIpLGk9PT12b2lkIDAmJihpPW5ldyBNYXApO2Zvcih2YXIgYT1bXSxmPTA7Zjx0aGlzLnNpZ25hdHVyZUJpbmRpbmcubGVuZ3RoOysrZil7dmFyIFM9dGhpcy5zaWduYXR1cmVCaW5kaW5nW2ZdLmVsYWJvcmF0ZShsLHQsbixpKTtsPVNbMF0sYT1hLmNvbmNhdChTWzFdKSx0PVNbMl0sbj1TWzNdfXJldHVybltsLGEsdCxuXX0sYi5wcm90b3R5cGUuZXZhbHVhdGU9ZnVuY3Rpb24obCx0KXtmb3IodmFyIG49bC5zdGF0ZSxpPTA7aTx0aGlzLnNpZ25hdHVyZUJpbmRpbmcubGVuZ3RoOysraSluPXRoaXMuc2lnbmF0dXJlQmluZGluZ1tpXS5ldmFsdWF0ZShuKTtyZXR1cm57bmV3U3RhdGU6bix2YWx1ZTp2b2lkIDAsaGFzVGhyb3duOiExfX0sYi5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtmb3IodmFyIGw9W10sdD0wO3Q8dGhpcy5zaWduYXR1cmVCaW5kaW5nLmxlbmd0aDsrK3QpbC5wdXNoKHRoaXMuc2lnbmF0dXJlQmluZGluZ1t0XS5zaW1wbGlmeSgpKTtyZXR1cm4gbmV3IGIobCl9LGIucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7Zm9yKHZhciBsPSJzdHJ1Y3R1cmUiLHQ9MDt0PHRoaXMuc2lnbmF0dXJlQmluZGluZy5sZW5ndGg7Kyt0KWwrPSIgIit0aGlzLnNpZ25hdHVyZUJpbmRpbmdbdF07cmV0dXJuIGwrIjsifSxifShxLkRlY2xhcmF0aW9uKTt1LlNpZ25hdHVyZURlY2xhcmF0aW9uPUc7dmFyIFk9ZnVuY3Rpb24oRil7ZnVuY3Rpb24gYihsKXt2YXIgdD1GLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIHQuZnVuY3RvckJpbmRpbmc9bCx0fXJldHVybiBnKGIsRiksYi5wcm90b3R5cGUuZWxhYm9yYXRlPWZ1bmN0aW9uKGwsdCxuLGkpe3ZhciBhO3Q9PT12b2lkIDAmJih0PW5ldyBNYXApLG49PT12b2lkIDAmJihuPSInKnQwIiksaT09PXZvaWQgMCYmKGk9bmV3IE1hcCk7Zm9yKHZhciBmPVtdLFM9MDtTPHRoaXMuZnVuY3RvckJpbmRpbmcubGVuZ3RoOysrUyl7dmFyIEw7bD0oYT10aGlzLmZ1bmN0b3JCaW5kaW5nW1NdLmVsYWJvcmF0ZShsLHQsbixpKSlbMF0sTD1hWzFdLHQ9YVsyXSxuPWFbM10sZj1mLmNvbmNhdChMKX1yZXR1cm5bbCxmLHQsbl19LGIucHJvdG90eXBlLmV2YWx1YXRlPWZ1bmN0aW9uKGwsdCl7Zm9yKHZhciBuPWwuc3RhdGUsaT0wO2k8dGhpcy5mdW5jdG9yQmluZGluZy5sZW5ndGg7KytpKW49dGhpcy5mdW5jdG9yQmluZGluZ1tpXS5ldmFsdWF0ZShuKTtyZXR1cm57bmV3U3RhdGU6bix2YWx1ZTp2b2lkIDAsaGFzVGhyb3duOiExfX0sYi5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtmb3IodmFyIGw9W10sdD0wO3Q8dGhpcy5mdW5jdG9yQmluZGluZy5sZW5ndGg7Kyt0KWwucHVzaCh0aGlzLmZ1bmN0b3JCaW5kaW5nW3RdLnNpbXBsaWZ5KCkpO3JldHVybiBuZXcgYihsKX0sYi5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtmb3IodmFyIGw9ImZ1bmN0b3IiLHQ9MDt0PHRoaXMuZnVuY3RvckJpbmRpbmcubGVuZ3RoOysrdClsKz0iICIrdGhpcy5mdW5jdG9yQmluZGluZ1t0XTtyZXR1cm4gbCsiOyJ9LGJ9KHEuRGVjbGFyYXRpb24pO3UuRnVuY3RvckRlY2xhcmF0aW9uPVk7dmFyIEo9ZnVuY3Rpb24oKXtmdW5jdGlvbiBGKGIsbCl7dGhpcy5uYW1lPWIsdGhpcy5iaW5kaW5nPWx9cmV0dXJuIEYucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBGKHRoaXMubmFtZSx0aGlzLmJpbmRpbmcuc2ltcGxpZnkoKSl9LEYucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbihiLGwsdCxuKXt2YXIgaT10aGlzLmJpbmRpbmcuZWxhYm9yYXRlKGIsbCx0LG4pO3JldHVybiBiLnNldFN0YXRpY1N0cnVjdHVyZSh0aGlzLm5hbWUuZ2V0VGV4dCgpLGlbMF0pLFtiLGlbMV0saVsyXSxpWzNdXX0sRi5wcm90b3R5cGUuZXZhbHVhdGU9ZnVuY3Rpb24oYixsLHQpe3ZhciBuPXRoaXMuYmluZGluZy5jb21wdXRlU3RydWN0dXJlKGIsbCx0KTtpZihuIT09dm9pZCAwKXt2YXIgaT1iLnN0YXRlO3JldHVybiBuIGluc3RhbmNlb2YgaC5WYWx1ZT97bmV3U3RhdGU6aSx2YWx1ZTpuLGhhc1Rocm93bjohMH06KGkuc2V0RHluYW1pY1N0cnVjdHVyZSh0aGlzLm5hbWUuZ2V0VGV4dCgpLG4pLHtuZXdTdGF0ZTppLHZhbHVlOnZvaWQgMCxoYXNUaHJvd246ITF9KX19LEYucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmFtZS5nZXRUZXh0KCkrIiA9ICIrdGhpcy5iaW5kaW5nfSxGfSgpO3UuU3RydWN0dXJlQmluZGluZz1KO3ZhciB6PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gRihiLGwpe3RoaXMubmFtZT1iLHRoaXMuYmluZGluZz1sfXJldHVybiBGLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiBuZXcgRih0aGlzLm5hbWUsdGhpcy5iaW5kaW5nLnNpbXBsaWZ5KCkpfSxGLnByb3RvdHlwZS5lbGFib3JhdGU9ZnVuY3Rpb24oYixsLHQsbil7dmFyIGk9dGhpcy5iaW5kaW5nLmVsYWJvcmF0ZShiLGwsdCxuKTtyZXR1cm4gYi5zZXRTdGF0aWNTaWduYXR1cmUodGhpcy5uYW1lLmdldFRleHQoKSxpWzBdKSxbYixpWzFdLGlbMl0saVszXV19LEYucHJvdG90eXBlLmV2YWx1YXRlPWZ1bmN0aW9uKGIpe3JldHVybiBiLnNldER5bmFtaWNTaWduYXR1cmUodGhpcy5uYW1lLmdldFRleHQoKSx0aGlzLmJpbmRpbmcuY29tcHV0ZUludGVyZmFjZShiKSksYn0sRi5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5uYW1lLmdldFRleHQoKSsiID0gIit0aGlzLmJpbmRpbmd9LEZ9KCk7dS5TaWduYXR1cmVCaW5kaW5nPXo7dmFyIHA9ZnVuY3Rpb24oKXtmdW5jdGlvbiBGKGIsbCx0LG4pe3RoaXMubmFtZT1iLHRoaXMuc2lnbmF0dXJlTmFtZT1sLHRoaXMuc2lnbmF0dXJlQmluZGluZz10LHRoaXMuYmluZGluZz1ufXJldHVybiBGLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3JldHVybiBuZXcgRih0aGlzLm5hbWUsdGhpcy5zaWduYXR1cmVOYW1lLHRoaXMuc2lnbmF0dXJlQmluZGluZy5zaW1wbGlmeSgpLHRoaXMuYmluZGluZy5zaW1wbGlmeSgpKX0sRi5wcm90b3R5cGUuZWxhYm9yYXRlPWZ1bmN0aW9uKGIsbCx0LG4pe2w9PT12b2lkIDAmJihsPW5ldyBNYXApLHQ9PT12b2lkIDAmJih0PSInKnQwIiksbj09PXZvaWQgMCYmKG49bmV3IE1hcCk7dmFyIGk9dGhpcy5zaWduYXR1cmVCaW5kaW5nLmVsYWJvcmF0ZShiLGwsdCxuKSxhPWIuZ2V0TmVzdGVkU3RhdGUoYi5pZCk7YS5zZXRTdGF0aWNTdHJ1Y3R1cmUodGhpcy5zaWduYXR1cmVOYW1lLmdldFRleHQoKSxpWzBdKTt2YXIgZj0hMSxTPVtdO3RoaXMuYmluZGluZyBpbnN0YW5jZW9mIG8mJihmPSEwLFMucHVzaChuZXcgRC5XYXJuaW5nKDAsJ0Z1bmN0b3IgIicrdGhpcy5uYW1lLmdldFRleHQoKStgIiBlbGFib3JhdGVkIGFwcHJveGltYXRlbHkuCmApKSk7dmFyIEw9dGhpcy5iaW5kaW5nLmVsYWJvcmF0ZShhLGlbMl0saVszXSxuKTtyZXR1cm4gYi5zZXRTdGF0aWNGdW5jdG9yKHRoaXMubmFtZS5nZXRUZXh0KCksW2lbMF0sTFswXSx0aGlzLnNpZ25hdHVyZU5hbWUuZ2V0VGV4dCgpXSxmKSxbYixpWzFdLmNvbmNhdChTKS5jb25jYXQoTFsxXSksTFsyXSxMWzNdXX0sRi5wcm90b3R5cGUuZXZhbHVhdGU9ZnVuY3Rpb24oYil7dmFyIGw9dGhpcy5zaWduYXR1cmVCaW5kaW5nLmNvbXB1dGVJbnRlcmZhY2UoYiksdD1BLmdldEluaXRpYWxTdGF0ZSgpLmdldE5lc3RlZFN0YXRlKGIuaWQpO3JldHVybiB0LmR5bmFtaWNCYXNpcz1iLmdldER5bmFtaWNDaGFuZ2VzKC0xKSxiLnNldER5bmFtaWNGdW5jdG9yKHRoaXMubmFtZS5nZXRUZXh0KCksbmV3IFYuRHluYW1pY0Z1bmN0b3JJbmZvcm1hdGlvbih0aGlzLnNpZ25hdHVyZU5hbWUsbCx0aGlzLmJpbmRpbmcsdCkpLGJ9LEYucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmFtZS5nZXRUZXh0KCkrIiggIit0aGlzLnNpZ25hdHVyZU5hbWUrIiA6ICIrdGhpcy5zaWduYXR1cmVCaW5kaW5nKyIgKSA9ICIrdGhpcy5iaW5kaW5nfSxGfSgpO3UuRnVuY3RvckJpbmRpbmc9cDt2YXIgYz1mdW5jdGlvbigpe2Z1bmN0aW9uIEYoKXt9cmV0dXJuIEYucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LEZ9KCk7dS5TcGVjaWZpY2F0aW9uPWM7dmFyIHc9ZnVuY3Rpb24oRil7ZnVuY3Rpb24gYihsKXt2YXIgdD1GLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIHQudmFsdWVEZXNjcmlwdGlvbj1sLHR9cmV0dXJuIGcoYixGKSxiLnByb3RvdHlwZS5lbGFib3JhdGU9ZnVuY3Rpb24obCx0LG4saSl7Zm9yKHZhciBhPW5ldyBWLlN0YXRpY0Jhc2lzKHt9LHt9LHt9LHt9LHt9KSxmPWZ1bmN0aW9uKGspe3ZhciBVPVMudmFsdWVEZXNjcmlwdGlvbltrXVsxXS5zaW1wbGlmeSgpLmluc3RhbnRpYXRlKGwsdCk7VS5nZXRUeXBlVmFyaWFibGVzKCkuZm9yRWFjaChmdW5jdGlvbihqLFgpe1U9bmV3IE0uVHlwZVZhcmlhYmxlQmluZChYLFUsail9KSxhLnNldFZhbHVlKFMudmFsdWVEZXNjcmlwdGlvbltrXVswXS5nZXRUZXh0KCksVSxWLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpfSxTPXRoaXMsTD0wO0w8dGhpcy52YWx1ZURlc2NyaXB0aW9uLmxlbmd0aDsrK0wpZihMKTtyZXR1cm5bYSxbXSx0LG5dfSxiLnByb3RvdHlwZS5jb21wdXRlSW50ZXJmYWNlPWZ1bmN0aW9uKGwpe2Zvcih2YXIgdD17fSxuPTA7bjx0aGlzLnZhbHVlRGVzY3JpcHRpb24ubGVuZ3RoOysrbil0W3RoaXMudmFsdWVEZXNjcmlwdGlvbltuXVswXS5nZXRUZXh0KCldPVYuSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRTtyZXR1cm4gbmV3IFYuRHluYW1pY0ludGVyZmFjZSh7fSx0LHt9KX0sYn0oYyk7dS5WYWx1ZVNwZWNpZmljYXRpb249dzt2YXIgVD1mdW5jdGlvbihGKXtmdW5jdGlvbiBiKGwpe3ZhciB0PUYuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gdC50eXBlRGVzY3JpcHRpb249bCx0fXJldHVybiBnKGIsRiksYi5wcm90b3R5cGUuZWxhYm9yYXRlPWZ1bmN0aW9uKGwsdCxuLGkpe2Zvcih2YXIgYT1uZXcgVi5TdGF0aWNCYXNpcyh7fSx7fSx7fSx7fSx7fSksZj0wO2Y8dGhpcy50eXBlRGVzY3JpcHRpb24ubGVuZ3RoOysrZilhLnNldFR5cGUodGhpcy50eXBlRGVzY3JpcHRpb25bZl1bMV0uZ2V0VGV4dCgpLG5ldyBNLkN1c3RvbVR5cGUodGhpcy50eXBlRGVzY3JpcHRpb25bZl1bMV0uZ2V0VGV4dCgpLHRoaXMudHlwZURlc2NyaXB0aW9uW2ZdWzBdKSxbXSx0aGlzLnR5cGVEZXNjcmlwdGlvbltmXVswXS5sZW5ndGgsITEpO3JldHVyblthLFtdLHQsbl19LGIucHJvdG90eXBlLmNvbXB1dGVJbnRlcmZhY2U9ZnVuY3Rpb24obCl7Zm9yKHZhciB0PXt9LG49MDtuPHRoaXMudHlwZURlc2NyaXB0aW9uLmxlbmd0aDsrK24pdFt0aGlzLnR5cGVEZXNjcmlwdGlvbltuXVsxXS5nZXRUZXh0KCldPVtdO3JldHVybiBuZXcgVi5EeW5hbWljSW50ZXJmYWNlKHQse30se30pfSxifShjKTt1LlR5cGVTcGVjaWZpY2F0aW9uPVQ7dmFyIE49ZnVuY3Rpb24oRil7ZnVuY3Rpb24gYihsKXt2YXIgdD1GLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIHQudHlwZURlc2NyaXB0aW9uPWwsdH1yZXR1cm4gZyhiLEYpLGIucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbihsLHQsbixpKXtmb3IodmFyIGE9bmV3IFYuU3RhdGljQmFzaXMoe30se30se30se30se30pLGY9MDtmPHRoaXMudHlwZURlc2NyaXB0aW9uLmxlbmd0aDsrK2YpYS5zZXRUeXBlKHRoaXMudHlwZURlc2NyaXB0aW9uW2ZdWzFdLmdldFRleHQoKSxuZXcgTS5DdXN0b21UeXBlKHRoaXMudHlwZURlc2NyaXB0aW9uW2ZdWzFdLmdldFRleHQoKSx0aGlzLnR5cGVEZXNjcmlwdGlvbltmXVswXSksW10sdGhpcy50eXBlRGVzY3JpcHRpb25bZl1bMF0ubGVuZ3RoLCEwKTtyZXR1cm5bYSxbXSx0LG5dfSxiLnByb3RvdHlwZS5jb21wdXRlSW50ZXJmYWNlPWZ1bmN0aW9uKGwpe2Zvcih2YXIgdD17fSxuPTA7bjx0aGlzLnR5cGVEZXNjcmlwdGlvbi5sZW5ndGg7KytuKXRbdGhpcy50eXBlRGVzY3JpcHRpb25bbl1bMV0uZ2V0VGV4dCgpXT1bXTtyZXR1cm4gbmV3IFYuRHluYW1pY0ludGVyZmFjZSh0LHt9LHt9KX0sYn0oYyk7dS5FcXVhbGl0eVR5cGVTcGVjaWZpY2F0aW9uPU47dmFyICQ9ZnVuY3Rpb24oRil7ZnVuY3Rpb24gYihsKXt2YXIgdD1GLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIHQuZGF0YXR5cGVEZXNjcmlwdGlvbj1sLHR9cmV0dXJuIGcoYixGKSxiLnByb3RvdHlwZS5lbGFib3JhdGU9ZnVuY3Rpb24obCx0LG4saSl7Zm9yKHZhciBhPW5ldyBWLlN0YXRpY0Jhc2lzKHt9LHt9LHt9LHt9LHt9KSxmPTA7Zjx0aGlzLmRhdGF0eXBlRGVzY3JpcHRpb24ubGVuZ3RoOysrZil7Zm9yKHZhciBTPVtdLEw9bmV3IE0uQ3VzdG9tVHlwZSh0aGlzLmRhdGF0eXBlRGVzY3JpcHRpb25bZl1bMV0uZ2V0VGV4dCgpLHRoaXMuZGF0YXR5cGVEZXNjcmlwdGlvbltmXVswXSksaz1mdW5jdGlvbihYKXtpZihTLnB1c2goVS5kYXRhdHlwZURlc2NyaXB0aW9uW2ZdWzJdW1hdWzBdLmdldFRleHQoKSksVS5kYXRhdHlwZURlc2NyaXB0aW9uW2ZdWzJdW1hdWzFdPT09dm9pZCAwKXt2YXIgWj1MO1ouZ2V0VHlwZVZhcmlhYmxlcygpLmZvckVhY2goZnVuY3Rpb24odGUsb2Upe1o9bmV3IE0uVHlwZVZhcmlhYmxlQmluZChvZSxaLHRlKX0pLGEuc2V0VmFsdWUoVS5kYXRhdHlwZURlc2NyaXB0aW9uW2ZdWzJdW1hdWzBdLmdldFRleHQoKSxaLFYuSWRlbnRpZmllclN0YXR1cy5WQUxVRV9DT05TVFJVQ1RPUil9ZWxzZXt2YXIgZWU9bmV3IE0uRnVuY3Rpb25UeXBlKFUuZGF0YXR5cGVEZXNjcmlwdGlvbltmXVsyXVtYXVsxXSxMKTtlZS5nZXRUeXBlVmFyaWFibGVzKCkuZm9yRWFjaChmdW5jdGlvbih0ZSxvZSl7ZWU9bmV3IE0uVHlwZVZhcmlhYmxlQmluZChvZSxlZSx0ZSl9KSxhLnNldFZhbHVlKFUuZGF0YXR5cGVEZXNjcmlwdGlvbltmXVsyXVtYXVswXS5nZXRUZXh0KCksZWUsVi5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX0NPTlNUUlVDVE9SKX19LFU9dGhpcyxqPTA7ajx0aGlzLmRhdGF0eXBlRGVzY3JpcHRpb25bZl1bMl0ubGVuZ3RoOysrailrKGopO2Euc2V0VHlwZSh0aGlzLmRhdGF0eXBlRGVzY3JpcHRpb25bZl1bMV0uZ2V0VGV4dCgpLEwsUyx0aGlzLmRhdGF0eXBlRGVzY3JpcHRpb25bZl1bMF0ubGVuZ3RoLCExKX1yZXR1cm5bYSxbXSx0LG5dfSxiLnByb3RvdHlwZS5jb21wdXRlSW50ZXJmYWNlPWZ1bmN0aW9uKGwpe2Zvcih2YXIgdD17fSxuPXt9LGk9MDtpPHRoaXMuZGF0YXR5cGVEZXNjcmlwdGlvbi5sZW5ndGg7KytpKXtmb3IodmFyIGE9W10sZj0wO2Y8dGhpcy5kYXRhdHlwZURlc2NyaXB0aW9uW2ldWzJdLmxlbmd0aDsrK2YpdFt0aGlzLmRhdGF0eXBlRGVzY3JpcHRpb25baV1bMl1bZl1bMF0uZ2V0VGV4dCgpXT1WLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfQ09OU1RSVUNUT1IsYS5wdXNoKHRoaXMuZGF0YXR5cGVEZXNjcmlwdGlvbltpXVsyXVtmXVswXS5nZXRUZXh0KCkpO25bdGhpcy5kYXRhdHlwZURlc2NyaXB0aW9uW2ldWzFdLmdldFRleHQoKV09YX1yZXR1cm4gbmV3IFYuRHluYW1pY0ludGVyZmFjZShuLHQse30pfSxiLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe2Zvcih2YXIgbD1bXSx0PTA7dDx0aGlzLmRhdGF0eXBlRGVzY3JpcHRpb24ubGVuZ3RoOysrdCl7Zm9yKHZhciBuPVtdLGk9MDtpPHRoaXMuZGF0YXR5cGVEZXNjcmlwdGlvblt0XVsyXS5sZW5ndGg7KytpKXRoaXMuZGF0YXR5cGVEZXNjcmlwdGlvblt0XVsyXVtpXVsxXT09PXZvaWQgMD9uLnB1c2godGhpcy5kYXRhdHlwZURlc2NyaXB0aW9uW3RdWzJdW2ldKTpuLnB1c2goW3RoaXMuZGF0YXR5cGVEZXNjcmlwdGlvblt0XVsyXVtpXVswXSx0aGlzLmRhdGF0eXBlRGVzY3JpcHRpb25bdF1bMl1baV1bMV0uc2ltcGxpZnkoKV0pO2wucHVzaChbdGhpcy5kYXRhdHlwZURlc2NyaXB0aW9uW3RdWzBdLHRoaXMuZGF0YXR5cGVEZXNjcmlwdGlvblt0XVsxXSxuXSl9cmV0dXJuIG5ldyBiKGwpfSxifShjKTt1LkRhdGF0eXBlU3BlY2lmaWNhdGlvbj0kO3ZhciBIPWZ1bmN0aW9uKEYpe2Z1bmN0aW9uIGIobCx0KXt2YXIgbj1GLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIG4ubmFtZT1sLG4ub2xkbmFtZT10LG59cmV0dXJuIGcoYixGKSxiLnByb3RvdHlwZS5lbGFib3JhdGU9ZnVuY3Rpb24obCx0LG4saSl7dmFyIGE9dm9pZCAwO2lmKHRoaXMub2xkbmFtZSBpbnN0YW5jZW9mIEIuTG9uZ0lkZW50aWZpZXJUb2tlbil7dmFyIGY9bC5nZXRBbmRSZXNvbHZlU3RhdGljU3RydWN0dXJlKHRoaXMub2xkbmFtZSk7ZiE9PXZvaWQgMCYmKGE9Zi5nZXRUeXBlKHRoaXMub2xkbmFtZS5pZC5nZXRUZXh0KCkpKX1lbHNlIGE9bC5nZXRTdGF0aWNUeXBlKHRoaXMub2xkbmFtZS5nZXRUZXh0KCkpO2lmKGE9PT12b2lkIDApdGhyb3cgbmV3IEQuRWxhYm9yYXRpb25FcnJvcignVGhlIGRhdGF0eXBlICInK3RoaXMub2xkbmFtZS5nZXRUZXh0KCkrYCIgZG9lc24ndCBleGlzdC5gKTt2YXIgUz1hLnR5cGUuaW5zdGFudGlhdGUobCx0KSxMPW5ldyBWLlN0YXRpY0Jhc2lzKHt9LHt9LHt9LHt9LHt9KTtyZXR1cm4gTC5zZXRUeXBlKHRoaXMubmFtZS5nZXRUZXh0KCksbmV3IE0uRnVuY3Rpb25UeXBlKG5ldyBNLkN1c3RvbVR5cGUodGhpcy5uYW1lLmdldFRleHQoKSxTLnR5cGVBcmd1bWVudHMsdGhpcy5vbGRuYW1lIGluc3RhbmNlb2YgQi5Mb25nSWRlbnRpZmllclRva2VuP3RoaXMub2xkbmFtZTp2b2lkIDApLFMpLFtdLGEuYXJpdHksYS5hbGxvd3NFcXVhbGl0eSksW0wsW10sdCxuXX0sYi5wcm90b3R5cGUuY29tcHV0ZUludGVyZmFjZT1mdW5jdGlvbihsKXt2YXIgdD12b2lkIDA7aWYodGhpcy5vbGRuYW1lIGluc3RhbmNlb2YgQi5Mb25nSWRlbnRpZmllclRva2VuKXt2YXIgbj1sLmdldEFuZFJlc29sdmVEeW5hbWljU3RydWN0dXJlKHRoaXMub2xkbmFtZSk7biE9PXZvaWQgMCYmKHQ9bi5nZXRUeXBlKHRoaXMub2xkbmFtZS5pZC5nZXRUZXh0KCkpKX1lbHNlIHQ9bC5nZXREeW5hbWljVHlwZSh0aGlzLm9sZG5hbWUuZ2V0VGV4dCgpKTtpZih0PT09dm9pZCAwKXRocm93IG5ldyBELkV2YWx1YXRpb25FcnJvcignVGhlIGRhdGF0eXBlICInK3RoaXMub2xkbmFtZS5nZXRUZXh0KCkrJyIgZG9lcyBub3QgZXhpc3QuJyk7Zm9yKHZhciBpPXt9LGE9MDthPHQubGVuZ3RoOysrYSlpW3RbYV1dPVYuSWRlbnRpZmllclN0YXR1cy5WQUxVRV9DT05TVFJVQ1RPUjt2YXIgZj17fTtyZXR1cm4gZlt0aGlzLm5hbWUuZ2V0VGV4dCgpXT10LG5ldyBWLkR5bmFtaWNJbnRlcmZhY2UoZixpLHt9KX0sYn0oYyk7dS5EYXRhdHlwZVJlcGxpY2F0aW9uU3BlY2lmaWNhdGlvbj1IO3ZhciBQPWZ1bmN0aW9uKEYpe2Z1bmN0aW9uIGIobCl7dmFyIHQ9Ri5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiB0LmV4Y2VwdGlvbkRlc2NyaXB0aW9uPWwsdH1yZXR1cm4gZyhiLEYpLGIucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbihsLHQsbixpKXtmb3IodmFyIGE9bmV3IFYuU3RhdGljQmFzaXMoe30se30se30se30se30pLGY9ZnVuY3Rpb24oayl7aWYoUy5leGNlcHRpb25EZXNjcmlwdGlvbltrXVsxXSE9PXZvaWQgMCl7dmFyIFU9Uy5leGNlcHRpb25EZXNjcmlwdGlvbltrXVsxXS5zaW1wbGlmeSgpLmluc3RhbnRpYXRlKGwsbmV3IE1hcCksaj1bXTtpZihVLmdldFR5cGVWYXJpYWJsZXMoKS5mb3JFYWNoKGZ1bmN0aW9uKFgsWil7ai5wdXNoKFopfSksai5sZW5ndGg+MCl0aHJvdyBELkVsYWJvcmF0aW9uRXJyb3IuZ2V0VW5ndWFyZGVkKGopO2Euc2V0VmFsdWUoUy5leGNlcHRpb25EZXNjcmlwdGlvbltrXVswXS5nZXRUZXh0KCksbmV3IE0uRnVuY3Rpb25UeXBlKFUsbmV3IE0uQ3VzdG9tVHlwZSgiZXhuIikpLm5vcm1hbGl6ZSgpWzBdLFYuSWRlbnRpZmllclN0YXR1cy5FWENFUFRJT05fQ09OU1RSVUNUT1IpfWVsc2UgYS5zZXRWYWx1ZShTLmV4Y2VwdGlvbkRlc2NyaXB0aW9uW2tdWzBdLmdldFRleHQoKSxuZXcgTS5DdXN0b21UeXBlKCJleG4iKS5ub3JtYWxpemUoKVswXSxWLklkZW50aWZpZXJTdGF0dXMuRVhDRVBUSU9OX0NPTlNUUlVDVE9SKX0sUz10aGlzLEw9MDtMPHRoaXMuZXhjZXB0aW9uRGVzY3JpcHRpb24ubGVuZ3RoOysrTClmKEwpO3JldHVyblthLFtdLHQsbl19LGIucHJvdG90eXBlLmNvbXB1dGVJbnRlcmZhY2U9ZnVuY3Rpb24obCl7Zm9yKHZhciB0PXt9LG49MDtuPHRoaXMuZXhjZXB0aW9uRGVzY3JpcHRpb24ubGVuZ3RoOysrbil0W3RoaXMuZXhjZXB0aW9uRGVzY3JpcHRpb25bbl1bMF0uZ2V0VGV4dCgpXT1WLklkZW50aWZpZXJTdGF0dXMuRVhDRVBUSU9OX0NPTlNUUlVDVE9SO3JldHVybiBuZXcgVi5EeW5hbWljSW50ZXJmYWNlKHt9LHQse30pfSxiLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe2Zvcih2YXIgbD1bXSx0PTA7dDx0aGlzLmV4Y2VwdGlvbkRlc2NyaXB0aW9uLmxlbmd0aDsrK3QpdGhpcy5leGNlcHRpb25EZXNjcmlwdGlvblt0XVsxXT09PXZvaWQgMD9sLnB1c2godGhpcy5leGNlcHRpb25EZXNjcmlwdGlvblt0XSk6bC5wdXNoKFt0aGlzLmV4Y2VwdGlvbkRlc2NyaXB0aW9uW3RdWzBdLHRoaXMuZXhjZXB0aW9uRGVzY3JpcHRpb25bdF1bMV0uc2ltcGxpZnkoKV0pO3JldHVybiBuZXcgYihsKX0sYn0oYyk7dS5FeGNlcHRpb25TcGVjaWZpY2F0aW9uPVA7dmFyIHg9ZnVuY3Rpb24oRil7ZnVuY3Rpb24gYihsKXt2YXIgdD1GLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIHQuc3RydWN0dXJlRGVzY3JpcHRpb249bCx0fXJldHVybiBnKGIsRiksYi5wcm90b3R5cGUuZWxhYm9yYXRlPWZ1bmN0aW9uKGwsdCxuLGkpe2Zvcih2YXIgYT1uZXcgVi5TdGF0aWNCYXNpcyh7fSx7fSx7fSx7fSx7fSksZj1bXSxTPXQsTD1uLGs9MDtrPHRoaXMuc3RydWN0dXJlRGVzY3JpcHRpb24ubGVuZ3RoOysrayl7dmFyIFU9dGhpcy5zdHJ1Y3R1cmVEZXNjcmlwdGlvbltrXVsxXS5lbGFib3JhdGUobCxTLEwsaSk7Zi5jb25jYXQoVVsxXSksUz1VWzJdLEw9VVszXSxhLnNldFN0cnVjdHVyZSh0aGlzLnN0cnVjdHVyZURlc2NyaXB0aW9uW2tdWzBdLmdldFRleHQoKSxVWzBdKX1yZXR1cm5bYSxmLFMsTF19LGIucHJvdG90eXBlLmNvbXB1dGVJbnRlcmZhY2U9ZnVuY3Rpb24obCl7Zm9yKHZhciB0PXt9LG49MDtuPHRoaXMuc3RydWN0dXJlRGVzY3JpcHRpb24ubGVuZ3RoOysrbil0W3RoaXMuc3RydWN0dXJlRGVzY3JpcHRpb25bbl1bMF0uZ2V0VGV4dCgpXT10aGlzLnN0cnVjdHVyZURlc2NyaXB0aW9uW25dWzFdLmNvbXB1dGVJbnRlcmZhY2UobCk7cmV0dXJuIG5ldyBWLkR5bmFtaWNJbnRlcmZhY2Uoe30se30sdCl9LGIucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7Zm9yKHZhciBsPVtdLHQ9MDt0PHRoaXMuc3RydWN0dXJlRGVzY3JpcHRpb24ubGVuZ3RoOysrdClsLnB1c2goW3RoaXMuc3RydWN0dXJlRGVzY3JpcHRpb25bdF1bMF0sdGhpcy5zdHJ1Y3R1cmVEZXNjcmlwdGlvblt0XVsxXS5zaW1wbGlmeSgpXSk7cmV0dXJuIG5ldyBiKGwpfSxifShjKTt1LlN0cnVjdHVyZVNwZWNpZmljYXRpb249eDt2YXIgUj1mdW5jdGlvbihGKXtmdW5jdGlvbiBiKGwpe3ZhciB0PUYuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gdC5leHByZXNzaW9uPWwsdH1yZXR1cm4gZyhiLEYpLGIucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbihsLHQsbixpKXtmb3IodmFyIGE9bmV3IFYuU3RhdGljQmFzaXMoe30se30se30se30se30pLGY9W10sUz0wO1M8dGhpcy5leHByZXNzaW9uLmxlbmd0aDsrK1Mpe3ZhciBMPXRoaXMuZXhwcmVzc2lvbltTXS5lbGFib3JhdGUobCx0LG4saSk7YT1hLmV4dGVuZChMWzBdKSxmPWYuY29uY2F0KExbMV0pLHQ9TFsyXSxuPUxbM119cmV0dXJuW2EsZix0LG5dfSxiLnByb3RvdHlwZS5jb21wdXRlSW50ZXJmYWNlPWZ1bmN0aW9uKGwpe2Zvcih2YXIgdD1uZXcgVi5EeW5hbWljSW50ZXJmYWNlKHt9LHt9LHt9KSxuPTA7bjx0aGlzLmV4cHJlc3Npb24ubGVuZ3RoOysrbil0PXQuZXh0ZW5kKHRoaXMuZXhwcmVzc2lvbltuXS5jb21wdXRlSW50ZXJmYWNlKGwpKTtyZXR1cm4gdH0sYi5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtmb3IodmFyIGw9W10sdD0wO3Q8dGhpcy5leHByZXNzaW9uLmxlbmd0aDsrK3QpbC5wdXNoKHRoaXMuZXhwcmVzc2lvblt0XS5zaW1wbGlmeSgpKTtyZXR1cm4gbmV3IGIobCl9LGJ9KGMpO3UuSW5jbHVkZVNwZWNpZmljYXRpb249Ujt2YXIgXz1mdW5jdGlvbihGKXtmdW5jdGlvbiBiKCl7cmV0dXJuIEYuY2FsbCh0aGlzKXx8dGhpc31yZXR1cm4gZyhiLEYpLGIucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbihsLHQsbixpKXtyZXR1cm5bbmV3IFYuU3RhdGljQmFzaXMoe30se30se30se30se30pLFtdLHQsbl19LGIucHJvdG90eXBlLmNvbXB1dGVJbnRlcmZhY2U9ZnVuY3Rpb24obCl7cmV0dXJuIG5ldyBWLkR5bmFtaWNJbnRlcmZhY2Uoe30se30se30pfSxifShjKTt1LkVtcHR5U3BlY2lmaWNhdGlvbj1fO3ZhciBXPWZ1bmN0aW9uKEYpe2Z1bmN0aW9uIGIobCl7dmFyIHQ9Ri5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiB0LnNwZWNpZmljYXRpb25zPWwsdH1yZXR1cm4gZyhiLEYpLGIucHJvdG90eXBlLmVsYWJvcmF0ZT1mdW5jdGlvbihsLHQsbixpKXtmb3IodmFyIGE9bmV3IFYuU3RhdGljQmFzaXMoe30se30se30se30se30pLGY9W10sUz1sLEw9MDtMPHRoaXMuc3BlY2lmaWNhdGlvbnMubGVuZ3RoOysrTCl7dmFyIGs9dGhpcy5zcGVjaWZpY2F0aW9uc1tMXS5lbGFib3JhdGUoUyx0LG4saSk7YT1hLmV4dGVuZChrWzBdKSxmPWYuY29uY2F0KGtbMV0pLHQ9a1syXSxuPWtbM10sKFM9Uy5nZXROZXN0ZWRTdGF0ZShTLmlkKSkuc3RhdGljQmFzaXM9a1swXX1yZXR1cm5bYSxmLHQsbl19LGIucHJvdG90eXBlLmNvbXB1dGVJbnRlcmZhY2U9ZnVuY3Rpb24obCl7Zm9yKHZhciB0PW5ldyBWLkR5bmFtaWNJbnRlcmZhY2Uoe30se30se30pLG49MDtuPHRoaXMuc3BlY2lmaWNhdGlvbnMubGVuZ3RoOysrbil0PXQuZXh0ZW5kKHRoaXMuc3BlY2lmaWNhdGlvbnNbbl0uY29tcHV0ZUludGVyZmFjZShsKSk7cmV0dXJuIHR9LGIucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7Zm9yKHZhciBsPVtdLHQ9MDt0PHRoaXMuc3BlY2lmaWNhdGlvbnMubGVuZ3RoOysrdClsLnB1c2godGhpcy5zcGVjaWZpY2F0aW9uc1t0XS5zaW1wbGlmeSgpKTtyZXR1cm4gbmV3IGIobCl9LGJ9KGMpO3UuU2VxdWVudGlhbFNwZWNpZmljYXRpb249Vzt2YXIgUT1mdW5jdGlvbihGKXtmdW5jdGlvbiBiKGwsdCl7dmFyIG49Ri5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBuLnNwZWNpZmljYXRpb249bCxuLnR5cGVOYW1lcz10LG59cmV0dXJuIGcoYixGKSxiLnByb3RvdHlwZS5lbGFib3JhdGU9ZnVuY3Rpb24obCx0LG4saSl7dmFyIGE9dGhpcy5zcGVjaWZpY2F0aW9uLmVsYWJvcmF0ZShsLHQsbixpKSxmPWwuZ2V0TmVzdGVkU3RhdGUoMCk7Zi5zdGF0aWNCYXNpcz1hWzBdO2Zvcih2YXIgUz1bXSxMPVtdLGs9W10sVT0hMSxqPTA7ajx0aGlzLnR5cGVOYW1lcy5sZW5ndGg7KytqKXt2YXIgWD12b2lkIDAsWj1hWzBdLGVlPXRoaXMudHlwZU5hbWVzW2pdLmdldFRleHQoKTtpZih0aGlzLnR5cGVOYW1lc1tqXWluc3RhbmNlb2YgQi5Mb25nSWRlbnRpZmllclRva2VuPyhaPWYuZ2V0QW5kUmVzb2x2ZVN0YXRpY1N0cnVjdHVyZSh0aGlzLnR5cGVOYW1lc1tqXSkpIT09dm9pZCAwJiYoWD1aLmdldFR5cGUodGhpcy50eXBlTmFtZXNbal0uaWQuZ2V0VGV4dCgpKSxlZT10aGlzLnR5cGVOYW1lc1tqXS5pZC5nZXRUZXh0KCkpOlg9Zi5nZXRTdGF0aWNUeXBlKHRoaXMudHlwZU5hbWVzW2pdLmdldFRleHQoKSksWD09PXZvaWQgMHx8Wj09PXZvaWQgMCl0aHJvdyBuZXcgRC5FbGFib3JhdGlvbkVycm9yKCdVbmRlZmluZWQgdHlwZSAiJyt0aGlzLnR5cGVOYW1lc1tqXS5nZXRUZXh0KCkrJyIuJyk7VT1VfHxYLmFsbG93c0VxdWFsaXR5LFMucHVzaChYKSxMLnB1c2goWiksay5wdXNoKGVlKX1mb3Ioaj0xO2o8dGhpcy50eXBlTmFtZXMubGVuZ3RoOysrailMW2pdLnNldFR5cGUoa1tqXSxuZXcgTS5GdW5jdGlvblR5cGUoU1tqXS50eXBlLFNbMF0udHlwZSksW10sMCxVKTtyZXR1cm4gYX0sYi5wcm90b3R5cGUuY29tcHV0ZUludGVyZmFjZT1mdW5jdGlvbihsKXtyZXR1cm4gdGhpcy5zcGVjaWZpY2F0aW9uLmNvbXB1dGVJbnRlcmZhY2UobCl9LGJ9KGMpO3UuU2hhcmluZ1NwZWNpZmljYXRpb249UTt2YXIgbmU9ZnVuY3Rpb24oRil7ZnVuY3Rpb24gYihsKXt2YXIgdD1GLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIHQuYWxpYXM9bCx0fXJldHVybiBnKGIsRiksYi5wcm90b3R5cGUuZWxhYm9yYXRlPWZ1bmN0aW9uKGwsdCxuLGkpe3Rocm93IG5ldyBELkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiQW5kIHlvdSBkb24ndCBzZWVtIHRvIHVuZGVyc3RhbmRcdTIwMjYiKX0sYi5wcm90b3R5cGUuY29tcHV0ZUludGVyZmFjZT1mdW5jdGlvbihsKXt0aHJvdyBuZXcgRC5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIkJlaW5nIGFuIGludGVycHJldGVyIGlzIHN1ZmZlcmluZy4iKX0sYi5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtmb3IodmFyIGw9W10sdD0wO3Q8dGhpcy5hbGlhcy5sZW5ndGg7Kyt0KWwucHVzaChbdGhpcy5hbGlhc1t0XVswXSx0aGlzLmFsaWFzW3RdWzFdXSk7dmFyIG49bmV3IHkobmV3IFQobCkpO2Zvcih0PTA7dDx0aGlzLmFsaWFzLmxlbmd0aDsrK3Qpbj1uZXcgdihuLHRoaXMuYWxpYXNbdF1bMF0sdGhpcy5hbGlhc1t0XVsxXSx0aGlzLmFsaWFzW3RdWzJdKTtyZXR1cm4gbmV3IFIoW25dKS5zaW1wbGlmeSgpfSxifShjKTt1LlR5cGVBbGlhc1NwZWNpZmljYXRpb249bmV9LDIxNTooZmUsdSxLKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh1LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx1LnBhcnNlPXUuUGFyc2VyPXZvaWQgMDt2YXIgbT1LKDQ5NCksZz1LKDY5OSkscz1LKDc1OCkscT1LKDUzNCksQj1LKDY1NSksTT1LKDY3NyksVj1mdW5jdGlvbigpe2Z1bmN0aW9uIEQoaCxBLEksTyl7aWYodGhpcy50b2tlbnM9aCx0aGlzLnN0YXRlPUEsdGhpcy5jdXJyZW50SWQ9SSx0aGlzLm9wdGlvbnM9Tyx0aGlzLnBvc2l0aW9uPTAsdGhpcy5uZXdjb25zPW5ldyBTZXQsdGhpcy5zdGF0ZT09PXZvaWQgMCl0aHJvdyBuZXcgcy5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIldoYXQgYXJlIHlvdSwgc3R1cGlkPyBIdXJyeSB1cCBhbmQgZ2l2ZSBtZSBhIHN0YXRlIGFscmVhZHkhIil9cmV0dXJuIEQucHJvdG90eXBlLmFzc2VydEZpbmlzaGVkPWZ1bmN0aW9uKCl7aWYodGhpcy5wb3NpdGlvbjw9dGhpcy50b2tlbnMubGVuZ3RoLTEpdGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoJ0p1bmsgYWZ0ZXIgZGVjbGFyYXRpb246ICInK3RoaXMuY3VycmVudFRva2VuKCkuZ2V0VGV4dCgpKyciLicpfSxELnByb3RvdHlwZS5hc3NlcnRLZXl3b3JkVG9rZW49ZnVuY3Rpb24oaCxBKXtpZihBPT09dm9pZCAwJiYoQT12b2lkIDApLCEoaCBpbnN0YW5jZW9mIHEuS2V5d29yZFRva2VuKSl0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignRXhwZWN0ZWQgYSByZXNlcnZlZCB3b3JkLCBnb3QgIicraC5nZXRUZXh0KCkrJyIgKCcraC50eXBlTmFtZSgpKyIpLiIpO2lmKEEhPT12b2lkIDAmJmgudGV4dCE9PUEpdGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoJ0V4cGVjdGVkICInK0ErJyIgYnV0IGdvdCAiJytoLnRleHQrJyIuJyl9LEQucHJvdG90eXBlLmFzc2VydFZpZFRva2VuPWZ1bmN0aW9uKGgpe2lmKCFoLmlzVmlkKCkpdGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoJ0V4cGVjdGVkIGFuIGlkZW50aWZpZXIsIGdvdCAiJytoLmdldFRleHQoKSsnIiAoJytoLnR5cGVOYW1lKCkrIikuIil9LEQucHJvdG90eXBlLmFzc2VydElkZW50aWZpZXJUb2tlbj1mdW5jdGlvbihoKXtpZighKGggaW5zdGFuY2VvZiBxLklkZW50aWZpZXJUb2tlbikpdGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoJ0V4cGVjdGVkIGFuIGlkZW50aWZpZXIsIGdvdCAiJytoLmdldFRleHQoKSsnIiAoJytoLnR5cGVOYW1lKCkrIikuIil9LEQucHJvdG90eXBlLmFzc2VydFZpZE9yTG9uZ1Rva2VuPWZ1bmN0aW9uKGgpe2lmKCEoaC5pc1ZpZCgpfHxoIGluc3RhbmNlb2YgcS5Mb25nSWRlbnRpZmllclRva2VuKSl0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignRXhwZWN0ZWQgYW4gaWRlbnRpZmllciwgZ290ICInK2guZ2V0VGV4dCgpKyciICgnK2gudHlwZU5hbWUoKSsiKS4iKX0sRC5wcm90b3R5cGUuYXNzZXJ0SWRlbnRpZmllck9yTG9uZ1Rva2VuPWZ1bmN0aW9uKGgpe2lmKCEoaCBpbnN0YW5jZW9mIHEuSWRlbnRpZmllclRva2VufHxoIGluc3RhbmNlb2YgcS5Mb25nSWRlbnRpZmllclRva2VuKSl0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignRXhwZWN0ZWQgYW4gaWRlbnRpZmllciwgZ290ICInK2guZ2V0VGV4dCgpKyciICgnK2gudHlwZU5hbWUoKSsiKS4iKX0sRC5wcm90b3R5cGUuYXNzZXJ0UmVjb3JkTGFiZWxUb2tlbj1mdW5jdGlvbihoKXtpZighaC5pc1ZhbGlkUmVjb3JkTGFiZWwoKSl0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignRXhwZWN0ZWQgYSByZWNvcmQgbGFiZWwgIicraC5nZXRUZXh0KCkrJyIgKCcraC50eXBlTmFtZSgpKyIpLiIpfSxELnByb3RvdHlwZS5jaGVja1ZpZE9yTG9uZ1Rva2VuPWZ1bmN0aW9uKGgpe3JldHVybiBoLmlzVmlkKCl8fGggaW5zdGFuY2VvZiBxLkxvbmdJZGVudGlmaWVyVG9rZW59LEQucHJvdG90eXBlLmNoZWNrSWRlbnRpZmllck9yTG9uZ1Rva2VuPWZ1bmN0aW9uKGgpe3JldHVybiBoIGluc3RhbmNlb2YgcS5JZGVudGlmaWVyVG9rZW58fGggaW5zdGFuY2VvZiBxLkxvbmdJZGVudGlmaWVyVG9rZW59LEQucHJvdG90eXBlLmNoZWNrS2V5d29yZFRva2VuPWZ1bmN0aW9uKGgsQSl7cmV0dXJuIEE9PT12b2lkIDAmJihBPXZvaWQgMCksaCBpbnN0YW5jZW9mIHEuS2V5d29yZFRva2VuJiYoQT09PXZvaWQgMHx8aC50ZXh0PT09QSl9LEQucHJvdG90eXBlLmd1YXJkU3RhclRva2VuPWZ1bmN0aW9uKGgpe3JldHVybiBoIGluc3RhbmNlb2YgcS5TdGFyVG9rZW4/bmV3IHEuSWRlbnRpZmllclRva2VuKCIqIik6aH0sRC5wcm90b3R5cGUucGFyc2VPcElkZW50aWZpZXJUb2tlbj1mdW5jdGlvbihoKXtoPT09dm9pZCAwJiYoaD0hMSk7dmFyIEE9dGhpcy5jdXJyZW50VG9rZW4oKSxJPXRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oQSwib3AiKTtJJiYrK3RoaXMucG9zaXRpb24saD90aGlzLmFzc2VydElkZW50aWZpZXJPckxvbmdUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpKTp0aGlzLmFzc2VydElkZW50aWZpZXJUb2tlbih0aGlzLmd1YXJkU3RhclRva2VuKHRoaXMuY3VycmVudFRva2VuKCkpKTt2YXIgTz10aGlzLmN1cnJlbnRUb2tlbigpO3JldHVybiBPLm9wUHJlZml4ZWQ9SSwrK3RoaXMucG9zaXRpb24sT30sRC5wcm90b3R5cGUucGFyc2VBdG9taWNFeHByZXNzaW9uPWZ1bmN0aW9uKCl7dmFyIGg9dGhpcy5jdXJyZW50VG9rZW4oKTtpZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKGgsIm9wIikpeysrdGhpcy5wb3NpdGlvbjt2YXIgQT10aGlzLmN1cnJlbnRUb2tlbigpO3JldHVybiB0aGlzLmFzc2VydFZpZE9yTG9uZ1Rva2VuKEEpLEEub3BQcmVmaXhlZD0hMCwrK3RoaXMucG9zaXRpb24sbmV3IG0uVmFsdWVJZGVudGlmaWVyKEEpfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oaCwieyIpKXJldHVybisrdGhpcy5wb3NpdGlvbix0aGlzLnBhcnNlRXhwcmVzc2lvblJvdygpO2lmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oaCwiKCIpKXtpZigrK3RoaXMucG9zaXRpb24sdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCIpIikpcmV0dXJuKyt0aGlzLnBvc2l0aW9uLG5ldyBtLlR1cGxlKFtdKTtmb3IodmFyIEk9W3RoaXMucGFyc2VFeHByZXNzaW9uKCldLE89ITEsRT0hMTs7KWlmKEE9dGhpcy5jdXJyZW50VG9rZW4oKSwhdGhpcy5jaGVja0tleXdvcmRUb2tlbihBLCIsIil8fE8pe2lmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oQSwiOyIpJiYhRSl7aWYoKyt0aGlzLnBvc2l0aW9uLE89ITAsIXRoaXMub3B0aW9ucy5hbGxvd1N1Y2Nlc3Nvck1MfHwhdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCIpIikpe0kucHVzaCh0aGlzLnBhcnNlRXhwcmVzc2lvbigpKTtjb250aW51ZX1BPXRoaXMuY3VycmVudFRva2VuKCl9aWYoIXRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oQSwiKSIpKXRocm93IG5ldyBzLlBhcnNlckVycm9yKCdFeHBlY3RlZCAiLCIsICI7IiBvciAiKSIgYnV0IGdvdCAiJytBLmdldFRleHQoKSsnIi4nKTtpZigrK3RoaXMucG9zaXRpb24sSS5sZW5ndGg9PT0xKXJldHVybiBJWzBdO2lmKEUpcmV0dXJuIG5ldyBtLlR1cGxlKEkpO2lmKE8pcmV0dXJuIG5ldyBtLlNlcXVlbmNlKEkpO0kucHVzaCh0aGlzLnBhcnNlRXhwcmVzc2lvbigpKX1lbHNlKyt0aGlzLnBvc2l0aW9uLEU9ITAsSS5wdXNoKHRoaXMucGFyc2VFeHByZXNzaW9uKCkpfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oaCwiWyIpKXtpZigrK3RoaXMucG9zaXRpb24sdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCJdIikpcmV0dXJuKyt0aGlzLnBvc2l0aW9uLG5ldyBtLkxpc3QoW10pO2ZvcihJPVt0aGlzLnBhcnNlRXhwcmVzc2lvbigpXTs7KXtpZihBPXRoaXMuY3VycmVudFRva2VuKCksIXRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oQSwiLCIpKXtpZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKEEsIl0iKSlyZXR1cm4rK3RoaXMucG9zaXRpb24sbmV3IG0uTGlzdChJKTt0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignRXhwZWN0ZWQgIiwiIG9yICJdIiBidXQgZm91bmQgIicrQS5nZXRUZXh0KCkrJyIuJyl9Kyt0aGlzLnBvc2l0aW9uLEkucHVzaCh0aGlzLnBhcnNlRXhwcmVzc2lvbigpKX19aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihoLCIjIikpeysrdGhpcy5wb3NpdGlvbjt2YXIgcj10aGlzLmN1cnJlbnRUb2tlbigpO2lmKHRoaXMub3B0aW9ucy5hbGxvd1ZlY3RvciYmdGhpcy5jaGVja0tleXdvcmRUb2tlbihyLCJbIikpe2lmKCsrdGhpcy5wb3NpdGlvbix0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIl0iKSlyZXR1cm4rK3RoaXMucG9zaXRpb24sbmV3IG0uVmVjdG9yKFtdKTtmb3IoST1bdGhpcy5wYXJzZUV4cHJlc3Npb24oKV07Oyl7aWYoQT10aGlzLmN1cnJlbnRUb2tlbigpLCF0aGlzLmNoZWNrS2V5d29yZFRva2VuKEEsIiwiKSl7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihBLCJdIikpcmV0dXJuKyt0aGlzLnBvc2l0aW9uLG5ldyBtLlZlY3RvcihJKTt0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignRXhwZWN0ZWQgIiwiIG9yICJdIiBidXQgZm91bmQgIicrQS5nZXRUZXh0KCkrJyIuJyl9Kyt0aGlzLnBvc2l0aW9uLEkucHVzaCh0aGlzLnBhcnNlRXhwcmVzc2lvbigpKX19cmV0dXJuIHRoaXMuYXNzZXJ0UmVjb3JkTGFiZWxUb2tlbihyKSwrK3RoaXMucG9zaXRpb24sbmV3IG0uUmVjb3JkU2VsZWN0b3Iocil9aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihoLCJsZXQiKSl7Kyt0aGlzLnBvc2l0aW9uO3ZhciBlPXRoaXMuc3RhdGU7dGhpcy5zdGF0ZT10aGlzLnN0YXRlLmdldE5lc3RlZFN0YXRlKHRoaXMuc3RhdGUuaWQpO3ZhciBvPW5ldyBTZXQ7dGhpcy5uZXdjb25zLmZvckVhY2goZnVuY3Rpb24oQyl7bz1vLmFkZChDKX0pO3ZhciB5PXRoaXMucGFyc2VEZWNsYXJhdGlvbigpO3RoaXMuYXNzZXJ0S2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImluIiksKyt0aGlzLnBvc2l0aW9uO2Zvcih2YXIgZD1bdGhpcy5wYXJzZUV4cHJlc3Npb24oKV0sdj10aGlzLmN1cnJlbnRUb2tlbigpO3RoaXMuY2hlY2tLZXl3b3JkVG9rZW4odiwiOyIpOyl7aWYoKyt0aGlzLnBvc2l0aW9uLHRoaXMub3B0aW9ucy5hbGxvd1N1Y2Nlc3Nvck1MJiZ0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImVuZCIpKXt2PXRoaXMuY3VycmVudFRva2VuKCk7YnJlYWt9ZC5wdXNoKHRoaXMucGFyc2VFeHByZXNzaW9uKCkpLHY9dGhpcy5jdXJyZW50VG9rZW4oKX1yZXR1cm4gdGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odiwiZW5kIiksKyt0aGlzLnBvc2l0aW9uLHRoaXMuc3RhdGU9ZSx0aGlzLm5ld2NvbnM9byxkLmxlbmd0aD49Mj9uZXcgbS5Mb2NhbERlY2xhcmF0aW9uRXhwcmVzc2lvbih5LG5ldyBtLlNlcXVlbmNlKGQpKTpuZXcgbS5Mb2NhbERlY2xhcmF0aW9uRXhwcmVzc2lvbih5LGRbMF0pfWlmKGggaW5zdGFuY2VvZiBxLkNvbnN0YW50VG9rZW4pcmV0dXJuKyt0aGlzLnBvc2l0aW9uLG5ldyBtLkNvbnN0YW50KGgpO2lmKGguaXNWaWQoKXx8aCBpbnN0YW5jZW9mIHEuTG9uZ0lkZW50aWZpZXJUb2tlbil7aWYoKyt0aGlzLnBvc2l0aW9uLHRoaXMuc3RhdGUuZ2V0SW5maXhTdGF0dXMoaCkhPT12b2lkIDAmJnRoaXMuc3RhdGUuZ2V0SW5maXhTdGF0dXMoaCkuaW5maXgpdGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoJ0luZml4IG9wZXJhdG9yICInK2guZ2V0VGV4dCgpKyciIGFwcGVhcmVkIGluIG5vbi1pbmZpeCBjb250ZXh0IHdpdGhvdXQgIm9wIi4nKTtyZXR1cm4gbmV3IG0uVmFsdWVJZGVudGlmaWVyKGgpfXRocm93IG5ldyBzLlBhcnNlckVycm9yKCdFeHBlY3RlZCBhdG9taWMgZXhwcmVzc2lvbiwgIicraC5nZXRUZXh0KCkrJyIgZm91bmQuJyl9LEQucHJvdG90eXBlLnBhcnNlRXhwcmVzc2lvblJvdz1mdW5jdGlvbigpe2Zvcih2YXIgaD1bXSxBPSEwOzspe3ZhciBJPXRoaXMuY3VycmVudFRva2VuKCk7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihJLCJ9IikpcmV0dXJuKyt0aGlzLnBvc2l0aW9uLG5ldyBtLlJlY29yZCghMCxoKTtpZihBfHwhdGhpcy5jaGVja0tleXdvcmRUb2tlbihJLCIsIikpe2lmKEE9ITEsIUkuaXNWYWxpZFJlY29yZExhYmVsKCkpdGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoJ0V4cGVjdGVkICJ9Iiwgb3IgaWRlbnRpZmllciwgZ290ICInK0kuZ2V0VGV4dCgpKyciLicpOysrdGhpcy5wb3NpdGlvbjt2YXIgTz10aGlzLmN1cnJlbnRUb2tlbigpO3RoaXMuYXNzZXJ0S2V5d29yZFRva2VuKE8sIj0iKSwrK3RoaXMucG9zaXRpb24saC5wdXNoKFtJLmdldFRleHQoKSx0aGlzLnBhcnNlRXhwcmVzc2lvbigpXSl9ZWxzZSsrdGhpcy5wb3NpdGlvbn19LEQucHJvdG90eXBlLnBhcnNlQXBwbGljYXRpb25FeHByZXNzaW9uPWZ1bmN0aW9uKCl7Zm9yKHZhciBoPXRoaXMucGFyc2VBdG9taWNFeHByZXNzaW9uKCk7Oyl7dmFyIEE9dGhpcy5wb3NpdGlvbixJPXRoaXMuY3VycmVudFRva2VuKCk7aWYodGhpcy5jaGVja1ZpZE9yTG9uZ1Rva2VuKEkpJiZ0aGlzLnN0YXRlLmdldEluZml4U3RhdHVzKEkpIT09dm9pZCAwJiZ0aGlzLnN0YXRlLmdldEluZml4U3RhdHVzKEkpLmluZml4KWJyZWFrO3RyeXt2YXIgTz10aGlzLnBhcnNlQXRvbWljRXhwcmVzc2lvbigpO2g9bmV3IG0uRnVuY3Rpb25BcHBsaWNhdGlvbihoLE8pfWNhdGNoKEUpe2lmKEUgaW5zdGFuY2VvZiBzLkluY29tcGxldGVFcnJvcil0aHJvdyBFO3RoaXMucG9zaXRpb249QTticmVha319cmV0dXJuIGh9LEQucHJvdG90eXBlLnBhcnNlSW5maXhFeHByZXNzaW9uPWZ1bmN0aW9uKCl7Zm9yKHZhciBoPVtdLEE9W10sST0wOzspe2gucHVzaCh0aGlzLnBhcnNlQXBwbGljYXRpb25FeHByZXNzaW9uKCkpO3ZhciBPPXRoaXMuY3VycmVudFRva2VuKCk7aWYoIXRoaXMuY2hlY2tWaWRPckxvbmdUb2tlbihPKXx8dGhpcy5zdGF0ZS5nZXRJbmZpeFN0YXR1cyhPKT09PXZvaWQgMHx8IXRoaXMuc3RhdGUuZ2V0SW5maXhTdGF0dXMoTykuaW5maXgpYnJlYWs7Kyt0aGlzLnBvc2l0aW9uLEEucHVzaChbTyxJKytdKX1yZXR1cm4gST09PTA/aFswXTpuZXcgbS5JbmZpeEV4cHJlc3Npb24oaCxBKS5yZVBhcnNlKHRoaXMuc3RhdGUpfSxELnByb3RvdHlwZS5wYXJzZUFwcGVuZGVkRXhwcmVzc2lvbj1mdW5jdGlvbigpe3ZhciBoPXRoaXMuY3VycmVudFRva2VuKCk7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihoLCJyYWlzZSIpKXJldHVybisrdGhpcy5wb3NpdGlvbixuZXcgbS5SYWlzZUV4Y2VwdGlvbih0aGlzLnBhcnNlRXhwcmVzc2lvbigpKTtpZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKGgsImlmIikpeysrdGhpcy5wb3NpdGlvbjt2YXIgQT10aGlzLnBhcnNlRXhwcmVzc2lvbigpO3RoaXMuYXNzZXJ0S2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksInRoZW4iKSwrK3RoaXMucG9zaXRpb247dmFyIEk9dGhpcy5wYXJzZUV4cHJlc3Npb24oKTtyZXR1cm4gdGhpcy5vcHRpb25zLmFsbG93U3VjY2Vzc29yTUwmJiF0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImVsc2UiKT9uZXcgbS5Db25kaXRpb25hbChBLEksbmV3IG0uVHVwbGUoW10pKToodGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiZWxzZSIpLCsrdGhpcy5wb3NpdGlvbixuZXcgbS5Db25kaXRpb25hbChBLEksdGhpcy5wYXJzZUV4cHJlc3Npb24oKSkpfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oaCwiY2FzZSIpKXJldHVybisrdGhpcy5wb3NpdGlvbixBPXRoaXMucGFyc2VFeHByZXNzaW9uKCksdGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwib2YiKSwrK3RoaXMucG9zaXRpb24sbmV3IG0uQ2FzZUFuYWx5c2lzKEEsdGhpcy5wYXJzZU1hdGNoKCkpO2lmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oaCwid2hpbGUiKSlyZXR1cm4rK3RoaXMucG9zaXRpb24sQT10aGlzLnBhcnNlRXhwcmVzc2lvbigpLHRoaXMuYXNzZXJ0S2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImRvIiksKyt0aGlzLnBvc2l0aW9uLG5ldyBtLldoaWxlKEEsdGhpcy5wYXJzZUV4cHJlc3Npb24oKSk7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihoLCJmbiIpKXJldHVybisrdGhpcy5wb3NpdGlvbixuZXcgbS5MYW1iZGEodGhpcy5wYXJzZU1hdGNoKCkpO2Zvcih2YXIgTz10aGlzLnBhcnNlSW5maXhFeHByZXNzaW9uKCksRT10aGlzLmN1cnJlbnRUb2tlbigpO3RoaXMuY2hlY2tLZXl3b3JkVG9rZW4oRSwiOiIpOykrK3RoaXMucG9zaXRpb24sTz1uZXcgbS5UeXBlZEV4cHJlc3Npb24oTyx0aGlzLnBhcnNlVHlwZSgpKSxFPXRoaXMuY3VycmVudFRva2VuKCk7cmV0dXJuIE99LEQucHJvdG90eXBlLnBhcnNlRXhwcmVzc2lvbj1mdW5jdGlvbigpe3ZhciBoPXRoaXMucGFyc2VBcHBlbmRlZEV4cHJlc3Npb24oKSxBPXRoaXMuY3VycmVudFRva2VuKCk7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihBLCJhbmRhbHNvIil8fHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oQSwib3JlbHNlIikpe2Zvcih2YXIgST1bW2gsWzBdXV0sTz1bXSxFPTA7Oyl7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihBLCJvcmVsc2UiKSlPLnB1c2goWzEsRSsrXSksKyt0aGlzLnBvc2l0aW9uO2Vsc2V7aWYoIXRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oQSwiYW5kYWxzbyIpKWJyZWFrO08ucHVzaChbMCxFKytdKSwrK3RoaXMucG9zaXRpb259SS5wdXNoKFt0aGlzLnBhcnNlQXBwZW5kZWRFeHByZXNzaW9uKCksW0VdXSksQT10aGlzLmN1cnJlbnRUb2tlbigpfU8uc29ydCgpO2Zvcih2YXIgcj0wO3I8Ty5sZW5ndGg7KytyKXt2YXIgZSxvPUlbT1tyXVsxXV1bMF0seT1JW09bcl1bMV0rMV1bMF07ZT1PW3JdWzBdPT09MD9uZXcgbS5Db25qdW5jdGlvbihvLHkpOm5ldyBtLkRpc2p1bmN0aW9uKG8seSk7Zm9yKHZhciBkPUlbT1tyXVsxXV1bMV0sdj0wLEM9SVtPW3JdWzFdKzFdWzFdO3Y8Qy5sZW5ndGg7disrKXt2YXIgRz1DW3ZdO2QucHVzaChHKX1mb3IodmFyIFk9MCxKPWQ7WTxKLmxlbmd0aDtZKyspSVtHPUpbWV1dPVtlLGRdfWg9SVswXVswXX1mb3IoQT10aGlzLmN1cnJlbnRUb2tlbigpO3RoaXMuY2hlY2tLZXl3b3JkVG9rZW4oQSwiaGFuZGxlIik7KSsrdGhpcy5wb3NpdGlvbixoPW5ldyBtLkhhbmRsZUV4Y2VwdGlvbihoLHRoaXMucGFyc2VNYXRjaCgpKSxBPXRoaXMuY3VycmVudFRva2VuKCk7cmV0dXJuIGh9LEQucHJvdG90eXBlLnBhcnNlU2ltcGxlU3RydWN0dXJlRXhwcmVzc2lvbj1mdW5jdGlvbigpe3ZhciBoPXRoaXMuY3VycmVudFRva2VuKCk7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihoLCJzdHJ1Y3QiKSl7Kyt0aGlzLnBvc2l0aW9uO3ZhciBBPXRoaXMucGFyc2VEZWNsYXJhdGlvbighMSwhMCk7cmV0dXJuIHRoaXMuYXNzZXJ0S2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImVuZCIpLCsrdGhpcy5wb3NpdGlvbixuZXcgTS5TdHJ1Y3R1cmVFeHByZXNzaW9uKEEpfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oaCwibGV0IikpeysrdGhpcy5wb3NpdGlvbixBPXRoaXMucGFyc2VEZWNsYXJhdGlvbighMSwhMCksdGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiaW4iKSwrK3RoaXMucG9zaXRpb247dmFyIEk9dGhpcy5wYXJzZVN0cnVjdHVyZUV4cHJlc3Npb24oKTtyZXR1cm4gdGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiZW5kIiksKyt0aGlzLnBvc2l0aW9uLG5ldyBNLkxvY2FsRGVjbGFyYXRpb25TdHJ1Y3R1cmVFeHByZXNzaW9uKEEsSSl9aWYoaCBpbnN0YW5jZW9mIHEuSWRlbnRpZmllclRva2VuKWlmKCsrdGhpcy5wb3NpdGlvbix0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIigiKSl7Kyt0aGlzLnBvc2l0aW9uO3ZhciBPPXRoaXMucG9zaXRpb247dHJ5e3JldHVybiBJPXRoaXMucGFyc2VTdHJ1Y3R1cmVFeHByZXNzaW9uKCksdGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiKSIpLCsrdGhpcy5wb3NpdGlvbixuZXcgTS5GdW5jdG9yQXBwbGljYXRpb24oaCxJKX1jYXRjaHtyZXR1cm4gdGhpcy5wb3NpdGlvbj1PLEE9dGhpcy5wYXJzZURlY2xhcmF0aW9uKCExLCEwKSx0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCIpIiksKyt0aGlzLnBvc2l0aW9uLG5ldyBNLkZ1bmN0b3JBcHBsaWNhdGlvbihoLG5ldyBNLlN0cnVjdHVyZUV4cHJlc3Npb24oQSkpfX1lbHNlLS10aGlzLnBvc2l0aW9uO2lmKHRoaXMuY2hlY2tJZGVudGlmaWVyT3JMb25nVG9rZW4oaCkpcmV0dXJuKyt0aGlzLnBvc2l0aW9uLG5ldyBNLlN0cnVjdHVyZUlkZW50aWZpZXIoaCk7dGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoIkV4cGVjdGVkIGEgc2ltcGxlIHN0cnVjdHVyZSBleHByZXNzaW9uLiIpfSxELnByb3RvdHlwZS5wYXJzZVN0cnVjdHVyZUV4cHJlc3Npb249ZnVuY3Rpb24oKXtmb3IodmFyIGg9dGhpcy5wYXJzZVNpbXBsZVN0cnVjdHVyZUV4cHJlc3Npb24oKTs7KWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiOiIpKSsrdGhpcy5wb3NpdGlvbixoPW5ldyBNLlRyYW5zcGFyZW50Q29uc3RyYWludChoLHRoaXMucGFyc2VTaWduYXR1cmVFeHByZXNzaW9uKCkpO2Vsc2V7aWYoIXRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiOj4iKSlicmVhazsrK3RoaXMucG9zaXRpb24saD1uZXcgTS5PcGFxdWVDb25zdHJhaW50KGgsdGhpcy5wYXJzZVNpZ25hdHVyZUV4cHJlc3Npb24oKSl9cmV0dXJuIGh9LEQucHJvdG90eXBlLnBhcnNlU2ltcGxlU2lnbmF0dXJlRXhwcmVzc2lvbj1mdW5jdGlvbigpe3ZhciBoPXRoaXMuY3VycmVudFRva2VuKCk7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihoLCJzaWciKSl7Kyt0aGlzLnBvc2l0aW9uO3ZhciBBPXRoaXMucGFyc2VTcGVjaWZpY2F0aW9uKCk7cmV0dXJuIHRoaXMuYXNzZXJ0S2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImVuZCIpLCsrdGhpcy5wb3NpdGlvbixuZXcgTS5TaWduYXR1cmVFeHByZXNzaW9uKEEpfWlmKGggaW5zdGFuY2VvZiBxLklkZW50aWZpZXJUb2tlbilyZXR1cm4rK3RoaXMucG9zaXRpb24sbmV3IE0uU2lnbmF0dXJlSWRlbnRpZmllcihoKTt0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcigiRXhwZWN0ZWQgYSBzaW1wbGUgc2lnbmF0dXJlIGV4cHJlc3Npb24uIil9LEQucHJvdG90eXBlLnBhcnNlU2lnbmF0dXJlRXhwcmVzc2lvbj1mdW5jdGlvbigpe2Zvcih2YXIgaD10aGlzLnBhcnNlU2ltcGxlU2lnbmF0dXJlRXhwcmVzc2lvbigpLEE9ITA7dGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCJ3aGVyZSIpfHwhQSYmdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCJhbmQiKTspe0E9ITEsKyt0aGlzLnBvc2l0aW9uLHRoaXMuYXNzZXJ0S2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksInR5cGUiKSwrK3RoaXMucG9zaXRpb247dmFyIEk9dGhpcy5wYXJzZVR5cGVWYXJTZXF1ZW5jZSgpO3RoaXMuYXNzZXJ0SWRlbnRpZmllck9yTG9uZ1Rva2VuKHRoaXMuY3VycmVudFRva2VuKCkpO3ZhciBPPXRoaXMuY3VycmVudFRva2VuKCk7Kyt0aGlzLnBvc2l0aW9uLHRoaXMuYXNzZXJ0S2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIj0iKSwrK3RoaXMucG9zaXRpb24saD1uZXcgTS5UeXBlUmVhbGlzYXRpb24oaCxJLE8sdGhpcy5wYXJzZVR5cGUoKSl9cmV0dXJuIGh9LEQucHJvdG90eXBlLnBhcnNlU2ltcGxlU3BlY2lmaWNhdGlvbj1mdW5jdGlvbigpe3ZhciBoPXRoaXMuY3VycmVudFRva2VuKCk7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihoLCJ2YWwiKSl7Kyt0aGlzLnBvc2l0aW9uO2Zvcih2YXIgQT1bXTs7KXt0aGlzLmFzc2VydElkZW50aWZpZXJPckxvbmdUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpKTt2YXIgST10aGlzLmN1cnJlbnRUb2tlbigpO2lmKCsrdGhpcy5wb3NpdGlvbix0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI6IiksKyt0aGlzLnBvc2l0aW9uLEEucHVzaChbSSx0aGlzLnBhcnNlVHlwZSgpXSksIXRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiYW5kIikpYnJlYWs7Kyt0aGlzLnBvc2l0aW9ufXJldHVybiBuZXcgTS5WYWx1ZVNwZWNpZmljYXRpb24oQSl9aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihoLCJ0eXBlIikpeysrdGhpcy5wb3NpdGlvbixBPVtdO2Zvcih2YXIgTz10aGlzLnBvc2l0aW9uOzspe3ZhciBFPXRoaXMucGFyc2VUeXBlVmFyU2VxdWVuY2UoKTtpZih0aGlzLmFzc2VydElkZW50aWZpZXJUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpKSxBLnB1c2goW0UsdGhpcy5jdXJyZW50VG9rZW4oKV0pLCsrdGhpcy5wb3NpdGlvbix0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIj0iKSl7dmFyIHI9W107Zm9yKHRoaXMucG9zaXRpb249TztFPXRoaXMucGFyc2VUeXBlVmFyU2VxdWVuY2UoKSx0aGlzLmFzc2VydElkZW50aWZpZXJUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpKSxJPXRoaXMuY3VycmVudFRva2VuKCksKyt0aGlzLnBvc2l0aW9uLHRoaXMuYXNzZXJ0S2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIj0iKSwrK3RoaXMucG9zaXRpb24sci5wdXNoKFtFLEksdGhpcy5wYXJzZVR5cGUoKV0pLHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiYW5kIik7KSsrdGhpcy5wb3NpdGlvbjtyZXR1cm4gbmV3IE0uVHlwZUFsaWFzU3BlY2lmaWNhdGlvbihyKX1pZighdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCJhbmQiKSlicmVhazsrK3RoaXMucG9zaXRpb259cmV0dXJuIG5ldyBNLlR5cGVTcGVjaWZpY2F0aW9uKEEpfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oaCwiZXF0eXBlIikpe2ZvcigrK3RoaXMucG9zaXRpb24sQT1bXTtFPXRoaXMucGFyc2VUeXBlVmFyU2VxdWVuY2UoKSx0aGlzLmFzc2VydElkZW50aWZpZXJUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpKSxBLnB1c2goW0UsdGhpcy5jdXJyZW50VG9rZW4oKV0pLCsrdGhpcy5wb3NpdGlvbix0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImFuZCIpOykrK3RoaXMucG9zaXRpb247cmV0dXJuIG5ldyBNLkVxdWFsaXR5VHlwZVNwZWNpZmljYXRpb24oQSl9aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihoLCJkYXRhdHlwZSIpKXtpZigrK3RoaXMucG9zaXRpb24sdGhpcy5wb3NpdGlvbisyPHRoaXMudG9rZW5zLmxlbmd0aCYmdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLnRva2Vuc1t0aGlzLnBvc2l0aW9uKzJdLCJkYXRhdHlwZSIpKXt0aGlzLmFzc2VydElkZW50aWZpZXJUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpKTt2YXIgZT10aGlzLmN1cnJlbnRUb2tlbigpOysrdGhpcy5wb3NpdGlvbix0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI9IiksKyt0aGlzLnBvc2l0aW9uLHRoaXMuYXNzZXJ0S2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImRhdGF0eXBlIiksKyt0aGlzLnBvc2l0aW9uLHRoaXMuYXNzZXJ0SWRlbnRpZmllck9yTG9uZ1Rva2VuKHRoaXMuY3VycmVudFRva2VuKCkpO3ZhciBvPXRoaXMuY3VycmVudFRva2VuKCk7cmV0dXJuKyt0aGlzLnBvc2l0aW9uLG5ldyBNLkRhdGF0eXBlUmVwbGljYXRpb25TcGVjaWZpY2F0aW9uKGUsbyl9Zm9yKEE9W107Oyl7RT10aGlzLnBhcnNlVHlwZVZhclNlcXVlbmNlKCksdGhpcy5hc3NlcnRJZGVudGlmaWVyVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSksZT10aGlzLmN1cnJlbnRUb2tlbigpLCsrdGhpcy5wb3NpdGlvbix0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI9IiksKyt0aGlzLnBvc2l0aW9uLHRoaXMub3B0aW9ucy5hbGxvd1N1Y2Nlc3Nvck1MPT09ITAmJnRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwifCIpJiYrK3RoaXMucG9zaXRpb247Zm9yKHZhciB5PVtdOzspe3RoaXMuYXNzZXJ0SWRlbnRpZmllclRva2VuKHRoaXMuY3VycmVudFRva2VuKCkpO3ZhciBkPXRoaXMuY3VycmVudFRva2VuKCk7Kyt0aGlzLnBvc2l0aW9uO3ZhciB2PXZvaWQgMDtpZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIm9mIikmJigrK3RoaXMucG9zaXRpb24sdj10aGlzLnBhcnNlVHlwZSgpKSx5LnB1c2goW2Qsdl0pLCF0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksInwiKSlicmVhazsrK3RoaXMucG9zaXRpb259aWYoQS5wdXNoKFtFLGUseV0pLCF0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImFuZCIpKWJyZWFrOysrdGhpcy5wb3NpdGlvbn1yZXR1cm4gbmV3IE0uRGF0YXR5cGVTcGVjaWZpY2F0aW9uKEEpfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oaCwiZXhjZXB0aW9uIikpe2ZvcigrK3RoaXMucG9zaXRpb24sQT1bXTt0aGlzLmFzc2VydElkZW50aWZpZXJUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpKSxlPXRoaXMuY3VycmVudFRva2VuKCksKyt0aGlzLnBvc2l0aW9uLHY9dm9pZCAwLHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwib2YiKSYmKCsrdGhpcy5wb3NpdGlvbix2PXRoaXMucGFyc2VUeXBlKCkpLEEucHVzaChbZSx2XSksdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCJhbmQiKTspKyt0aGlzLnBvc2l0aW9uO3JldHVybiBuZXcgTS5FeGNlcHRpb25TcGVjaWZpY2F0aW9uKEEpfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oaCwic3RydWN0dXJlIikpe2ZvcigrK3RoaXMucG9zaXRpb24sQT1bXTt0aGlzLmFzc2VydElkZW50aWZpZXJUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpKSxlPXRoaXMuY3VycmVudFRva2VuKCksKyt0aGlzLnBvc2l0aW9uLHRoaXMuYXNzZXJ0S2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIjoiKSwrK3RoaXMucG9zaXRpb24sQS5wdXNoKFtlLHRoaXMucGFyc2VTaWduYXR1cmVFeHByZXNzaW9uKCldKSx0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImFuZCIpOykrK3RoaXMucG9zaXRpb247cmV0dXJuIG5ldyBNLlN0cnVjdHVyZVNwZWNpZmljYXRpb24oQSl9aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihoLCJpbmNsdWRlIikpeysrdGhpcy5wb3NpdGlvbjt2YXIgQz1bXSxHPXRoaXMucG9zaXRpb247dHJ5e2Zvcig7OylDLnB1c2godGhpcy5wYXJzZVNpZ25hdHVyZUV4cHJlc3Npb24oKSksRz10aGlzLnBvc2l0aW9ufWNhdGNoe3RoaXMucG9zaXRpb249R31yZXR1cm4gbmV3IE0uSW5jbHVkZVNwZWNpZmljYXRpb24oQyl9cmV0dXJuIG5ldyBNLkVtcHR5U3BlY2lmaWNhdGlvbn0sRC5wcm90b3R5cGUucGFyc2VTZXF1ZW50aWFsU3BlY2lmaWNhdGlvbj1mdW5jdGlvbigpe2Zvcih2YXIgaD1bXTs7KXt2YXIgQT10aGlzLnBhcnNlU2ltcGxlU3BlY2lmaWNhdGlvbigpO2lmKEEgaW5zdGFuY2VvZiBNLkVtcHR5U3BlY2lmaWNhdGlvbilicmVhaztoLnB1c2goQSksdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI7IikmJisrdGhpcy5wb3NpdGlvbn1yZXR1cm4gbmV3IE0uU2VxdWVudGlhbFNwZWNpZmljYXRpb24oaCl9LEQucHJvdG90eXBlLnBhcnNlU3BlY2lmaWNhdGlvbj1mdW5jdGlvbigpe2Zvcih2YXIgaD10aGlzLnBhcnNlU2VxdWVudGlhbFNwZWNpZmljYXRpb24oKTt0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksInNoYXJpbmciKTspeysrdGhpcy5wb3NpdGlvbix0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCJ0eXBlIiksKyt0aGlzLnBvc2l0aW9uLHRoaXMuYXNzZXJ0SWRlbnRpZmllck9yTG9uZ1Rva2VuKHRoaXMuY3VycmVudFRva2VuKCkpO3ZhciBBPVt0aGlzLmN1cnJlbnRUb2tlbigpXTtmb3IoKyt0aGlzLnBvc2l0aW9uO3RoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiPSIpOykrK3RoaXMucG9zaXRpb24sdGhpcy5hc3NlcnRJZGVudGlmaWVyT3JMb25nVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSksQS5wdXNoKHRoaXMuY3VycmVudFRva2VuKCkpLCsrdGhpcy5wb3NpdGlvbjtpZihBLmxlbmd0aDwyKXRocm93IG5ldyBzLlBhcnNlckVycm9yKCdBICJzaGFyaW5nIiBleHByZXNzaW9uIHJlcXVpcmVzIGF0IGxlYXN0IDIgdHlwZSBuYW1lcy4nKTtoPW5ldyBNLlNoYXJpbmdTcGVjaWZpY2F0aW9uKGgsQSl9cmV0dXJuIGh9LEQucHJvdG90eXBlLnBhcnNlTWF0Y2g9ZnVuY3Rpb24oKXt0aGlzLm9wdGlvbnMuYWxsb3dTdWNjZXNzb3JNTCYmdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCJ8IikmJisrdGhpcy5wb3NpdGlvbjtmb3IodmFyIGg9W107Oyl7dmFyIEE9dGhpcy5wYXJzZVBhdHRlcm4oKTtBLnNpbXBsaWZ5KCkuYXNzZXJ0VW5pcXVlQmluZGluZyh0aGlzLnN0YXRlLHRoaXMubmV3Y29ucyksdGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiPT4iKSwrK3RoaXMucG9zaXRpb247dmFyIEk9dGhpcy5wYXJzZUV4cHJlc3Npb24oKTtpZihoLnB1c2goW0EsSV0pLCF0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksInwiKSlicmVhazsrK3RoaXMucG9zaXRpb259cmV0dXJuIG5ldyBtLk1hdGNoKGgpfSxELnByb3RvdHlwZS5wYXJzZVBhdHRlcm5Sb3c9ZnVuY3Rpb24oKXtmb3IodmFyIGg9W10sQT0hMCxJPSEwOzspe3ZhciBPPXRoaXMuY3VycmVudFRva2VuKCk7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihPLCJ9IikpcmV0dXJuKyt0aGlzLnBvc2l0aW9uLG5ldyBtLlJlY29yZChJLGgpO2lmKCFJKXRocm93IG5ldyBzLlBhcnNlckVycm9yKCJSZWNvcmQgd2lsZGNhcmQgbXVzdCBhcHBlYXIgYXMgbGFzdCBlbGVtZW50IG9mIHRoZSByZWNvcmQuIik7aWYoQXx8IXRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oTywiLCIpKWlmKEE9ITEsdGhpcy5jaGVja0tleXdvcmRUb2tlbihPLCIuLi4iKSlJPSExLCsrdGhpcy5wb3NpdGlvbjtlbHNle2lmKCFPLmlzVmFsaWRSZWNvcmRMYWJlbCgpKXRocm93IHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oTywiYXMiKSYmdGhpcy5vcHRpb25zLmFsbG93U3VjY2Vzc29yTUw/bmV3IHMuUGFyc2VyRXJyb3IoIkxheWVyZWQgcGF0dGVybiBpbnNpZGUgb2YgcmVjb3JkIHBhdHRlcnMgYXJlIGRpc2FsbG93ZWQgaW4gU3VjY2Vzc29yTUwgbW9kZS4iKTpuZXcgcy5QYXJzZXJFcnJvcignRXhwZWN0ZWQgIn0iLCAiLi4uIiwgImFzIiwgb3IgYW4gaWRlbnRpZmllciwgZ290ICInK08uZ2V0VGV4dCgpKyciLicpOysrdGhpcy5wb3NpdGlvbjt2YXIgRT10aGlzLmN1cnJlbnRUb2tlbigpO2lmKCEoRSBpbnN0YW5jZW9mIHEuS2V5d29yZFRva2VuKSl0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignRXhwZWN0ZWQgIjoiLCAiYXMiLCAiLCIsIG9yICI9IiwgZ290ICcrRS5nZXRUZXh0KCkrJyIuJyk7aWYoRS50ZXh0PT09Ij0iKXsrK3RoaXMucG9zaXRpb24saC5wdXNoKFtPLmdldFRleHQoKSx0aGlzLnBhcnNlUGF0dGVybigpXSk7Y29udGludWV9dmFyIHI9dm9pZCAwO2lmKE8gaW5zdGFuY2VvZiBxLk51bWVyaWNUb2tlbil0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignWW91IGNhbm5vdCBhc3NpZ24gdG8gIicrTy5nZXRUZXh0KCkrJyIuJyk7dmFyIGU9bmV3IG0uVmFsdWVJZGVudGlmaWVyKE8pO0UudGV4dD09PSI6IiYmKCsrdGhpcy5wb3NpdGlvbixyPXRoaXMucGFyc2VUeXBlKCksRT10aGlzLmN1cnJlbnRUb2tlbigpKSxFLnRleHQhPT0iYXMifHx0aGlzLm9wdGlvbnMuYWxsb3dTdWNjZXNzb3JNTD9yIT09dm9pZCAwJiYoZT1uZXcgbS5UeXBlZEV4cHJlc3Npb24oZSxyKSk6KCsrdGhpcy5wb3NpdGlvbixlPW5ldyBtLkxheWVyZWRQYXR0ZXJuKGUubmFtZSxyLHRoaXMucGFyc2VQYXR0ZXJuKCkpLEU9dGhpcy5jdXJyZW50VG9rZW4oKSksaC5wdXNoKFtPLmdldFRleHQoKSxlXSl9ZWxzZSsrdGhpcy5wb3NpdGlvbn19LEQucHJvdG90eXBlLnBhcnNlQXRvbWljUGF0dGVybj1mdW5jdGlvbigpe2lmKHRoaXMucG9zaXRpb24+PXRoaXMudG9rZW5zLmxlbmd0aCl0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcigiVW5leHBlY3RlZCBlbmQgb2YgdG9rZW4gc3RyZWFtIik7dmFyIGg9dGhpcy5jdXJyZW50VG9rZW4oKTtpZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKGgsIm9wIikpeysrdGhpcy5wb3NpdGlvbjt2YXIgQT10aGlzLmN1cnJlbnRUb2tlbigpO3RoaXMuYXNzZXJ0VmlkT3JMb25nVG9rZW4oQSksQS5vcFByZWZpeGVkPSEwLCsrdGhpcy5wb3NpdGlvbjt2YXIgST10aGlzLnBvc2l0aW9uO3RyeXtpZighKEEgaW5zdGFuY2VvZiBxLkxvbmdJZGVudGlmaWVyVG9rZW4pKXt2YXIgTz10aGlzLmN1cnJlbnRUb2tlbigpLEU9dm9pZCAwO3JldHVybiB0aGlzLmNoZWNrS2V5d29yZFRva2VuKE8sIjoiKSYmKCsrdGhpcy5wb3NpdGlvbixFPXRoaXMucGFyc2VUeXBlKCksTz10aGlzLmN1cnJlbnRUb2tlbigpKSx0aGlzLmFzc2VydEtleXdvcmRUb2tlbihPLCJhcyIpLCsrdGhpcy5wb3NpdGlvbixuZXcgbS5MYXllcmVkUGF0dGVybihBLEUsdGhpcy5wYXJzZVBhdHRlcm4oKSl9fWNhdGNoe3RoaXMucG9zaXRpb249SX1yZXR1cm4gbmV3IG0uVmFsdWVJZGVudGlmaWVyKEEpfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oaCwiXyIpKXJldHVybisrdGhpcy5wb3NpdGlvbixuZXcgbS5XaWxkY2FyZDtpZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKGgsInsiKSlyZXR1cm4rK3RoaXMucG9zaXRpb24sdGhpcy5wYXJzZVBhdHRlcm5Sb3coKTtpZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKGgsIigiKSl7aWYoKyt0aGlzLnBvc2l0aW9uLHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiKSIpKXJldHVybisrdGhpcy5wb3NpdGlvbixuZXcgbS5UdXBsZShbXSk7Zm9yKHZhciByPVt0aGlzLnBhcnNlUGF0dGVybigpXTs7KXtpZihBPXRoaXMuY3VycmVudFRva2VuKCksIXRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oQSwiLCIpKXtpZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKEEsIikiKSlyZXR1cm4rK3RoaXMucG9zaXRpb24sci5sZW5ndGg9PT0xP3JbMF06bmV3IG0uVHVwbGUocik7dGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoJ0V4cGVjdGVkICIsIiBvciAiKSIsIGJ1dCBnb3QgIicrQS5nZXRUZXh0KCkrJyIuJyl9Kyt0aGlzLnBvc2l0aW9uLHIucHVzaCh0aGlzLnBhcnNlUGF0dGVybigpKX19aWYodGhpcy5vcHRpb25zLmFsbG93VmVjdG9yJiZ0aGlzLmNoZWNrS2V5d29yZFRva2VuKGgsIiMiKSYmdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLm5leHRUb2tlbigpLCJbIikpe2lmKCsrdGhpcy5wb3NpdGlvbiwrK3RoaXMucG9zaXRpb24sdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCJdIikpcmV0dXJuKyt0aGlzLnBvc2l0aW9uLG5ldyBtLlZlY3RvcihbXSk7Zm9yKHI9W3RoaXMucGFyc2VQYXR0ZXJuKCldOzspe2lmKEE9dGhpcy5jdXJyZW50VG9rZW4oKSwhdGhpcy5jaGVja0tleXdvcmRUb2tlbihBLCIsIikpe2lmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oQSwiXSIpKXJldHVybisrdGhpcy5wb3NpdGlvbixuZXcgbS5WZWN0b3Iocik7dGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoJ0V4cGVjdGVkICIsIiBvciAiXSIgYnV0IGZvdW5kICInK0EuZ2V0VGV4dCgpKyciLicpfSsrdGhpcy5wb3NpdGlvbixyLnB1c2godGhpcy5wYXJzZVBhdHRlcm4oKSl9fWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oaCwiWyIpKXtpZigrK3RoaXMucG9zaXRpb24sdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCJdIikpcmV0dXJuKyt0aGlzLnBvc2l0aW9uLG5ldyBtLkxpc3QoW10pO2ZvcihyPVt0aGlzLnBhcnNlUGF0dGVybigpXTs7KXtpZihBPXRoaXMuY3VycmVudFRva2VuKCksIXRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oQSwiLCIpKXtpZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKEEsIl0iKSlyZXR1cm4rK3RoaXMucG9zaXRpb24sbmV3IG0uTGlzdChyKTt0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignRXhwZWN0ZWQgIiwiIG9yICJdIiBidXQgZm91bmQgIicrQS5nZXRUZXh0KCkrJyIuJyl9Kyt0aGlzLnBvc2l0aW9uLHIucHVzaCh0aGlzLnBhcnNlUGF0dGVybigpKX19ZWxzZXtpZihoIGluc3RhbmNlb2YgcS5Db25zdGFudFRva2VuKXtpZihoIGluc3RhbmNlb2YgcS5SZWFsQ29uc3RhbnRUb2tlbiYmdGhpcy5vcHRpb25zLnJlYWxFcXVhbGl0eSE9PSEwKXRocm93IG5ldyBzLlBhcnNlckVycm9yKCdJIGFtIG5vdCBpbnRlcmVzdGVkIGluIHJlYWwgY29uc3RhbnRzIHN1Y2ggYXMgIicraC5nZXRUZXh0KCkrJyIgYXBwZWFyaW5nIGluIHBhdHRlcm5zLicpO3JldHVybisrdGhpcy5wb3NpdGlvbixuZXcgbS5Db25zdGFudChoKX1pZihoLmlzVmlkKCkmJmguZ2V0VGV4dCgpIT09Ij0ifHxoIGluc3RhbmNlb2YgcS5Mb25nSWRlbnRpZmllclRva2VuKXsrK3RoaXMucG9zaXRpb24sST10aGlzLnBvc2l0aW9uO3RyeXtpZighKGggaW5zdGFuY2VvZiBxLkxvbmdJZGVudGlmaWVyVG9rZW4pKXJldHVybiBPPXRoaXMuY3VycmVudFRva2VuKCksRT12b2lkIDAsdGhpcy5jaGVja0tleXdvcmRUb2tlbihPLCI6IikmJigrK3RoaXMucG9zaXRpb24sRT10aGlzLnBhcnNlVHlwZSgpLE89dGhpcy5jdXJyZW50VG9rZW4oKSksdGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4oTywiYXMiKSwrK3RoaXMucG9zaXRpb24saCBpbnN0YW5jZW9mIHEuS2V5d29yZFRva2VuJiYoaD1uZXcgcS5JZGVudGlmaWVyVG9rZW4oaC5nZXRUZXh0KCkpKSxuZXcgbS5MYXllcmVkUGF0dGVybihoLEUsdGhpcy5wYXJzZVBhdHRlcm4oKSl9Y2F0Y2h7dGhpcy5wb3NpdGlvbj1JfXJldHVybiBuZXcgbS5WYWx1ZUlkZW50aWZpZXIoaCl9fXRocm93IG5ldyBzLlBhcnNlckVycm9yKCdFeHBlY3RlZCBhdG9taWMgcGF0dGVybiBidXQgZ290ICInK2guZ2V0VGV4dCgpKyciLicpfSxELnByb3RvdHlwZS5wYXJzZUFwcGxpY2F0aW9uUGF0dGVybj1mdW5jdGlvbigpe3ZhciBoPXRoaXMucG9zaXRpb24sQT10aGlzLmN1cnJlbnRUb2tlbigpLEk9dGhpcy5wYXJzZUF0b21pY1BhdHRlcm4oKTtpZihJIGluc3RhbmNlb2YgbS5WYWx1ZUlkZW50aWZpZXImJnRoaXMuc3RhdGUuZ2V0SW5maXhTdGF0dXMoSS5uYW1lKSE9PXZvaWQgMCYmdGhpcy5zdGF0ZS5nZXRJbmZpeFN0YXR1cyhJLm5hbWUpLmluZml4JiYhKGg+MCYmdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLnRva2Vuc1toLTFdLCJvcCIpfHx0aGlzLmNoZWNrS2V5d29yZFRva2VuKEEsIm9wIikpKXRocm93IG5ldyBzLlBhcnNlckVycm9yKCdJbmZpeCBvcGVyYXRvciAiJytJKyciIGFwcGVhcmVkIGluIG5vbi1pbmZpeCBjb250ZXh0IHdpdGhvdXQgIm9wIi4nKTtmb3IoOzspe3ZhciBPPXRoaXMucG9zaXRpb24sRT10aGlzLmN1cnJlbnRUb2tlbigpO2lmKHRoaXMuY2hlY2tWaWRPckxvbmdUb2tlbihFKSYmdGhpcy5zdGF0ZS5nZXRJbmZpeFN0YXR1cyhFKSE9PXZvaWQgMCYmdGhpcy5zdGF0ZS5nZXRJbmZpeFN0YXR1cyhFKS5pbmZpeClicmVhazt2YXIgcj0hMTt0cnl7dmFyIGU9dGhpcy5wYXJzZUF0b21pY1BhdHRlcm4oKTtpZihJIGluc3RhbmNlb2YgbS5XaWxkY2FyZCl0aHJvdyByPSEwLG5ldyBzLlBhcnNlckVycm9yKCJZb3UgY2Fubm90IGFwcGx5IGEgcGF0dGVybiB0byBhIHdpbGRjYXJkLiIpO0k9bmV3IG0uRnVuY3Rpb25BcHBsaWNhdGlvbihJLGUpfWNhdGNoKG8pe2lmKHIpdGhyb3cgbzt0aGlzLnBvc2l0aW9uPU87YnJlYWt9fXJldHVybiBJfSxELnByb3RvdHlwZS5wYXJzZUluZml4UGF0dGVybj1mdW5jdGlvbigpe2Zvcih2YXIgaD1bXSxBPVtdLEk9MDs7KXtoLnB1c2godGhpcy5wYXJzZUFwcGxpY2F0aW9uUGF0dGVybigpKTt2YXIgTz10aGlzLmN1cnJlbnRUb2tlbigpO2lmKCF0aGlzLmNoZWNrSWRlbnRpZmllck9yTG9uZ1Rva2VuKE8pfHx0aGlzLnN0YXRlLmdldEluZml4U3RhdHVzKE8pPT09dm9pZCAwfHwhdGhpcy5zdGF0ZS5nZXRJbmZpeFN0YXR1cyhPKS5pbmZpeClicmVhazsrK3RoaXMucG9zaXRpb24sQS5wdXNoKFtPLEkrK10pfXJldHVybiBJPT09MD9oWzBdOm5ldyBtLkluZml4RXhwcmVzc2lvbihoLEEpLnJlUGFyc2UodGhpcy5zdGF0ZSl9LEQucHJvdG90eXBlLnBhcnNlUGF0dGVybj1mdW5jdGlvbigpe2Zvcih2YXIgaD10aGlzLnBhcnNlSW5maXhQYXR0ZXJuKCk7Oyl7aWYoIXRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiOiIpKXtpZih0aGlzLm9wdGlvbnMuYWxsb3dTdWNjZXNzb3JNTD09PSEwKXtpZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImFzIikpeysrdGhpcy5wb3NpdGlvbixoPW5ldyBtLkNvbmp1bmN0aXZlUGF0dGVybihoLHRoaXMucGFyc2VQYXR0ZXJuKCkpO2NvbnRpbnVlfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwifCIpKXsrK3RoaXMucG9zaXRpb24saD1uZXcgbS5EaXNqdW5jdGl2ZVBhdHRlcm4oaCx0aGlzLnBhcnNlSW5maXhQYXR0ZXJuKCkpO2NvbnRpbnVlfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwid2l0aCIpKXsrK3RoaXMucG9zaXRpb247dmFyIEE9dGhpcy5wYXJzZVBhdHRlcm4oKTt0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI9IiksKyt0aGlzLnBvc2l0aW9uLGg9bmV3IG0uTmVzdGVkTWF0Y2goaCxBLHRoaXMucGFyc2VFeHByZXNzaW9uKCkpO2NvbnRpbnVlfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiaWYiKSl7Kyt0aGlzLnBvc2l0aW9uLGg9bmV3IG0uUGF0dGVybkd1YXJkKGgsdGhpcy5wYXJzZUV4cHJlc3Npb24oKSk7Y29udGludWV9fWJyZWFrfSsrdGhpcy5wb3NpdGlvbixoPW5ldyBtLlR5cGVkRXhwcmVzc2lvbihoLHRoaXMucGFyc2VUeXBlKCkpfXJldHVybiBofSxELnByb3RvdHlwZS5wYXJzZVR5cGVSb3c9ZnVuY3Rpb24oKXtmb3IodmFyIGg9bmV3IE1hcCxBPSEwOzspe3ZhciBJPXRoaXMuY3VycmVudFRva2VuKCk7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihJLCJ9IikpcmV0dXJuKyt0aGlzLnBvc2l0aW9uLG5ldyBnLlJlY29yZFR5cGUoaCwhMCk7aWYoQXx8IXRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oSSwiLCIpKXtpZihBPSExLEkuaXNWYWxpZFJlY29yZExhYmVsKCkpeysrdGhpcy5wb3NpdGlvbjt2YXIgTz10aGlzLmN1cnJlbnRUb2tlbigpO2lmKCEoTyBpbnN0YW5jZW9mIHEuS2V5d29yZFRva2VuKSl0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignRXhwZWN0ZWQgIjoiLicpO2lmKE8udGV4dD09PSI6Iil7aWYoKyt0aGlzLnBvc2l0aW9uLGguaGFzKEkuZ2V0VGV4dCgpKSl0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignRHVwbGljYXRlIHJlY29yZCBsYWJlbCAiJytJLmdldFRleHQoKSsnIi4nKTtoLnNldChJLmdldFRleHQoKSx0aGlzLnBhcnNlVHlwZSgpKTtjb250aW51ZX10aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignRXhwZWN0ZWQgIjoiLicpfXRocm93IG5ldyBzLlBhcnNlckVycm9yKCdFeHBlY3RlZCAifSIsIG9yIGFuIGlkZW50aWZpZXIsIGdvdCAiJytJLmdldFRleHQoKSsnIi4nKX0rK3RoaXMucG9zaXRpb259fSxELnByb3RvdHlwZS5wYXJzZVNpbXBsZVR5cGU9ZnVuY3Rpb24oKXt2YXIgaD10aGlzLmN1cnJlbnRUb2tlbigpO2lmKGggaW5zdGFuY2VvZiBxLlR5cGVWYXJpYWJsZVRva2VuKXJldHVybisrdGhpcy5wb3NpdGlvbixuZXcgZy5UeXBlVmFyaWFibGUoaC5nZXRUZXh0KCkpO2lmKHRoaXMuY2hlY2tJZGVudGlmaWVyT3JMb25nVG9rZW4oaCkpcmV0dXJuKyt0aGlzLnBvc2l0aW9uLGggaW5zdGFuY2VvZiBxLkxvbmdJZGVudGlmaWVyVG9rZW4/bmV3IGcuQ3VzdG9tVHlwZShoLmlkLmdldFRleHQoKSxbXSxoKTpuZXcgZy5DdXN0b21UeXBlKGguZ2V0VGV4dCgpLFtdKTtpZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKGgsInsiKSlyZXR1cm4rK3RoaXMucG9zaXRpb24sdGhpcy5wYXJzZVR5cGVSb3coKTtpZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKGgsIigiKSl7aWYoKyt0aGlzLnBvc2l0aW9uLHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiKSIpKXRocm93IG5ldyBzLlBhcnNlckVycm9yKCdVc2UgInt9IiBvciAidW5pdCIgdG8gZGVub3RlIHRoZSB1bml0IHR5cGUuJyk7Zm9yKHZhciBBPVt0aGlzLnBhcnNlVHlwZSgpXTs7KXt2YXIgST10aGlzLmN1cnJlbnRUb2tlbigpO2lmKCF0aGlzLmNoZWNrS2V5d29yZFRva2VuKEksIiwiKSl7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihJLCIpIikpe2lmKCsrdGhpcy5wb3NpdGlvbixBLmxlbmd0aD09PTEpcmV0dXJuIEFbMF07dGhpcy5hc3NlcnRJZGVudGlmaWVyT3JMb25nVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSk7dmFyIE89dGhpcy5jdXJyZW50VG9rZW4oKTtyZXR1cm4rK3RoaXMucG9zaXRpb24sbmV3IGcuQ3VzdG9tVHlwZShPLmdldFRleHQoKSxBKX10aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignRXhwZWN0ZWQgIiwiIG9yICIpIiwgZ290ICInK0kuZ2V0VGV4dCgpKyciLicpfSsrdGhpcy5wb3NpdGlvbixBLnB1c2godGhpcy5wYXJzZVR5cGUoKSl9fXRocm93IG5ldyBzLlBhcnNlckVycm9yKCdFeHBlY3RlZCBlaXRoZXIgIigiIG9yICJ7IiBnb3QgIicraC5nZXRUZXh0KCkrJyIuJyl9LEQucHJvdG90eXBlLnBhcnNlVHlwZT1mdW5jdGlvbigpe3ZhciBoPXRoaXMucGFyc2VUdXBsZVR5cGUoKSxBPXRoaXMuY3VycmVudFRva2VuKCk7aWYoIXRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oQSwiLT4iKSlyZXR1cm4gaDsrK3RoaXMucG9zaXRpb247dmFyIEk9dGhpcy5wYXJzZVR5cGUoKTtyZXR1cm4gbmV3IGcuRnVuY3Rpb25UeXBlKGgsSSl9LEQucHJvdG90eXBlLnBhcnNlVHVwbGVUeXBlPWZ1bmN0aW9uKCl7Zm9yKHZhciBoPVt0aGlzLnBhcnNlQ3VzdG9tVHlwZSgpXTt0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIioiKTspKyt0aGlzLnBvc2l0aW9uLGgucHVzaCh0aGlzLnBhcnNlQ3VzdG9tVHlwZSgpKTtyZXR1cm4gaC5sZW5ndGg9PT0xP2hbMF06bmV3IGcuVHVwbGVUeXBlKGgpfSxELnByb3RvdHlwZS5wYXJzZUN1c3RvbVR5cGU9ZnVuY3Rpb24oKXtmb3IodmFyIGg9dGhpcy5wYXJzZVNpbXBsZVR5cGUoKTt0aGlzLnBvc2l0aW9uPHRoaXMudG9rZW5zLmxlbmd0aDspe3ZhciBBPXRoaXMuY3VycmVudFRva2VuKCk7aWYoIXRoaXMuY2hlY2tJZGVudGlmaWVyT3JMb25nVG9rZW4oQSkpcmV0dXJuIGg7Kyt0aGlzLnBvc2l0aW9uLGg9QSBpbnN0YW5jZW9mIHEuTG9uZ0lkZW50aWZpZXJUb2tlbj9uZXcgZy5DdXN0b21UeXBlKEEuaWQuZ2V0VGV4dCgpLFtoXSxBKTpuZXcgZy5DdXN0b21UeXBlKEEuZ2V0VGV4dCgpLFtoXSl9cmV0dXJuIGh9LEQucHJvdG90eXBlLnBhcnNlVmFsdWVCaW5kaW5nPWZ1bmN0aW9uKCl7dmFyIGg9dGhpcy5jdXJyZW50VG9rZW4oKTtpZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKGgsInJlYyIpKXsrK3RoaXMucG9zaXRpb247dmFyIEE9dGhpcy5wYXJzZVZhbHVlQmluZGluZygpO3JldHVybiBBLmlzUmVjdXJzaXZlPSEwLEF9dmFyIEk9dGhpcy5wYXJzZVBhdHRlcm4oKTtyZXR1cm4gSS5zaW1wbGlmeSgpLmFzc2VydFVuaXF1ZUJpbmRpbmcodGhpcy5zdGF0ZSx0aGlzLm5ld2NvbnMpLHRoaXMuYXNzZXJ0S2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIj0iKSwrK3RoaXMucG9zaXRpb24sbmV3IEIuVmFsdWVCaW5kaW5nKCExLEksdGhpcy5wYXJzZUV4cHJlc3Npb24oKSl9LEQucHJvdG90eXBlLnBhcnNlRnVuY3Rpb25WYWx1ZUJpbmRpbmc9ZnVuY3Rpb24oKXt2YXIgaD1bXSxBPS0xLEk9dm9pZCAwO2Zvcih0aGlzLm9wdGlvbnMuYWxsb3dTdWNjZXNzb3JNTD09PSEwJiZ0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksInwiKSYmKyt0aGlzLnBvc2l0aW9uOzspe3ZhciBPPVtdLEU9dm9pZCAwLHI9dm9pZCAwO2lmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiKCIpKXt2YXIgZT10aGlzLnBvc2l0aW9uO3RyeXt2YXIgbz10aGlzLnBhcnNlUGF0dGVybigpLHk9ITEsZD1bXTtmb3IobyBpbnN0YW5jZW9mIG0uRnVuY3Rpb25BcHBsaWNhdGlvbnx8KHk9ITApOyF5JiZvIGluc3RhbmNlb2YgbS5GdW5jdGlvbkFwcGxpY2F0aW9uOylkLnB1c2goby5hcmd1bWVudCksbz1vLmZ1bmM7aWYobyBpbnN0YW5jZW9mIG0uVmFsdWVJZGVudGlmaWVyfHwoeT0hMCkseSl0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcigiTnlhYm9yb24gaXMgc2FkLiBEaWQgeW91IGZvcmdldCBhIGZ1bmN0aW9uIG5hbWU/Iik7cj1vO2Zvcih2YXIgdj1kLmxlbmd0aC0xO3Y+PTA7LS12KU8ucHVzaChkW3ZdKX1jYXRjaCh3KXt2YXIgQz0hMTt0cnl7dGhpcy5wb3NpdGlvbj1lLCsrdGhpcy5wb3NpdGlvbjt2YXIgRz10aGlzLnBhcnNlQXRvbWljUGF0dGVybigpO2lmKHRoaXMuYXNzZXJ0VmlkT3JMb25nVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSkscj1uZXcgbS5WYWx1ZUlkZW50aWZpZXIodGhpcy5jdXJyZW50VG9rZW4oKSksdGhpcy5zdGF0ZS5nZXRJbmZpeFN0YXR1cyh0aGlzLmN1cnJlbnRUb2tlbigpKT09PXZvaWQgMHx8IXRoaXMuc3RhdGUuZ2V0SW5maXhTdGF0dXModGhpcy5jdXJyZW50VG9rZW4oKSkuaW5maXgpdGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoJyInK3RoaXMuY3VycmVudFRva2VuKCkuZ2V0VGV4dCgpKyciIGRvZXMgbm90IGhhdmUgaW5maXggc3RhdHVzLicpO2lmKHRoaXMub3B0aW9ucy5hbGxvd1N1Y2Nlc3Nvck1MIT09ITAmJnRoaXMuY3VycmVudFRva2VuKCkuZ2V0VGV4dCgpPT09Ij0iKXRocm93IEM9ITAsbmV3IHMuRmVhdHVyZURpc2FibGVkRXJyb3IoJ1doeSB3b3VsZCB5b3UgdHJ5IHRvIHJlYmluZCAiPSI/Jyk7Kyt0aGlzLnBvc2l0aW9uO3ZhciBZPXRoaXMucGFyc2VBdG9taWNQYXR0ZXJuKCk7Zm9yKHRoaXMuYXNzZXJ0S2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIikiKSwrK3RoaXMucG9zaXRpb24sTy5wdXNoKG5ldyBtLlR1cGxlKFtHLFldKSk7IXRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiPSIpJiYhdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI6Iik7KXtpZigobz10aGlzLnBhcnNlQXRvbWljUGF0dGVybigpKWluc3RhbmNlb2YgbS5WYWx1ZUlkZW50aWZpZXImJnRoaXMuc3RhdGUuZ2V0SW5maXhTdGF0dXMoby5uYW1lKSE9PXZvaWQgMCYmdGhpcy5zdGF0ZS5nZXRJbmZpeFN0YXR1cyhvLm5hbWUpLmluZml4KXRocm93IG5ldyBzLlBhcnNlckVycm9yKCdDdXRlIGxpdHRsZSBpbmZpeCBpZGVudGlmaWVycyBzdWNoIGFzICInK28rJyIgc3VyZSBzaG91bGQgcGxheSBzb21ld2hlcmUgZWxzZS4nKTtPLnB1c2gobyl9fWNhdGNoKFQpe3Rocm93IEM/VDp3fX19ZWxzZXt2YXIgSj10aGlzLnBvc2l0aW9uLHo9ITEscD0hMTt0cnl7dmFyIGM9dGhpcy5wYXJzZU9wSWRlbnRpZmllclRva2VuKCk7aWYocj1uZXcgbS5WYWx1ZUlkZW50aWZpZXIoYyksdGhpcy5zdGF0ZS5nZXRJbmZpeFN0YXR1cyhyLm5hbWUpIT09dm9pZCAwJiZ0aGlzLnN0YXRlLmdldEluZml4U3RhdHVzKHIubmFtZSkuaW5maXgmJiFyLm5hbWUub3BQcmVmaXhlZCl0aHJvdyB6PSEwLG5ldyBzLlBhcnNlckVycm9yKCdNaXNzaW5nICJvcCIuJyk7Zm9yKDshdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI9IikmJiF0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIjoiKTspe2lmKChvPXRoaXMucGFyc2VBdG9taWNQYXR0ZXJuKCkpaW5zdGFuY2VvZiBtLlZhbHVlSWRlbnRpZmllciYmdGhpcy5zdGF0ZS5nZXRJbmZpeFN0YXR1cyhvLm5hbWUpIT09dm9pZCAwJiZ0aGlzLnN0YXRlLmdldEluZml4U3RhdHVzKG8ubmFtZSkuaW5maXgpdGhyb3cgcD0hMCxuZXcgcy5QYXJzZXJFcnJvcignQ3V0ZSBsaXR0bGUgaW5maXggaWRlbnRpZmllcnMgc3VjaCBhcyAiJytvKyciIHN1cmUgc2hvdWxkIHBsYXkgc29tZXdoZXJlIGVsc2UuJyk7Ty5wdXNoKG8pfX1jYXRjaCh3KXtpZih6KXRocm93IHc7ej0hMTt0cnl7aWYodGhpcy5wb3NpdGlvbj1KLEc9dGhpcy5wYXJzZUF0b21pY1BhdHRlcm4oKSx0aGlzLmFzc2VydFZpZE9yTG9uZ1Rva2VuKHRoaXMuY3VycmVudFRva2VuKCkpLHI9bmV3IG0uVmFsdWVJZGVudGlmaWVyKHRoaXMuY3VycmVudFRva2VuKCkpLHRoaXMuc3RhdGUuZ2V0SW5maXhTdGF0dXModGhpcy5jdXJyZW50VG9rZW4oKSk9PT12b2lkIDB8fCF0aGlzLnN0YXRlLmdldEluZml4U3RhdHVzKHRoaXMuY3VycmVudFRva2VuKCkpLmluZml4KXRocm93IHA/KHo9ITAsdyk6bmV3IHMuUGFyc2VyRXJyb3IoJyInK3RoaXMuY3VycmVudFRva2VuKCkuZ2V0VGV4dCgpKyciIGRvZXMgbm90IGhhdmUgaW5maXggc3RhdHVzLicpOysrdGhpcy5wb3NpdGlvbixZPXRoaXMucGFyc2VBdG9taWNQYXR0ZXJuKCksTy5wdXNoKG5ldyBtLlR1cGxlKFtHLFldKSl9Y2F0Y2h7dGhyb3cgd319fWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiOiIpJiYoKyt0aGlzLnBvc2l0aW9uLEU9dGhpcy5wYXJzZVR5cGUoKSksdGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiPSIpLCsrdGhpcy5wb3NpdGlvbixBPT09LTEpQT1PLmxlbmd0aDtlbHNlIGlmKEEhPT0yJiZBIT09MyYmQSE9PU8ubGVuZ3RoKXRocm93IG5ldyBzLlBhcnNlckVycm9yKCJEaWZmZXJlbnQgbnVtYmVyIG9mIGFyZ3VtZW50cy4iKTtpZihBPT09MCl0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignRnVuY3Rpb25zIG5lZWQgYXJndW1lbnRzIHRvIHN1cnZpdmUuIFJlbHkgb24gInZhbCIgaW5zdGVhZC4nKTtpZihJPT09dm9pZCAwKUk9cjtlbHNlIGlmKHIubmFtZS5nZXRUZXh0KCkhPT1JLm5hbWUuZ2V0VGV4dCgpKXRocm93IG5ldyBzLlBhcnNlckVycm9yKCdEaWZmZXJlbnQgZnVuY3Rpb24gbmFtZXMgaW4gZGlmZmVyZW50IGNhc2VzICgiJytyLm5hbWUuZ2V0VGV4dCgpKyciIHZzLiAiJytJLm5hbWUuZ2V0VGV4dCgpKyciKScpO2lmKG5ldyBtLlR1cGxlKE8pLnNpbXBsaWZ5KCkuYXNzZXJ0VW5pcXVlQmluZGluZyh0aGlzLnN0YXRlLHRoaXMubmV3Y29ucyksaC5wdXNoKFtPLEUsdGhpcy5wYXJzZUV4cHJlc3Npb24oKV0pLCF0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksInwiKSlicmVhazsrK3RoaXMucG9zaXRpb259cmV0dXJuIG5ldyBCLkZ1bmN0aW9uVmFsdWVCaW5kaW5nKGgsSSl9LEQucHJvdG90eXBlLnBhcnNlVHlwZUJpbmRpbmc9ZnVuY3Rpb24oKXt2YXIgaD10aGlzLnBhcnNlVHlwZVZhclNlcXVlbmNlKCk7dGhpcy5hc3NlcnRJZGVudGlmaWVyVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSk7dmFyIEE9dGhpcy5jdXJyZW50VG9rZW4oKTtyZXR1cm4rK3RoaXMucG9zaXRpb24sdGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiPSIpLCsrdGhpcy5wb3NpdGlvbixuZXcgQi5UeXBlQmluZGluZyhoLEEsdGhpcy5wYXJzZVR5cGUoKSl9LEQucHJvdG90eXBlLnBhcnNlVHlwZUJpbmRpbmdTZXE9ZnVuY3Rpb24oKXtmb3IodmFyIGg9W107aC5wdXNoKHRoaXMucGFyc2VUeXBlQmluZGluZygpKSx0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImFuZCIpOykrK3RoaXMucG9zaXRpb247cmV0dXJuIGh9LEQucHJvdG90eXBlLnBhcnNlRXhjZXB0aW9uQmluZGluZz1mdW5jdGlvbigpe3ZhciBoPXRoaXMucGFyc2VPcElkZW50aWZpZXJUb2tlbigpO2lmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwib2YiKSl7Kyt0aGlzLnBvc2l0aW9uO3ZhciBBPXRoaXMucGFyc2VUeXBlKCk7cmV0dXJuIG5ldyBCLkRpcmVjdEV4Y2VwdGlvbkJpbmRpbmcoaCxBKX1pZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIj0iKSl7Kyt0aGlzLnBvc2l0aW9uO3ZhciBJPXRoaXMucGFyc2VPcElkZW50aWZpZXJUb2tlbighMCk7cmV0dXJuIG5ldyBCLkV4Y2VwdGlvbkFsaWFzKGgsSSl9cmV0dXJuIG5ldyBCLkRpcmVjdEV4Y2VwdGlvbkJpbmRpbmcoaCx2b2lkIDApfSxELnByb3RvdHlwZS5wYXJzZURhdGF0eXBlQmluZGluZz1mdW5jdGlvbigpe3ZhciBoPXRoaXMucGFyc2VUeXBlVmFyU2VxdWVuY2UoKTt0aGlzLmFzc2VydElkZW50aWZpZXJUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpKTt2YXIgQT10aGlzLmN1cnJlbnRUb2tlbigpOysrdGhpcy5wb3NpdGlvbix0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI9IiksKyt0aGlzLnBvc2l0aW9uO3ZhciBJPVtdO2Zvcih0aGlzLm9wdGlvbnMuYWxsb3dTdWNjZXNzb3JNTD09PSEwJiZ0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksInwiKSYmKyt0aGlzLnBvc2l0aW9uOzspe3ZhciBPPXRoaXMucGFyc2VPcElkZW50aWZpZXJUb2tlbigpO2lmKHRoaXMubmV3Y29ucz10aGlzLm5ld2NvbnMuYWRkKE8uZ2V0VGV4dCgpKSx0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIm9mIikpeysrdGhpcy5wb3NpdGlvbjt2YXIgRT10aGlzLnBhcnNlVHlwZSgpO0kucHVzaChbTyxFXSl9ZWxzZSBJLnB1c2goW08sdm9pZCAwXSk7aWYoIXRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwifCIpKWJyZWFrOysrdGhpcy5wb3NpdGlvbn1yZXR1cm4gbmV3IEIuRGF0YXR5cGVCaW5kaW5nKGgsQSxJKX0sRC5wcm90b3R5cGUucGFyc2VEYXRhdHlwZUJpbmRpbmdTZXE9ZnVuY3Rpb24oKXtmb3IodmFyIGg9W107aC5wdXNoKHRoaXMucGFyc2VEYXRhdHlwZUJpbmRpbmcoKSksdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCJhbmQiKTspKyt0aGlzLnBvc2l0aW9uO3JldHVybiBofSxELnByb3RvdHlwZS5wYXJzZVN0cnVjdHVyZUJpbmRpbmc9ZnVuY3Rpb24oKXt0aGlzLmFzc2VydElkZW50aWZpZXJUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpKTt2YXIgaD10aGlzLmN1cnJlbnRUb2tlbigpO2lmKCsrdGhpcy5wb3NpdGlvbix0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIjoiKSl7Kyt0aGlzLnBvc2l0aW9uO3ZhciBBPXRoaXMucGFyc2VTaWduYXR1cmVFeHByZXNzaW9uKCk7dGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiPSIpLCsrdGhpcy5wb3NpdGlvbjt2YXIgST10aGlzLnBhcnNlU3RydWN0dXJlRXhwcmVzc2lvbigpO3JldHVybiBuZXcgTS5TdHJ1Y3R1cmVCaW5kaW5nKGgsbmV3IE0uVHJhbnNwYXJlbnRDb25zdHJhaW50KEksQSkpfXJldHVybiB0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIjo+Iik/KCsrdGhpcy5wb3NpdGlvbixBPXRoaXMucGFyc2VTaWduYXR1cmVFeHByZXNzaW9uKCksdGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiPSIpLCsrdGhpcy5wb3NpdGlvbixJPXRoaXMucGFyc2VTdHJ1Y3R1cmVFeHByZXNzaW9uKCksbmV3IE0uU3RydWN0dXJlQmluZGluZyhoLG5ldyBNLk9wYXF1ZUNvbnN0cmFpbnQoSSxBKSkpOih0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI9IiksKyt0aGlzLnBvc2l0aW9uLG5ldyBNLlN0cnVjdHVyZUJpbmRpbmcoaCx0aGlzLnBhcnNlU3RydWN0dXJlRXhwcmVzc2lvbigpKSl9LEQucHJvdG90eXBlLnBhcnNlU3RydWN0dXJlQmluZGluZ1NlcT1mdW5jdGlvbigpe2Zvcih2YXIgaD1bXTtoLnB1c2godGhpcy5wYXJzZVN0cnVjdHVyZUJpbmRpbmcoKSksdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCJhbmQiKTspKyt0aGlzLnBvc2l0aW9uO3JldHVybiBofSxELnByb3RvdHlwZS5wYXJzZVNpZ25hdHVyZUJpbmRpbmc9ZnVuY3Rpb24oKXt0aGlzLmFzc2VydElkZW50aWZpZXJUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpKTt2YXIgaD10aGlzLmN1cnJlbnRUb2tlbigpO3JldHVybisrdGhpcy5wb3NpdGlvbix0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI9IiksKyt0aGlzLnBvc2l0aW9uLG5ldyBNLlNpZ25hdHVyZUJpbmRpbmcoaCx0aGlzLnBhcnNlU2lnbmF0dXJlRXhwcmVzc2lvbigpKX0sRC5wcm90b3R5cGUucGFyc2VTaWduYXR1cmVCaW5kaW5nU2VxPWZ1bmN0aW9uKCl7Zm9yKHZhciBoPVtdO2gucHVzaCh0aGlzLnBhcnNlU2lnbmF0dXJlQmluZGluZygpKSx0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImFuZCIpOykrK3RoaXMucG9zaXRpb247cmV0dXJuIGh9LEQucHJvdG90eXBlLnBhcnNlRnVuY3RvckJpbmRpbmc9ZnVuY3Rpb24oKXt0aGlzLmFzc2VydElkZW50aWZpZXJUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpKTt2YXIgaD10aGlzLmN1cnJlbnRUb2tlbigpO2lmKCsrdGhpcy5wb3NpdGlvbix0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCIoIiksKyt0aGlzLnBvc2l0aW9uLHRoaXMuY3VycmVudFRva2VuKClpbnN0YW5jZW9mIHEuSWRlbnRpZmllclRva2VuKXt2YXIgQT10aGlzLmN1cnJlbnRUb2tlbigpOysrdGhpcy5wb3NpdGlvbix0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI6IiksKyt0aGlzLnBvc2l0aW9uO3ZhciBJPXRoaXMucGFyc2VTaWduYXR1cmVFeHByZXNzaW9uKCk7aWYodGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiKSIpLCsrdGhpcy5wb3NpdGlvbix0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIjoiKSl7Kyt0aGlzLnBvc2l0aW9uO3ZhciBPPXRoaXMucGFyc2VTaWduYXR1cmVFeHByZXNzaW9uKCk7cmV0dXJuIHRoaXMuYXNzZXJ0S2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIj0iKSwrK3RoaXMucG9zaXRpb24sbmV3IE0uRnVuY3RvckJpbmRpbmcoaCxBLEksbmV3IE0uVHJhbnNwYXJlbnRDb25zdHJhaW50KHRoaXMucGFyc2VTdHJ1Y3R1cmVFeHByZXNzaW9uKCksTykpfXJldHVybiB0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIjo+Iik/KCsrdGhpcy5wb3NpdGlvbixPPXRoaXMucGFyc2VTaWduYXR1cmVFeHByZXNzaW9uKCksdGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiPSIpLCsrdGhpcy5wb3NpdGlvbixuZXcgTS5GdW5jdG9yQmluZGluZyhoLEEsSSxuZXcgTS5PcGFxdWVDb25zdHJhaW50KHRoaXMucGFyc2VTdHJ1Y3R1cmVFeHByZXNzaW9uKCksTykpKToodGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiPSIpLCsrdGhpcy5wb3NpdGlvbixuZXcgTS5GdW5jdG9yQmluZGluZyhoLEEsSSx0aGlzLnBhcnNlU3RydWN0dXJlRXhwcmVzc2lvbigpKSl9dmFyIEU9dGhpcy5wYXJzZVNwZWNpZmljYXRpb24oKSxyPW5ldyBNLlNpZ25hdHVyZUV4cHJlc3Npb24oRSk7dGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiKSIpLCsrdGhpcy5wb3NpdGlvbjt2YXIgZT0hMSxvPXZvaWQgMDt0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIjoiKT8oKyt0aGlzLnBvc2l0aW9uLG89dGhpcy5wYXJzZVNpZ25hdHVyZUV4cHJlc3Npb24oKSk6dGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI6PiIpJiYoZT0hMCwrK3RoaXMucG9zaXRpb24sbz10aGlzLnBhcnNlU2lnbmF0dXJlRXhwcmVzc2lvbigpKSx0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI9IiksKyt0aGlzLnBvc2l0aW9uO3ZhciB5PXRoaXMucGFyc2VTdHJ1Y3R1cmVFeHByZXNzaW9uKCksZD1uZXcgcS5BbHBoYW51bWVyaWNJZGVudGlmaWVyVG9rZW4oIl9fZmFyZyIpO3JldHVybiBvIT09dm9pZCAwJiYoeT1lP25ldyBNLk9wYXF1ZUNvbnN0cmFpbnQoeSxvKTpuZXcgTS5UcmFuc3BhcmVudENvbnN0cmFpbnQoeSxvKSkseT1uZXcgTS5Mb2NhbERlY2xhcmF0aW9uU3RydWN0dXJlRXhwcmVzc2lvbihuZXcgQi5PcGVuRGVjbGFyYXRpb24oW2RdKSx5KSxuZXcgTS5GdW5jdG9yQmluZGluZyhoLGQscix5KX0sRC5wcm90b3R5cGUucGFyc2VGdW5jdG9yQmluZGluZ1NlcT1mdW5jdGlvbigpe2Zvcih2YXIgaD1bXTtoLnB1c2godGhpcy5wYXJzZUZ1bmN0b3JCaW5kaW5nKCkpLHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiYW5kIik7KSsrdGhpcy5wb3NpdGlvbjtyZXR1cm4gaH0sRC5wcm90b3R5cGUucGFyc2VUeXBlVmFyU2VxdWVuY2U9ZnVuY3Rpb24oaCl7aD09PXZvaWQgMCYmKGg9ITEpO3ZhciBBPXRoaXMuY3VycmVudFRva2VuKCksST1bXTtpZihBIGluc3RhbmNlb2YgcS5UeXBlVmFyaWFibGVUb2tlbilyZXR1cm4gSS5wdXNoKG5ldyBnLlR5cGVWYXJpYWJsZShBLnRleHQpKSwrK3RoaXMucG9zaXRpb24sSTtpZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKEEsIigiKSlmb3IoKyt0aGlzLnBvc2l0aW9uOzspe2lmKCEoKEE9dGhpcy5jdXJyZW50VG9rZW4oKSlpbnN0YW5jZW9mIHEuVHlwZVZhcmlhYmxlVG9rZW4pKXtpZihoKXJldHVybjt0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcigiRXhwZWN0ZWQgYSB0eXBlIHZhcmlibGUuIil9aWYoSS5wdXNoKG5ldyBnLlR5cGVWYXJpYWJsZShBLnRleHQpKSwrK3RoaXMucG9zaXRpb24sQT10aGlzLmN1cnJlbnRUb2tlbigpLCF0aGlzLmNoZWNrS2V5d29yZFRva2VuKEEsIiwiKSl7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihBLCIpIikpeysrdGhpcy5wb3NpdGlvbjticmVha310aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignRXhwZWN0ZWQgIiwiIG9yICIpIiBidXQgZ290ICInK0EuZ2V0VGV4dCgpKyciLicpfSsrdGhpcy5wb3NpdGlvbn1yZXR1cm4gSX0sRC5wcm90b3R5cGUucGFyc2VEZWNsYXJhdGlvbj1mdW5jdGlvbihoLEEpe2g9PT12b2lkIDAmJihoPSExKSxBPT09dm9pZCAwJiYoQT0hMSk7Zm9yKHZhciBJPVtdLE89dGhpcy5jdXJyZW50SWQrKzt0aGlzLnBvc2l0aW9uPHRoaXMudG9rZW5zLmxlbmd0aDspe3ZhciBFPXRoaXMucGFyc2VTaW1wbGVEZWNsYXJhdGlvbihoLEEpO2lmKEUgaW5zdGFuY2VvZiBCLkVtcHR5RGVjbGFyYXRpb24pe2lmKHRoaXMucG9zaXRpb24+PXRoaXMudG9rZW5zLmxlbmd0aHx8dGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCJpbiIpfHx0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImVuZCIpfHx0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIikiKSlicmVha31lbHNlIEkucHVzaChFKSx0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIjsiKSYmKyt0aGlzLnBvc2l0aW9ufXJldHVybiBuZXcgQi5TZXF1ZW50aWFsRGVjbGFyYXRpb24oSSxPKX0sRC5wcm90b3R5cGUucGFyc2VTaW1wbGVEZWNsYXJhdGlvbj1mdW5jdGlvbihoLEEpe2g9PT12b2lkIDAmJihoPSExKSxBPT09dm9pZCAwJiYoQT0hMSk7dmFyIEk9dGhpcy5jdXJyZW50VG9rZW4oKSxPPXRoaXMuY3VycmVudElkKys7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihJLCJ2YWwiKSl7Kyt0aGlzLnBvc2l0aW9uLCh5PXRoaXMucGFyc2VUeXBlVmFyU2VxdWVuY2UoITApKT09PXZvaWQgMCYmKC0tdGhpcy5wb3NpdGlvbix5PVtdKTtmb3IodmFyIEU9W10scj0hMTs7KXt2YXIgZT10aGlzLnBhcnNlVmFsdWVCaW5kaW5nKCk7aWYoZS5pc1JlY3Vyc2l2ZSl7cj0hMDtmb3IodmFyIG89ZS5wYXR0ZXJuO28gaW5zdGFuY2VvZiBtLlR5cGVkRXhwcmVzc2lvbjspbz1vLmV4cHJlc3Npb247aWYoIShlLmV4cHJlc3Npb24gaW5zdGFuY2VvZiBtLkxhbWJkYSkpdGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoJ1VzaW5nICJyZWMiIHJlcXVpcmVzIGJpbmRpbmcgYSBsYW1iZGEuJyk7aWYoIShvIGluc3RhbmNlb2YgbS5WYWx1ZUlkZW50aWZpZXJ8fG8gaW5zdGFuY2VvZiBtLldpbGRjYXJkKSl0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignVXNpbmcgInJlYyIgcmVxdWlyZXMgYmluZGluZyB0byBhIHNpbmdsZSBpZGVudGlmaWVyIGFuZCBub3QgIicrby50b1N0cmluZygwLCEwKSsnIi4nKX1pZihlLmlzUmVjdXJzaXZlPXIsRS5wdXNoKGUpLCF0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImFuZCIpKWJyZWFrOysrdGhpcy5wb3NpdGlvbn1yZXR1cm4gbmV3IEIuVmFsdWVEZWNsYXJhdGlvbih5LEUsTyl9aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihJLCJmdW4iKSl7dmFyIHk7Kyt0aGlzLnBvc2l0aW9uLCh5PXRoaXMucGFyc2VUeXBlVmFyU2VxdWVuY2UoITApKT09PXZvaWQgMCYmKC0tdGhpcy5wb3NpdGlvbix5PVtdKTtmb3IodmFyIGQ9W107ZC5wdXNoKHRoaXMucGFyc2VGdW5jdGlvblZhbHVlQmluZGluZygpKSx0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImFuZCIpOykrK3RoaXMucG9zaXRpb247cmV0dXJuIG5ldyBCLkZ1bmN0aW9uRGVjbGFyYXRpb24oeSxkLE8pfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oSSwidHlwZSIpKXJldHVybisrdGhpcy5wb3NpdGlvbixuZXcgQi5UeXBlRGVjbGFyYXRpb24odGhpcy5wYXJzZVR5cGVCaW5kaW5nU2VxKCksTyk7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihJLCJkYXRhdHlwZSIpKXtpZih0aGlzLnBvc2l0aW9uKzM8dGhpcy50b2tlbnMubGVuZ3RoJiZ0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMudG9rZW5zW3RoaXMucG9zaXRpb24rM10sImRhdGF0eXBlIikpeysrdGhpcy5wb3NpdGlvbjt2YXIgdj10aGlzLmN1cnJlbnRUb2tlbigpO3RoaXMuYXNzZXJ0SWRlbnRpZmllclRva2VuKHYpLCsrdGhpcy5wb3NpdGlvbix0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI9IiksKyt0aGlzLnBvc2l0aW9uLHRoaXMuYXNzZXJ0S2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksImRhdGF0eXBlIiksKyt0aGlzLnBvc2l0aW9uO3ZhciBDPXRoaXMuY3VycmVudFRva2VuKCk7cmV0dXJuIHRoaXMuYXNzZXJ0SWRlbnRpZmllck9yTG9uZ1Rva2VuKEMpLCsrdGhpcy5wb3NpdGlvbixuZXcgQi5EYXRhdHlwZVJlcGxpY2F0aW9uKHYsQyxPKX0rK3RoaXMucG9zaXRpb247dmFyIEc9dGhpcy5wYXJzZURhdGF0eXBlQmluZGluZ1NlcSgpO2lmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwid2l0aHR5cGUiKSl7Kyt0aGlzLnBvc2l0aW9uO3ZhciBZPXRoaXMucGFyc2VUeXBlQmluZGluZ1NlcSgpO3JldHVybiBuZXcgQi5EYXRhdHlwZURlY2xhcmF0aW9uKEcsWSxPKX1yZXR1cm4gbmV3IEIuRGF0YXR5cGVEZWNsYXJhdGlvbihHLHZvaWQgMCxPKX1pZih0aGlzLmNoZWNrS2V5d29yZFRva2VuKEksImFic3R5cGUiKSl7Kyt0aGlzLnBvc2l0aW9uO3ZhciBKPXRoaXMuc3RhdGU7dGhpcy5zdGF0ZT10aGlzLnN0YXRlLmdldE5lc3RlZFN0YXRlKHRoaXMuc3RhdGUuaWQpO3ZhciB6PW5ldyBTZXQ7dGhpcy5uZXdjb25zLmZvckVhY2goZnVuY3Rpb24oXyl7ej16LmFkZChfKX0pLEc9dGhpcy5wYXJzZURhdGF0eXBlQmluZGluZ1NlcSgpO3ZhciBwPXZvaWQgMDt0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMuY3VycmVudFRva2VuKCksIndpdGh0eXBlIikmJigrK3RoaXMucG9zaXRpb24scD10aGlzLnBhcnNlVHlwZUJpbmRpbmdTZXEoKSksdGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwid2l0aCIpLCsrdGhpcy5wb3NpdGlvbjt2YXIgYz10aGlzLnBhcnNlRGVjbGFyYXRpb24oKTtyZXR1cm4gdGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiZW5kIiksKyt0aGlzLnBvc2l0aW9uLHRoaXMuc3RhdGU9Six0aGlzLm5ld2NvbnM9eixuZXcgQi5BYnN0eXBlRGVjbGFyYXRpb24oRyxwLGMsTyl9aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihJLCJleGNlcHRpb24iKSl7Kyt0aGlzLnBvc2l0aW9uO2Zvcih2YXIgdz1bXTt3LnB1c2godGhpcy5wYXJzZUV4Y2VwdGlvbkJpbmRpbmcoKSksdGhpcy5jaGVja0tleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCJhbmQiKTspKyt0aGlzLnBvc2l0aW9uO3JldHVybiBuZXcgQi5FeGNlcHRpb25EZWNsYXJhdGlvbih3LE8pfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oSSwibG9jYWwiKSl7Kyt0aGlzLnBvc2l0aW9uLEo9dGhpcy5zdGF0ZSx0aGlzLnN0YXRlPXRoaXMuc3RhdGUuZ2V0TmVzdGVkU3RhdGUodGhpcy5zdGF0ZS5pZCk7dmFyIFQ9bmV3IFNldDt0aGlzLm5ld2NvbnMuZm9yRWFjaChmdW5jdGlvbihfKXtUPVQuYWRkKF8pfSksYz10aGlzLnBhcnNlRGVjbGFyYXRpb24oITEsQSksdGhpcy5hc3NlcnRLZXl3b3JkVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSwiaW4iKSwrK3RoaXMucG9zaXRpb247dmFyIE49dGhpcy5wYXJzZURlY2xhcmF0aW9uKCExLEEpO3JldHVybiB0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCJlbmQiKSwrK3RoaXMucG9zaXRpb24sdGhpcy5zdGF0ZT1KLHRoaXMubmV3Y29ucz1ULG5ldyBCLkxvY2FsRGVjbGFyYXRpb24oYyxOLE8pfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oSSwib3BlbiIpKXsrK3RoaXMucG9zaXRpb247Zm9yKHZhciAkPVtdO3RoaXMuY2hlY2tJZGVudGlmaWVyT3JMb25nVG9rZW4odGhpcy5jdXJyZW50VG9rZW4oKSk7KSQucHVzaCh0aGlzLmN1cnJlbnRUb2tlbigpKSwrK3RoaXMucG9zaXRpb247aWYoJC5sZW5ndGg9PT0wKXRocm93IG5ldyBzLlBhcnNlckVycm9yKCdFbXB0eSAib3BlbiIgZGVjbGFyYXRpb24uJyk7cmV0dXJuIG5ldyBCLk9wZW5EZWNsYXJhdGlvbigkLE8pfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oSSwiaW5maXgiKSl7Kyt0aGlzLnBvc2l0aW9uO3ZhciBIPTA7aWYodGhpcy5jdXJyZW50VG9rZW4oKWluc3RhbmNlb2YgcS5JbnRlZ2VyQ29uc3RhbnRUb2tlbil7aWYodGhpcy5jdXJyZW50VG9rZW4oKS50ZXh0Lmxlbmd0aCE9PTEpdGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoIlByZWNlZGVuY2VzIG1heSBvbmx5IGJlIHNpbmdsZSBkaWdpdHMuIik7SD10aGlzLmN1cnJlbnRUb2tlbigpLnZhbHVlLCsrdGhpcy5wb3NpdGlvbn1mb3IoJD1bXTt0aGlzLmN1cnJlbnRUb2tlbigpLmlzVmlkKCk7KSQucHVzaCh0aGlzLmN1cnJlbnRUb2tlbigpKSwrK3RoaXMucG9zaXRpb247aWYoJC5sZW5ndGg9PT0wKXRocm93IG5ldyBzLlBhcnNlckVycm9yKCdFbXB0eSAiaW5maXgiIGRlY2xhcmF0aW9uLicpO3JldHVybihQPW5ldyBCLkluZml4RGVjbGFyYXRpb24oJCxILE8pKS5zZXRJbmZpeFN0YXR1cyh0aGlzLnN0YXRlKSxQfWlmKHRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oSSwiaW5maXhyIikpe2lmKCsrdGhpcy5wb3NpdGlvbixIPTAsdGhpcy5jdXJyZW50VG9rZW4oKWluc3RhbmNlb2YgcS5JbnRlZ2VyQ29uc3RhbnRUb2tlbil7aWYodGhpcy5jdXJyZW50VG9rZW4oKS50ZXh0Lmxlbmd0aCE9PTEpdGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoIlByZWNlZGVuY2VzIG1heSBvbmx5IGJlIHNpbmdsZSBkaWdpdHMuIik7SD10aGlzLmN1cnJlbnRUb2tlbigpLnZhbHVlLCsrdGhpcy5wb3NpdGlvbn1mb3IoJD1bXTt0aGlzLmN1cnJlbnRUb2tlbigpLmlzVmlkKCk7KSQucHVzaCh0aGlzLmN1cnJlbnRUb2tlbigpKSwrK3RoaXMucG9zaXRpb247aWYoJC5sZW5ndGg9PT0wKXRocm93IG5ldyBzLlBhcnNlckVycm9yKCdFbXB0eSAiaW5maXhyIiBkZWNsYXJhdGlvbi4nKTtyZXR1cm4oUD1uZXcgQi5JbmZpeFJEZWNsYXJhdGlvbigkLEgsTykpLnNldEluZml4U3RhdHVzKHRoaXMuc3RhdGUpLFB9aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihJLCJub25maXgiKSl7Zm9yKCsrdGhpcy5wb3NpdGlvbiwkPVtdO3RoaXMuY3VycmVudFRva2VuKCkuaXNWaWQoKTspJC5wdXNoKHRoaXMuY3VycmVudFRva2VuKCkpLCsrdGhpcy5wb3NpdGlvbjtpZigkLmxlbmd0aD09PTApdGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoJ0VtcHR5ICJub25maXgiIGRlY2xhcmF0aW9uLicpO3ZhciBQO3JldHVybihQPW5ldyBCLk5vbmZpeERlY2xhcmF0aW9uKCQsTykpLnNldEluZml4U3RhdHVzKHRoaXMuc3RhdGUpLFB9aWYodGhpcy5vcHRpb25zLmFsbG93U3VjY2Vzc29yTUwmJnRoaXMuY2hlY2tLZXl3b3JkVG9rZW4oSSwiZG8iKSlyZXR1cm4rK3RoaXMucG9zaXRpb24sbmV3IEIuRXZhbHVhdGlvbih0aGlzLnBhcnNlRXhwcmVzc2lvbigpKTtpZigodGhpcy5vcHRpb25zLmFsbG93U3RydWN0dXJlc0FueXdoZXJlPT09ITB8fEEpJiZ0aGlzLmNoZWNrS2V5d29yZFRva2VuKEksInN0cnVjdHVyZSIpKXJldHVybisrdGhpcy5wb3NpdGlvbixuZXcgTS5TdHJ1Y3R1cmVEZWNsYXJhdGlvbih0aGlzLnBhcnNlU3RydWN0dXJlQmluZGluZ1NlcSgpKTtpZigodGhpcy5vcHRpb25zLmFsbG93U2lnbmF0dXJlc0FueXdoZXJlPT09ITB8fGgpJiZ0aGlzLmNoZWNrS2V5d29yZFRva2VuKEksInNpZ25hdHVyZSIpKXJldHVybisrdGhpcy5wb3NpdGlvbixuZXcgTS5TaWduYXR1cmVEZWNsYXJhdGlvbih0aGlzLnBhcnNlU2lnbmF0dXJlQmluZGluZ1NlcSgpKTtpZigodGhpcy5vcHRpb25zLmFsbG93RnVuY3RvcnNBbnl3aGVyZT09PSEwfHxoKSYmdGhpcy5jaGVja0tleXdvcmRUb2tlbihJLCJmdW5jdG9yIikpcmV0dXJuKyt0aGlzLnBvc2l0aW9uLG5ldyBNLkZ1bmN0b3JEZWNsYXJhdGlvbih0aGlzLnBhcnNlRnVuY3RvckJpbmRpbmdTZXEoKSk7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihJLCI7IikpcmV0dXJuKyt0aGlzLnBvc2l0aW9uLG5ldyBCLkVtcHR5RGVjbGFyYXRpb24oTyk7aWYodGhpcy5jaGVja0tleXdvcmRUb2tlbihJLCJpbiIpfHx0aGlzLmNoZWNrS2V5d29yZFRva2VuKEksImVuZCIpfHx0aGlzLmNoZWNrS2V5d29yZFRva2VuKEksIikiKSlyZXR1cm4gbmV3IEIuRW1wdHlEZWNsYXJhdGlvbihPKTtpZihoKXtpZih0aGlzLnBvc2l0aW9uPjAmJiF0aGlzLmNoZWNrS2V5d29yZFRva2VuKHRoaXMudG9rZW5zW3RoaXMucG9zaXRpb24tMV0sIjsiKSl0aHJvdyBuZXcgcy5QYXJzZXJFcnJvcignQSBzaW5nbGUgdG9wLWxldmVsIGV4cHJlc3Npb24gbXVzdCBiZSBzZXBhcmF0ZWQgZnJvbSBwcmVjZWVkaW5nIGRlY2xhcmF0aW9ucyBieSBhICI7Ii4nKTt2YXIgeD10aGlzLnBhcnNlRXhwcmVzc2lvbigpLFI9bmV3IEIuVmFsdWVCaW5kaW5nKCExLG5ldyBtLlZhbHVlSWRlbnRpZmllcihuZXcgcS5BbHBoYW51bWVyaWNJZGVudGlmaWVyVG9rZW4oIml0IikpLHgpO3JldHVybiB0aGlzLmFzc2VydEtleXdvcmRUb2tlbih0aGlzLmN1cnJlbnRUb2tlbigpLCI7IiksbmV3IEIuVmFsdWVEZWNsYXJhdGlvbihbXSxbUl0sTyl9dGhyb3cgbmV3IHMuUGFyc2VyRXJyb3IoJ0V4cGVjdGVkIGEgZGVjbGFyYXRpb24sIGZvdW5kICInK0kuZ2V0VGV4dCgpKyciLicpfSxELnByb3RvdHlwZS5jdXJyZW50VG9rZW49ZnVuY3Rpb24oKXtpZih0aGlzLnBvc2l0aW9uPj10aGlzLnRva2Vucy5sZW5ndGgpdGhyb3cgbmV3IHMuSW5jb21wbGV0ZUVycm9yKCJNb3JlIGlucHV0LCBJJ20gc3RhcnZpbmcuIH5ueWFuLiIpO3JldHVybiB0aGlzLnRva2Vuc1t0aGlzLnBvc2l0aW9uXX0sRC5wcm90b3R5cGUubmV4dFRva2VuPWZ1bmN0aW9uKCl7aWYodGhpcy5wb3NpdGlvbisxPj10aGlzLnRva2Vucy5sZW5ndGgpdGhyb3cgbmV3IHMuSW5jb21wbGV0ZUVycm9yKCJNb3JlIGlucHV0LCBJJ20gc3RhcnZpbmcuIH5ueWFuLiIpO3JldHVybiB0aGlzLnRva2Vuc1t0aGlzLnBvc2l0aW9uKzFdfSxEfSgpO3UuUGFyc2VyPVYsdS5wYXJzZT1mdW5jdGlvbihELGgsQSl7QT09PXZvaWQgMCYmKEE9e30pO3ZhciBJPW5ldyBWKEQsaCxoLmlkLEEpLE89SS5wYXJzZURlY2xhcmF0aW9uKCEwLCEwKTtyZXR1cm4gSS5hc3NlcnRGaW5pc2hlZCgpLE99fSwzNjc6KGZlLHUsSyk9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdS5TdGF0ZT11LlN0YXRpY0Jhc2lzPXUuRHluYW1pY0Jhc2lzPXUuSW5maXhTdGF0dXM9dS5EeW5hbWljSW50ZXJmYWNlPXUuRHluYW1pY0Z1bmN0b3JJbmZvcm1hdGlvbj11LlR5cGVJbmZvcm1hdGlvbj11LklkZW50aWZpZXJTdGF0dXM9dm9pZCAwO3ZhciBtLGc9Syg2OTkpLHM9SygxMDYpLHE9Syg1MzQpLEI9Syg3NTgpOyhtPXUuSWRlbnRpZmllclN0YXR1c3x8KHUuSWRlbnRpZmllclN0YXR1cz17fSkpW20uVkFMVUVfVkFSSUFCTEU9MF09IlZBTFVFX1ZBUklBQkxFIixtW20uVkFMVUVfQ09OU1RSVUNUT1I9MV09IlZBTFVFX0NPTlNUUlVDVE9SIixtW20uRVhDRVBUSU9OX0NPTlNUUlVDVE9SPTJdPSJFWENFUFRJT05fQ09OU1RSVUNUT1IiO3ZhciBNPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gRShyLGUsbyx5KXt5PT09dm9pZCAwJiYoeT0hMCksdGhpcy50eXBlPXIsdGhpcy5jb25zdHJ1Y3RvcnM9ZSx0aGlzLmFyaXR5PW8sdGhpcy5hbGxvd3NFcXVhbGl0eT15fXJldHVybiBFLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVybiJUeXBlSW5mb3JtYXRpb24oIit0aGlzLnR5cGUrIiwgWyIrdGhpcy5jb25zdHJ1Y3RvcnMrIl0sIGFyaXR5ID0gIit0aGlzLmFyaXR5KyIsIGFsbG93c0VxdWFsaXR5ID0gIit0aGlzLmFsbG93c0VxdWFsaXR5KyIpIn0sRX0oKTt1LlR5cGVJbmZvcm1hdGlvbj1NO3ZhciBWPWZ1bmN0aW9uKEUscixlLG8pe3RoaXMucGFyYW1OYW1lPUUsdGhpcy5wYXJhbT1yLHRoaXMuYm9keT1lLHRoaXMuc3RhdGU9b307dS5EeW5hbWljRnVuY3RvckluZm9ybWF0aW9uPVY7dmFyIEQ9ZnVuY3Rpb24oKXtmdW5jdGlvbiBFKHIsZSxvKXt0aGlzLnR5cGVJbnRlcmZhY2U9cix0aGlzLnZhbHVlSW50ZXJmYWNlPWUsdGhpcy5zdHJ1Y3R1cmVJbnRlcmZhY2U9b31yZXR1cm4gRS5wcm90b3R5cGUuZXh0ZW5kPWZ1bmN0aW9uKHIpe2Zvcih2YXIgZSBpbiByLnR5cGVJbnRlcmZhY2Upci50eXBlSW50ZXJmYWNlLmhhc093blByb3BlcnR5KGUpJiYodGhpcy50eXBlSW50ZXJmYWNlW2VdPXIudHlwZUludGVyZmFjZVtlXSk7Zm9yKHZhciBlIGluIHIudmFsdWVJbnRlcmZhY2Upci52YWx1ZUludGVyZmFjZS5oYXNPd25Qcm9wZXJ0eShlKSYmKHRoaXMudmFsdWVJbnRlcmZhY2VbZV09ci52YWx1ZUludGVyZmFjZVtlXSk7Zm9yKHZhciBlIGluIHIuc3RydWN0dXJlSW50ZXJmYWNlKXIuc3RydWN0dXJlSW50ZXJmYWNlLmhhc093blByb3BlcnR5KGUpJiYodGhpcy5zdHJ1Y3R1cmVJbnRlcmZhY2VbZV09ci5zdHJ1Y3R1cmVJbnRlcmZhY2VbZV0pO3JldHVybiB0aGlzfSxFfSgpO3UuRHluYW1pY0ludGVyZmFjZT1EO3ZhciBoPWZ1bmN0aW9uKEUscixlKXtyPT09dm9pZCAwJiYocj0wKSxlPT09dm9pZCAwJiYoZT0hMSksdGhpcy5pbmZpeD1FLHRoaXMucHJlY2VkZW5jZT1yLHRoaXMucmlnaHRBc3NvY2lhdGl2ZT1lfTt1LkluZml4U3RhdHVzPWg7dmFyIEE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBFKHIsZSxvLHksZCl7dGhpcy50eXBlRW52aXJvbm1lbnQ9cix0aGlzLnZhbHVlRW52aXJvbm1lbnQ9ZSx0aGlzLnN0cnVjdHVyZUVudmlyb25tZW50PW8sdGhpcy5zaWduYXR1cmVFbnZpcm9ubWVudD15LHRoaXMuZnVuY3RvckVudmlyb25tZW50PWR9cmV0dXJuIEUucHJvdG90eXBlLmdldFZhbHVlPWZ1bmN0aW9uKHIpe2lmKHRoaXMudmFsdWVFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShyKSlyZXR1cm4gdGhpcy52YWx1ZUVudmlyb25tZW50W3JdfSxFLnByb3RvdHlwZS5nZXRUeXBlPWZ1bmN0aW9uKHIpe2lmKHRoaXMudHlwZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KHIpKXJldHVybiB0aGlzLnR5cGVFbnZpcm9ubWVudFtyXX0sRS5wcm90b3R5cGUuZ2V0U3RydWN0dXJlPWZ1bmN0aW9uKHIpe2lmKHRoaXMuc3RydWN0dXJlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkocikpcmV0dXJuIHRoaXMuc3RydWN0dXJlRW52aXJvbm1lbnRbcl19LEUucHJvdG90eXBlLmdldFNpZ25hdHVyZT1mdW5jdGlvbihyKXtpZih0aGlzLnNpZ25hdHVyZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KHIpKXJldHVybiB0aGlzLnNpZ25hdHVyZUVudmlyb25tZW50W3JdfSxFLnByb3RvdHlwZS5nZXRGdW5jdG9yPWZ1bmN0aW9uKHIpe2lmKHRoaXMuZnVuY3RvckVudmlyb25tZW50Lmhhc093blByb3BlcnR5KHIpKXJldHVybiBuZXcgVih0aGlzLmZ1bmN0b3JFbnZpcm9ubWVudFtyXS5wYXJhbU5hbWUsdGhpcy5mdW5jdG9yRW52aXJvbm1lbnRbcl0ucGFyYW0sdGhpcy5mdW5jdG9yRW52aXJvbm1lbnRbcl0uYm9keSx0aGlzLmZ1bmN0b3JFbnZpcm9ubWVudFtyXS5zdGF0ZS5nZXROZXN0ZWRTdGF0ZSh0aGlzLmZ1bmN0b3JFbnZpcm9ubWVudFtyXS5zdGF0ZS5pZCkpfSxFLnByb3RvdHlwZS5zZXRWYWx1ZT1mdW5jdGlvbihyLGUsbyl7dGhpcy52YWx1ZUVudmlyb25tZW50W3JdPVtlLG9dfSxFLnByb3RvdHlwZS5zZXRUeXBlPWZ1bmN0aW9uKHIsZSl7dGhpcy50eXBlRW52aXJvbm1lbnRbcl09ZX0sRS5wcm90b3R5cGUuc2V0U3RydWN0dXJlPWZ1bmN0aW9uKHIsZSl7dGhpcy5zdHJ1Y3R1cmVFbnZpcm9ubWVudFtyXT1lfSxFLnByb3RvdHlwZS5zZXRTaWduYXR1cmU9ZnVuY3Rpb24ocixlKXt0aGlzLnNpZ25hdHVyZUVudmlyb25tZW50W3JdPWV9LEUucHJvdG90eXBlLnNldEZ1bmN0b3I9ZnVuY3Rpb24ocixlKXt0aGlzLmZ1bmN0b3JFbnZpcm9ubWVudFtyXT1lfSxFLnByb3RvdHlwZS5leHRlbmQ9ZnVuY3Rpb24ocil7Zm9yKHZhciBlIGluIHIudHlwZUVudmlyb25tZW50KXIudHlwZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KGUpJiYodGhpcy50eXBlRW52aXJvbm1lbnRbZV09ci50eXBlRW52aXJvbm1lbnRbZV0pO2Zvcih2YXIgZSBpbiByLnZhbHVlRW52aXJvbm1lbnQpci52YWx1ZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KGUpJiYodGhpcy52YWx1ZUVudmlyb25tZW50W2VdPXIudmFsdWVFbnZpcm9ubWVudFtlXSk7Zm9yKHZhciBlIGluIHIuc3RydWN0dXJlRW52aXJvbm1lbnQpci5zdHJ1Y3R1cmVFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShlKSYmKHRoaXMuc3RydWN0dXJlRW52aXJvbm1lbnRbZV09ci5zdHJ1Y3R1cmVFbnZpcm9ubWVudFtlXSk7Zm9yKHZhciBlIGluIHIuc2lnbmF0dXJlRW52aXJvbm1lbnQpci5zaWduYXR1cmVFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShlKSYmKHRoaXMuc2lnbmF0dXJlRW52aXJvbm1lbnRbZV09ci5zaWduYXR1cmVFbnZpcm9ubWVudFtlXSk7Zm9yKHZhciBlIGluIHIuZnVuY3RvckVudmlyb25tZW50KXIuZnVuY3RvckVudmlyb25tZW50Lmhhc093blByb3BlcnR5KGUpJiYodGhpcy5mdW5jdG9yRW52aXJvbm1lbnRbZV09ci5mdW5jdG9yRW52aXJvbm1lbnRbZV0pO3JldHVybiB0aGlzfSxFLnByb3RvdHlwZS5yZXN0cmljdD1mdW5jdGlvbihyKXt2YXIgZT1uZXcgRSh7fSx7fSx7fSx0aGlzLnNpZ25hdHVyZUVudmlyb25tZW50LHRoaXMuZnVuY3RvckVudmlyb25tZW50KTtmb3IodmFyIG8gaW4gci50eXBlSW50ZXJmYWNlKWlmKHIudHlwZUludGVyZmFjZS5oYXNPd25Qcm9wZXJ0eShvKSYmdGhpcy50eXBlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkobykpe2Zvcih2YXIgeT1uZXcgU2V0LGQ9W10sdj0wO3Y8dGhpcy50eXBlRW52aXJvbm1lbnRbb10ubGVuZ3RoOysrdil5PXkuYWRkKHRoaXMudHlwZUVudmlyb25tZW50W29dW3ZdKTtmb3Iodj0wO3Y8ci50eXBlSW50ZXJmYWNlW29dLmxlbmd0aDsrK3YpeS5oYXMoci50eXBlSW50ZXJmYWNlW29dW3ZdKSYmZC5wdXNoKHIudHlwZUludGVyZmFjZVtvXVt2XSk7ZS50eXBlRW52aXJvbm1lbnRbb109ZH1mb3IodmFyIG8gaW4gci52YWx1ZUludGVyZmFjZSlyLnZhbHVlSW50ZXJmYWNlLmhhc093blByb3BlcnR5KG8pJiZ0aGlzLnZhbHVlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkobykmJihlLnZhbHVlRW52aXJvbm1lbnRbb109W3RoaXMudmFsdWVFbnZpcm9ubWVudFtvXVswXSxyLnZhbHVlSW50ZXJmYWNlW29dXSk7Zm9yKHZhciBvIGluIHIuc3RydWN0dXJlSW50ZXJmYWNlKXIuc3RydWN0dXJlSW50ZXJmYWNlLmhhc093blByb3BlcnR5KG8pJiZ0aGlzLnN0cnVjdHVyZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KG8pJiYoZS5zdHJ1Y3R1cmVFbnZpcm9ubWVudFtvXT10aGlzLnN0cnVjdHVyZUVudmlyb25tZW50W29dLnJlc3RyaWN0KHIuc3RydWN0dXJlSW50ZXJmYWNlW29dKSk7cmV0dXJuIGV9LEV9KCk7dS5EeW5hbWljQmFzaXM9QTt2YXIgST1mdW5jdGlvbigpe2Z1bmN0aW9uIEUocixlLG8seSxkKXt0aGlzLnR5cGVFbnZpcm9ubWVudD1yLHRoaXMudmFsdWVFbnZpcm9ubWVudD1lLHRoaXMuc3RydWN0dXJlRW52aXJvbm1lbnQ9byx0aGlzLnNpZ25hdHVyZUVudmlyb25tZW50PXksdGhpcy5mdW5jdG9yRW52aXJvbm1lbnQ9ZH1yZXR1cm4gRS5wcm90b3R5cGUuZ2V0VmFsdWU9ZnVuY3Rpb24ocil7aWYodGhpcy52YWx1ZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KHIpKXJldHVybiB0aGlzLnZhbHVlRW52aXJvbm1lbnRbcl19LEUucHJvdG90eXBlLmdldFR5cGU9ZnVuY3Rpb24ocil7aWYodGhpcy50eXBlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkocikpcmV0dXJuIHRoaXMudHlwZUVudmlyb25tZW50W3JdfSxFLnByb3RvdHlwZS5nZXRTdHJ1Y3R1cmU9ZnVuY3Rpb24ocil7aWYodGhpcy5zdHJ1Y3R1cmVFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShyKSlyZXR1cm4gdGhpcy5zdHJ1Y3R1cmVFbnZpcm9ubWVudFtyXX0sRS5wcm90b3R5cGUuZ2V0U2lnbmF0dXJlPWZ1bmN0aW9uKHIpe2lmKHRoaXMuc2lnbmF0dXJlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkocikpcmV0dXJuIHRoaXMuc2lnbmF0dXJlRW52aXJvbm1lbnRbcl19LEUucHJvdG90eXBlLmdldEZ1bmN0b3I9ZnVuY3Rpb24ocil7aWYodGhpcy5mdW5jdG9yRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkocikpe3ZhciBlPXRoaXMuZnVuY3RvckVudmlyb25tZW50W3JdWzBdLG89dGhpcy5mdW5jdG9yRW52aXJvbm1lbnRbcl1bMV07cmV0dXJuW25ldyBFKHt9LHt9LHt9LHt9LHt9KS5leHRlbmQoZSksbmV3IEUoe30se30se30se30se30pLmV4dGVuZChvKSx0aGlzLmZ1bmN0b3JFbnZpcm9ubWVudFtyXVsyXSx0aGlzLmZ1bmN0b3JFbnZpcm9ubWVudFtyXVszXV19fSxFLnByb3RvdHlwZS5zZXRWYWx1ZT1mdW5jdGlvbihyLGUsbyl7dGhpcy52YWx1ZUVudmlyb25tZW50W3JdPVtlLG9dfSxFLnByb3RvdHlwZS5kZWxldGVWYWx1ZT1mdW5jdGlvbihyKXt0aGlzLnZhbHVlRW52aXJvbm1lbnRbcl09dm9pZCAwfSxFLnByb3RvdHlwZS5zZXRUeXBlPWZ1bmN0aW9uKHIsZSxvLHksZCl7dGhpcy50eXBlRW52aXJvbm1lbnRbcl09bmV3IE0oZSxvLHksZCl9LEUucHJvdG90eXBlLnNldFN0cnVjdHVyZT1mdW5jdGlvbihyLGUpe3RoaXMuc3RydWN0dXJlRW52aXJvbm1lbnRbcl09ZX0sRS5wcm90b3R5cGUuc2V0U2lnbmF0dXJlPWZ1bmN0aW9uKHIsZSl7dGhpcy5zaWduYXR1cmVFbnZpcm9ubWVudFtyXT1lfSxFLnByb3RvdHlwZS5zZXRGdW5jdG9yPWZ1bmN0aW9uKHIsZSxvKXt0aGlzLmZ1bmN0b3JFbnZpcm9ubWVudFtyXT1bZVswXSxlWzFdLGVbMl0sb119LEUucHJvdG90eXBlLmV4dGVuZD1mdW5jdGlvbihyKXtmb3IodmFyIGUgaW4gci50eXBlRW52aXJvbm1lbnQpci50eXBlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkoZSkmJih0aGlzLnR5cGVFbnZpcm9ubWVudFtlXT1uZXcgTShyLnR5cGVFbnZpcm9ubWVudFtlXS50eXBlLHIudHlwZUVudmlyb25tZW50W2VdLmNvbnN0cnVjdG9ycyxyLnR5cGVFbnZpcm9ubWVudFtlXS5hcml0eSxyLnR5cGVFbnZpcm9ubWVudFtlXS5hbGxvd3NFcXVhbGl0eSkpO2Zvcih2YXIgZSBpbiByLnZhbHVlRW52aXJvbm1lbnQpci52YWx1ZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KGUpJiYodGhpcy52YWx1ZUVudmlyb25tZW50W2VdPXIudmFsdWVFbnZpcm9ubWVudFtlXSk7Zm9yKHZhciBlIGluIHIuc3RydWN0dXJlRW52aXJvbm1lbnQpci5zdHJ1Y3R1cmVFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShlKSYmKHRoaXMuc3RydWN0dXJlRW52aXJvbm1lbnRbZV09ci5zdHJ1Y3R1cmVFbnZpcm9ubWVudFtlXSk7Zm9yKHZhciBlIGluIHIuc2lnbmF0dXJlRW52aXJvbm1lbnQpci5zaWduYXR1cmVFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShlKSYmKHRoaXMuc2lnbmF0dXJlRW52aXJvbm1lbnRbZV09ci5zaWduYXR1cmVFbnZpcm9ubWVudFtlXSk7Zm9yKHZhciBlIGluIHIuZnVuY3RvckVudmlyb25tZW50KXIuZnVuY3RvckVudmlyb25tZW50Lmhhc093blByb3BlcnR5KGUpJiYodGhpcy5mdW5jdG9yRW52aXJvbm1lbnRbZV09ci5mdW5jdG9yRW52aXJvbm1lbnRbZV0pO3JldHVybiB0aGlzfSxFfSgpO3UuU3RhdGljQmFzaXM9STt2YXIgTz1mdW5jdGlvbigpe2Z1bmN0aW9uIEUocixlLG8seSxkLHYsQyxHLFksSix6LHAsYyl7Qz09PXZvaWQgMCYmKEM9WzAsbmV3IE1hcF0pLEc9PT12b2lkIDAmJihHPXt9KSxZPT09dm9pZCAwJiYoWT17fSksSj09PXZvaWQgMCYmKEo9W10pLHo9PT12b2lkIDAmJih6PSExKSxwPT09dm9pZCAwJiYocD0hMSksYz09PXZvaWQgMCYmKGM9W10pLHRoaXMuaWQ9cix0aGlzLnBhcmVudD1lLHRoaXMuc3RhdGljQmFzaXM9byx0aGlzLmR5bmFtaWNCYXNpcz15LHRoaXMubWVtb3J5PWQsdGhpcy5leGNlcHRpb25FdmFsSWQ9dix0aGlzLmZyZWVUeXBlVmFyaWFibGVzPUMsdGhpcy5pbmZpeEVudmlyb25tZW50PUcsdGhpcy52YWx1ZUlkZW50aWZpZXJJZD1ZLHRoaXMud2FybnM9Six0aGlzLmluc2lkZUxvY2FsRGVjbEJvZHk9eix0aGlzLmxvY2FsRGVjbFN0YXJ0PXAsdGhpcy5sb2FkZWRNb2R1bGVzPWN9cmV0dXJuIEUuYWxsb3dzUmViaW5kPWZ1bmN0aW9uKHIpe3JldHVybnt0cnVlOiExLGZhbHNlOiExLG5pbDohMSwiOjoiOiExLCI9IjohMSxyZWY6ITEsIjo9IjohMSwiISI6ITF9W3JdPT09dm9pZCAwfSxFLnByb3RvdHlwZS5wcmludEJpbmRpbmc9ZnVuY3Rpb24ocixlLG8seSxkKXt5PT09dm9pZCAwJiYoeT17fSksZD09PXZvaWQgMCYmKGQ9ITApO3ZhciB2LEMsRz15LmJvbGRUZXh0PT09dm9pZCAwP2Z1bmN0aW9uKHApe3JldHVybiBwfTp5LmJvbGRUZXh0LFk9eS5pdGFsaWNUZXh0PT09dm9pZCAwP2Z1bmN0aW9uKHApe3JldHVybiBwfTp5Lml0YWxpY1RleHQsSj15LmVzY2FwZVRleHQ9PT12b2lkIDA/ZnVuY3Rpb24ocCl7cmV0dXJuIHB9OnkuZXNjYXBlVGV4dDtlIT09dm9pZCAwJiYodj1lWzBdKSxvIT09dm9pZCAwJiYoQz1vWzBdKTt2YXIgej0iIjtyZXR1cm4odiBpbnN0YW5jZW9mIHMuVmFsdWVDb25zdHJ1Y3Rvcnx8byBpbnN0YW5jZW9mIGcuQ3VzdG9tVHlwZSYmbysiIiE9ImV4biIpJiZkP3orPSJjb24iOmUgaW5zdGFuY2VvZiBzLkV4Y2VwdGlvbkNvbnN0cnVjdG9yfHxvKyIiPT0iZXhuIj96Kz0iZXhuIjp6Kz0idmFsIix2P0MmJkMuaXNPcGFxdWUoKT96Kz0iICIrRyhyKyIgPSA8IitKKEMuZ2V0T3BhcXVlTmFtZSgpKSsiPiIpOnorPSIgIitHKHIrIiA9ICIrSih2LnRvU3RyaW5nKHRoaXMpKSk6eis9IiAiK0cociksQz96KyI6ICIrWShKKEMudG9TdHJpbmcoeSkpKSsiOyI6eisiOiB1bmRlZmluZWQ7In0sRS5wcm90b3R5cGUucHJpbnRCYXNpcz1mdW5jdGlvbihyLGUsbyx5KXtvPT09dm9pZCAwJiYobz17fSkseT09PXZvaWQgMCYmKHk9MCk7dmFyIGQ9IiIsdj1vLmZ1bGxTeW1ib2w9PT12b2lkIDA/IiI6by5mdWxsU3ltYm9sLEM9by5lbXB0eVN5bWJvbD09PXZvaWQgMD8iIjpvLmVtcHR5U3ltYm9sLEc9eT09PTA/djpDLFk9IiAiLnJlcGVhdCh5KihvLmluZGVudD09PXZvaWQgMD8yOm8uaW5kZW50KSksSj1vLmJvbGRUZXh0PT09dm9pZCAwP2Z1bmN0aW9uKHgpe3JldHVybiB4fTpvLmJvbGRUZXh0LHo9by5lc2NhcGVUZXh0PT09dm9pZCAwP2Z1bmN0aW9uKHgpe3JldHVybiB4fTpvLmVzY2FwZVRleHQ7aWYocj09PXZvaWQgMCYmZSE9PXZvaWQgMCl7Zm9yKHZhciBwIGluIGUudmFsdWVFbnZpcm9ubWVudCllLnZhbHVlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkocCkmJihkKz1HKyIgIitZK3RoaXMucHJpbnRCaW5kaW5nKHAsdm9pZCAwLGUuZ2V0VmFsdWUocCksbykrYApgKTtmb3IodmFyIHAgaW4gZS50eXBlRW52aXJvbm1lbnQpaWYoZS50eXBlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkocCkmJihIPWUuZ2V0VHlwZShwKSkhPT12b2lkIDAmJkgudHlwZSBpbnN0YW5jZW9mIGcuQ3VzdG9tVHlwZSlpZihILmNvbnN0cnVjdG9ycy5sZW5ndGg9PT0wKUguYWxsb3dzRXF1YWxpdHk/ZCs9RysiICIrWSsiZXF0eXBlICIrSih6KEgudHlwZS50b1N0cmluZyhvKSkpK2A7CmA6ZCs9RysiICIrWSsidHlwZSAiK0ooeihILnR5cGUudG9TdHJpbmcobykpKStgOwpgO2Vsc2V7ZCs9RysiICIrWSsiZGF0YXR5cGUgIitKKHooSC50eXBlLnRvU3RyaW5nKG8pKSkrYCA6IHsKYDtmb3IodmFyIGM9MCx3PUguY29uc3RydWN0b3JzO2M8dy5sZW5ndGg7YysrKXt2YXIgVD13W2NdO2QrPUMrIiAgICIrWSt0aGlzLnByaW50QmluZGluZyhULHZvaWQgMCxlLmdldFZhbHVlKFQpLG8pK2AKYH1kKz1DKyIgIitZK2B9OwpgfWZvcih2YXIgcCBpbiBlLnR5cGVFbnZpcm9ubWVudCllLnR5cGVFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShwKSYmKEg9ZS5nZXRUeXBlKHApKSE9PXZvaWQgMCYmSC50eXBlIGluc3RhbmNlb2YgZy5GdW5jdGlvblR5cGUmJihkKz1HKyIgIitZKyJ0eXBlICIrSih6KEgudHlwZS5wYXJhbWV0ZXJUeXBlLnRvU3RyaW5nKG8pKSsiID0gIit6KEgudHlwZS5yZXR1cm5UeXBlLnRvU3RyaW5nKG8pKSkrYDsKYCk7Zm9yKHZhciBwIGluIGUuc3RydWN0dXJlRW52aXJvbm1lbnQpZS5zdHJ1Y3R1cmVFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShwKSYmKGQrPUcrIiAiK1krInN0cnVjdHVyZSAiK0ooeihwKSkrYDogc2lnCmAsZCs9ZT90aGlzLnByaW50QmFzaXModm9pZCAwLGUuZ2V0U3RydWN0dXJlKHApLG8seSsxKTp0aGlzLnByaW50QmFzaXModm9pZCAwLHZvaWQgMCxvLHkrMSksZCs9QysiICIrWStgZW5kOwpgKTtmb3IodmFyIHAgaW4gZS5zaWduYXR1cmVFbnZpcm9ubWVudCllLnNpZ25hdHVyZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KHApJiYoZCs9RysiICIrWSsic2lnbmF0dXJlICIrSih6KHApKStgOiBzaWcKYCxkKz1lP3RoaXMucHJpbnRCYXNpcyh2b2lkIDAsZS5nZXRTaWduYXR1cmUocCksbyx5KzEpOnRoaXMucHJpbnRCYXNpcyh2b2lkIDAsdm9pZCAwLG8seSsxKSxkKz1DKyIgIitZK2BlbmQ7CmApO2Zvcih2YXIgcCBpbiBlLmZ1bmN0b3JFbnZpcm9ubWVudCllLmZ1bmN0b3JFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShwKSYmKGQrPUcrIiAiK1krImZ1bmN0b3IgIitKKHoocCkpKyIoIixlPyhQPWUuZ2V0RnVuY3RvcihwKSkhPT12b2lkIDA/UFsyXSE9PXZvaWQgMD8oZCs9UFsyXStgOiBzaWcKYCxkKz10aGlzLnByaW50QmFzaXModm9pZCAwLFBbMF0sbyx5KzEpLGQrPUMrIiAiK1krYGVuZCk6IHNpZwpgLGQrPXRoaXMucHJpbnRCYXNpcyh2b2lkIDAsUFsxXSxvLHkrMSkpOihkKz1gCmAsZCs9dGhpcy5wcmludEJhc2lzKHZvaWQgMCxQWzBdLG8seSsxKSxkKz1DKyIgIitZK2ApOiBzdHJ1Y3QKYCxkKz10aGlzLnByaW50QmFzaXModm9pZCAwLFBbMV0sbyx5KzEpKTpkKz1gPHVuZGVmaW5lZD4pOiBzdHJ1Y3QKYDooZCs9YCA/Pz8gKTogc2lnCmAsZCs9dGhpcy5wcmludEJhc2lzKHZvaWQgMCx2b2lkIDAsbyx5KzEpKSxkKz1DKyIgIitZK2BlbmQ7CmApfWVsc2UgaWYoZSE9PXZvaWQgMCYmciE9PXZvaWQgMCl7Zm9yKHZhciBwIGluIHIudmFsdWVFbnZpcm9ubWVudClyLnZhbHVlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkocCkmJihkKz1lP0crIiAiK1krdGhpcy5wcmludEJpbmRpbmcocCxyLnZhbHVlRW52aXJvbm1lbnRbcF0sZS5nZXRWYWx1ZShwKSxvLCExKStgCmA6RysiICIrWSt0aGlzLnByaW50QmluZGluZyhwLHIudmFsdWVFbnZpcm9ubWVudFtwXSx2b2lkIDAsbywhMSkrYApgKTtmb3IodmFyIHAgaW4gci50eXBlRW52aXJvbm1lbnQpaWYoci50eXBlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkocCkmJmUudHlwZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KHApJiYoSD1lLmdldFR5cGUocCkpIT09dm9pZCAwJiZILnR5cGUgaW5zdGFuY2VvZiBnLkN1c3RvbVR5cGUpaWYoSC5jb25zdHJ1Y3RvcnMubGVuZ3RoPT09MClILmFsbG93c0VxdWFsaXR5P2QrPUcrIiAiK1krImVxdHlwZSAiK0ooeihILnR5cGUudG9TdHJpbmcobykpKStgOwpgOmQrPUcrIiAiK1krInR5cGUgIitKKHooSC50eXBlLnRvU3RyaW5nKG8pKSkrYDsKYDtlbHNle2QrPUcrIiAiK1krImRhdGF0eXBlICIrSih6KEgudHlwZS50b1N0cmluZyhvKSkpK2AgPSB7CmA7Zm9yKHZhciBOPTAsJD1ILmNvbnN0cnVjdG9ycztOPCQubGVuZ3RoO04rKylUPSRbTl0sZCs9QysiICAgIitZK3RoaXMucHJpbnRCaW5kaW5nKFQsci52YWx1ZUVudmlyb25tZW50W1RdLGUuZ2V0VmFsdWUoVCksbykrYApgO2QrPUMrIiAiK1krYH07CmB9Zm9yKHZhciBwIGluIHIudHlwZUVudmlyb25tZW50KXt2YXIgSDtyLnR5cGVFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShwKSYmZS50eXBlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkocCkmJihIPWUuZ2V0VHlwZShwKSkhPT12b2lkIDAmJkgudHlwZSBpbnN0YW5jZW9mIGcuRnVuY3Rpb25UeXBlJiYoZCs9RysiICIrWSsidHlwZSAiK0ooeihILnR5cGUucGFyYW1ldGVyVHlwZS50b1N0cmluZyhvKSsiID0gIitILnR5cGUucmV0dXJuVHlwZS50b1N0cmluZyhvKSkpK2A7CmApfWZvcih2YXIgcCBpbiByLnN0cnVjdHVyZUVudmlyb25tZW50KXIuc3RydWN0dXJlRW52aXJvbm1lbnQuaGFzT3duUHJvcGVydHkocCkmJihkKz1HKyIgIitZKyJzdHJ1Y3R1cmUgIitKKHoocCkpK2AgPSBzdHJ1Y3QKYCxkKz1lP3RoaXMucHJpbnRCYXNpcyhyLmdldFN0cnVjdHVyZShwKSxlLmdldFN0cnVjdHVyZShwKSxvLHkrMSk6dGhpcy5wcmludEJhc2lzKHIuZ2V0U3RydWN0dXJlKHApLHZvaWQgMCxvLHkrMSksZCs9QysiICIrWStgZW5kOwpgKTtmb3IodmFyIHAgaW4gci5zaWduYXR1cmVFbnZpcm9ubWVudClyLnNpZ25hdHVyZUVudmlyb25tZW50Lmhhc093blByb3BlcnR5KHApJiYoZCs9RysiICIrWSsic2lnbmF0dXJlICIrSih6KHApKStgOiBzaWcKYCxkKz1lP3RoaXMucHJpbnRCYXNpcyh2b2lkIDAsZS5nZXRTaWduYXR1cmUocCksbyx5KzEpOnRoaXMucHJpbnRCYXNpcyh2b2lkIDAsdm9pZCAwLG8seSsxKSxkKz1DKyIgIitZK2BlbmQ7CmApO2Zvcih2YXIgcCBpbiByLmZ1bmN0b3JFbnZpcm9ubWVudClpZihyLmZ1bmN0b3JFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShwKSl7dmFyIFA7ZCs9RysiICIrWSsiZnVuY3RvciAiK0ooeihwKSkrIigiLGU/KFA9ZS5nZXRGdW5jdG9yKHApKSE9PXZvaWQgMD9QWzJdIT09Il9fZmFyZyI/KGQrPVBbMl0rYDogc2lnCmAsZCs9dGhpcy5wcmludEJhc2lzKHZvaWQgMCxQWzBdLG8seSsxKSxkKz1DKyIgIitZK2BlbmQpOiBzdHJ1Y3QKYCxkKz10aGlzLnByaW50QmFzaXModm9pZCAwLFBbMV0sbyx5KzEpKTooZCs9YApgLGQrPXRoaXMucHJpbnRCYXNpcyh2b2lkIDAsUFswXSxvLHkrMSksZCs9QysiICIrWStgKTogc3RydWN0CmAsZCs9dGhpcy5wcmludEJhc2lzKHZvaWQgMCxQWzFdLG8seSsxKSk6ZCs9YCA8ZnVuY3RvciB1bmRlZmluZWQ+ICk6IHN0cnVjdApgOihkKz1gID8/PyApOiBzaWcKYCxkKz10aGlzLnByaW50QmFzaXModm9pZCAwLHZvaWQgMCxvLHkrMSkpLGQrPUMrIiAiK1krYGVuZDsKYH19cmV0dXJuIGR9LEUucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKHIpe3I9PT12b2lkIDAmJihyPXt9KTt2YXIgZT1yLnN0b3BJZD09PXZvaWQgMD90aGlzLmlkOnIuc3RvcElkLG89dGhpcy5nZXREeW5hbWljQ2hhbmdlcyhlLTEpLHk9dGhpcy5nZXRTdGF0aWNDaGFuZ2VzKGUtMSk7cmV0dXJuIHRoaXMucHJpbnRCYXNpcyhvLHksciwwKX0sRS5wcm90b3R5cGUuZ2V0TmVzdGVkU3RhdGU9ZnVuY3Rpb24ocil7cj09PXZvaWQgMCYmKHI9dm9pZCAwKSxyPT09dm9pZCAwJiYocj10aGlzLmlkKzEpO3ZhciBlPW5ldyBFKHIsdGhpcyxuZXcgSSh7fSx7fSx7fSx7fSx7fSksbmV3IEEoe30se30se30se30se30pLFt0aGlzLm1lbW9yeVswXSx7fV0sdGhpcy5leGNlcHRpb25FdmFsSWQsW3RoaXMuZnJlZVR5cGVWYXJpYWJsZXNbMF0sbmV3IE1hcF0pO2UuaW5zaWRlTG9jYWxEZWNsQm9keT10aGlzLmluc2lkZUxvY2FsRGVjbEJvZHk7Zm9yKHZhciBvPTAseT10aGlzLmxvYWRlZE1vZHVsZXM7bzx5Lmxlbmd0aDtvKyspe3ZhciBkPXlbb107ZS5sb2FkZWRNb2R1bGVzLnB1c2goZCl9cmV0dXJuIGV9LEUucHJvdG90eXBlLmhhc01vZHVsZT1mdW5jdGlvbihyKXtmb3IodmFyIGU9MCxvPXRoaXMubG9hZGVkTW9kdWxlcztlPG8ubGVuZ3RoO2UrKylpZihvW2VdPT09cilyZXR1cm4hMDtyZXR1cm4hMX0sRS5wcm90b3R5cGUucmVnaXN0ZXJNb2R1bGU9ZnVuY3Rpb24ocil7dGhpcy5sb2FkZWRNb2R1bGVzLnB1c2gocil9LEUucHJvdG90eXBlLmdldElkQ2hhbmdlcz1mdW5jdGlvbihyKXtpZih0aGlzLmlkPD1yKXJldHVybnt9O3ZhciBlPXt9O2Zvcih2YXIgbyBpbiB0aGlzLnBhcmVudCE9PXZvaWQgMCYmKGU9dGhpcy5wYXJlbnQuZ2V0SWRDaGFuZ2VzKHIpKSx0aGlzLnZhbHVlSWRlbnRpZmllcklkKXRoaXMudmFsdWVJZGVudGlmaWVySWQuaGFzT3duUHJvcGVydHkobykmJihlW29dPXRoaXMudmFsdWVJZGVudGlmaWVySWRbb10pO3JldHVybiBlfSxFLnByb3RvdHlwZS5nZXRNZW1vcnlDaGFuZ2VzPWZ1bmN0aW9uKHIpe2lmKHRoaXMuaWQ8PXIpcmV0dXJuW107dmFyIGU9W107Zm9yKHZhciBvIGluIHRoaXMucGFyZW50IT09dm9pZCAwJiYoZT10aGlzLnBhcmVudC5nZXRNZW1vcnlDaGFuZ2VzKHIpKSx0aGlzLm1lbW9yeVsxXSl0aGlzLm1lbW9yeVsxXS5oYXNPd25Qcm9wZXJ0eShvKSYmZS5wdXNoKFsrbyx0aGlzLm1lbW9yeVsxXVtvXV0pO3JldHVybiBlfSxFLnByb3RvdHlwZS5nZXREeW5hbWljQ2hhbmdlcz1mdW5jdGlvbihyKXtpZih0aGlzLmlkPD1yKXJldHVybiBuZXcgQSh7fSx7fSx7fSx7fSx7fSk7dmFyIGU9bmV3IEEoe30se30se30se30se30pO3JldHVybiB0aGlzLnBhcmVudCE9PXZvaWQgMCYmKGU9dGhpcy5wYXJlbnQuZ2V0RHluYW1pY0NoYW5nZXMocikpLGUuZXh0ZW5kKHRoaXMuZHluYW1pY0Jhc2lzKX0sRS5wcm90b3R5cGUuZ2V0RHluYW1pY0xvY2FsRGVjbENoYW5nZXM9ZnVuY3Rpb24ocil7aWYodGhpcy5pZDw9cnx8dGhpcy5sb2NhbERlY2xTdGFydClyZXR1cm4gbmV3IEEoe30se30se30se30se30pO3ZhciBlPW5ldyBBKHt9LHt9LHt9LHt9LHt9KTtyZXR1cm4gdGhpcy5wYXJlbnQhPT12b2lkIDAmJihlPXRoaXMucGFyZW50LmdldER5bmFtaWNMb2NhbERlY2xDaGFuZ2VzKHIpKSxlLmV4dGVuZCh0aGlzLmR5bmFtaWNCYXNpcyl9LEUucHJvdG90eXBlLmdldFN0YXRpY0NoYW5nZXM9ZnVuY3Rpb24ocil7aWYodGhpcy5pZDw9cilyZXR1cm4gbmV3IEkoe30se30se30se30se30pO3ZhciBlPW5ldyBJKHt9LHt9LHt9LHt9LHt9KTtyZXR1cm4gdGhpcy5wYXJlbnQhPT12b2lkIDAmJihlPXRoaXMucGFyZW50LmdldFN0YXRpY0NoYW5nZXMocikpLGUuZXh0ZW5kKHRoaXMuc3RhdGljQmFzaXMpfSxFLnByb3RvdHlwZS5nZXRDZWxsPWZ1bmN0aW9uKHIpe3JldHVybiB0aGlzLm1lbW9yeVsxXVtyXSE9PXZvaWQgMD90aGlzLm1lbW9yeVsxXVtyXTp0aGlzLnBhcmVudD09PXZvaWQgMD92b2lkIDA6dGhpcy5wYXJlbnQuZ2V0Q2VsbChyKX0sRS5wcm90b3R5cGUuZ2V0VHlwZVZhcmlhYmxlQmluZHM9ZnVuY3Rpb24ocil7cj09PXZvaWQgMCYmKHI9MCk7dmFyIGU9dGhpcy5mcmVlVHlwZVZhcmlhYmxlcztpZih0aGlzLnBhcmVudD09PXZvaWQgMHx8dGhpcy5wYXJlbnQuaWQ8cil7dmFyIG89bmV3IE1hcDtyZXR1cm4gZVsxXS5mb3JFYWNoKGZ1bmN0aW9uKGQsdil7by5zZXQodixkKX0pLFtlWzBdLG9dfXZhciB5PXRoaXMucGFyZW50LmdldFR5cGVWYXJpYWJsZUJpbmRzKHIpO3JldHVybiBlWzFdLmZvckVhY2goZnVuY3Rpb24oZCx2KXt5WzFdLnNldCh2LGQpfSksW01hdGgubWF4KGVbMF0seVswXSkseVsxXV19LEUucHJvdG90eXBlLmdldFN0YXRpY1ZhbHVlPWZ1bmN0aW9uKHIsZSl7aWYoZT09PXZvaWQgMCYmKGU9MCksIXIuc3RhcnRzV2l0aCgiX19hcmciKSYmIXIuc3RhcnRzV2l0aCgiJyoiKSl7dmFyIG89dGhpcy5zdGF0aWNCYXNpcy5nZXRWYWx1ZShyKTtyZXR1cm4gbyE9PXZvaWQgMHx8dGhpcy5wYXJlbnQ9PT12b2lkIDB8fHRoaXMucGFyZW50LmlkPGU/byE9PXZvaWQgMD9bb1swXSxvWzFdXTpvOnRoaXMucGFyZW50LmdldFN0YXRpY1ZhbHVlKHIsZSl9fSxFLnByb3RvdHlwZS5nZXRTdGF0aWNUeXBlPWZ1bmN0aW9uKHIsZSl7ZT09PXZvaWQgMCYmKGU9MCk7dmFyIG89dGhpcy5zdGF0aWNCYXNpcy5nZXRUeXBlKHIpO3JldHVybiBvIT09dm9pZCAwfHx0aGlzLnBhcmVudD09PXZvaWQgMHx8dGhpcy5wYXJlbnQuaWQ8ZT9vOnRoaXMucGFyZW50LmdldFN0YXRpY1R5cGUocixlKX0sRS5wcm90b3R5cGUuZ2V0U3RhdGljU3RydWN0dXJlPWZ1bmN0aW9uKHIsZSl7ZT09PXZvaWQgMCYmKGU9MCk7dmFyIG89dGhpcy5zdGF0aWNCYXNpcy5nZXRTdHJ1Y3R1cmUocik7cmV0dXJuIG8hPT12b2lkIDB8fHRoaXMucGFyZW50PT09dm9pZCAwfHx0aGlzLnBhcmVudC5pZDxlP286dGhpcy5wYXJlbnQuZ2V0U3RhdGljU3RydWN0dXJlKHIsZSl9LEUucHJvdG90eXBlLmdldEFuZFJlc29sdmVTdGF0aWNTdHJ1Y3R1cmU9ZnVuY3Rpb24ocixlKXtlPT09dm9pZCAwJiYoZT0wKTt2YXIgbz12b2lkIDA7aWYoci5xdWFsaWZpZXJzLmxlbmd0aD09PTApdGhyb3cgbmV3IEIuRXZhbHVhdGlvbkVycm9yKCJVbnF1YWxpZmllZCBMb25nSWRlbnRpZmllclRva2VuIGFyZSB0b28gdW5xdWFsaWZpZWQgdG8gYmUgdXNlZnVsIGhlcmUuIik7bz10aGlzLmdldFN0YXRpY1N0cnVjdHVyZShyLnF1YWxpZmllcnNbMF0uZ2V0VGV4dCgpLGUpO2Zvcih2YXIgeT0xO3k8ci5xdWFsaWZpZXJzLmxlbmd0aDsrK3kpe2lmKG89PT12b2lkIDApcmV0dXJuIG87bz1vLmdldFN0cnVjdHVyZShyLnF1YWxpZmllcnNbeV0uZ2V0VGV4dCgpKX1yZXR1cm4gb30sRS5wcm90b3R5cGUuZ2V0U3RhdGljU2lnbmF0dXJlPWZ1bmN0aW9uKHIsZSl7ZT09PXZvaWQgMCYmKGU9MCk7dmFyIG89dGhpcy5zdGF0aWNCYXNpcy5nZXRTaWduYXR1cmUocik7cmV0dXJuIG8hPT12b2lkIDB8fHRoaXMucGFyZW50PT09dm9pZCAwfHx0aGlzLnBhcmVudC5pZDxlP286dGhpcy5wYXJlbnQuZ2V0U3RhdGljU2lnbmF0dXJlKHIsZSl9LEUucHJvdG90eXBlLmdldFN0YXRpY0Z1bmN0b3I9ZnVuY3Rpb24ocixlKXtlPT09dm9pZCAwJiYoZT0wKTt2YXIgbz10aGlzLnN0YXRpY0Jhc2lzLmdldEZ1bmN0b3Iocik7cmV0dXJuIG8hPT12b2lkIDB8fHRoaXMucGFyZW50PT09dm9pZCAwfHx0aGlzLnBhcmVudC5pZDxlP286dGhpcy5wYXJlbnQuZ2V0U3RhdGljRnVuY3RvcihyLGUpfSxFLnByb3RvdHlwZS5nZXREeW5hbWljVmFsdWU9ZnVuY3Rpb24ocixlKXtlPT09dm9pZCAwJiYoZT0wKTt2YXIgbz10aGlzLmR5bmFtaWNCYXNpcy5nZXRWYWx1ZShyKTtyZXR1cm4gbyE9PXZvaWQgMHx8dGhpcy5wYXJlbnQ9PT12b2lkIDB8fHRoaXMucGFyZW50LmlkPGU/byE9PXZvaWQgMD9bb1swXSxvWzFdXTpvOnRoaXMucGFyZW50LmdldER5bmFtaWNWYWx1ZShyLGUpfSxFLnByb3RvdHlwZS5nZXREeW5hbWljVHlwZT1mdW5jdGlvbihyLGUpe2U9PT12b2lkIDAmJihlPTApO3ZhciBvPXRoaXMuZHluYW1pY0Jhc2lzLmdldFR5cGUocik7cmV0dXJuIG8hPT12b2lkIDB8fHRoaXMucGFyZW50PT09dm9pZCAwfHx0aGlzLnBhcmVudC5pZDxlP28hPT12b2lkIDA/W29bMF0sb1sxXV06bzp0aGlzLnBhcmVudC5nZXREeW5hbWljVHlwZShyLGUpfSxFLnByb3RvdHlwZS5nZXREeW5hbWljU3RydWN0dXJlPWZ1bmN0aW9uKHIsZSl7ZT09PXZvaWQgMCYmKGU9MCk7dmFyIG89dGhpcy5keW5hbWljQmFzaXMuZ2V0U3RydWN0dXJlKHIpO3JldHVybiBvIT09dm9pZCAwfHx0aGlzLnBhcmVudD09PXZvaWQgMHx8dGhpcy5wYXJlbnQuaWQ8ZT9vOnRoaXMucGFyZW50LmdldER5bmFtaWNTdHJ1Y3R1cmUocixlKX0sRS5wcm90b3R5cGUuZ2V0QW5kUmVzb2x2ZUR5bmFtaWNTdHJ1Y3R1cmU9ZnVuY3Rpb24ocixlKXtlPT09dm9pZCAwJiYoZT0wKTt2YXIgbz12b2lkIDA7aWYoci5xdWFsaWZpZXJzLmxlbmd0aD09PTApdGhyb3cgbmV3IEIuRXZhbHVhdGlvbkVycm9yKCJVbnF1YWxpZmllZCBMb25nSWRlbnRpZmllclRva2VuIGFyZSB0b28gdW5xdWFsaWZpZWQgdG8gYmUgdXNlZnVsIGhlcmUuIik7bz10aGlzLmdldER5bmFtaWNTdHJ1Y3R1cmUoci5xdWFsaWZpZXJzWzBdLmdldFRleHQoKSxlKTtmb3IodmFyIHk9MTt5PHIucXVhbGlmaWVycy5sZW5ndGg7Kyt5KXtpZihvPT09dm9pZCAwKXJldHVybiBvO289by5nZXRTdHJ1Y3R1cmUoci5xdWFsaWZpZXJzW3ldLmdldFRleHQoKSl9cmV0dXJuIG99LEUucHJvdG90eXBlLmdldER5bmFtaWNTaWduYXR1cmU9ZnVuY3Rpb24ocixlKXtlPT09dm9pZCAwJiYoZT0wKTt2YXIgbz10aGlzLmR5bmFtaWNCYXNpcy5nZXRTaWduYXR1cmUocik7cmV0dXJuIG8hPT12b2lkIDB8fHRoaXMucGFyZW50PT09dm9pZCAwfHx0aGlzLnBhcmVudC5pZDxlP286dGhpcy5wYXJlbnQuZ2V0RHluYW1pY1NpZ25hdHVyZShyLGUpfSxFLnByb3RvdHlwZS5nZXREeW5hbWljRnVuY3Rvcj1mdW5jdGlvbihyLGUpe2U9PT12b2lkIDAmJihlPTApO3ZhciBvPXRoaXMuZHluYW1pY0Jhc2lzLmdldEZ1bmN0b3Iocik7cmV0dXJuIG8hPT12b2lkIDB8fHRoaXMucGFyZW50PT09dm9pZCAwfHx0aGlzLnBhcmVudC5pZDxlP286dGhpcy5wYXJlbnQuZ2V0RHluYW1pY0Z1bmN0b3IocixlKX0sRS5wcm90b3R5cGUuZ2V0SW5maXhTdGF0dXM9ZnVuY3Rpb24ocixlKXtpZihlPT09dm9pZCAwJiYoZT0wKSxyLmlzVmlkKCl8fHIgaW5zdGFuY2VvZiBxLkxvbmdJZGVudGlmaWVyVG9rZW4pcmV0dXJuIHRoaXMuaW5maXhFbnZpcm9ubWVudC5oYXNPd25Qcm9wZXJ0eShyLmdldFRleHQoKSl8fCF0aGlzLnBhcmVudHx8dGhpcy5wYXJlbnQuaWQ8ZT90aGlzLmluZml4RW52aXJvbm1lbnRbci5nZXRUZXh0KCldOnRoaXMucGFyZW50LmdldEluZml4U3RhdHVzKHIsZSk7dGhyb3cgbmV3IEIuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCdZb3UgZ2F2ZSBtZSBzb21lICInK3IuZ2V0VGV4dCgpKyciICgnK3IudHlwZU5hbWUoKSsiKSBidXQgSSBvbmx5IHdhbnQgKExvbmcpSWRlbnRpZmllclRva2VuLiIpfSxFLnByb3RvdHlwZS5nZXRWYWx1ZUlkZW50aWZpZXJJZD1mdW5jdGlvbihyLGUpe3JldHVybiBlPT09dm9pZCAwJiYoZT0wKSx0aGlzLnZhbHVlSWRlbnRpZmllcklkLmhhc093blByb3BlcnR5KHIpP3RoaXMudmFsdWVJZGVudGlmaWVySWRbcl06IXRoaXMucGFyZW50fHx0aGlzLnBhcmVudC5pZDxlPzA6dGhpcy5wYXJlbnQuZ2V0VmFsdWVJZGVudGlmaWVySWQocixlKX0sRS5wcm90b3R5cGUuZ2V0V2FybmluZ3M9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy53YXJuc30sRS5wcm90b3R5cGUuaW5jcmVtZW50VmFsdWVJZGVudGlmaWVySWQ9ZnVuY3Rpb24ocixlKXtpZihlPT09dm9pZCAwJiYoZT12b2lkIDApLGU9PT12b2lkIDB8fHRoaXMuaWQ9PT1lKXRoaXMudmFsdWVJZGVudGlmaWVySWRbcl09dGhpcy5nZXRWYWx1ZUlkZW50aWZpZXJJZChyLGUpKzE7ZWxzZXtpZihlPnRoaXMuaWR8fHRoaXMucGFyZW50PT09dm9pZCAwKXRocm93IG5ldyBCLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignU3RhdGUgd2l0aCBpZCAiJytlKyciIGRvZXMgbm90IGV4aXN0LicpO3RoaXMucGFyZW50LmluY3JlbWVudFZhbHVlSWRlbnRpZmllcklkKHIsZSl9fSxFLnByb3RvdHlwZS5zZXRDZWxsPWZ1bmN0aW9uKHIsZSl7cj49dGhpcy5tZW1vcnlbMF0mJih0aGlzLm1lbW9yeVswXT1yKzEpLHRoaXMubWVtb3J5WzFdW3JdPWV9LEUucHJvdG90eXBlLnNldE5ld0NlbGw9ZnVuY3Rpb24ocil7cmV0dXJuIHRoaXMubWVtb3J5WzFdW3RoaXMubWVtb3J5WzBdXT1yLG5ldyBzLlJlZmVyZW5jZVZhbHVlKHRoaXMubWVtb3J5WzBdKyspfSxFLnByb3RvdHlwZS5nZXROZXh0RXhjZXB0aW9uRXZhbElkPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXhjZXB0aW9uRXZhbElkKyt9LEUucHJvdG90eXBlLmRlbGV0ZVN0YXRpY1ZhbHVlPWZ1bmN0aW9uKHIpe3RoaXMuc3RhdGljQmFzaXMuZGVsZXRlVmFsdWUociksdGhpcy5wYXJlbnQhPT12b2lkIDAmJnRoaXMucGFyZW50LmRlbGV0ZVN0YXRpY1ZhbHVlKHIpfSxFLnByb3RvdHlwZS5zZXRTdGF0aWNWYWx1ZT1mdW5jdGlvbihyLGUsbyx5KXtpZih5PT09dm9pZCAwJiYoeT12b2lkIDApLHk9PT12b2lkIDB8fHk9PT10aGlzLmlkKXRoaXMuc3RhdGljQmFzaXMuc2V0VmFsdWUocixlLG8pO2Vsc2V7aWYoeT50aGlzLmlkfHx0aGlzLnBhcmVudD09PXZvaWQgMCl0aHJvdyBuZXcgQi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ1N0YXRlIHdpdGggaWQgIicreSsnIiBkb2VzIG5vdCBleGlzdC4nKTt0aGlzLnBhcmVudC5zZXRTdGF0aWNWYWx1ZShyLGUsbyx5KX19LEUucHJvdG90eXBlLnNldFN0YXRpY1R5cGU9ZnVuY3Rpb24ocixlLG8seSxkLHYpe2lmKHY9PT12b2lkIDAmJih2PXZvaWQgMCksdj09PXZvaWQgMHx8dj09PXRoaXMuaWQpdGhpcy5zdGF0aWNCYXNpcy5zZXRUeXBlKHIsZSxvLHksZCk7ZWxzZXtpZih2PnRoaXMuaWR8fHRoaXMucGFyZW50PT09dm9pZCAwKXRocm93IG5ldyBCLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignU3RhdGUgd2l0aCBpZCAiJyt2KyciIGRvZXMgbm90IGV4aXN0LicpO3RoaXMucGFyZW50LnNldFN0YXRpY1R5cGUocixlLG8seSxkLHYpfX0sRS5wcm90b3R5cGUuc2V0U3RhdGljU3RydWN0dXJlPWZ1bmN0aW9uKHIsZSxvKXtpZihvPT09dm9pZCAwJiYobz12b2lkIDApLG89PT12b2lkIDB8fG89PT10aGlzLmlkKXRoaXMuc3RhdGljQmFzaXMuc2V0U3RydWN0dXJlKHIsZSk7ZWxzZXtpZihvPnRoaXMuaWR8fHRoaXMucGFyZW50PT09dm9pZCAwKXRocm93IG5ldyBCLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignU3RhdGUgd2l0aCBpZCAiJytvKyciIGRvZXMgbm90IGV4aXN0LicpO3RoaXMucGFyZW50LnNldFN0YXRpY1N0cnVjdHVyZShyLGUsbyl9fSxFLnByb3RvdHlwZS5zZXRTdGF0aWNTaWduYXR1cmU9ZnVuY3Rpb24ocixlLG8pe2lmKG89PT12b2lkIDAmJihvPXZvaWQgMCksbz09PXZvaWQgMHx8bz09PXRoaXMuaWQpdGhpcy5zdGF0aWNCYXNpcy5zZXRTaWduYXR1cmUocixlKTtlbHNle2lmKG8+dGhpcy5pZHx8dGhpcy5wYXJlbnQ9PT12b2lkIDApdGhyb3cgbmV3IEIuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCdTdGF0ZSB3aXRoIGlkICInK28rJyIgZG9lcyBub3QgZXhpc3QuJyk7dGhpcy5wYXJlbnQuc2V0U3RhdGljU2lnbmF0dXJlKHIsZSxvKX19LEUucHJvdG90eXBlLnNldFN0YXRpY0Z1bmN0b3I9ZnVuY3Rpb24ocixlLG8seSl7aWYobz09PXZvaWQgMCYmKG89ITEpLHk9PT12b2lkIDAmJih5PXZvaWQgMCkseT09PXZvaWQgMHx8eT09PXRoaXMuaWQpdGhpcy5zdGF0aWNCYXNpcy5zZXRGdW5jdG9yKHIsZSxvKTtlbHNle2lmKHk+dGhpcy5pZHx8dGhpcy5wYXJlbnQ9PT12b2lkIDApdGhyb3cgbmV3IEIuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCdTdGF0ZSB3aXRoIGlkICInK3krJyIgZG9lcyBub3QgZXhpc3QuJyk7dGhpcy5wYXJlbnQuc2V0U3RhdGljRnVuY3RvcihyLGUsbyx5KX19LEUucHJvdG90eXBlLnNldER5bmFtaWNWYWx1ZT1mdW5jdGlvbihyLGUsbyx5KXtpZih5PT09dm9pZCAwJiYoeT12b2lkIDApLHk9PT12b2lkIDB8fHk9PT10aGlzLmlkKXRoaXMuZHluYW1pY0Jhc2lzLnNldFZhbHVlKHIsZSxvKTtlbHNle2lmKHk+dGhpcy5pZHx8dGhpcy5wYXJlbnQ9PT12b2lkIDApdGhyb3cgbmV3IEIuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCdTdGF0ZSB3aXRoIGlkICInK3krJyIgZG9lcyBub3QgZXhpc3QuJyk7dGhpcy5wYXJlbnQuc2V0RHluYW1pY1ZhbHVlKHIsZSxvLHkpfX0sRS5wcm90b3R5cGUuc2V0RHluYW1pY1R5cGU9ZnVuY3Rpb24ocixlLG8pe2lmKG89PT12b2lkIDAmJihvPXZvaWQgMCksbz09PXZvaWQgMHx8bz09PXRoaXMuaWQpdGhpcy5keW5hbWljQmFzaXMuc2V0VHlwZShyLGUpO2Vsc2V7aWYobz50aGlzLmlkfHx0aGlzLnBhcmVudD09PXZvaWQgMCl0aHJvdyBuZXcgQi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ1N0YXRlIHdpdGggaWQgIicrbysnIiBkb2VzIG5vdCBleGlzdC4nKTt0aGlzLnBhcmVudC5zZXREeW5hbWljVHlwZShyLGUsbyl9fSxFLnByb3RvdHlwZS5zZXREeW5hbWljU3RydWN0dXJlPWZ1bmN0aW9uKHIsZSxvKXtpZihvPT09dm9pZCAwJiYobz12b2lkIDApLG89PT12b2lkIDB8fG89PT10aGlzLmlkKXRoaXMuZHluYW1pY0Jhc2lzLnNldFN0cnVjdHVyZShyLGUpO2Vsc2V7aWYobz50aGlzLmlkfHx0aGlzLnBhcmVudD09PXZvaWQgMCl0aHJvdyBuZXcgQi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ1N0YXRlIHdpdGggaWQgIicrbysnIiBkb2VzIG5vdCBleGlzdC4nKTt0aGlzLnBhcmVudC5zZXREeW5hbWljU3RydWN0dXJlKHIsZSxvKX19LEUucHJvdG90eXBlLnNldER5bmFtaWNTaWduYXR1cmU9ZnVuY3Rpb24ocixlLG8pe2lmKG89PT12b2lkIDAmJihvPXZvaWQgMCksbz09PXZvaWQgMHx8bz09PXRoaXMuaWQpdGhpcy5keW5hbWljQmFzaXMuc2V0U2lnbmF0dXJlKHIsZSk7ZWxzZXtpZihvPnRoaXMuaWR8fHRoaXMucGFyZW50PT09dm9pZCAwKXRocm93IG5ldyBCLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignU3RhdGUgd2l0aCBpZCAiJytvKyciIGRvZXMgbm90IGV4aXN0LicpO3RoaXMucGFyZW50LnNldER5bmFtaWNTaWduYXR1cmUocixlLG8pfX0sRS5wcm90b3R5cGUuc2V0RHluYW1pY0Z1bmN0b3I9ZnVuY3Rpb24ocixlLG8pe2lmKG89PT12b2lkIDAmJihvPXZvaWQgMCksbz09PXZvaWQgMHx8bz09PXRoaXMuaWQpdGhpcy5keW5hbWljQmFzaXMuc2V0RnVuY3RvcihyLGUpO2Vsc2V7aWYobz50aGlzLmlkfHx0aGlzLnBhcmVudD09PXZvaWQgMCl0aHJvdyBuZXcgQi5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ1N0YXRlIHdpdGggaWQgIicrbysnIiBkb2VzIG5vdCBleGlzdC4nKTt0aGlzLnBhcmVudC5zZXREeW5hbWljRnVuY3RvcihyLGUsbyl9fSxFLnByb3RvdHlwZS5zZXRJbmZpeFN0YXR1cz1mdW5jdGlvbihyLGUsbyx5LGQpe2lmKGQ9PT12b2lkIDAmJihkPXZvaWQgMCksZD09PXZvaWQgMHx8ZD09PXRoaXMuaWQpKHIuaXNWaWQoKXx8ciBpbnN0YW5jZW9mIHEuTG9uZ0lkZW50aWZpZXJUb2tlbikmJih0aGlzLmluZml4RW52aXJvbm1lbnRbci5nZXRUZXh0KCldPW5ldyBoKHksZSxvKSk7ZWxzZXtpZihkPnRoaXMuaWR8fHRoaXMucGFyZW50PT09dm9pZCAwKXRocm93IG5ldyBCLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignU3RhdGUgd2l0aCBpZCAiJytkKyciIGRvZXMgbm90IGV4aXN0LicpO3RoaXMucGFyZW50LnNldEluZml4U3RhdHVzKHIsZSxvLHksZCl9fSxFLnByb3RvdHlwZS5zZXRWYWx1ZUlkZW50aWZpZXJJZD1mdW5jdGlvbihyLGUsbyl7aWYobz09PXZvaWQgMCYmKG89dm9pZCAwKSxvPT09dm9pZCAwfHxvPT09dGhpcy5pZCl0aGlzLnZhbHVlSWRlbnRpZmllcklkW3JdPWU7ZWxzZXtpZihvPnRoaXMuaWR8fHRoaXMucGFyZW50PT09dm9pZCAwKXRocm93IG5ldyBCLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignU3RhdGUgd2l0aCBpZCAiJytvKyciIGRvZXMgbm90IGV4aXN0LicpO3RoaXMucGFyZW50LnNldFZhbHVlSWRlbnRpZmllcklkKHIsZSxvKX19LEUucHJvdG90eXBlLmFkZFdhcm5pbmc9ZnVuY3Rpb24ocixlKXtpZihlPT09dm9pZCAwJiYoZT12b2lkIDApLGU9PT12b2lkIDB8fGU9PT10aGlzLmlkKXRoaXMud2FybnMucHVzaChyKTtlbHNle2lmKGU+dGhpcy5pZHx8dGhpcy5wYXJlbnQ9PT12b2lkIDApdGhyb3cgbmV3IEIuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCdTdGF0ZSB3aXRoIGlkICInK2UrJyIgZG9lcyBub3QgZXhpc3QuJyk7dGhpcy5wYXJlbnQuYWRkV2FybmluZyhyLGUpfX0sRS5wcm90b3R5cGUuc2V0V2FybmluZ3M9ZnVuY3Rpb24ocixlKXtpZihlPT09dm9pZCAwJiYoZT12b2lkIDApLGU9PT12b2lkIDB8fGU9PT10aGlzLmlkKXRoaXMud2FybnM9cjtlbHNle2lmKGU+dGhpcy5pZHx8dGhpcy5wYXJlbnQ9PT12b2lkIDApdGhyb3cgbmV3IEIuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCdTdGF0ZSB3aXRoIGlkICInK2UrJyIgZG9lcyBub3QgZXhpc3QuJyk7dGhpcy5wYXJlbnQuc2V0V2FybmluZ3MocixlKX19LEV9KCk7dS5TdGF0ZT1PfSwxOTc6KGZlLHUsSyk9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdS5sb2FkTW9kdWxlPXUuU1RETElCPXUuZmFpbEV4Y2VwdGlvbj11LnN1YnNjcmlwdEV4Y2VwdGlvbj11LmNockV4Y2VwdGlvbj11LnNpemVFeGNlcHRpb249dS5kb21haW5FeGNlcHRpb249dS5vdmVyZmxvd0V4Y2VwdGlvbj11LmV4blR5cGU9dS5jaGFyVHlwZT11LnN0cmluZ1R5cGU9dS5ib29sVHlwZT11LndvcmRUeXBlPXUucmVhbFR5cGU9dS5pbnRUeXBlPXZvaWQgMDt2YXIgbT1LKDM2NyksZz1LKDc1OCkscz1LKDY5OSkscT1LKDEwNiksQj1LKDUxOSksTT1LKDQxMiksVj1LKDY5NiksRD1LKDQ1NiksaD1LKDMzNCksQT1LKDgwMSksST1LKDM1OSksTz1LKDY3OSksRT1LKDI0NSkscj1LKDc5MCksZT1LKDc0Miksbz1LKDkyOCkseT1LKDQ2MCksZD1LKDY2Nyk7dS5pbnRUeXBlPW5ldyBzLkN1c3RvbVR5cGUoImludCIpLHUucmVhbFR5cGU9bmV3IHMuQ3VzdG9tVHlwZSgicmVhbCIpLHUud29yZFR5cGU9bmV3IHMuQ3VzdG9tVHlwZSgid29yZCIpLHUuYm9vbFR5cGU9bmV3IHMuQ3VzdG9tVHlwZSgiYm9vbCIpLHUuc3RyaW5nVHlwZT1uZXcgcy5DdXN0b21UeXBlKCJzdHJpbmciKSx1LmNoYXJUeXBlPW5ldyBzLkN1c3RvbVR5cGUoImNoYXIiKSx1LmV4blR5cGU9bmV3IHMuQ3VzdG9tVHlwZSgiZXhuIiksdS5vdmVyZmxvd0V4Y2VwdGlvbj1uZXcgcS5FeGNlcHRpb25Db25zdHJ1Y3RvcigiT3ZlcmZsb3ciLDAsMCwzKSx1LmRvbWFpbkV4Y2VwdGlvbj1uZXcgcS5FeGNlcHRpb25Db25zdHJ1Y3RvcigiRG9tYWluIiwwLDAsNCksdS5zaXplRXhjZXB0aW9uPW5ldyBxLkV4Y2VwdGlvbkNvbnN0cnVjdG9yKCJTaXplIiwwLDAsNSksdS5jaHJFeGNlcHRpb249bmV3IHEuRXhjZXB0aW9uQ29uc3RydWN0b3IoIkNociIsMCwwLDYpLHUuc3Vic2NyaXB0RXhjZXB0aW9uPW5ldyBxLkV4Y2VwdGlvbkNvbnN0cnVjdG9yKCJTdWJzY3JpcHQiLDAsMCw3KSx1LmZhaWxFeGNlcHRpb249bmV3IHEuRXhjZXB0aW9uQ29uc3RydWN0b3IoIkZhaWwiLDEsMCw4KSx1LlNURExJQj17X19CYXNlOntuYXRpdmU6ZnVuY3Rpb24odil7cmV0dXJuIHYuc2V0U3RhdGljVmFsdWUoImV4bk5hbWUiLG5ldyBzLkZ1bmN0aW9uVHlwZSh1LmV4blR5cGUsdS5zdHJpbmdUeXBlKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLHYuc2V0RHluYW1pY1ZhbHVlKCJleG5OYW1lIixuZXcgcS5QcmVkZWZpbmVkRnVuY3Rpb24oImV4bk5hbWUiLGZ1bmN0aW9uKEMsRyl7aWYoQyBpbnN0YW5jZW9mIHEuRXhjZXB0aW9uVmFsdWUpcmV0dXJuW25ldyBxLlN0cmluZ1ZhbHVlKEMuY29uc3RydWN0b3JOYW1lKSwhMSxbXV07dGhyb3cgbmV3IGcuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJFeHBlY3RlZCBhbiBleGNlcHRpb24uIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLHYuc2V0U3RhdGljVmFsdWUoImV4bk1lc3NhZ2UiLG5ldyBzLkZ1bmN0aW9uVHlwZSh1LmV4blR5cGUsdS5zdHJpbmdUeXBlKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLHYuc2V0RHluYW1pY1ZhbHVlKCJleG5NZXNzYWdlIixuZXcgcS5QcmVkZWZpbmVkRnVuY3Rpb24oImV4bk1lc3NhZ2UiLGZ1bmN0aW9uKEMsRyl7aWYoQyBpbnN0YW5jZW9mIHEuRXhjZXB0aW9uVmFsdWUpcmV0dXJuW25ldyBxLlN0cmluZ1ZhbHVlKEMucGNUb1N0cmluZyhHLm1vZGlmaWFibGUsbmV3IHEuUHJpbnRDb3VudGVyKDUwKSkpLCExLFtdXTt0aHJvdyBuZXcgZy5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIkV4cGVjdGVkIGFuIGV4Y2VwdGlvbi4iKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksdn0sY29kZTpgZnVuIG8gKGYsZykgeCA9IGYgKGcgeCk7CiAgICAgICAgICAgIGluZml4IDMgbzsKICAgICAgICAgICAgZGF0YXR5cGUgb3JkZXIgPSBMRVNTIHwgRVFVQUwgfCBHUkVBVEVSOwoKICAgICAgICAgICAgZXhjZXB0aW9uIERvbWFpbjsKICAgICAgICAgICAgZXhjZXB0aW9uIFNpemU7CiAgICAgICAgICAgIGV4Y2VwdGlvbiBDaHI7CiAgICAgICAgICAgIGV4Y2VwdGlvbiBTdWJzY3JpcHQ7CiAgICAgICAgICAgIGV4Y2VwdGlvbiBGYWlsIG9mIHN0cmluZzsKCiAgICAgICAgICAgIGZ1biBub3QgdHJ1ZSA9IGZhbHNlIHwgbm90IGZhbHNlID0gdHJ1ZTsKCiAgICAgICAgICAgICgqIGZ1biAhIChhIDogJ0EgcmVmKTogJ0EgPSAhIGE7CiAgICAgICAgICAgIGZ1biBvcCA6PSAoKGEsIGIpIDogKCdBIHJlZiAqICdBKSk6IHVuaXQgPSBhIDo9IGI7CiAgICAgICAgICAgIGZ1biByZWYgKGEgOiAnQSk6ICdBIHJlZiA9IHJlZiBhOyAqKQoKICAgICAgICAgICAgZnVuIGlnbm9yZSBhID0gKCk7CiAgICAgICAgICAgIGluZml4IDAgYmVmb3JlOwogICAgICAgICAgICBmdW4gYSBiZWZvcmUgKGI6IHVuaXQpID0gYTtgLHJlcXVpcmVzOnZvaWQgMH0sQXJyYXk6Vi5BUlJBWV9MSUIsQXNzZXJ0OkQuQVNTRVJUX0xJQixDaGFyOmguQ0hBUl9MSUIsRXZhbDpBLkVWQUxfTElCLEludDpJLklOVF9MSUIsTGlzdDpPLkxJU1RfTElCLExpc3Rzb3J0OkUuTElTVFNPUlRfTElCLE1hdGg6ci5NQVRIX0xJQixPcHRpb246e25hdGl2ZTp2b2lkIDAsY29kZTpgc3RydWN0dXJlIE9wdGlvbiA9IHN0cnVjdAogICAgICAgICAgICAgICAgZXhjZXB0aW9uIE9wdGlvbjsKCiAgICAgICAgICAgICAgICBkYXRhdHlwZSAnYSBvcHRpb24gPSBOT05FIHwgU09NRSBvZiAnYTsKCiAgICAgICAgICAgICAgICBmdW4gZ2V0T3B0IChOT05FLCBhKSA9IGEKICAgICAgICAgICAgICAgICAgfCBnZXRPcHQgKFNPTUUgeCwgYSkgPSB4OwoKICAgICAgICAgICAgICAgIGZ1biBpc1NvbWUgTk9ORSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgIHwgaXNTb21lIChTT01FIF8pID0gdHJ1ZTsKCiAgICAgICAgICAgICAgICBmdW4gdmFsT2YgKFNPTUUgeCkgPSB4CiAgICAgICAgICAgICAgICAgIHwgdmFsT2YgTk9ORSA9IHJhaXNlIE9wdGlvbjsKICAgICAgICAgICAgZW5kOwogICAgICAgICAgICBvcGVuIE9wdGlvbjsKCiAgICAgICAgICAgIHN0cnVjdHVyZSBPcHRpb24gPSBzdHJ1Y3QKICAgICAgICAgICAgICAgIG9wZW4gT3B0aW9uOwoKICAgICAgICAgICAgICAgIGZ1biBhcHAgZiAoU09NRSB2KSA9IGYgdgogICAgICAgICAgICAgICAgICB8IGFwcCBmIE5PTkUgPSAoKTsKCiAgICAgICAgICAgICAgICBmdW4gbWFwIGYgTk9ORSA9IE5PTkUKICAgICAgICAgICAgICAgICAgfCBtYXAgZiAoU09NRSB2KSA9IFNPTUUoZiB2KTsKCiAgICAgICAgICAgICAgICBmdW4gbWFwUGFydGlhbCBmIE5PTkUgPSBOT05FCiAgICAgICAgICAgICAgICAgIHwgbWFwUGFydGlhbCBmIChTT01FIHYpID0gZiB2OwoKICAgICAgICAgICAgICAgIGZ1biBmaWx0ZXIgZiB4ID0gaWYgZiB4IHRoZW4gU09NRSB4IGVsc2UgTk9ORTsKCiAgICAgICAgICAgICAgICBmdW4gam9pbiBOT05FID0gTk9ORQogICAgICAgICAgICAgICAgICB8IGpvaW4gKFNPTUUgKFNPTUUgeCkpID0gU09NRSB4OwoKICAgICAgICAgICAgICAgIGZ1biBjb21wb3NlIChmLCBnKSBhID0gY2FzZSBnIGEgb2YKICAgICAgICAgICAgICAgICAgICAgIE5PTkUgPT4gTk9ORQogICAgICAgICAgICAgICAgICAgIHwgU09NRSB2ID0+IFNPTUUgKGYgdik7CgogICAgICAgICAgICAgICAgZnVuIGNvbXBvc2VQYXJ0aWFsIChmLCBnKSBhID0gY2FzZSBnIGEgb2YKICAgICAgICAgICAgICAgICAgICAgIE5PTkUgPT4gTk9ORQogICAgICAgICAgICAgICAgICAgIHwgU09NRSB2ID0+IChmIHYpOwogICAgICAgICAgICBlbmQ7CiAgICAgICAgICAgIGAscmVxdWlyZXM6dm9pZCAwfSxSYW5kb206ZS5SQU5ET01fTElCLFJlYWw6by5SRUFMX0xJQixTdHJpbmc6eS5TVFJJTkdfTElCLFZlY3RvcjpkLlZFQ1RPUl9MSUIsVmVyc2lvbjp7bmF0aXZlOnZvaWQgMCxjb2RlOmBzdHJ1Y3R1cmUgVmVyc2lvbiA9IHN0cnVjdAogICAgICAgICAgICB2YWwgdmVyc2lvbiAgICAgPSAiYCtNLlZFUlNJT04rYCI7CiAgICAgICAgICAgIHZhbCBicmFuY2ggICAgICA9ICJgK00uQlJBTkNIX05BTUUrYCI7CiAgICAgICAgICAgIHZhbCBjb21taXQgICAgICA9ICJgK00uQ09NTUlUX0hBU0grYCI7CiAgICAgICAgICAgIHZhbCBidWlsZERhdGUgICA9ICJgK00uQlVJTERfREFURStgIjsKICAgICAgICAgICAgdmFsIG1lc3NhZ2UgICAgID0gImArTS5DT01NSVRfTUVTU0FHRStgIjsKICAgICAgICBlbmQ7YCxyZXF1aXJlczp2b2lkIDB9fSx1LmxvYWRNb2R1bGU9ZnVuY3Rpb24gdihDLEcsWSl7aWYoIXUuU1RETElCLmhhc093blByb3BlcnR5KEcpKXRocm93IG5ldyBnLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignVGhlIG1vZHVsZSAiJytHKyciIGRvZXMgbm90IGV4aXN0LiBBdXV1dX4nKTtpZihDLmhhc01vZHVsZShHKSlyZXR1cm4gQzt2YXIgSj11LlNURExJQltHXTtpZihKLnJlcXVpcmVzIT09dm9pZCAwKWZvcih2YXIgej0wLHA9Si5yZXF1aXJlczt6PHAubGVuZ3RoO3orKyl7dmFyIGM9cFt6XTtDLmhhc01vZHVsZShjKXx8KEM9dihDLGMsWSkpfXJldHVybiBKLm5hdGl2ZSE9PXZvaWQgMCYmKEM9Si5uYXRpdmUoQyxZKSksSi5jb2RlIT09dm9pZCAwJiYoQz1CLmludGVycHJldChKLmNvZGUsQyxZKS5zdGF0ZSksQy5yZWdpc3Rlck1vZHVsZShHKSxDfX0sNjk2OihmZSx1LEspPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHUsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHUuQVJSQVlfTElCPXZvaWQgMDt2YXIgbT1LKDM2NyksZz1LKDY5OSkscz1LKDEwNikscT1LKDc1OCksQj1LKDE5Nyk7dS5BUlJBWV9MSUI9e25hdGl2ZTpmdW5jdGlvbihNKXt2YXIgVj1uZXcgbS5EeW5hbWljQmFzaXMoe30se30se30se30se30pLEQ9bmV3IG0uU3RhdGljQmFzaXMoe30se30se30se30se30pLGg9bmV3IGcuQ3VzdG9tVHlwZSgiYXJyYXkiLFtuZXcgZy5UeXBlVmFyaWFibGUoIidhIildKSxBPW5ldyBnLkN1c3RvbVR5cGUoImxpc3QiLFtuZXcgZy5UeXBlVmFyaWFibGUoIidhIildKTtyZXR1cm4gRC5zZXRUeXBlKCJhcnJheSIsaCxbXSwxLCEwKSxWLnNldFR5cGUoImFycmF5IixbXSksVi5zZXRWYWx1ZSgiYXJyYXkiLG5ldyBzLlByZWRlZmluZWRGdW5jdGlvbigiYXJyYXkiLGZ1bmN0aW9uKEksTyl7aWYoSSBpbnN0YW5jZW9mIHMuUmVjb3JkVmFsdWUmJkkuZW50cmllcy5zaXplPT09Mil7dmFyIEU9SS5nZXRWYWx1ZSgiMSIpLHI9SS5nZXRWYWx1ZSgiMiIpO2lmKEUgaW5zdGFuY2VvZiBzLkludGVnZXIpe3ZhciBlPUUudmFsdWU7aWYoZTwwKXJldHVybltCLnNpemVFeGNlcHRpb24uY29uc3RydWN0KCksITAsW11dO3ZhciBvPW5ldyBzLkFycmF5VmFsdWUoTy5tb2RpZmlhYmxlLm1lbW9yeVswXSsxLGUpO08ubW9kaWZpYWJsZS5zZXROZXdDZWxsKG8pO2Zvcih2YXIgeT0wO3k8ZTsrK3kpTy5tb2RpZmlhYmxlLnNldE5ld0NlbGwocik7cmV0dXJuW28sITEsW11dfX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoInN0ZCB0eXBlIG1pc21hdGNoIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLEQuc2V0VmFsdWUoImFycmF5IixuZXcgZy5GdW5jdGlvblR5cGUobmV3IGcuVHVwbGVUeXBlKFtCLmludFR5cGUsbmV3IGcuVHlwZVZhcmlhYmxlKCInYSIpXSkuc2ltcGxpZnkoKSxoKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLFYuc2V0VmFsdWUoImZyb21MaXN0IixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oImZyb21MaXN0IixmdW5jdGlvbihJLE8pe3ZhciBFPW5ldyBzLkFycmF5VmFsdWUoTy5tb2RpZmlhYmxlLm1lbW9yeVswXSsxLDApO2lmKE8ubW9kaWZpYWJsZS5zZXROZXdDZWxsKEUpLEkgaW5zdGFuY2VvZiBzLkNvbnN0cnVjdGVkVmFsdWUpe2Zvcih2YXIgcj1JO3IuY29uc3RydWN0b3JOYW1lIT09Im5pbCI7KXtpZihyLmNvbnN0cnVjdG9yTmFtZSE9PSI6OiIpdGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpO3ZhciBlPXIuYXJndW1lbnQ7aWYoIShlIGluc3RhbmNlb2Ygcy5SZWNvcmRWYWx1ZSYmZS5lbnRyaWVzLnNpemU9PT0yKSl0aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoInN0ZCB0eXBlIG1pc21hdGNoIik7dmFyIG89ZS5nZXRWYWx1ZSgiMSIpLHk9ZS5nZXRWYWx1ZSgiMiIpO2lmKCEobyBpbnN0YW5jZW9mIHMuVmFsdWUmJnkgaW5zdGFuY2VvZiBzLkNvbnN0cnVjdGVkVmFsdWUpKXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKTtPLm1vZGlmaWFibGUuc2V0TmV3Q2VsbChvKSxFLmxlbmd0aCsrLHI9eX1yZXR1cm5bRSwhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxELnNldFZhbHVlKCJmcm9tTGlzdCIsbmV3IGcuRnVuY3Rpb25UeXBlKEEsaCksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxWLnNldFZhbHVlKCJzdWIiLG5ldyBzLlByZWRlZmluZWRGdW5jdGlvbigic3ViIixmdW5jdGlvbihJLE8pe2lmKEkgaW5zdGFuY2VvZiBzLlJlY29yZFZhbHVlJiZJLmVudHJpZXMuc2l6ZT09PTIpe3ZhciBFPUkuZ2V0VmFsdWUoIjEiKSxyPUkuZ2V0VmFsdWUoIjIiKTtpZihFIGluc3RhbmNlb2Ygcy5BcnJheVZhbHVlJiZyIGluc3RhbmNlb2Ygcy5JbnRlZ2VyKXt2YXIgZT1yLnZhbHVlO3JldHVybiBlPDB8fGU+PUUubGVuZ3RoP1tCLnN1YnNjcmlwdEV4Y2VwdGlvbi5jb25zdHJ1Y3QoKSwhMCxbXV06W08ubW9kaWZpYWJsZS5nZXRDZWxsKEUuYWRkcmVzcytlKSwhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgic3ViIixuZXcgZy5GdW5jdGlvblR5cGUobmV3IGcuVHVwbGVUeXBlKFtoLEIuaW50VHlwZV0pLnNpbXBsaWZ5KCksbmV3IGcuVHlwZVZhcmlhYmxlKCInYSIpKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLFYuc2V0VmFsdWUoInVwZGF0ZSIsbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCJ1cGRhdGUiLGZ1bmN0aW9uKEksTyl7aWYoSSBpbnN0YW5jZW9mIHMuUmVjb3JkVmFsdWUmJkkuZW50cmllcy5zaXplPT09Myl7dmFyIEU9SS5nZXRWYWx1ZSgiMSIpLHI9SS5nZXRWYWx1ZSgiMiIpLGU9SS5nZXRWYWx1ZSgiMyIpO2lmKEUgaW5zdGFuY2VvZiBzLkFycmF5VmFsdWUmJnIgaW5zdGFuY2VvZiBzLkludGVnZXIpe3ZhciBvPXIudmFsdWU7cmV0dXJuIG88MHx8bz49RS5sZW5ndGg/W0Iuc3Vic2NyaXB0RXhjZXB0aW9uLmNvbnN0cnVjdCgpLCEwLFtdXTooTy5tb2RpZmlhYmxlLnNldENlbGwoRS5hZGRyZXNzK28sZSksW25ldyBzLlJlY29yZFZhbHVlLCExLFtdXSl9dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgidXBkYXRlIixuZXcgZy5GdW5jdGlvblR5cGUobmV3IGcuVHVwbGVUeXBlKFtoLEIuaW50VHlwZSxuZXcgZy5UeXBlVmFyaWFibGUoIidhIildKSxuZXcgZy5UdXBsZVR5cGUoW10pKS5zaW1wbGlmeSgpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksVi5zZXRWYWx1ZSgibGVuZ3RoIixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oImxlbmd0aCIsZnVuY3Rpb24oSSxPKXtpZihJIGluc3RhbmNlb2Ygcy5BcnJheVZhbHVlKXJldHVybltuZXcgcy5JbnRlZ2VyKEkubGVuZ3RoKSwhMSxbXV07dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxELnNldFZhbHVlKCJsZW5ndGgiLG5ldyBnLkZ1bmN0aW9uVHlwZShoLEIuaW50VHlwZSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxNLnNldER5bmFtaWNTdHJ1Y3R1cmUoIkFycmF5IixWKSxNLnNldFN0YXRpY1N0cnVjdHVyZSgiQXJyYXkiLEQpLE19LGNvZGU6YHNpZ25hdHVyZSBBUlJBWSA9IHNpZwogICAgICAgICgqIGVxdHlwZSAnYSBhcnJheSA9ICdhIGFycmF5ICopCiAgICAgICAgKCogdHlwZSAnYSB2ZWN0b3IgPSAnYSBWZWN0b3IudmVjdG9yICopCiAgICAgICAgKCogdmFsIG1heExlbiA6IGludCAqKQogICAgICAgIHZhbCBhcnJheSA6IGludCAqICdhIC0+ICdhIGFycmF5CiAgICAgICAgdmFsIGZyb21MaXN0IDogJ2EgbGlzdCAtPiAnYSBhcnJheQogICAgICAgIHZhbCB0YWJ1bGF0ZSA6IGludCAqIChpbnQgLT4gJ2EpIC0+ICdhIGFycmF5CiAgICAgICAgdmFsIGxlbmd0aCA6ICdhIGFycmF5IC0+IGludAogICAgICAgIHZhbCBzdWIgOiAnYSBhcnJheSAqIGludCAtPiAnYQogICAgICAgIHZhbCB1cGRhdGUgOiAnYSBhcnJheSAqIGludCAqICdhIC0+IHVuaXQKICAgICAgICB2YWwgdmVjdG9yIDogJ2EgYXJyYXkgLT4gJ2EgdmVjdG9yCiAgICAgICAgdmFsIGNvcHkgICAgOiB7c3JjIDogJ2EgYXJyYXksIGRzdCA6ICdhIGFycmF5LCBkaSA6IGludH0gLT4gdW5pdAogICAgICAgIHZhbCBjb3B5VmVjIDoge3NyYyA6ICdhIHZlY3RvciwgZHN0IDogJ2EgYXJyYXksIGRpIDogaW50fSAtPiB1bml0CiAgICAgICAgdmFsIGFwcGkgOiAoaW50ICogJ2EgLT4gdW5pdCkgLT4gJ2EgYXJyYXkgLT4gdW5pdAogICAgICAgIHZhbCBhcHAgIDogKCdhIC0+IHVuaXQpIC0+ICdhIGFycmF5IC0+IHVuaXQKICAgICAgICB2YWwgbW9kaWZ5aSA6IChpbnQgKiAnYSAtPiAnYSkgLT4gJ2EgYXJyYXkgLT4gdW5pdAogICAgICAgIHZhbCBtb2RpZnkgIDogKCdhIC0+ICdhKSAtPiAnYSBhcnJheSAtPiB1bml0CiAgICAgICAgdmFsIGZvbGRsaSA6IChpbnQgKiAnYSAqICdiIC0+ICdiKSAtPiAnYiAtPiAnYSBhcnJheSAtPiAnYgogICAgICAgIHZhbCBmb2xkcmkgOiAoaW50ICogJ2EgKiAnYiAtPiAnYikgLT4gJ2IgLT4gJ2EgYXJyYXkgLT4gJ2IKICAgICAgICB2YWwgZm9sZGwgIDogKCdhICogJ2IgLT4gJ2IpIC0+ICdiIC0+ICdhIGFycmF5IC0+ICdiCiAgICAgICAgdmFsIGZvbGRyICA6ICgnYSAqICdiIC0+ICdiKSAtPiAnYiAtPiAnYSBhcnJheSAtPiAnYgogICAgICAgIHZhbCBmaW5kaSA6IChpbnQgKiAnYSAtPiBib29sKSAtPiAnYSBhcnJheSAtPiAoaW50ICogJ2EpIG9wdGlvbgogICAgICAgIHZhbCBmaW5kICA6ICgnYSAtPiBib29sKSAtPiAnYSBhcnJheSAtPiAnYSBvcHRpb24KICAgICAgICB2YWwgZXhpc3RzIDogKCdhIC0+IGJvb2wpIC0+ICdhIGFycmF5IC0+IGJvb2wKICAgICAgICB2YWwgYWxsIDogKCdhIC0+IGJvb2wpIC0+ICdhIGFycmF5IC0+IGJvb2wKICAgICAgICB2YWwgY29sbGF0ZSA6ICgnYSAqICdhIC0+IG9yZGVyKSAtPiAnYSBhcnJheSAqICdhIGFycmF5IC0+IG9yZGVyCiAgICBlbmQ7CgogICAgc3RydWN0dXJlIEFycmF5IDo+IEFSUkFZID0gc3RydWN0CiAgICAgICAgb3BlbiBBcnJheTsKICAgICAgICBmdW4gdGFidWxhdGUgKG4sIGYpID0gZnJvbUxpc3QgKExpc3QudGFidWxhdGUgKG4sIGYpKTsKCiAgICAgICAgZnVuIHZlY3RvciBhcnIgPSBWZWN0b3IudGFidWxhdGUgKGxlbmd0aCBhcnIsIGZuIGkgPT4gc3ViIChhcnIsIGkpKTsKCiAgICAgICAgZnVuIGNvcHkge3NyYywgZHN0LCBkaX0gPSBpZiBkaSA8IDAgb3JlbHNlIGxlbmd0aCBkc3QgPCBkaSArIGxlbmd0aCBzcmMgdGhlbiByYWlzZSBTdWJzY3JpcHQKICAgICAgICAgICAgZWxzZQogICAgICAgICAgICBsZXQKICAgICAgICAgICAgICAgIHZhbCBsZW4gPSBsZW5ndGggc3JjCiAgICAgICAgICAgICAgICBmdW4gbG9vcCBpbmRleCA9IGlmIGluZGV4ID0gbGVuIHRoZW4gKCkKICAgICAgICAgICAgICAgICAgICBlbHNlICggdXBkYXRlKGRzdCwgaW5kZXggKyBkaSwgc3ViKHNyYywgaW5kZXgpKTsgbG9vcCAoaW5kZXggKyAxKSkKICAgICAgICAgICAgaW4KICAgICAgICAgICAgICAgIGxvb3AgMAogICAgICAgICAgICBlbmQ7CiAgICAgICAgZnVuIGNvcHlWZWMge3NyYywgZHN0LCBkaX0gPSBpZiBkaSA8IDAgb3JlbHNlIGxlbmd0aCBkc3QgPCBkaSArIFZlY3Rvci5sZW5ndGggc3JjIHRoZW4gcmFpc2UgU3Vic2NyaXB0CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgbGV0CiAgICAgICAgICAgICAgICB2YWwgbGVuID0gVmVjdG9yLmxlbmd0aCBzcmMKICAgICAgICAgICAgICAgIGZ1biBsb29wIGluZGV4ID0gaWYgaW5kZXggPSBsZW4gdGhlbiAoKQogICAgICAgICAgICAgICAgICAgIGVsc2UgKCB1cGRhdGUoZHN0LCBpbmRleCArIGRpLCBWZWN0b3Iuc3ViKHNyYywgaW5kZXgpKTsgbG9vcCAoaW5kZXggKyAxKSkKICAgICAgICAgICAgaW4KICAgICAgICAgICAgICAgIGxvb3AgMAogICAgICAgICAgICBlbmQ7CgogICAgICAgIGZ1biBhcHBpIHAgYXJyID0gbGV0CiAgICAgICAgICAgIHZhbCBsZW4gPSBsZW5ndGggYXJyCiAgICAgICAgICAgIGZ1biBsb29wIGluZGV4ID0gaWYgaW5kZXggPSBsZW4gdGhlbiAoKQogICAgICAgICAgICAgICAgZWxzZSAocChpbmRleCwgc3ViKGFyciwgaW5kZXgpKTsgbG9vcCAoaW5kZXggKzEpKQogICAgICAgICAgICBpbgogICAgICAgICAgICAgICAgbG9vcCAwCiAgICBlbmQ7CiAgICBmdW4gYXBwIHAgPSBhcHBpIChmbiAoXywgdikgPT4gcCB2KTsKCiAgICBmdW4gbW9kaWZ5aSBwIGFyciA9CiAgICAgICAgbGV0CiAgICAgICAgICAgIHZhbCBsZW4gPSBsZW5ndGggYXJyCiAgICAgICAgICAgIGZ1biBsb29wIGluZGV4ID0gaWYgaW5kZXggPSBsZW4gdGhlbiAoKQogICAgICAgICAgICAgICAgZWxzZSAoIHVwZGF0ZShhcnIsIGluZGV4LCBwKGluZGV4LCBzdWIoYXJyLCBpbmRleCkpKTsgbG9vcCAoaW5kZXggKzEpKQogICAgICAgIGluCiAgICAgICAgICAgIGxvb3AgMAogICAgICAgIGVuZDsKCiAgICBmdW4gbW9kaWZ5aSBwIGFyciA9CiAgICAgICAgbGV0CiAgICAgICAgICAgIHZhbCBsZW4gPSBsZW5ndGggYXJyCiAgICAgICAgICAgIGZ1biBsb29wIGluZGV4ID0gaWYgaW5kZXggPSBsZW4gdGhlbiAoKQogICAgICAgICAgICAgICAgZWxzZSAoIHVwZGF0ZShhcnIsIGluZGV4LCBwKGluZGV4LCBzdWIoYXJyLCBpbmRleCkpKTsgbG9vcCAoaW5kZXggKzEpKQogICAgICAgIGluCiAgICAgICAgICAgIGxvb3AgMAogICAgICAgIGVuZDsKICAgIGZ1biBtb2RpZnkgcCA9IG1vZGlmeWkgKGZuIChfLCB2KSA9PiBwIHYpOwoKICAgIGZ1biBmb2xkbGkgZiBpbml0IGFyciA9CiAgICAgICAgbGV0CiAgICAgICAgICAgIHZhbCBsZW4gPSBsZW5ndGggYXJyCiAgICAgICAgICAgIGZ1biBsb29wIChpLCBiKSA9CiAgICAgICAgICAgICAgICBpZiBpID0gbGVuIHRoZW4gYgogICAgICAgICAgICAgICAgZWxzZSBsb29wIChpICsgMSwgZiAoaSwgc3ViIChhcnIsIGkpLCBiKSkKICAgICAgICAgICAgaW4KICAgICAgICAgICAgICAgIGxvb3AgKDAsIGluaXQpCiAgICAgICAgZW5kOwogICAgZnVuIGZvbGRyaSBmIGluaXQgYXJyID0KICAgICAgICBsZXQKICAgICAgICAgICAgdmFsIGxlbiA9IGxlbmd0aCBhcnIKICAgICAgICAgICAgZnVuIGxvb3AgKGksIGIpID0KICAgICAgICAgICAgICAgIGlmIGkgPSB+MSB0aGVuIGIKICAgICAgICAgICAgICAgIGVsc2UgbG9vcCAoaSAtIDEsIGYgKGksIHN1YiAoYXJyLCBpKSwgYikpCiAgICAgICAgICAgIGluCiAgICAgICAgICAgICAgICBsb29wIChsZW4gLSAxLCBpbml0KQogICAgICAgICAgICBlbmQ7CiAgICBmdW4gZm9sZGwgZiBpbml0IGFyciA9IGZvbGRsaSAoZm4gKF8sIGEsIHgpID0+IGYoYSwgeCkpIGluaXQgYXJyOwogICAgZnVuIGZvbGRyIGYgaW5pdCBhcnIgPSBmb2xkcmkgKGZuIChfLCBhLCB4KSA9PiBmKGEsIHgpKSBpbml0IGFycjsKCiAgICBmdW4gZmluZGkgZiBhcnIgPQogICAgICAgIGxldAogICAgICAgICAgICB2YWwgbGVuID0gbGVuZ3RoIGFycgogICAgICAgICAgICBmdW4gbG9vcCBpbmRleCA9CiAgICAgICAgICAgICAgICBpZiBpbmRleCA9IEFycmF5Lmxlbmd0aCBhcnIgdGhlbiBOT05FCiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBsZXQKICAgICAgICAgICAgICAgICAgICB2YWwgZWwgPSBzdWIoYXJyLCBpbmRleCkKICAgICAgICAgICAgICAgIGluCiAgICAgICAgICAgICAgICAgICAgaWYgZiAoaW5kZXgsIGVsKSB0aGVuIFNPTUUgKGluZGV4LCBlbCkgZWxzZSBsb29wIChpbmRleCsxKQogICAgICAgICAgICAgICAgZW5kCiAgICAgICAgaW4KICAgICAgICAgICAgbG9vcCAwCiAgICAgICAgZW5kOwogICAgZnVuIGZpbmQgZiBhcnIgPSBjYXNlIGZpbmRpIChmbiAoXywgdikgPT4gZiB2KSBhcnIgb2YgTk9ORSA9PiBOT05FCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCBTT01FIChfLCB2KSA9PiBTT01FIHY7CiAgICBmdW4gZXhpc3RzIHAgYXJyID0gY2FzZSBmaW5kIHAgYXJyIG9mIE5PTkUgPT4gZmFsc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgU09NRSBfID0+IHRydWU7CgogICAgZnVuIGFsbCBwID0gZm9sZGwgKGZuICh2LCBhY2MpID0+IHAgdiBhbmRhbHNvIGFjYykgdHJ1ZTsKICAgIGZ1biBjb2xsYXRlIHAgKGExLCBhMikgPQogICAgICAgIGxldAogICAgICAgICAgICB2YWwgbGVuZ3RoMSA9IGxlbmd0aCBhMQogICAgICAgICAgICB2YWwgbGVuZ3RoMiA9IGxlbmd0aCBhMgogICAgICAgICAgICBmdW4gbG9vcCBpbmRleCA9CiAgICAgICAgICAgICAgICBpZiBpbmRleCA9IGxlbmd0aDEgYW5kYWxzbyBpbmRleCA9IGxlbmd0aDIgdGhlbiBFUVVBTAogICAgICAgICAgICAgICAgZWxzZSBpZiBpbmRleCA9IGxlbmd0aDEgdGhlbiBMRVNTCiAgICAgICAgICAgICAgICBlbHNlIGlmIGluZGV4ID0gbGVuZ3RoMiB0aGVuIEdSRUFURVIKICAgICAgICAgICAgICAgIGVsc2UgY2FzZSBwIChzdWIgKGExLCBpbmRleCksIHN1YiAoYTIsIGluZGV4KSkgb2YKICAgICAgICAgICAgICAgICAgICAgICAgRVFVQUwgPT4gbG9vcCAoaW5kZXggKyAxKQogICAgICAgICAgICAgICAgICAgICAgICAgIHwgbCA9PiBsCiAgICAgICAgaW4KICAgICAgICAgICAgbG9vcCAwCiAgICAgICAgZW5kOwogICAgZW5kO2AscmVxdWlyZXM6WyJPcHRpb24iLCJMaXN0IiwiVmVjdG9yIl19fSw0NTY6KGZlLHUsSyk9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdS5BU1NFUlRfTElCPXZvaWQgMDt2YXIgbT1LKDM2NyksZz1LKDY5OSkscz1LKDEwNikscT1LKDc1OCksQj1LKDE5Nyk7dS5BU1NFUlRfTElCPXtuYXRpdmU6ZnVuY3Rpb24oTSl7dmFyIFY9bmV3IG0uRHluYW1pY0Jhc2lzKHt9LHt9LHt9LHt9LHt9KSxEPW5ldyBtLlN0YXRpY0Jhc2lzKHt9LHt9LHt9LHt9LHt9KTtyZXR1cm4gVi5zZXRWYWx1ZSgiYXNzZXJ0RGVmaW5lZCIsbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCJhc3NlcnREZWZpbmVkIixmdW5jdGlvbihoLEEpe3ZhciBJPSExO2lmKGggaW5zdGFuY2VvZiBzLlJlY29yZFZhbHVlJiZoLmVudHJpZXMuc2l6ZT09PTIpe3ZhciBPPWguZ2V0VmFsdWUoIjEiKSxFPWguZ2V0VmFsdWUoIjIiKTtpZihPIGluc3RhbmNlb2Ygcy5TdHJpbmdWYWx1ZSl7dmFyIHI9Ty52YWx1ZSxlPUEubW9kaWZpYWJsZTtyZXR1cm4oZT09PXZvaWQgMHx8ZS5nZXREeW5hbWljVmFsdWUocik9PT12b2lkIDApJiYoST0hMCksST9bQi5mYWlsRXhjZXB0aW9uLmNvbnN0cnVjdChFKSwhMCxbXV06W25ldyBzLlJlY29yZFZhbHVlLCExLFtdXX19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJJIGhhdGUgZWNjaGkgcGVvcGxlISIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxELnNldFZhbHVlKCJhc3NlcnREZWZpbmVkIixuZXcgZy5GdW5jdGlvblR5cGUobmV3IGcuVHVwbGVUeXBlKFtCLnN0cmluZ1R5cGUsQi5zdHJpbmdUeXBlXSksbmV3IGcuVHVwbGVUeXBlKFtdKSkuc2ltcGxpZnkoKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLFYuc2V0VmFsdWUoInByaW50VHlwZSIsbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCJwcmludFR5cGUiLGZ1bmN0aW9uKGgsQSl7dmFyIEk9W107aWYoaCBpbnN0YW5jZW9mIHMuU3RyaW5nVmFsdWUpe3ZhciBPPWgudmFsdWUsRT1BLm1vZGlmaWFibGU7aWYoRSE9PXZvaWQgMCl7dmFyIHI9RS5nZXRTdGF0aWNWYWx1ZShPKTtpZihyIT09dm9pZCAwKXt2YXIgZT1yWzBdO2UhPT12b2lkIDAmJkkucHVzaChuZXcgcS5XYXJuaW5nKC0yLGUudG9TdHJpbmcoe30pKSl9cmV0dXJuW25ldyBzLlJlY29yZFZhbHVlLCExLEldfX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIlx1MzBCM1x1MzBDRVx1MzBFNFx1MzBFRFx1MzBGQyEhXHUzMEQwXHUzMEFCXHUzMEU0XHUzMEVEXHUzMEZDISEiKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgicHJpbnRUeXBlIixuZXcgZy5GdW5jdGlvblR5cGUoQi5zdHJpbmdUeXBlLG5ldyBnLlR1cGxlVHlwZShbXSkpLnNpbXBsaWZ5KCksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxWLnNldFZhbHVlKCJhc3NlcnRUeXBlIixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oImFzc2VydFR5cGUiLGZ1bmN0aW9uKGgsQSl7dmFyIEk9ITE7aWYoaCBpbnN0YW5jZW9mIHMuUmVjb3JkVmFsdWUmJmguZW50cmllcy5zaXplPT09Mil7dmFyIE89aC5nZXRWYWx1ZSgiMSIpLEU9aC5nZXRWYWx1ZSgiMiIpO2lmKE8gaW5zdGFuY2VvZiBzLlJlY29yZFZhbHVlJiZoLmVudHJpZXMuc2l6ZT09PTIpe3ZhciByPU8uZ2V0VmFsdWUoIjEiKSxlPU8uZ2V0VmFsdWUoIjIiKTtpZihyIGluc3RhbmNlb2Ygcy5TdHJpbmdWYWx1ZSYmZSBpbnN0YW5jZW9mIHMuU3RyaW5nVmFsdWUpe3ZhciBvPXIudmFsdWUseT1BLm1vZGlmaWFibGU7aWYoeT09PXZvaWQgMClJPSEwO2Vsc2V7dmFyIGQ9eS5nZXRTdGF0aWNWYWx1ZShvKTtpZihkPT09dm9pZCAwKUk9ITA7ZWxzZXt2YXIgdj1kWzBdO3YhPT12b2lkIDAmJnYudG9TdHJpbmcoe30pPT09ZS52YWx1ZXx8KEk9ITApfX1yZXR1cm4gST9bQi5mYWlsRXhjZXB0aW9uLmNvbnN0cnVjdChFKSwhMCxbXV06W25ldyBzLlJlY29yZFZhbHVlLCExLFtdXX19fXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiSW4gdGhlIG5hbWUgb2YgdGhlIG1vb24sIEkgd2lsbCBwdW5pc2ggeW91ISIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxELnNldFZhbHVlKCJhc3NlcnRUeXBlIixuZXcgZy5GdW5jdGlvblR5cGUobmV3IGcuVHVwbGVUeXBlKFtuZXcgZy5UdXBsZVR5cGUoW0Iuc3RyaW5nVHlwZSxCLnN0cmluZ1R5cGVdKSxCLnN0cmluZ1R5cGVdKSxuZXcgZy5UdXBsZVR5cGUoW10pKS5zaW1wbGlmeSgpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksVi5zZXRWYWx1ZSgiYXNzZXJ0VmFsdWUiLG5ldyBzLlByZWRlZmluZWRGdW5jdGlvbigiYXNzZXJ0VmFsdWUiLGZ1bmN0aW9uKGgsQSl7dmFyIEk9ITE7aWYoaCBpbnN0YW5jZW9mIHMuUmVjb3JkVmFsdWUmJmguZW50cmllcy5zaXplPT09Mil7dmFyIE89aC5nZXRWYWx1ZSgiMSIpLEU9aC5nZXRWYWx1ZSgiMiIpO2lmKE8gaW5zdGFuY2VvZiBzLlJlY29yZFZhbHVlJiZoLmVudHJpZXMuc2l6ZT09PTIpe3ZhciByPU8uZ2V0VmFsdWUoIjEiKSxlPU8uZ2V0VmFsdWUoIjIiKTtpZihyIGluc3RhbmNlb2Ygcy5TdHJpbmdWYWx1ZSYmZSBpbnN0YW5jZW9mIHMuU3RyaW5nVmFsdWUpe3ZhciBvPXIudmFsdWUseT1BLm1vZGlmaWFibGU7aWYoeT09PXZvaWQgMClJPSEwO2Vsc2V7dmFyIGQ9eS5nZXREeW5hbWljVmFsdWUobyk7aWYoZD09PXZvaWQgMClJPSEwO2Vsc2V7dmFyIHY9ZFswXTt2IT09dm9pZCAwJiZ2LnRvU3RyaW5nKHkpPT09ZS52YWx1ZXx8KEk9ITApfX1yZXR1cm4gST9bQi5mYWlsRXhjZXB0aW9uLmNvbnN0cnVjdChFKSwhMCxbXV06W25ldyBzLlJlY29yZFZhbHVlLCExLFtdXX19fXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiXHU1NjE4XHUzMDYwXHUzMEMzXHVGRjAxIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLEQuc2V0VmFsdWUoImFzc2VydFZhbHVlIixuZXcgZy5GdW5jdGlvblR5cGUobmV3IGcuVHVwbGVUeXBlKFtuZXcgZy5UdXBsZVR5cGUoW0Iuc3RyaW5nVHlwZSxCLnN0cmluZ1R5cGVdKSxCLnN0cmluZ1R5cGVdKSxuZXcgZy5UdXBsZVR5cGUoW10pKS5zaW1wbGlmeSgpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksVi5zZXRWYWx1ZSgiYXNzZXJ0VmFsdWVFcSIsbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCJhc3NlcnRWYWx1ZUVxIixmdW5jdGlvbihoLEEpe3ZhciBJPSExO2lmKGggaW5zdGFuY2VvZiBzLlJlY29yZFZhbHVlJiZoLmVudHJpZXMuc2l6ZT09PTIpe3ZhciBPPWguZ2V0VmFsdWUoIjEiKSxFPWguZ2V0VmFsdWUoIjIiKTtpZihPIGluc3RhbmNlb2Ygcy5SZWNvcmRWYWx1ZSYmaC5lbnRyaWVzLnNpemU9PT0yKXt2YXIgcj1PLmdldFZhbHVlKCIxIiksZT1PLmdldFZhbHVlKCIyIik7aWYociBpbnN0YW5jZW9mIHMuU3RyaW5nVmFsdWUpe3ZhciBvPXIudmFsdWUseT1BLm1vZGlmaWFibGU7aWYoeT09PXZvaWQgMClJPSEwO2Vsc2V7dmFyIGQ9eS5nZXREeW5hbWljVmFsdWUobyk7aWYoZD09PXZvaWQgMClJPSEwO2Vsc2V7dmFyIHY9ZFswXTt2IT09dm9pZCAwJiZ2LmVxdWFscyhlKXx8KEk9ITApfX1yZXR1cm4gST9bQi5mYWlsRXhjZXB0aW9uLmNvbnN0cnVjdChFKSwhMCxbXV06W25ldyBzLlJlY29yZFZhbHVlLCExLFtdXX19fXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigiQmVlcC4gQmVlcC1CZWVwLiBCZWVwLiBCZWVwLUJlZXAtQmVlcC4gQmVlcC4gQmVlcC4iKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgiYXNzZXJ0VmFsdWVFcSIsbmV3IGcuRnVuY3Rpb25UeXBlKG5ldyBnLlR1cGxlVHlwZShbbmV3IGcuVHVwbGVUeXBlKFtCLnN0cmluZ1R5cGUsbmV3IGcuVHlwZVZhcmlhYmxlKCInYSIpXSksQi5zdHJpbmdUeXBlXSksbmV3IGcuVHVwbGVUeXBlKFtdKSkuc2ltcGxpZnkoKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLFYuc2V0VmFsdWUoImNvdW50Q2FsbE9jY3VycmVuY2VzIixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oImNvdW50Q2FsbE9jY3VycmVuY2VzIixmdW5jdGlvbihoLEEpe3JldHVybltuZXcgcy5SZWNvcmRWYWx1ZSwhMSxbXV19KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLEQuc2V0VmFsdWUoImNvdW50Q2FsbE9jY3VycmVuY2VzIixuZXcgZy5GdW5jdGlvblR5cGUobmV3IGcuVHVwbGVUeXBlKFtCLnN0cmluZ1R5cGUsQi5zdHJpbmdUeXBlXSksQi5pbnRUeXBlKS5zaW1wbGlmeSgpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksVi5zZXRWYWx1ZSgiY291bnRFeHByZXNzaW9uT2NjdXJyZW5jZXMiLG5ldyBzLlByZWRlZmluZWRGdW5jdGlvbigiY291bnRFeHByZXNzaW9uT2NjdXJyZW5jZXMiLGZ1bmN0aW9uKGgsQSl7cmV0dXJuW25ldyBzLlJlY29yZFZhbHVlLCExLFtdXX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgiY291bnRFeHByZXNzaW9uT2NjdXJyZW5jZXMiLG5ldyBnLkZ1bmN0aW9uVHlwZShuZXcgZy5UdXBsZVR5cGUoW0Iuc3RyaW5nVHlwZSxCLnN0cmluZ1R5cGVdKSxCLmludFR5cGUpLnNpbXBsaWZ5KCksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxNLnNldER5bmFtaWNTdHJ1Y3R1cmUoIkFzc2VydCIsViksTS5zZXRTdGF0aWNTdHJ1Y3R1cmUoIkFzc2VydCIsRCksTX0sY29kZTpgc2lnbmF0dXJlIEFTU0VSVCA9IHNpZwogICAgICAgIHZhbCBhc3NlcnQgOiBib29sICogc3RyaW5nIC0+IHVuaXQ7CiAgICAgICAgdmFsIGludmVydCA6ICgnYSAqIHN0cmluZyAtPiB1bml0KSAtPiAnYSAqIHN0cmluZyAtPiB1bml0OwoKICAgICAgICAoKiBDaGVja3Mgd2hldGhlciBhbiBpZGVudGlmaWVyIGlzIGRlZmluZWQsIG90aGVyd2lzZSByYWlzZXMgYW4gRmFpbAogICAgICAgICAgIHdpdGggdGhlIHNlY29uZCBwYXJhbWV0ZXIgYXMgdGhlIG1lc3NhZ2UgKikKICAgICAgICB2YWwgYXNzZXJ0RGVmaW5lZCA6IHN0cmluZyAqIHN0cmluZyAtPiB1bml0OwoKICAgICAgICAoKiBQcmludHMgdGhlIHR5cGUgb2YgdGhlIHN5bWJvbCBwYXNzZWQgYXMgYXJndW1lbnQgKikKICAgICAgICB2YWwgcHJpbnRUeXBlIDogc3RyaW5nIC0+IHVuaXQ7CgogICAgICAgICgqIENoZWNrcyB3aGV0aGVyIGFuIGlkZW50aWZpZXIgaGFzIHRoZSBzcGVjaWZpZWQgdHlwZSwKICAgICAgICAgICBvdGhlcndpc2UgcmFpc2VzIGFuIEZhaWwgd2l0aCB0aGUgc2Vjb25kIHBhcmFtZXRlciBhcyB0aGUgbWVzc2FnZSAqKQogICAgICAgIHZhbCBhc3NlcnRUeXBlIDogKHN0cmluZyAqIHN0cmluZykgKiBzdHJpbmcgLT4gdW5pdDsKCiAgICAgICAgKCogQ2hlY2tzIHdoZXRoZXIgYW4gaWRlbnRpZmllciBpcyBlcXVhbCB0byB0aGUgZ2l2ZW4gdmFsdWUsCiAgICAgICAgICAgb3RoZXJ3aXNlIHJhaXNlcyBhbiBGYWlsIHdpdGggdGhlIHNlY29uZCBwYXJhbWV0ZXIgYXMgdGhlIG1lc3NhZ2UgKikKICAgICAgICB2YWwgYXNzZXJ0VmFsdWVFcSA6IChzdHJpbmcgKiAnJ2EpICogc3RyaW5nIC0+IHVuaXQ7CgogICAgICAgIHZhbCBhc3NlcnRWYWx1ZSA6IChzdHJpbmcgKiBzdHJpbmcpICogc3RyaW5nIC0+IHVuaXQ7CgogICAgICAgICgqIENvdW50cyBob3cgb2Z0ZW4gdGhlIHNlY29uZCBpZGVudGlmaWVyIG9jY3VycyBpbiB0aGUgZGVmaW5pdGlvbiBvZiB0aGUgZmlyc3QgaWRlbnRpZmllcgogICAgICAgICAgIChhZnRlciByZXNvbHZpbmcgc2ltcGxpZmljYXRpb25zKS4gKikKICAgICAgICAoKiB2YWwgY291bnRDYWxsT2NjdXJyZW5jZXMgOiBzdHJpbmcgKiBzdHJpbmcgLT4gaW50OyAqKQoKICAgICAgICAoKiBDb3VudHMgaG93IG9mdGVuIHRoZSBzZWNvbmQgcGFyYW1ldGVyIChFeHByZXNzaW9uVHlwZSkgb2NjdXJzIGluIHRoZSBkZWZpbml0aW9uIG9mIHRoZQogICAgICAgICAgIGZpcnN0IGlkZW50aWZpZXIuICopCiAgICAgICAgKCogdmFsIGNvdW50RXhwcmVzc2lvbk9jY3VycmVuY2VzIDogc3RyaW5nICogc3RyaW5nIC0+IGludDsgKikKICAgIGVuZDsKCiAgICBzdHJ1Y3R1cmUgQXNzZXJ0IDo+IEFTU0VSVCA9IHN0cnVjdAogICAgICAgIG9wZW4gQXNzZXJ0OwoKICAgICAgICBmdW4gYXNzZXJ0ICh0cnVlLCBfKSA9ICgpCiAgICAgICAgICB8IGFzc2VydCAoZmFsc2UsIG1zZykgPSByYWlzZSBGYWlsKG1zZyk7CgogICAgICAgIGZ1biBpbnZlcnQgYXNzZXJ0aW9uIChleHAsIG1zZykgPSBsZXQKICAgICAgICAgIHZhbCB0aHJvd24gPSAoYXNzZXJ0aW9uIChleHAsICIiKTsgZmFsc2UpIGhhbmRsZSBGYWlsIGUgPT4gdHJ1ZTsKICAgICAgICBpbgogICAgICAgICAgaWYgdGhyb3duIHRoZW4gKCkgZWxzZSByYWlzZSBGYWlsKG1zZykKICAgICAgICBlbmQ7CiAgICBlbmQ7YCxyZXF1aXJlczpbXX19LDMzNDooZmUsdSxLKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh1LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx1LkNIQVJfTElCPXZvaWQgMDt2YXIgbT1LKDM2NyksZz1LKDY5OSkscz1LKDEwNikscT1LKDc1OCksQj1LKDE5Nyk7dS5DSEFSX0xJQj17bmF0aXZlOmZ1bmN0aW9uKE0pe3JldHVybiBNLnNldER5bmFtaWNWYWx1ZSgib3JkIixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oIm9yZCIsZnVuY3Rpb24oVixEKXtpZihWIGluc3RhbmNlb2Ygcy5DaGFyVmFsdWUpe3ZhciBoPVYudmFsdWU7cmV0dXJuW25ldyBzLkludGVnZXIoaC5jaGFyQ29kZUF0KDApKSwhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxNLnNldFN0YXRpY1ZhbHVlKCJvcmQiLG5ldyBnLkZ1bmN0aW9uVHlwZShCLmNoYXJUeXBlLEIuaW50VHlwZSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxNLnNldER5bmFtaWNWYWx1ZSgiY2hyIixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oImNociIsZnVuY3Rpb24oVixEKXtpZihWIGluc3RhbmNlb2Ygcy5JbnRlZ2VyKXt2YXIgaD1WLnZhbHVlO3JldHVybiBoPDB8fGg+MjU1P1tCLmNockV4Y2VwdGlvbi5jb25zdHJ1Y3QoKSwhMCxbXV06W25ldyBzLkNoYXJWYWx1ZShTdHJpbmcuZnJvbUNoYXJDb2RlKGgpKSwhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxNLnNldFN0YXRpY1ZhbHVlKCJjaHIiLG5ldyBnLkZ1bmN0aW9uVHlwZShCLmludFR5cGUsQi5jaGFyVHlwZSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxNfSxjb2RlOmBzdHJ1Y3R1cmUgQ2hhciA9IHN0cnVjdAogICAgICAgIGZ1biBpc0xvd2VyIGMgID0gIyJhIiA8PSBjIGFuZGFsc28gYyA8PSAjInoiCiAgICAgICAgZnVuIGlzVXBwZXIgYyAgPSAjIkEiIDw9IGMgYW5kYWxzbyBjIDw9ICMiWiIKICAgICAgICBmdW4gaXNEaWdpdCBjICA9ICMiMCIgPD0gYyBhbmRhbHNvIGMgPD0gIyI5IgogICAgICAgIGZ1biBpc0FscGhhIGMgID0gaXNMb3dlciBjIG9yZWxzZSBpc1VwcGVyIGMKICAgICAgICBmdW4gaXNIZXhEaWdpdCBjID0gIyIwIiA8PSBjIGFuZGFsc28gYyA8PSAjIjkiCiAgICAgICAgb3JlbHNlICMiYSIgPD0gYyBhbmRhbHNvIGMgPD0gIyJmIgogICAgICAgIG9yZWxzZSAjIkEiIDw9IGMgYW5kYWxzbyBjIDw9ICMiRiIKICAgICAgICBmdW4gaXNBbHBoYU51bSBjID0gaXNBbHBoYSBjIG9yZWxzZSBpc0RpZ2l0IGMKICAgICAgICBmdW4gaXNQcmludCBjICA9IGMgPj0gIyIgIiBhbmRhbHNvIGMgPCAjIlxcMTI3IgogICAgICAgIGZ1biBpc1NwYWNlIGMgID0gYyA9ICMiICIgb3JlbHNlICMiXFwwMDkiIDw9IGMgYW5kYWxzbyBjIDw9ICMiXFwwMTMiCiAgICAgICAgZnVuIGlzR3JhcGggYyAgPSBpc1ByaW50IGMgYW5kYWxzbyBub3QgKGlzU3BhY2UgYykKICAgICAgICBmdW4gaXNQdW5jdCBjICA9IGlzR3JhcGggYyBhbmRhbHNvIG5vdCAoaXNBbHBoYU51bSBjKQogICAgICAgIGZ1biBpc0FzY2lpIGMgID0gYyA8PSAjIlxcMTI3IgogICAgICAgIGZ1biBpc0NudHJsIGMgID0gYyA8ICMiICIgb3JlbHNlIGMgPj0gIyJcXDEyNyIKCiAgICAgICAgZnVuIHRvTG93ZXIgYyA9CiAgICAgICAgICAgIGlmICMiQSIgPD0gYyBhbmRhbHNvIGMgPD0gIyJaIiB0aGVuIGNociAob3JkIGMgKyAzMikKICAgICAgICBlbHNlIGM7CiAgICAgICAgZnVuIHRvVXBwZXIgYyA9CiAgICAgICAgICAgIGlmICMiYSIgPD0gYyBhbmRhbHNvIGMgPD0gIyJ6IiB0aGVuIGNociAob3JkIGMgLSAzMikKICAgICAgICBlbHNlIGM7CgogICAgICAgIGZ1biBjb21wYXJlIChhLCBiKSA9IEludC5jb21wYXJlKG9yZCBhLCBvcmQgYik7CiAgICAgICAgZnVuIG9wPCAoYSwgYikgPSBJbnQuY29tcGFyZShvcmQgYSwgb3JkIGIpID0gTEVTUzsKICAgICAgICBmdW4gb3A+IChhLCBiKSA9IEludC5jb21wYXJlKG9yZCBhLCBvcmQgYikgPSBHUkVBVEVSOwogICAgICAgIGZ1biBvcDw9IChhLCBiKSA9IEludC5jb21wYXJlKG9yZCBhLCBvcmQgYikgPD4gR1JFQVRFUjsKICAgICAgICBmdW4gb3A+PSAoYSwgYikgPSBJbnQuY29tcGFyZShvcmQgYSwgb3JkIGIpIDw+IExFU1M7CgogICAgICAgIHZhbCBvcmQgPSBvcmQ7CiAgICAgICAgdmFsIGNociA9IGNocjsKICAgICAgICB2YWwgbWF4T3JkID0gMjU1OwogICAgICAgIHZhbCBtYXhDaGFyID0gY2hyIG1heE9yZDsKICAgICAgICB2YWwgbWluQ2hhciA9IGNociAwOwoKICAgICAgICBmdW4gc3VjYyBjID0gaWYgYyA9IG1heENoYXIgdGhlbiByYWlzZSBDaHIgZWxzZSBjaHIob3JkIGMgKyAxKQogICAgICAgIGZ1biBwcmVkIGMgPSBpZiBjID0gbWluQ2hhciB0aGVuIHJhaXNlIENociBlbHNlIGNocihvcmQgYyAtIDEpCgogICAgICAgIGZ1biBjb250YWlucyBzID0gbGV0CiAgICAgICAgICAgIHZhbCB0YWJsZSA9IEFycmF5LmFycmF5KG1heE9yZCArIDEsIGZhbHNlKQogICAgICAgICAgICB2YWwgbCA9IGV4cGxvZGUgcwogICAgICAgIGluCiAgICAgICAgICAgIChMaXN0LmFwcCAoZm4geCA9PiBBcnJheS51cGRhdGUodGFibGUsIG9yZCB4LCB0cnVlKSkgbDsgZm4gYyA9PiBBcnJheS5zdWIodGFibGUsIG9yZCBjKSkKICAgICAgICBlbmQ7CiAgICAgICAgZnVuIG5vdENvbnRhaW5zIHMgPSBsZXQKICAgICAgICAgICAgdmFsIHRhYmxlID0gQXJyYXkuYXJyYXkobWF4T3JkICsgMSwgZmFsc2UpCiAgICAgICAgICAgIHZhbCBsID0gZXhwbG9kZSBzCiAgICAgICAgaW4KICAgICAgICAgICAgKExpc3QuYXBwIChmbiB4ID0+IEFycmF5LnVwZGF0ZSh0YWJsZSwgb3JkIHgsIHRydWUpKSBsOyBmbiBjID0+IG5vdCAoQXJyYXkuc3ViKHRhYmxlLCBvcmQgYykpKQogICAgICAgIGVuZDsKICAgIGVuZDtgLHJlcXVpcmVzOlsiSW50IiwiQXJyYXkiLCJMaXN0Il19fSw4MDE6KGZlLHUsSyk9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdS5FVkFMX0xJQj12b2lkIDA7dmFyIG09SygzNjcpLGc9Syg2OTkpLHM9SygxMDYpLHE9Syg3NTgpLEI9Syg0MDMpLE09SygyMTUpLFY9Syg2NTUpLEQ9Syg0OTQpLGg9SygxOTcpO3UuRVZBTF9MSUI9e25hdGl2ZTpmdW5jdGlvbihBKXt2YXIgST1uZXcgbS5EeW5hbWljQmFzaXMoe30se30se30se30se30pLE89bmV3IG0uU3RhdGljQmFzaXMoe30se30se30se30se30pO3JldHVybiBJLnNldFZhbHVlKCJldmFsRXhwIixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oInN5bWJvbGljX2V2YWwiLGZ1bmN0aW9uKEUscil7aWYoIShFIGluc3RhbmNlb2Ygcy5TdHJpbmdWYWx1ZSkpdGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJUaGlzIHN0ZCB0eXBlIG1pc21hdGNoIHJlaWducyBzdXByZW1lISIpO3ZhciBlPUUudmFsdWU7dHJ5e3ZhciBvPUIubGV4KGUrIjsiLHt9KSx5PW5ldyBNLlBhcnNlcihvLHIuc3RhdGUsci5zdGF0ZS5pZCx7fSkucGFyc2VFeHByZXNzaW9uKCk7eT15LnNpbXBsaWZ5KCk7dmFyIGQ9W107ZC5wdXNoKHtuZXh0OnkscGFyYW1zOntzdGF0ZTpyLnN0YXRlLmdldE5lc3RlZFN0YXRlKCksbW9kaWZpYWJsZTpyLnN0YXRlLmdldE5lc3RlZFN0YXRlKCkscmVjUmVzdWx0OnZvaWQgMH19KTtmb3IodmFyIHY9dm9pZCAwLEM9IiIsRz1uZXcgTWFwLFk9ZnVuY3Rpb24oKXt2YXIgSj1kLnBvcCgpO2lmKEo9PT12b2lkIDApdGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJcdTMwRDBcdTMwQzhcdTMwRUJcdTMwMDFcdTMwRDBcdTMwQzhcdTMwRUJcdTMwNTdcdTMwNUZcdTMwNDRcdUZGMDEiKTt2YXIgej1KLm5leHQscD1KLnBhcmFtcztwLnJlY1Jlc3VsdD12LHY9eiBpbnN0YW5jZW9mIFYuRGVjbGFyYXRpb24/ei5ldmFsdWF0ZShwLGQpOnouY29tcHV0ZShwLGQpO3ZhciBjPUoubmV4dC50b1N0cmluZygpO2lmKHAuc3RlcD09PTEmJiFjLmluY2x1ZGVzKCJfX2FyZyIpKWlmKHYmJnYudmFsdWUpQys9YysiIFx1MjE5MiAiK3YudmFsdWUudG9TdHJpbmcocC5zdGF0ZSkrYApgO2Vsc2V7dmFyIHc9bmV3IE1hcDtHLmZvckVhY2goZnVuY3Rpb24oVCxOKXtjLmluY2x1ZGVzKE4pP2M9Yy5yZXBsYWNlKE4sVCk6dy5zZXQoTixUKX0pLEc9dyxDKz1jK2AKYH12JiZ2LnZhbHVlJiZ2LnZhbHVlLnRvU3RyaW5nKHAuc3RhdGUpIT09ImZuIiYmKEoubmV4dCBpbnN0YW5jZW9mIEQuVmFsdWVJZGVudGlmaWVyfHxKLm5leHQgaW5zdGFuY2VvZiBELlJlY29yZHx8Ry5zZXQoSi5uZXh0LnRvU3RyaW5nKCksdi52YWx1ZS50b1N0cmluZyhwLnN0YXRlKSkpfTtkLmxlbmd0aD4wOylZKCk7cmV0dXJuIHYhPT12b2lkIDAmJnYudmFsdWUhPT12b2lkIDAmJihDKz12LnZhbHVlLnRvU3RyaW5nKHZvaWQgMCkrYApgKSxbbmV3IHMuUmVjb3JkVmFsdWUsITEsW25ldyBxLldhcm5pbmcoLTIsQyldXX1jYXRjaChKKXtyZXR1cm5bbmV3IHMuUmVjb3JkVmFsdWUsITEsW25ldyBxLldhcm5pbmcoLTEsSi5tZXNzYWdlKV1dfX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksTy5zZXRWYWx1ZSgiZXZhbEV4cCIsbmV3IGcuRnVuY3Rpb25UeXBlKGguc3RyaW5nVHlwZSxuZXcgZy5UdXBsZVR5cGUoW10pKS5zaW1wbGlmeSgpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksQS5zZXREeW5hbWljU3RydWN0dXJlKCJFdmFsIixJKSxBLnNldFN0YXRpY1N0cnVjdHVyZSgiRXZhbCIsTyksQX0sY29kZTp2b2lkIDAscmVxdWlyZXM6dm9pZCAwfX0sMzU5OihmZSx1LEspPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHUsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHUuSU5UX0xJQj12b2lkIDA7dmFyIG09SygzNjcpLGc9Syg2OTkpLHM9SygxMDYpLHE9Syg3NTgpLEI9SygxOTcpO3UuSU5UX0xJQj17bmF0aXZlOmZ1bmN0aW9uKE0pe3ZhciBWPW5ldyBtLkR5bmFtaWNCYXNpcyh7fSx7fSx7fSx7fSx7fSksRD1uZXcgbS5TdGF0aWNCYXNpcyh7fSx7fSx7fSx7fSx7fSk7cmV0dXJuIFYuc2V0VmFsdWUoInRvU3RyaW5nIixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oInRvU3RyaW5nIixmdW5jdGlvbihoLEEpe2lmKGggaW5zdGFuY2VvZiBzLkludGVnZXIpcmV0dXJuW25ldyBzLlN0cmluZ1ZhbHVlKGgudG9TdHJpbmcodm9pZCAwKSksITEsW11dO3Rocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgidG9TdHJpbmciLG5ldyBnLkZ1bmN0aW9uVHlwZShCLmludFR5cGUsQi5zdHJpbmdUeXBlKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLE0uc2V0RHluYW1pY1N0cnVjdHVyZSgiSW50IixWKSxNLnNldFN0YXRpY1N0cnVjdHVyZSgiSW50IixEKSxNfSxjb2RlOmBzdHJ1Y3R1cmUgSW50ID0gc3RydWN0CiAgICAgICAgICAgIG9wZW4gSW50OwogICAgICAgICAgICBmdW4gY29tcGFyZSAoeCwgeTogaW50KSA9IGlmIHggPCB5IHRoZW4gTEVTUyBlbHNlIGlmIHggPiB5IHRoZW4gR1JFQVRFUiBlbHNlIEVRVUFMOwoKICAgICAgICAgICAgdmFsIG1pbkludCA9IFNPTUUgfmArLXMuTUlOSU5UK2A7CiAgICAgICAgICAgIHZhbCBtYXhJbnQgPSBTT01FIGArcy5NQVhJTlQrYDsKICAgICAgICAgICAgZnVuIG1heCAoeCwgeSkgPSBpZiB4IDwgeSB0aGVuIHkgZWxzZSB4IDogaW50OwogICAgICAgICAgICBmdW4gbWluICh4LCB5KSA9IGlmIHggPiB5IHRoZW4geSBlbHNlIHggOiBpbnQ7CiAgICAgICAgZW5kO2AscmVxdWlyZXM6WyJPcHRpb24iXX19LDY3OTooZmUsdSxLKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh1LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx1LkxJU1RfTElCPXZvaWQgMDt2YXIgbT1LKDM2NyksZz1LKDY5OSkscz1LKDEwNik7dS5MSVNUX0xJQj17bmF0aXZlOmZ1bmN0aW9uKHEpe3ZhciBCPW5ldyBtLkR5bmFtaWNCYXNpcyh7fSx7fSx7fSx7fSx7fSksTT1uZXcgbS5TdGF0aWNCYXNpcyh7fSx7fSx7fSx7fSx7fSk7cmV0dXJuIE0uc2V0VHlwZSgibGlzdCIsbmV3IGcuQ3VzdG9tVHlwZSgibGlzdCIsW25ldyBnLlR5cGVWYXJpYWJsZSgiJ2EiKV0pLFsibmlsIiwiOjoiXSwxLCEwKSxNLnNldFZhbHVlKCJuaWwiLG5ldyBnLlR5cGVWYXJpYWJsZUJpbmQoIidhIixuZXcgZy5DdXN0b21UeXBlKCJsaXN0IixbbmV3IGcuVHlwZVZhcmlhYmxlKCInYSIpXSkpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9DT05TVFJVQ1RPUiksTS5zZXRWYWx1ZSgiOjoiLG5ldyBnLlR5cGVWYXJpYWJsZUJpbmQoIidhIixuZXcgZy5GdW5jdGlvblR5cGUobmV3IGcuVHVwbGVUeXBlKFtuZXcgZy5UeXBlVmFyaWFibGUoIidhIiksbmV3IGcuQ3VzdG9tVHlwZSgibGlzdCIsW25ldyBnLlR5cGVWYXJpYWJsZSgiJ2EiKV0pXSksbmV3IGcuQ3VzdG9tVHlwZSgibGlzdCIsW25ldyBnLlR5cGVWYXJpYWJsZSgiJ2EiKV0pKSkuc2ltcGxpZnkoKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfQ09OU1RSVUNUT1IpLEIuc2V0VHlwZSgibGlzdCIsWyJuaWwiLCI6OiJdKSxCLnNldFZhbHVlKCJuaWwiLG5ldyBzLlZhbHVlQ29uc3RydWN0b3IoIm5pbCIpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9DT05TVFJVQ1RPUiksQi5zZXRWYWx1ZSgiOjoiLG5ldyBzLlZhbHVlQ29uc3RydWN0b3IoIjo6IiwxKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfQ09OU1RSVUNUT1IpLHEuc2V0RHluYW1pY1N0cnVjdHVyZSgiTGlzdCIsQikscS5zZXRTdGF0aWNTdHJ1Y3R1cmUoIkxpc3QiLE0pLHF9LGNvZGU6YAogICAgICAgIHNpZ25hdHVyZSBMSVNUID0gc2lnCiAgICAgICAgICAgIGRhdGF0eXBlICdhIGxpc3QgPSBuaWwgfCA6OiBvZiAnYSAqICdhIGxpc3Q7CiAgICAgICAgICAgIGV4Y2VwdGlvbiBFbXB0eQogICAgICAgICAgICB2YWwgbnVsbCA6ICdhIGxpc3QgLT4gYm9vbAogICAgICAgICAgICB2YWwgaGQgOiAnYSBsaXN0IC0+ICdhCiAgICAgICAgICAgIHZhbCB0bCA6ICdhIGxpc3QgLT4gJ2EgbGlzdAogICAgICAgICAgICB2YWwgbGFzdCA6ICdhIGxpc3QgLT4gJ2EKICAgICAgICAgICAgdmFsIGdldEl0ZW0gOiAnYSBsaXN0IC0+ICgnYSAqICdhIGxpc3QpIG9wdGlvbgogICAgICAgICAgICB2YWwgbnRoIDogJ2EgbGlzdCAqIGludCAtPiAnYQogICAgICAgICAgICB2YWwgdGFrZSA6ICdhIGxpc3QgKiBpbnQgLT4gJ2EgbGlzdAogICAgICAgICAgICB2YWwgZHJvcCA6ICdhIGxpc3QgKiBpbnQgLT4gJ2EgbGlzdAogICAgICAgICAgICB2YWwgbGVuZ3RoIDogJ2EgbGlzdCAtPiBpbnQKICAgICAgICAgICAgdmFsIHJldiA6ICdhIGxpc3QgLT4gJ2EgbGlzdAogICAgICAgICAgICB2YWwgQCA6ICdhIGxpc3QgKiAnYSBsaXN0IC0+ICdhIGxpc3QKICAgICAgICAgICAgdmFsIGNvbmNhdCA6ICdhIGxpc3QgbGlzdCAtPiAnYSBsaXN0CiAgICAgICAgICAgIHZhbCByZXZBcHBlbmQgOiAnYSBsaXN0ICogJ2EgbGlzdCAtPiAnYSBsaXN0CiAgICAgICAgICAgIHZhbCBhcHAgOiAoJ2EgLT4gdW5pdCkgLT4gJ2EgbGlzdCAtPiB1bml0CiAgICAgICAgICAgIHZhbCBtYXAgOiAoJ2EgLT4gJ2IpIC0+ICdhIGxpc3QgLT4gJ2IgbGlzdAogICAgICAgICAgICB2YWwgbWFwUGFydGlhbCA6ICgnYSAtPiAnYiBvcHRpb24pIC0+ICdhIGxpc3QgLT4gJ2IgbGlzdAogICAgICAgICAgICB2YWwgZmluZCA6ICgnYSAtPiBib29sKSAtPiAnYSBsaXN0IC0+ICdhIG9wdGlvbgogICAgICAgICAgICB2YWwgZmlsdGVyIDogKCdhIC0+IGJvb2wpIC0+ICdhIGxpc3QgLT4gJ2EgbGlzdAogICAgICAgICAgICB2YWwgcGFydGl0aW9uIDogKCdhIC0+IGJvb2wpIC0+ICdhIGxpc3QgLT4gJ2EgbGlzdCAqICdhIGxpc3QKICAgICAgICAgICAgdmFsIHBlcm11dGF0aW9uczogJ2EgbGlzdCAtPiAnYSBsaXN0IGxpc3QKICAgICAgICAgICAgdmFsIGZvbGRyIDogKCdhICogJ2IgLT4gJ2IpIC0+ICdiIC0+ICdhIGxpc3QgLT4gJ2IKICAgICAgICAgICAgdmFsIGZvbGRsIDogKCdhICogJ2IgLT4gJ2IpIC0+ICdiIC0+ICdhIGxpc3QgLT4gJ2IKICAgICAgICAgICAgdmFsIGV4aXN0cyA6ICgnYSAtPiBib29sKSAtPiAnYSBsaXN0IC0+IGJvb2wKICAgICAgICAgICAgdmFsIGFsbCA6ICgnYSAtPiBib29sKSAtPiAnYSBsaXN0IC0+IGJvb2wKICAgICAgICAgICAgdmFsIHRhYnVsYXRlIDogaW50ICogKGludCAtPiAnYSkgLT4gJ2EgbGlzdAogICAgICAgICAgICB2YWwgY29sbGF0ZSA6ICgnYSAqICdhIC0+IG9yZGVyKSAtPiAnYSBsaXN0ICogJ2EgbGlzdCAtPiBvcmRlcgogICAgICAgIGVuZDsKCiAgICAgICAgc3RydWN0dXJlIExpc3QgOiBzaWcKICAgICAgICAgICAgZGF0YXR5cGUgJ2EgbGlzdCA9IG5pbCB8IDo6IG9mICdhICogJ2EgbGlzdDsKICAgICAgICAgICAgdmFsIHJldjogJ2EgbGlzdCAtPiAnYSBsaXN0OwogICAgICAgIGVuZCAgPSBzdHJ1Y3QKICAgICAgICAgICAgb3BlbiBMaXN0OwogICAgICAgICAgICBmdW4gcmV2JyBuaWwgeXMgICAgID0geXMKICAgICAgICAgICAgICB8IHJldicgKHg6OnhzKSB5cyA9IHJldicgeHMgKHg6OnlzKQogICAgICAgICAgICBmdW4gcmV2IHhzID0gcmV2JyB4cyBuaWw7CiAgICAgICAgZW5kOwoKICAgICAgICBzdHJ1Y3R1cmUgTGlzdCA9IHN0cnVjdAogICAgICAgICAgICBleGNlcHRpb24gRW1wdHk7CiAgICAgICAgICAgIG9wZW4gTGlzdDsKCiAgICAgICAgICAgIGZ1biBoZCBuaWwgPSByYWlzZSBFbXB0eQogICAgICAgICAgICAgIHwgaGQgKHg6OnhyKSA9IHg7CgogICAgICAgICAgICBmdW4gdGwgbmlsID0gcmFpc2UgRW1wdHkKICAgICAgICAgICAgICB8IHRsICh4Ojp4cikgPSB4cjsKCiAgICAgICAgICAgIGZ1biBudWxsIG5pbCA9IHRydWUKICAgICAgICAgICAgICB8IG51bGwgKHg6OnhyKSA9IGZhbHNlOwoKICAgICAgICAgICAgZnVuIG1hcCBmIG5pbCA9IG5pbAogICAgICAgICAgICAgIHwgbWFwIGYgKHg6OnhyKSA9IChmIHgpIDo6IChtYXAgZiB4cik7CgogICAgICAgICAgICBpbmZpeHIgNSBAOwogICAgICAgICAgICBmdW4gW10gQCB5cyA9IHlzCiAgICAgICAgICAgICAgfCAoeDo6eHIpIEAgeXMgPSB4IDo6ICh4ciBAIHlzKTsKCiAgICAgICAgICAgIGZ1biBsZW5ndGggbmlsID0gMAogICAgICAgICAgICAgIHwgbGVuZ3RoICh4Ojp4cikgPSAxICsgbGVuZ3RoIHhyOwoKICAgICAgICAgICAgZnVuIGZvbGRyIGYgZSBbXSAgICAgID0gZQogICAgICAgICAgICAgIHwgZm9sZHIgZiBlICh4Ojp4cikgPSBmKHgsIGZvbGRyIGYgZSB4cik7CgogICAgICAgICAgICBmdW4gZm9sZGwgZiBlIFtdICAgICAgPSBlCiAgICAgICAgICAgICAgfCBmb2xkbCBmIGUgKHg6OnhyKSA9IGZvbGRsIGYgKGYoeCwgZSkpIHhyOwoKICAgICAgICAgICAgZnVuIGFwcCAoZjogJ2EgLT4gdW5pdCkgW10gPSAoKQogICAgICAgICAgICAgIHwgYXBwIChmOiAnYSAtPiB1bml0KSAoeDo6eHMpID0gKGYgeDsgYXBwIGYgeHMpOwogICAgICAgIGVuZDsKICAgICAgICBvcGVuIExpc3Q7CiAgICAgICAgaW5maXhyIDUgQDsKCiAgICAgICAgc3RydWN0dXJlIExpc3QgOiBMSVNUID0gc3RydWN0CiAgICAgICAgICAgIG9wZW4gTGlzdDsKCiAgICAgICAgICAgIGZ1biBjb25jYXQgbmlsID0gbmlsCiAgICAgICAgICAgICAgfCBjb25jYXQgKHg6OnhyKSA9IHggQCBjb25jYXQgeHI7CgogICAgICAgICAgICBmdW4gdGFidWxhdGUgKG4sIGYpID0gbGV0CiAgICAgICAgICAgICAgICBmdW4gaCBpID0gaWYgaSA8IG4gdGhlbiBmIGkgOjogaCAoaSArIDEpIGVsc2UgW10KICAgICAgICAgICAgaW4KICAgICAgICAgICAgICAgIGlmIG4gPCAwIHRoZW4gcmFpc2UgU2l6ZSBlbHNlIGggMAogICAgICAgICAgICBlbmQ7CgogICAgICAgICAgICBmdW4gZXhpc3RzIHAgW10gICAgICA9IGZhbHNlCiAgICAgICAgICAgICAgfCBleGlzdHMgcCAoeDo6eHIpID0gcCB4IG9yZWxzZSBleGlzdHMgcCB4cjsKCiAgICAgICAgICAgIGZ1biBhbGwgcCBbXSAgICAgID0gdHJ1ZQogICAgICAgICAgICAgIHwgYWxsIHAgKHg6OnhyKSA9IHAgeCBhbmRhbHNvIGFsbCBwIHhyOwoKICAgICAgICAgICAgZnVuIGZpbHRlciBwIFtdICAgICAgPSBbXQogICAgICAgICAgICAgIHwgZmlsdGVyIHAgKHg6OnhyKSA9IGlmIHAgeCB0aGVuIHggOjogZmlsdGVyIHAgeHIgZWxzZSBmaWx0ZXIgcCB4cjsKCiAgICAgICAgICAgIGZ1biBjb2xsYXRlIChjb21wYXJlIDogJ2EgKiAnYSAtPiBvcmRlcikgcCA9IGNhc2UgcCBvZgogICAgICAgICAgICAgICAgKG5pbCwgXzo6XykgICAgID0+IExFU1MKICAgICAgICAgICAgICB8IChuaWwsIG5pbCkgICAgICA9PiBFUVVBTAogICAgICAgICAgICAgIHwgKF86Ol8sIG5pbCkgICAgID0+IEdSRUFURVIKICAgICAgICAgICAgICB8ICh4Ojp4ciwgeTo6eXIpICA9PiBjYXNlIGNvbXBhcmUgKHgsIHkpIG9mCiAgICAgICAgICAgICAgICAgICAgIEVRVUFMICA9PiBjb2xsYXRlIGNvbXBhcmUgKHhyLCB5cikKICAgICAgICAgICAgICAgICAgIHwgcyAgICAgID0+IHM7CgogICAgICAgICAgICBmdW4gbnRoIChbXSwgXykgICAgPSByYWlzZSBTdWJzY3JpcHQKICAgICAgICAgICAgICB8IG50aCAoeDo6eHMsIDApID0geAogICAgICAgICAgICAgIHwgbnRoICh4Ojp4cywgbikgPSBudGggKHhzLCBuIC0gMSk7CgogICAgICAgICAgICBmdW4gbGFzdCBbeF0gPSB4CiAgICAgICAgICAgICAgfCBsYXN0ICh4Ojp4cykgPSBsYXN0IHhzCiAgICAgICAgICAgICAgfCBsYXN0IFtdID0gcmFpc2UgRW1wdHk7CgogICAgICAgICAgICBmdW4gZ2V0SXRlbSBbXSA9IE5PTkUKICAgICAgICAgICAgICB8IGdldEl0ZW0geCA9IFNPTUUgKGhkIHgsIHRsIHgpOwoKICAgICAgICAgICAgZnVuIHRha2UgKHgsIDApID0gW10KICAgICAgICAgICAgICB8IHRha2UgKFtdLCBfKSA9IHJhaXNlIFN1YnNjcmlwdAogICAgICAgICAgICAgIHwgdGFrZSAoeDo6eHMsIG4pID0geCA6OiB0YWtlICh4cywgbiAtIDEpOwoKICAgICAgICAgICAgZnVuIGRyb3AgKHgsIDApID0geAogICAgICAgICAgICAgIHwgZHJvcCAoW10sIF8pID0gcmFpc2UgU3Vic2NyaXB0CiAgICAgICAgICAgICAgfCBkcm9wICh4Ojp4cywgbikgPSBkcm9wICh4cywgbiAtIDEpOwoKICAgICAgICAgICAgZnVuIHJldkFwcGVuZCAobDEsIGwyKSA9IChyZXYgbDEpIEAgbDI7CgogICAgICAgICAgICBmdW4gbWFwUGFydGlhbCBmIGwKICAgICAgICAgICAgICAgID0gKChtYXAgdmFsT2YpIG8gKGZpbHRlciBpc1NvbWUpIG8gKG1hcCBmKSkgbDsKCiAgICAgICAgICAgIGZ1biBwZXJtdXRhdGlvbnMgeCA9IGxldAogICAgICAgICAgICAgICAgZnVuIHAyIGEgW10gPSBbIGEgXQogICAgICAgICAgICAgICAgICB8IHAyIGEgW3hdID0gbWFwIChmbiB5ID0+IHg6OnkpICggcDIgW10gYSApCiAgICAgICAgICAgICAgICAgIHwgcDIgYSAoeDo6eHMpID0gKCBtYXAgKCBmbiB5ID0+IHg6OnkgKSAocDIgW10gKGFAeHMpKSkgQCAocDIgKGEgQCBbeF0pIHhzICkKICAgICAgICAgICAgaW4KICAgICAgICAgICAgICAgIHAyIFtdIHgKICAgICAgICAgICAgZW5kOwoKICAgICAgICAgICAgZnVuIGZpbmQgZiBbXSA9IE5PTkUKICAgICAgICAgICAgICB8IGZpbmQgZiAoeDo6eHMpID0gaWYgZiB4IHRoZW4gU09NRSB4IGVsc2UgZmluZCBmIHhzOwoKICAgICAgICAgICAgZnVuIHBhcnRpdGlvbiBmIFtdID0gKFtdLCBbXSkKICAgICAgICAgICAgICB8IHBhcnRpdGlvbiBmICh4Ojp4cykgPSBsZXQKICAgICAgICAgICAgICAgIHZhbCB0bXAgPSBwYXJ0aXRpb24gZiB4cwogICAgICAgICAgICBpbgogICAgICAgICAgICAgICAgaWYgZiB4IHRoZW4gKHggOjogIzEgdG1wLCAjMiB0bXApCiAgICAgICAgICAgICAgICBlbHNlICgjMSB0bXAsIHggOjogIzIgdG1wKQogICAgICAgICAgICBlbmQ7CiAgICAgICAgZW5kOwogICAgYCxyZXF1aXJlczpbIk9wdGlvbiJdfX0sMjQ1OihmZSx1KT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh1LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx1LkxJU1RTT1JUX0xJQj12b2lkIDAsdS5MSVNUU09SVF9MSUI9e25hdGl2ZTp2b2lkIDAsY29kZTpgc3RydWN0dXJlIExpc3Rzb3J0IDogc2lnCiAgICAgICAgICAgIHZhbCBzb3J0OiAoJ2EgKiAnYSAtPiBvcmRlcikgLT4gJ2EgbGlzdCAtPiAnYSBsaXN0OwogICAgICAgICAgICB2YWwgc29ydGVkOiAoJ2EgKiAnYSAtPiBvcmRlcikgLT4gJ2EgbGlzdCAtPiBib29sOwogICAgICAgICAgICB2YWwgbWVyZ2VVbmlxOiAoJ2EgKiAnYSAtPiBvcmRlcikgLT4gJ2EgbGlzdCAqICdhIGxpc3QgLT4gJ2EgbGlzdDsKICAgICAgICAgICAgdmFsIG1lcmdlOiAoJ2EgKiAnYSAtPiBvcmRlcikgLT4gJ2EgbGlzdCAqICdhIGxpc3QgLT4gJ2EgbGlzdDsKICAgICAgICAgICAgdmFsIGVxY2xhc3NlczogKCdhICogJ2EgLT4gb3JkZXIpIC0+ICdhIGxpc3QgLT4gJ2EgbGlzdCBsaXN0OwogICAgICAgIGVuZCA9IHN0cnVjdAogICAgICAgICAgZnVuIHRha2Ugb3JkciB4MSB4ciBbXSAgICAgICA9IHgxIDo6IHhyCiAgICAgICAgICAgIHwgdGFrZSBvcmRyIHgxIHhyICh5MTo6eXIpID0gKGNhc2Ugb3Jkcih4MSwgeTEpIG9mCiAgICAgICAgICAgICAgICBMRVNTICAgID0+IHgxIDo6IHRha2Ugb3JkciB5MSB5ciB4cgogICAgICAgICAgICAgIHwgXyAgICAgICA9PiB5MSA6OiB0YWtlIG9yZHIgeDEgeHIgeXIpOwoKICAgICAgICAgIGZ1biB0YWtlVW5pcSBvcmRyIHgxIHhyIFtdICAgICAgID0geDEgOjogeHIKICAgICAgICAgICAgfCB0YWtlVW5pcSBvcmRyIHgxIHhyICh5MTo6eXIpID0gKGNhc2Ugb3Jkcih4MSwgeTEpIG9mCiAgICAgICAgICAgICAgICBMRVNTICAgID0+IHgxIDo6IHRha2VVbmlxIG9yZHIgeTEgeXIgeHIKICAgICAgICAgICAgICB8IEdSRUFURVIgPT4geTEgOjogdGFrZVVuaXEgb3JkciB4MSB4ciB5cgogICAgICAgICAgICAgIHwgRVFVQUwgICA9PiB0YWtlVW5pcSBvcmRyIHgxIHhyIHlyKTsKCiAgICAgICAgICBmdW4gbWVyZ2Ugb3JkciAoW10sICAgICB5cykgPSB5cwogICAgICAgICAgICB8IG1lcmdlIG9yZHIgKHgxOjp4ciwgeXMpID0gdGFrZSBvcmRyIHgxIHhyIHlzOwoKICAgICAgICAgIGZ1biBtZXJnZVVuaXEgb3JkciAoW10sICAgICB5cykgPSB5cwogICAgICAgICAgICB8IG1lcmdlVW5pcSBvcmRyICh4MTo6eHIsIHlzKSA9IHRha2VVbmlxIG9yZHIgeDEgeHIgeXM7CgogICAgICAgICAgZnVuIG1lcmdlcGFpcnMgb3JkciBsMSAgW10gayAgICAgICAgICAgICAgPSBbbDFdCiAgICAgICAgICAgIHwgbWVyZ2VwYWlycyBvcmRyIGwxIChsMjo6bHIpIGsgPQogICAgICAgICAgICAgIGlmIGsgbW9kIDIgPSAxIHRoZW4gbDE6OmwyOjpscgogICAgICAgICAgICAgIGVsc2UgbWVyZ2VwYWlycyBvcmRyIChtZXJnZSBvcmRyIChsMSwgbDIpKSBsciAoayBkaXYgMik7CgogICAgICAgICAgZnVuIG5leHRydW4gb3JkciBydW4gW10gICAgICA9IChydW4sIFtdKQogICAgICAgICAgICB8IG5leHRydW4gb3JkciBydW4gKHg6OnhyKSA9CiAgICAgICAgICAgICAgaWYgb3Jkcih4LCBMaXN0LmhkIHJ1bikgPSBMRVNTIHRoZW4gKHJ1biwgeDo6eHIpCiAgICAgICAgICAgICAgZWxzZSBuZXh0cnVuIG9yZHIgKHg6OnJ1bikgeHI7CgogICAgICAgICAgZnVuIHNvcnRpbmcgb3JkciBbXSAgICAgIGxzIHIgPSBMaXN0LmhkKG1lcmdlcGFpcnMgb3JkciBbXSBscyAwKQogICAgICAgICAgICB8IHNvcnRpbmcgb3JkciAoeDo6eHMpIGxzIHIgPSBsZXQKICAgICAgICAgICAgICAgIHZhbCAocmV2cnVuLCB0YWlsKSA9IG5leHRydW4gb3JkciBbeF0geHMKICAgICAgICAgICAgICBpbgogICAgICAgICAgICAgICAgc29ydGluZyBvcmRyIHRhaWwgKG1lcmdlcGFpcnMgb3JkciAoTGlzdC5yZXYgcmV2cnVuKSBscyAocisxKSkgKHIrMSkKICAgICAgICAgICAgICBlbmQ7CgogICAgICAgICAgZnVuIGdyb3VwIG9yZHIgbGFzdCByZXN0IGNzMSBjc3MgPSBjYXNlIHJlc3Qgb2YKICAgICAgICAgICAgICBbXSAgICAgPT4gY3MxIDo6IGNzcwogICAgICAgICAgICB8IHIxOjpyciA9PiBpZiBvcmRyKHIxLCBsYXN0KSA9IEVRVUFMIHRoZW4gZ3JvdXAgb3JkciByMSByciAocjEgOjogY3MxKSBjc3MKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBncm91cCBvcmRyIHIxIHJyIFtyMV0gKGNzMSA6OiBjc3MpOwoKICAgICAgICAgIGZ1biBzb3J0IG9yZHIgW10gICAgICAgICAgICAgICA9IFtdCiAgICAgICAgICAgIHwgc29ydCBvcmRyIFt4XSAgICAgICAgICAgICAgPSBbeF0KICAgICAgICAgICAgfCBzb3J0IG9yZHIgW3gxLCB4Ml0gICAgICAgICA9IChjYXNlIG9yZHIoeDEsIHgyKSBvZgogICAgICAgICAgICAgICAgR1JFQVRFUiA9PiBbeDIsIHgxXQogICAgICAgICAgICAgIHwgXyAgICAgICA9PiBbeDEsIHgyXSkKICAgICAgICAgICAgfCBzb3J0IG9yZHIgeHMgPSBzb3J0aW5nIG9yZHIgeHMgW10gMDsKCiAgICAgICAgICBmdW4gc29ydGVkIG9yZHIgW10gICAgICAgICAgID0gdHJ1ZQogICAgICAgICAgICB8IHNvcnRlZCBvcmRyIFt4XSAgICAgICAgICA9IHRydWUKICAgICAgICAgICAgfCBzb3J0ZWQgb3JkciAoeDE6OngyOjp4cikgPQogICAgICAgICAgICAgIG9yZHIoeDEsIHgyKSA8PiBHUkVBVEVSIGFuZGFsc28gc29ydGVkIG9yZHIgKHgyOjp4cik7CgogICAgICAgICAgZnVuIGVxY2xhc3NlcyBvcmRyIHhzID0gbGV0CiAgICAgICAgICAgICAgdmFsIHhzID0gTGlzdC5yZXYgKHNvcnQgb3JkciB4cykKICAgICAgICAgICAgaW4KICAgICAgICAgICAgICBjYXNlIHhzIG9mCiAgICAgICAgICAgICAgICAgIFtdICAgICA9PiBbXQogICAgICAgICAgICAgICAgfCB4MTo6eHIgPT4gZ3JvdXAgb3JkciB4MSB4ciBbeDFdIFtdCiAgICAgICAgICAgICAgZW5kOwogICAgICAgIGVuZDsKICAgICAgICBzdHJ1Y3R1cmUgTGlzdCA9IHN0cnVjdAogICAgICAgICAgICBvcGVuIExpc3Q7CiAgICAgICAgICAgIG9wZW4gTGlzdHNvcnQ7CiAgICAgICAgZW5kO2AscmVxdWlyZXM6WyJMaXN0Il19fSw3OTA6KGZlLHUsSyk9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdS5NQVRIX0xJQj12b2lkIDA7dmFyIG09SygzNjcpLGc9Syg2OTkpLHM9SygxMDYpLHE9Syg3NTgpLEI9SygxOTcpO3UuTUFUSF9MSUI9e25hdGl2ZTpmdW5jdGlvbihNKXt2YXIgVj1uZXcgbS5EeW5hbWljQmFzaXMoe30se30se30se30se30pLEQ9bmV3IG0uU3RhdGljQmFzaXMoe30se30se30se30se30pO3JldHVybiBWLnNldFZhbHVlKCJzcXJ0IixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oInNxcnQiLGZ1bmN0aW9uKGgsQSl7aWYoaCBpbnN0YW5jZW9mIHMuUmVhbCl7dmFyIEk9aC52YWx1ZTtyZXR1cm4gSTwwP1tCLmRvbWFpbkV4Y2VwdGlvbi5jb25zdHJ1Y3QoKSwhMCxbXV06W25ldyBzLlJlYWwoTWF0aC5zcXJ0KEkpKSwhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxELnNldFZhbHVlKCJzcXJ0IixuZXcgZy5GdW5jdGlvblR5cGUoQi5yZWFsVHlwZSxCLnJlYWxUeXBlKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLFYuc2V0VmFsdWUoInNpbiIsbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCJzaW4iLGZ1bmN0aW9uKGgsQSl7aWYoaCBpbnN0YW5jZW9mIHMuUmVhbCl7dmFyIEk9aC52YWx1ZTtyZXR1cm5bbmV3IHMuUmVhbChNYXRoLnNpbihJKSksITEsW11dfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgic2luIixuZXcgZy5GdW5jdGlvblR5cGUoQi5yZWFsVHlwZSxCLnJlYWxUeXBlKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLFYuc2V0VmFsdWUoImNvcyIsbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCJjb3MiLGZ1bmN0aW9uKGgsQSl7aWYoaCBpbnN0YW5jZW9mIHMuUmVhbCl7dmFyIEk9aC52YWx1ZTtyZXR1cm5bbmV3IHMuUmVhbChNYXRoLmNvcyhJKSksITEsW11dfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgiY29zIixuZXcgZy5GdW5jdGlvblR5cGUoQi5yZWFsVHlwZSxCLnJlYWxUeXBlKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLFYuc2V0VmFsdWUoInRhbiIsbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCJ0YW4iLGZ1bmN0aW9uKGgsQSl7aWYoaCBpbnN0YW5jZW9mIHMuUmVhbCl7dmFyIEk9aC52YWx1ZTtyZXR1cm5bbmV3IHMuUmVhbChNYXRoLnRhbihJKSksITEsW11dfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgidGFuIixuZXcgZy5GdW5jdGlvblR5cGUoQi5yZWFsVHlwZSxCLnJlYWxUeXBlKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLFYuc2V0VmFsdWUoImFzaW4iLG5ldyBzLlByZWRlZmluZWRGdW5jdGlvbigiYXNpbiIsZnVuY3Rpb24oaCxBKXtpZihoIGluc3RhbmNlb2Ygcy5SZWFsKXt2YXIgST1oLnZhbHVlO3JldHVybltuZXcgcy5SZWFsKE1hdGguYXNpbihJKSksITEsW11dfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgiYXNpbiIsbmV3IGcuRnVuY3Rpb25UeXBlKEIucmVhbFR5cGUsQi5yZWFsVHlwZSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxWLnNldFZhbHVlKCJhY29zIixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oImFjb3MiLGZ1bmN0aW9uKGgsQSl7aWYoaCBpbnN0YW5jZW9mIHMuUmVhbCl7dmFyIEk9aC52YWx1ZTtyZXR1cm5bbmV3IHMuUmVhbChNYXRoLmFjb3MoSSkpLCExLFtdXX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoInN0ZCB0eXBlIG1pc21hdGNoIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLEQuc2V0VmFsdWUoImFjb3MiLG5ldyBnLkZ1bmN0aW9uVHlwZShCLnJlYWxUeXBlLEIucmVhbFR5cGUpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksVi5zZXRWYWx1ZSgiYXRhbiIsbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCJhdGFuIixmdW5jdGlvbihoLEEpe2lmKGggaW5zdGFuY2VvZiBzLlJlYWwpe3ZhciBJPWgudmFsdWU7cmV0dXJuW25ldyBzLlJlYWwoTWF0aC5hdGFuKEkpKSwhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxELnNldFZhbHVlKCJhdGFuIixuZXcgZy5GdW5jdGlvblR5cGUoQi5yZWFsVHlwZSxCLnJlYWxUeXBlKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLFYuc2V0VmFsdWUoImF0YW4yIixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oImF0YW4yIixmdW5jdGlvbihoLEEpe2lmKGggaW5zdGFuY2VvZiBzLlJlY29yZFZhbHVlKXt2YXIgST1oLmdldFZhbHVlKCIxIiksTz1oLmdldFZhbHVlKCIyIik7aWYoSSBpbnN0YW5jZW9mIHMuUmVhbCYmTyBpbnN0YW5jZW9mIHMuUmVhbCl7dmFyIEU9SS52YWx1ZSxyPU8udmFsdWU7cmV0dXJuW25ldyBzLlJlYWwoTWF0aC5hdGFuMihFLHIpKSwhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgiYXRhbjIiLG5ldyBnLkZ1bmN0aW9uVHlwZShuZXcgZy5UdXBsZVR5cGUoW0IucmVhbFR5cGUsQi5yZWFsVHlwZV0pLEIucmVhbFR5cGUpLnNpbXBsaWZ5KCksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxWLnNldFZhbHVlKCJleHAiLG5ldyBzLlByZWRlZmluZWRGdW5jdGlvbigiZXhwIixmdW5jdGlvbihoLEEpe2lmKGggaW5zdGFuY2VvZiBzLlJlYWwpe3ZhciBJPWgudmFsdWU7cmV0dXJuW25ldyBzLlJlYWwoTWF0aC5leHAoSSkpLCExLFtdXX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoInN0ZCB0eXBlIG1pc21hdGNoIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLEQuc2V0VmFsdWUoImV4cCIsbmV3IGcuRnVuY3Rpb25UeXBlKEIucmVhbFR5cGUsQi5yZWFsVHlwZSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxWLnNldFZhbHVlKCJwb3ciLG5ldyBzLlByZWRlZmluZWRGdW5jdGlvbigicG93IixmdW5jdGlvbihoLEEpe2lmKGggaW5zdGFuY2VvZiBzLlJlY29yZFZhbHVlKXt2YXIgST1oLmdldFZhbHVlKCIxIiksTz1oLmdldFZhbHVlKCIyIik7aWYoSSBpbnN0YW5jZW9mIHMuUmVhbCYmTyBpbnN0YW5jZW9mIHMuUmVhbCl7dmFyIEU9SS52YWx1ZSxyPU8udmFsdWU7cmV0dXJuW25ldyBzLlJlYWwoTWF0aC5wb3coRSxyKSksITEsW11dfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoInN0ZCB0eXBlIG1pc21hdGNoIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLEQuc2V0VmFsdWUoInBvdyIsbmV3IGcuRnVuY3Rpb25UeXBlKG5ldyBnLlR1cGxlVHlwZShbQi5yZWFsVHlwZSxCLnJlYWxUeXBlXSksQi5yZWFsVHlwZSkuc2ltcGxpZnkoKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLFYuc2V0VmFsdWUoImxuIixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oImxuIixmdW5jdGlvbihoLEEpe2lmKGggaW5zdGFuY2VvZiBzLlJlYWwpe3ZhciBJPWgudmFsdWU7cmV0dXJuW25ldyBzLlJlYWwoTWF0aC5sb2coSSkpLCExLFtdXX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoInN0ZCB0eXBlIG1pc21hdGNoIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLEQuc2V0VmFsdWUoImxuIixuZXcgZy5GdW5jdGlvblR5cGUoQi5yZWFsVHlwZSxCLnJlYWxUeXBlKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLFYuc2V0VmFsdWUoImxvZzEwIixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oImxvZzEwIixmdW5jdGlvbihoLEEpe2lmKGggaW5zdGFuY2VvZiBzLlJlYWwpe3ZhciBJPWgudmFsdWU7cmV0dXJuW25ldyBzLlJlYWwoTWF0aC5sb2cxMChJKSksITEsW11dfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgibG9nMTAiLG5ldyBnLkZ1bmN0aW9uVHlwZShCLnJlYWxUeXBlLEIucmVhbFR5cGUpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksVi5zZXRWYWx1ZSgic2luaCIsbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCJzaW5oIixmdW5jdGlvbihoLEEpe2lmKGggaW5zdGFuY2VvZiBzLlJlYWwpe3ZhciBJPWgudmFsdWU7cmV0dXJuW25ldyBzLlJlYWwoTWF0aC5zaW5oKEkpKSwhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxELnNldFZhbHVlKCJzaW5oIixuZXcgZy5GdW5jdGlvblR5cGUoQi5yZWFsVHlwZSxCLnJlYWxUeXBlKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLFYuc2V0VmFsdWUoImNvc2giLG5ldyBzLlByZWRlZmluZWRGdW5jdGlvbigiY29zaCIsZnVuY3Rpb24oaCxBKXtpZihoIGluc3RhbmNlb2Ygcy5SZWFsKXt2YXIgST1oLnZhbHVlO3JldHVybltuZXcgcy5SZWFsKE1hdGguY29zaChJKSksITEsW11dfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgiY29zaCIsbmV3IGcuRnVuY3Rpb25UeXBlKEIucmVhbFR5cGUsQi5yZWFsVHlwZSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxWLnNldFZhbHVlKCJ0YW5oIixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oInRhbmgiLGZ1bmN0aW9uKGgsQSl7aWYoaCBpbnN0YW5jZW9mIHMuUmVhbCl7dmFyIEk9aC52YWx1ZTtyZXR1cm5bbmV3IHMuUmVhbChNYXRoLnRhbmgoSSkpLCExLFtdXX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoInN0ZCB0eXBlIG1pc21hdGNoIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLEQuc2V0VmFsdWUoInRhbmgiLG5ldyBnLkZ1bmN0aW9uVHlwZShCLnJlYWxUeXBlLEIucmVhbFR5cGUpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksVi5zZXRWYWx1ZSgicGkiLG5ldyBzLlJlYWwoMy4xNDE1OTI2NTM1OSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxELnNldFZhbHVlKCJwaSIsQi5yZWFsVHlwZSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLFYuc2V0VmFsdWUoImUiLG5ldyBzLlJlYWwoMi43MTgyODE4Mjg0NiksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxELnNldFZhbHVlKCJlIixCLnJlYWxUeXBlLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksTS5zZXREeW5hbWljU3RydWN0dXJlKCJNYXRoIixWKSxNLnNldFN0YXRpY1N0cnVjdHVyZSgiTWF0aCIsRCksTX0sY29kZTpgc2lnbmF0dXJlIE1BVEggPSBzaWcKICAgICAgICAoKiB0eXBlIHJlYWwgKikKICAgICAgICB2YWwgcGkgOiByZWFsCiAgICAgICAgdmFsIGUgOiByZWFsCiAgICAgICAgdmFsIHNxcnQgOiByZWFsIC0+IHJlYWwKICAgICAgICB2YWwgc2luIDogcmVhbCAtPiByZWFsCiAgICAgICAgdmFsIGNvcyA6IHJlYWwgLT4gcmVhbAogICAgICAgIHZhbCB0YW4gOiByZWFsIC0+IHJlYWwKICAgICAgICB2YWwgYXNpbiA6IHJlYWwgLT4gcmVhbAogICAgICAgIHZhbCBhY29zIDogcmVhbCAtPiByZWFsCiAgICAgICAgdmFsIGF0YW4gOiByZWFsIC0+IHJlYWwKICAgICAgICB2YWwgYXRhbjIgOiByZWFsICogcmVhbCAtPiByZWFsCiAgICAgICAgdmFsIGV4cCA6IHJlYWwgLT4gcmVhbAogICAgICAgIHZhbCBwb3cgOiByZWFsICogcmVhbCAtPiByZWFsCiAgICAgICAgdmFsIGxuICAgIDogcmVhbCAtPiByZWFsCiAgICAgICAgdmFsIGxvZzEwIDogcmVhbCAtPiByZWFsCiAgICAgICAgdmFsIHNpbmggOiByZWFsIC0+IHJlYWwKICAgICAgICB2YWwgY29zaCA6IHJlYWwgLT4gcmVhbAogICAgICAgIHZhbCB0YW5oIDogcmVhbCAtPiByZWFsCiAgICBlbmQ7CgogICAgc3RydWN0dXJlIE1hdGggOj4gTUFUSCA9IHN0cnVjdAogICAgICAgIG9wZW4gTWF0aDsKICAgIGVuZDtgLHJlcXVpcmVzOnZvaWQgMH19LDc0MjooZmUsdSxLKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh1LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx1LlJBTkRPTV9MSUI9dm9pZCAwO3ZhciBtPUsoMzY3KSxnPUsoNjk5KSxzPUsoMTA2KSxxPUsoMTk3KTt1LlJBTkRPTV9MSUI9e25hdGl2ZTpmdW5jdGlvbihCKXt2YXIgTT1uZXcgbS5EeW5hbWljQmFzaXMoe30se30se30se30se30pLFY9bmV3IG0uU3RhdGljQmFzaXMoe30se30se30se30se30pO3JldHVybiBNLnNldFZhbHVlKCJkYXRlIixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oInRvU3RyaW5nIixmdW5jdGlvbihELGgpe3JldHVybltuZXcgcy5JbnRlZ2VyKG5ldyBEYXRlKCkuZ2V0TWlsbGlzZWNvbmRzKCkrbmV3IERhdGUoKS5nZXRTZWNvbmRzKCkpLCExLFtdXX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksVi5zZXRWYWx1ZSgiZGF0ZSIsbmV3IGcuRnVuY3Rpb25UeXBlKG5ldyBnLlR1cGxlVHlwZShbXSkuc2ltcGxpZnkoKSxxLmludFR5cGUpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksQi5zZXREeW5hbWljU3RydWN0dXJlKCJSYW5kb20iLE0pLEIuc2V0U3RhdGljU3RydWN0dXJlKCJSYW5kb20iLFYpLEJ9LGNvZGU6YHNpZ25hdHVyZSBSQU5ET00gPSBzaWcKICAgICAgICB0eXBlIHJhbmQ7CgogICAgICAgIHZhbCByYW5kU2VlZDogcmVhbCAtPiByYW5kOwogICAgICAgIHZhbCByYW5kOiB1bml0IC0+IHJhbmQ7CiAgICAgICAgKCogdmFsIHRvU3RyaW5nIDogcmFuZCAtPiBzdHJpbmc7ICopCiAgICAgICAgKCogdmFsIGZyb21TdHJpbmcgOiBzdHJpbmcgLT4gcmFuZDsgKikKCiAgICAgICAgdmFsIHJhbmRSZWFsOiByYW5kIC0+IHJlYWw7CiAgICAgICAgdmFsIHJhbmRSZWFsTGlzdDogaW50ICogcmFuZCAtPiByZWFsIGxpc3Q7CiAgICAgICAgdmFsIHJhbmRSYW5nZTogaW50ICogaW50IC0+IHJhbmQgLT4gaW50OwogICAgICAgIHZhbCByYW5kUmFuZ2VMaXN0OiBpbnQgKiBpbnQgLT4gaW50ICogcmFuZCAtPiBpbnQgbGlzdDsKICAgIGVuZDsKCiAgICBzdHJ1Y3R1cmUgUmFuZG9tIDo+IFJBTkRPTSA9IHN0cnVjdAogICAgICAgICgqIG1vc21sIHJhbmRvbSAqKQogICAgICAgIG9wZW4gUmFuZG9tOwoKICAgICAgICB0eXBlIHJhbmQgPSB7c2VlZHJlZiA6IHJlYWwgcmVmfTsKCiAgICAgICAgdmFsIGEgPSAxNjgwNy4wOwogICAgICAgIHZhbCBtID0gMjE0NzQ4MzY0Ny4wOwoKICAgICAgICBmdW4gbmV4dHJhbmQgc2VlZCA9IGxldAogICAgICAgICAgICB2YWwgdCA9IGEqc2VlZAogICAgICAgIGluCiAgICAgICAgICAgIHQgLSBtICogUmVhbC5mcm9tSW50KFJlYWwuZmxvb3IodC9tKSkKICAgICAgICBlbmQ7CgogICAgICAgIGZ1biByYW5kU2VlZCBzZWVkID0gaWYKICAgICAgICAgICAgc2VlZCA+IDAuMCBvcmVsc2Ugc2VlZCA8IDAuMAogICAgICAgIHRoZW4KICAgICAgICAgICAge3NlZWRyZWYgPSByZWYgKG5leHRyYW5kIHNlZWQpfQogICAgICAgIGVsc2UKICAgICAgICAgICAgcmFpc2UgRmFpbCAiUmFuZG9tLnJhbmRTZWVkOiBiYWQgc2VlZCAwLjAiOwoKICAgICAgICAoKiBmdW4gdG9TdHJpbmcge3NlZWRyZWZ9ID0gSW50LnRvU3RyaW5nIChSZWFsLnJvdW5kICghc2VlZHJlZikpOyAqKQogICAgICAgICgqIGZ1biBmcm9tU3RyaW5nIHMgPSBjYXNlIEludC5mcm9tU3RyaW5nIHMgb2YKICAgICAgICAgICAgTk9ORSA9PiByYWlzZSBGYWlsICJSYW5kb20uZnJvbVN0cmluZzogZ2l2ZW4gc3RyaW5nIGlzIGludmFsaWQiCiAgICAgICAgICAgIHwgU09NRSAwID0+IHJhaXNlIEZhaWwgIlJhbmRvbS5mcm9tU3RyaW5nOiBnaXZlbiBzdHJpbmcgaXMgaW52YWxpZCIKICAgICAgICAgICAgfCBTT01FIHggPT4ge3NlZWRyZWYgPSByZWYgKFJlYWwuZnJvbUludCB4KX07ICopCgogICAgICAgIGZ1biByYW5kICgpID0gcmFuZFNlZWQgKFJlYWwuZnJvbUludCAoZGF0ZSAoKSkpOwoKICAgICAgICBmdW4gcmFuZFJlYWwge3NlZWRyZWZ9ID0gKHNlZWRyZWYgOj0gbmV4dHJhbmQgKCFzZWVkcmVmKTsgIXNlZWRyZWYgLyBtKTsKCiAgICAgICAgZnVuIHJhbmRSZWFsTGlzdCAobiwge3NlZWRyZWZ9KSA9IGxldAogICAgICAgICAgICBmdW4gaCAwIHNlZWQgcmVzID0gKHNlZWRyZWYgOj0gc2VlZDsgcmVzKQogICAgICAgICAgICAgIHwgaCBpIHNlZWQgcmVzID0gaCAoaS0xKSAobmV4dHJhbmQgc2VlZCkgKHNlZWQgLyBtIDo6IHJlcykKICAgICAgICBpbgogICAgICAgICAgICBoIG4gKCFzZWVkcmVmKSBbXQogICAgICAgIGVuZDsKCiAgICAgICAgZnVuIHJhbmRSYW5nZSAobWluLCBtYXgpID0gaWYgbWluID49IG1heCB0aGVuIHJhaXNlIEZhaWwgIlJhbmRvbS5yYW5kUmFuZ2U6IGVtcHR5IHJhbmdlIiBlbHNlIGxldAogICAgICAgICAgICB2YWwgc2NhbGUgPSAoUmVhbC5mcm9tSW50IG1heCAtIFJlYWwuZnJvbUludCBtaW4pIC8gbQogICAgICAgIGluCiAgICAgICAgICAgIGZuIHtzZWVkcmVmfSA9PgogICAgICAgICAgICAgICAgKHNlZWRyZWYgOj0gbmV4dHJhbmQgKCFzZWVkcmVmKTsgUmVhbC5mbG9vcihSZWFsLmZyb21JbnQgbWluICsgc2NhbGUgKiAoIXNlZWRyZWYpKSkKICAgICAgICBlbmQ7CgogICAgICAgIGZ1biByYW5kUmFuZ2VMaXN0IChtaW4sIG1heCkgPSBpZiBtaW4gPj0gbWF4IHRoZW4gcmFpc2UgRmFpbCAiUmFuZG9tLnJhbmRSYW5nZUxpc3Q6IGVtcHR5IHJhbmdlIgogICAgICAgIGVsc2UgbGV0CiAgICAgICAgICAgIHZhbCBzY2FsZSA9IChSZWFsLmZyb21JbnQgbWF4IC0gUmVhbC5mcm9tSW50IG1pbikgLyBtCiAgICAgICAgaW4KICAgICAgICAgICAgZm4gKG4sIHtzZWVkcmVmfSkgPT4gbGV0CiAgICAgICAgICAgICAgICBmdW4gaCAwIHNlZWQgcmVzID0gKHNlZWRyZWYgOj0gc2VlZDsgcmVzKQogICAgICAgICAgICAgICAgICB8IGggaSBzZWVkIHJlcyA9IGggKGktMSkgKG5leHRyYW5kIHNlZWQpCiAgICAgICAgICAgICAgICAgICAgKFJlYWwuZmxvb3IoUmVhbC5mcm9tSW50IG1pbiArIHNjYWxlICogc2VlZCkgOjogcmVzKQogICAgICAgICAgICBpbgogICAgICAgICAgICAgICAgaCBuICghc2VlZHJlZikgW10KICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kOwogICAgZW5kO2AscmVxdWlyZXM6WyJSZWFsIl19fSw5Mjg6KGZlLHUsSyk9PntPYmplY3QuZGVmaW5lUHJvcGVydHkodSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdS5SRUFMX0xJQj12b2lkIDA7dmFyIG09SygzNjcpLGc9Syg2OTkpLHM9SygxMDYpLHE9Syg3NTgpLEI9SygxOTcpO3UuUkVBTF9MSUI9e25hdGl2ZTpmdW5jdGlvbihNKXt2YXIgVj1uZXcgbS5EeW5hbWljQmFzaXMoe30se30se30se30se30pLEQ9bmV3IG0uU3RhdGljQmFzaXMoe30se30se30se30se30pO3JldHVybiBWLnNldFZhbHVlKCJmcm9tSW50IixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oImZyb21JbnQiLGZ1bmN0aW9uKGgsQSl7aWYoaCBpbnN0YW5jZW9mIHMuSW50ZWdlcil7dmFyIEk9aC52YWx1ZTtyZXR1cm5bbmV3IHMuUmVhbChJKSwhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxELnNldFZhbHVlKCJmcm9tSW50IixuZXcgZy5GdW5jdGlvblR5cGUoQi5pbnRUeXBlLEIucmVhbFR5cGUpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksVi5zZXRWYWx1ZSgicm91bmQiLG5ldyBzLlByZWRlZmluZWRGdW5jdGlvbigicm91bmQiLGZ1bmN0aW9uKGgsQSl7aWYoaCBpbnN0YW5jZW9mIHMuUmVhbCl7dmFyIEk9aC52YWx1ZSxPPW5ldyBzLkludGVnZXIoTWF0aC5yb3VuZChJKSk7cmV0dXJuIE8uaGFzT3ZlcmZsb3coKT9bQi5vdmVyZmxvd0V4Y2VwdGlvbi5jb25zdHJ1Y3QoKSwhMCxbXV06W08sITEsW11dfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgicm91bmQiLG5ldyBnLkZ1bmN0aW9uVHlwZShCLnJlYWxUeXBlLEIuaW50VHlwZSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxWLnNldFZhbHVlKCJmbG9vciIsbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCJmbG9vciIsZnVuY3Rpb24oaCxBKXtpZihoIGluc3RhbmNlb2Ygcy5SZWFsKXt2YXIgST1oLnZhbHVlLE89bmV3IHMuSW50ZWdlcihNYXRoLmZsb29yKEkpKTtyZXR1cm4gTy5oYXNPdmVyZmxvdygpP1tCLm92ZXJmbG93RXhjZXB0aW9uLmNvbnN0cnVjdCgpLCEwLFtdXTpbTywhMSxbXV19dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxELnNldFZhbHVlKCJmbG9vciIsbmV3IGcuRnVuY3Rpb25UeXBlKEIucmVhbFR5cGUsQi5pbnRUeXBlKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLFYuc2V0VmFsdWUoImNlaWwiLG5ldyBzLlByZWRlZmluZWRGdW5jdGlvbigiY2VpbCIsZnVuY3Rpb24oaCxBKXtpZihoIGluc3RhbmNlb2Ygcy5SZWFsKXt2YXIgST1oLnZhbHVlLE89bmV3IHMuSW50ZWdlcihNYXRoLmNlaWwoSSkpO3JldHVybiBPLmhhc092ZXJmbG93KCk/W0Iub3ZlcmZsb3dFeGNlcHRpb24uY29uc3RydWN0KCksITAsW11dOltPLCExLFtdXX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoInN0ZCB0eXBlIG1pc21hdGNoIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLEQuc2V0VmFsdWUoImNlaWwiLG5ldyBnLkZ1bmN0aW9uVHlwZShCLnJlYWxUeXBlLEIuaW50VHlwZSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxWLnNldFZhbHVlKCJ0b1N0cmluZyIsbmV3IHMuUHJlZGVmaW5lZEZ1bmN0aW9uKCJ0b1N0cmluZyIsZnVuY3Rpb24oaCxBKXtpZihoIGluc3RhbmNlb2Ygcy5SZWFsKXJldHVybltuZXcgcy5TdHJpbmdWYWx1ZShoLnRvU3RyaW5nKHZvaWQgMCkpLCExLFtdXTt0aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoInN0ZCB0eXBlIG1pc21hdGNoIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLEQuc2V0VmFsdWUoInRvU3RyaW5nIixuZXcgZy5GdW5jdGlvblR5cGUoQi5yZWFsVHlwZSxCLnN0cmluZ1R5cGUpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksTS5zZXREeW5hbWljU3RydWN0dXJlKCJSZWFsIixWKSxNLnNldFN0YXRpY1N0cnVjdHVyZSgiUmVhbCIsRCksTX0sY29kZTpgc2lnbmF0dXJlIFJFQUwgPSBzaWcKICAgICAgICAoKiB0eXBlIHJlYWwgKikKCiAgICAgICAgc3RydWN0dXJlIE1hdGggOiBNQVRICgogICAgICAgICgqIHZhbCByYWRpeCA6IGludCAqKQogICAgICAgICgqIHZhbCBwcmVjaXNpb24gOiBpbnQgKikKCiAgICAgICAgKCogdmFsIG1heEZpbml0ZSAgICA6IHJlYWwgKikKICAgICAgICAoKiB2YWwgbWluUG9zICAgICAgIDogcmVhbCAqKQogICAgICAgICgqIHZhbCBtaW5Ob3JtYWxQb3MgOiByZWFsICopCgogICAgICAgICgqIHZhbCBwb3NJbmYgOiByZWFsICopCiAgICAgICAgKCogdmFsIG5lZ0luZiA6IHJlYWwgKikKCiAgICAgICAgKCogdmFsICsgOiByZWFsICogcmVhbCAtPiByZWFsICopCiAgICAgICAgKCogdmFsIC0gOiByZWFsICogcmVhbCAtPiByZWFsICopCiAgICAgICAgKCogdmFsICogOiByZWFsICogcmVhbCAtPiByZWFsICopCiAgICAgICAgKCogdmFsIC8gOiByZWFsICogcmVhbCAtPiByZWFsICopCiAgICAgICAgKCogdmFsIHJlbSA6IHJlYWwgKiByZWFsIC0+IHJlYWwgKikKICAgICAgICAoKiB2YWwgKisgOiByZWFsICogcmVhbCAqIHJlYWwgLT4gcmVhbCAqKQogICAgICAgICgqIHZhbCAqLSA6IHJlYWwgKiByZWFsICogcmVhbCAtPiByZWFsICopCiAgICAgICAgKCogdmFsIH4gOiByZWFsIC0+IHJlYWwgKikKICAgICAgICAoKiB2YWwgYWJzIDogcmVhbCAtPiByZWFsICopCgogICAgICAgICgqIHZhbCBtaW4gOiByZWFsICogcmVhbCAtPiByZWFsICopCiAgICAgICAgKCogdmFsIG1heCA6IHJlYWwgKiByZWFsIC0+IHJlYWwgKikKCiAgICAgICAgKCogdmFsIHNpZ24gOiByZWFsIC0+IGludCAqKQogICAgICAgICgqIHZhbCBzaWduQml0IDogcmVhbCAtPiBib29sICopCiAgICAgICAgKCogdmFsIHNhbWVTaWduIDogcmVhbCAqIHJlYWwgLT4gYm9vbCAqKQogICAgICAgICgqIHZhbCBjb3B5U2lnbiA6IHJlYWwgKiByZWFsIC0+IHJlYWwgKikKCiAgICAgICAgdmFsIGNvbXBhcmUgICAgIDogcmVhbCAqIHJlYWwgLT4gb3JkZXIKICAgICAgICAoKiB2YWwgY29tcGFyZVJlYWwgOiByZWFsICogcmVhbCAtPiBJRUVFUmVhbC5yZWFsX29yZGVyICopCiAgICAgICAgKCogdmFsIDwgIDogcmVhbCAqIHJlYWwgLT4gYm9vbCAqKQogICAgICAgICgqIHZhbCA8PSA6IHJlYWwgKiByZWFsIC0+IGJvb2wgKikKICAgICAgICAoKiB2YWwgPiAgOiByZWFsICogcmVhbCAtPiBib29sICopCiAgICAgICAgKCogdmFsID49IDogcmVhbCAqIHJlYWwgLT4gYm9vbCAqKQogICAgICAgICgqIHZhbCA9PSA6IHJlYWwgKiByZWFsIC0+IGJvb2wgKikKICAgICAgICAoKiB2YWwgIT0gOiByZWFsICogcmVhbCAtPiBib29sICopCiAgICAgICAgKCogdmFsID89IDogcmVhbCAqIHJlYWwgLT4gYm9vbCAqKQogICAgICAgICgqIHZhbCB1bm9yZGVyZWQgOiByZWFsICogcmVhbCAtPiBib29sICopCgogICAgICAgICgqIHZhbCBpc0Zpbml0ZSA6IHJlYWwgLT4gYm9vbCAqKQogICAgICAgICgqIHZhbCBpc05hbiA6IHJlYWwgLT4gYm9vbCAqKQogICAgICAgICgqIHZhbCBpc05vcm1hbCA6IHJlYWwgLT4gYm9vbCAqKQogICAgICAgICgqIHZhbCBjbGFzcyA6IHJlYWwgLT4gSUVFRVJlYWwuZmxvYXRfY2xhc3MgKikKCiAgICAgICAgKCogdmFsIHRvTWFuRXhwIDogcmVhbCAtPiB7bWFuIDogcmVhbCwgZXhwIDogaW50fSAqKQogICAgICAgICgqIHZhbCBmcm9tTWFuRXhwIDoge21hbiA6IHJlYWwsIGV4cCA6IGludH0gLT4gcmVhbCAqKQogICAgICAgICgqIHZhbCBzcGxpdCAgIDogcmVhbCAtPiB7d2hvbGUgOiByZWFsLCBmcmFjIDogcmVhbH0gKikKICAgICAgICAoKiB2YWwgcmVhbE1vZCA6IHJlYWwgLT4gcmVhbCAqKQoKICAgICAgICAoKiB2YWwgbmV4dEFmdGVyIDogcmVhbCAqIHJlYWwgLT4gcmVhbCAqKQogICAgICAgICgqIHZhbCBjaGVja0Zsb2F0IDogcmVhbCAtPiByZWFsICopCgogICAgICAgICgqIHZhbCByZWFsRmxvb3IgOiByZWFsIC0+IHJlYWwgKikKICAgICAgICAoKiB2YWwgcmVhbENlaWwgIDogcmVhbCAtPiByZWFsICopCiAgICAgICAgKCogdmFsIHJlYWxUcnVuYyA6IHJlYWwgLT4gcmVhbCAqKQogICAgICAgICgqIHZhbCByZWFsUm91bmQgOiByZWFsIC0+IHJlYWwgKikKICAgICAgICB2YWwgZmxvb3IgOiByZWFsIC0+IGludAogICAgICAgIHZhbCBjZWlsICA6IHJlYWwgLT4gaW50CiAgICAgICAgKCogdmFsIHRydW5jIDogcmVhbCAtPiBpbnQgKikKICAgICAgICB2YWwgcm91bmQgOiByZWFsIC0+IGludAogICAgICAgICgqIHZhbCB0b0ludCAgICAgIDogSUVFRVJlYWwucm91bmRpbmdfbW9kZSAtPiByZWFsIC0+IGludCAqKQogICAgICAgICgqIHZhbCB0b0xhcmdlSW50IDogSUVFRVJlYWwucm91bmRpbmdfbW9kZSAtPiByZWFsIC0+IExhcmdlSW50LmludCAqKQogICAgICAgIHZhbCBmcm9tSW50ICAgICAgOiBpbnQgLT4gcmVhbAogICAgICAgICgqIHZhbCBmcm9tTGFyZ2VJbnQgOiBMYXJnZUludC5pbnQgLT4gcmVhbCAqKQogICAgICAgICgqIHZhbCB0b0xhcmdlICAgOiByZWFsIC0+IExhcmdlUmVhbC5yZWFsICopCiAgICAgICAgKCogdmFsIGZyb21MYXJnZSA6IElFRUVSZWFsLnJvdW5kaW5nX21vZGUgLT4gTGFyZ2VSZWFsLnJlYWwgLT4gcmVhbCAqKQoKICAgICAgICAoKiB2YWwgZm10ICAgICAgOiBTdHJpbmdDdnQucmVhbGZtdCAtPiByZWFsIC0+IHN0cmluZyAqKQogICAgICAgIHZhbCB0b1N0cmluZyA6IHJlYWwgLT4gc3RyaW5nCiAgICAgICAgKCogdmFsIHNjYW4gICAgICAgOiAoY2hhciwgJ2EpIFN0cmluZ0N2dC5yZWFkZXIgLT4gKHJlYWwsICdhKSBTdHJpbmdDdnQucmVhZGVyICopCiAgICAgICAgKCogdmFsIGZyb21TdHJpbmcgOiBzdHJpbmcgLT4gcmVhbCBvcHRpb24gKikKCiAgICAgICAgKCogdmFsIHRvRGVjaW1hbCAgIDogcmVhbCAtPiBJRUVFUmVhbC5kZWNpbWFsX2FwcHJveCAqKQogICAgICAgICgqIHZhbCBmcm9tRGVjaW1hbCA6IElFRUVSZWFsLmRlY2ltYWxfYXBwcm94IC0+IHJlYWwgb3B0aW9uICopCiAgICBlbmQ7CgogICAgc3RydWN0dXJlIFJlYWwgPSBzdHJ1Y3QKICAgICAgICBvcGVuIFJlYWw7CiAgICAgICAgc3RydWN0dXJlIE1hdGggOiBNQVRIID0gc3RydWN0CiAgICAgICAgICAgIG9wZW4gTWF0aDsKICAgICAgICBlbmQKICAgICAgICBmdW4gY29tcGFyZSAoeCwgeTogcmVhbCkgPSBpZiB4IDwgeSB0aGVuIExFU1MgZWxzZSBpZiB4ID4geSB0aGVuIEdSRUFURVIgZWxzZSBFUVVBTDsKICAgIGVuZDsKCiAgICBzdHJ1Y3R1cmUgTGFyZ2VSZWFsIDo+IFJFQUwgPSBzdHJ1Y3QKICAgICAgICBvcGVuIFJlYWw7CiAgICBlbmQ7CiAgICBzdHJ1Y3R1cmUgUmVhbCA6PiBSRUFMID0gc3RydWN0CiAgICAgICAgb3BlbiBSZWFsOwogICAgZW5kOwoKICAgIHZhbCBjZWlsICA9IFJlYWwuY2VpbDsKICAgIHZhbCBmbG9vciA9IFJlYWwuZmxvb3I7CiAgICB2YWwgcm91bmQgPSBSZWFsLnJvdW5kOwogICAgKCogdmFsIHRydW5jID0gUmVhbC50cnVuYzsgKikKICAgIHZhbCByZWFsID0gUmVhbC5mcm9tSW50OwogICAgYCxyZXF1aXJlczpbIk1hdGgiXX19LDQ2MDooZmUsdSxLKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh1LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx1LlNUUklOR19MSUI9dm9pZCAwO3ZhciBtPUsoMzY3KSxnPUsoNjk5KTt1LlNUUklOR19MSUI9e25hdGl2ZTpmdW5jdGlvbihzKXt2YXIgcT1uZXcgbS5EeW5hbWljQmFzaXMoe30se30se30se30se30pLEI9bmV3IG0uU3RhdGljQmFzaXMoe30se30se30se30se30pO3JldHVybiBCLnNldFR5cGUoInN0cmluZyIsbmV3IGcuQ3VzdG9tVHlwZSgic3RyaW5nIixbXSksW10sMCwhMCkscS5zZXRUeXBlKCJzdHJpbmciLFtdKSxCLnNldFR5cGUoImNoYXIiLG5ldyBnLkN1c3RvbVR5cGUoImNoYXIiLFtdKSxbXSwwLCEwKSxxLnNldFR5cGUoImNoYXIiLFtdKSxzLnNldER5bmFtaWNTdHJ1Y3R1cmUoIlN0cmluZyIscSkscy5zZXRTdGF0aWNTdHJ1Y3R1cmUoIlN0cmluZyIsQiksc30sY29kZTpgc3RydWN0dXJlIFN0cmluZyA6IHNpZwogICAgICAgICAgICBlcXR5cGUgc3RyaW5nCiAgICAgICAgICAgIGVxdHlwZSBjaGFyCiAgICAgICAgICAgIHZhbCBzaXplIDogc3RyaW5nIC0+IGludAogICAgICAgICAgICB2YWwgc3ViIDogc3RyaW5nICogaW50IC0+IGNoYXIKICAgICAgICAgICAgdmFsIGV4dHJhY3QgICA6IHN0cmluZyAqIGludCAqIGludCBvcHRpb24gLT4gc3RyaW5nCiAgICAgICAgICAgIHZhbCBzdWJzdHJpbmcgOiBzdHJpbmcgKiBpbnQgKiBpbnQgLT4gc3RyaW5nCiAgICAgICAgICAgIHZhbCBeIDogc3RyaW5nICogc3RyaW5nIC0+IHN0cmluZwogICAgICAgICAgICB2YWwgY29uY2F0IDogc3RyaW5nIGxpc3QgLT4gc3RyaW5nCiAgICAgICAgICAgIHZhbCBjb25jYXRXaXRoIDogc3RyaW5nIC0+IHN0cmluZyBsaXN0IC0+IHN0cmluZwogICAgICAgICAgICB2YWwgc3RyIDogY2hhciAtPiBzdHJpbmcKICAgICAgICAgICAgdmFsIGltcGxvZGUgOiBjaGFyIGxpc3QgLT4gc3RyaW5nCiAgICAgICAgICAgIHZhbCBleHBsb2RlIDogc3RyaW5nIC0+IGNoYXIgbGlzdAogICAgICAgICAgICB2YWwgbWFwIDogKGNoYXIgLT4gY2hhcikgLT4gc3RyaW5nIC0+IHN0cmluZwogICAgICAgICAgICB2YWwgdHJhbnNsYXRlIDogKGNoYXIgLT4gc3RyaW5nKSAtPiBzdHJpbmcgLT4gc3RyaW5nCiAgICAgICAgICAgIHZhbCB0b2tlbnMgOiAoY2hhciAtPiBib29sKSAtPiBzdHJpbmcgLT4gc3RyaW5nIGxpc3QKICAgICAgICAgICAgdmFsIGZpZWxkcyA6IChjaGFyIC0+IGJvb2wpIC0+IHN0cmluZyAtPiBzdHJpbmcgbGlzdAogICAgICAgICAgICB2YWwgaXNQcmVmaXggICAgOiBzdHJpbmcgLT4gc3RyaW5nIC0+IGJvb2wKICAgICAgICAgICAgdmFsIGlzU3Vic3RyaW5nIDogc3RyaW5nIC0+IHN0cmluZyAtPiBib29sCiAgICAgICAgICAgIHZhbCBpc1N1ZmZpeCAgICA6IHN0cmluZyAtPiBzdHJpbmcgLT4gYm9vbAogICAgICAgICAgICB2YWwgY29tcGFyZSA6IHN0cmluZyAqIHN0cmluZyAtPiBvcmRlcgogICAgICAgICAgICB2YWwgY29sbGF0ZSA6IChjaGFyICogY2hhciAtPiBvcmRlcikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+IHN0cmluZyAqIHN0cmluZyAtPiBvcmRlcgogICAgICAgICAgICB2YWwgPCAgOiBzdHJpbmcgKiBzdHJpbmcgLT4gYm9vbAogICAgICAgICAgICB2YWwgPD0gOiBzdHJpbmcgKiBzdHJpbmcgLT4gYm9vbAogICAgICAgICAgICB2YWwgPiAgOiBzdHJpbmcgKiBzdHJpbmcgLT4gYm9vbAogICAgICAgICAgICB2YWwgPj0gOiBzdHJpbmcgKiBzdHJpbmcgLT4gYm9vbAogICAgICAgIGVuZCA9IHN0cnVjdAogICAgICAgICAgICBvcGVuIFN0cmluZzsKCiAgICAgICAgICAgIGZ1biBzaXplIHMgPSBMaXN0Lmxlbmd0aCAoZXhwbG9kZSBzKTsKICAgICAgICAgICAgZnVuIHN1YiAocyxpKSA9IExpc3QubnRoIChleHBsb2RlIHMsIGkpOwogICAgICAgICAgICBmdW4gZXh0cmFjdCAocywgaSwgTk9ORSkgPSBpbXBsb2RlIChMaXN0LmRyb3AgKGV4cGxvZGUgcywgaSkpCiAgICAgICAgICAgICAgfCBleHRyYWN0IChzLCBpLCBTT01FIGopID0gaW1wbG9kZSAoTGlzdC50YWtlIChMaXN0LmRyb3AgKGV4cGxvZGUgcywgaSksIGopKTsKICAgICAgICAgICAgZnVuIHN1YnN0cmluZyAocywgaSwgaikgPSBleHRyYWN0IChzLCBpLCBTT01FIGopOwogICAgICAgICAgICB2YWwgb3BeID0gb3BeOwoKICAgICAgICAgICAgZnVuIGNjMiBiIChbXSwgeSkgPSB5CiAgICAgICAgICAgICAgfCBjYzIgYiAoeDo6eHMsIHkpID0gY2MyIGIgKHhzLCB5XmJeeCk7CiAgICAgICAgICAgIGZ1biBjb25jYXQgYSA9IGNjMiAiIiAoYSwgIiIpOwogICAgICAgICAgICBmdW4gY29uY2F0V2l0aCBiIFtdID0gIiIKICAgICAgICAgICAgICB8IGNvbmNhdFdpdGggYiAoYTo6YykgPSBhIF4gKGNjMiBiIChjLCAiIikpOwoKICAgICAgICAgICAgZnVuIHN0ciBjID0gaW1wbG9kZSBbY107CiAgICAgICAgICAgIHZhbCBpbXBsb2RlID0gaW1wbG9kZTsKICAgICAgICAgICAgdmFsIGV4cGxvZGUgPSBleHBsb2RlOwogICAgICAgICAgICBmdW4gbWFwIGYgcyA9IGltcGxvZGUoTGlzdC5tYXAgZiAoZXhwbG9kZSBzKSk7CiAgICAgICAgICAgIGZ1biB0cmFuc2xhdGUgZiBzID0gY29uY2F0KExpc3QubWFwIGYgKGV4cGxvZGUgcykpOwoKCiAgICAgICAgICAgIGZ1biBjbXAgZiAoW10sIFtdKSA9IEVRVUFMCiAgICAgICAgICAgICAgfCBjbXAgZiAoW10sIF8pID0gTEVTUwogICAgICAgICAgICAgIHwgY21wIGYgKF8sIFtdKSA9IEdSRUFURVIKICAgICAgICAgICAgICB8IGNtcCBmICh4Ojp4cywgeTo6eXMpID0gbGV0CiAgICAgICAgICAgICAgICAgICAgdmFsIHRtcCA9IGYgKHgsIHkpOwogICAgICAgICAgICAgICAgaW4KICAgICAgICAgICAgICAgICAgICBpZiB0bXAgPD4gRVFVQUwgdGhlbiB0bXAgZWxzZSBjbXAgZiAoeHMsIHlzKQogICAgICAgICAgICAgICAgZW5kOwoKICAgICAgICAgICAgZnVuIG1hdGNoUHJlZml4IChbXSwgXykgPSB0cnVlCiAgICAgICAgICAgICAgfCBtYXRjaFByZWZpeCAoXywgW10pID0gZmFsc2UKICAgICAgICAgICAgICB8IG1hdGNoUHJlZml4ICh4Ojp4cywgeTo6eXMpID0gaWYgeCA8PiB5IHRoZW4gZmFsc2UgZWxzZSBtYXRjaFByZWZpeCAoeHMsIHlzKTsKCiAgICAgICAgICAgIGZ1biBtYXRjaFN1YnN0cmluZyAoW10sIF8pID0gdHJ1ZQogICAgICAgICAgICAgIHwgbWF0Y2hTdWJzdHJpbmcgKF8sIFtdKSA9IGZhbHNlCiAgICAgICAgICAgICAgfCBtYXRjaFN1YnN0cmluZyAoeCwgeTo6eXMpID0gaWYgbWF0Y2hQcmVmaXggKHgsIHk6OnlzKSB0aGVuIHRydWUKICAgICAgICAgICAgICAgIGVsc2UgbWF0Y2hTdWJzdHJpbmcgKHgsIHlzKTsKCiAgICAgICAgICAgIGZ1biBnZXRGaWVsZHMgKGYsIFtdLCB0bXAsIHgpID0gKGltcGxvZGUgdG1wKSA6OiB4CiAgICAgICAgICAgICAgfCBnZXRGaWVsZHMgKGYsIChyOjpycyksIHRtcCwgeCkgPSBpZiBmIHIgdGhlbgogICAgICAgICAgICAgICAgICAgIGdldEZpZWxkcyAoZiwgcnMsIFtdLCAoaW1wbG9kZSB0bXApOjp4KQogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgIGdldEZpZWxkcyAoZiwgcnMsIHI6OnRtcCwgeCk7CgogICAgICAgICAgICBmdW4gdG9rZW5zIGYgcyA9IExpc3QuZmlsdGVyIChmbiB0ID0+IHQgPD4gIiIpIChnZXRGaWVsZHMgKGYsIHJldiAoZXhwbG9kZSBzKSwgW10sIFtdKSk7CiAgICAgICAgICAgIGZ1biBmaWVsZHMgZiBzID0gZ2V0RmllbGRzIChmLCByZXYgKGV4cGxvZGUgcyksIFtdLCBbXSk7CgogICAgICAgICAgICBmdW4gaXNQcmVmaXggYSBiID0gbWF0Y2hQcmVmaXggKGV4cGxvZGUgYSwgZXhwbG9kZSBiKTsKICAgICAgICAgICAgZnVuIGlzU3Vic3RyaW5nIGEgYiA9IG1hdGNoU3Vic3RyaW5nIChleHBsb2RlIGEsIGV4cGxvZGUgYik7CiAgICAgICAgICAgIGZ1biBpc1N1ZmZpeCBhIGIgPSBtYXRjaFByZWZpeCAocmV2IChleHBsb2RlIGEpLCByZXYgKGV4cGxvZGUgYikpOwoKICAgICAgICAgICAgZnVuIGNvbXBhcmUgKGEsIGIpID0gY21wIENoYXIuY29tcGFyZSAoZXhwbG9kZSBhLCBleHBsb2RlIGIpOwogICAgICAgICAgICBmdW4gY29sbGF0ZSBmIChhLCBiKSA9IGNtcCBmIChleHBsb2RlIGEsIGV4cGxvZGUgYik7CgogICAgICAgICAgICBmdW4gb3A8IChhLCBiKSA9IGNvbXBhcmUgKGEsIGIpID0gTEVTUzsKICAgICAgICAgICAgZnVuIG9wPiAoYSwgYikgPSBjb21wYXJlIChhLCBiKSA9IEdSRUFURVI7CiAgICAgICAgICAgIGZ1biBvcDw9IChhLCBiKSA9IGNvbXBhcmUgKGEsIGIpIDw+IEdSRUFURVI7CiAgICAgICAgICAgIGZ1biBvcD49IChhLCBiKSA9IGNvbXBhcmUgKGEsIGIpIDw+IExFU1M7CiAgICAgICAgZW5kOwogICAgICAgIHZhbCBjb25jYXQgICAgPSBTdHJpbmcuY29uY2F0OwogICAgICAgIHZhbCBzaXplICAgICAgPSBTdHJpbmcuc2l6ZTsKICAgICAgICB2YWwgc3RyICAgICAgID0gU3RyaW5nLnN0cjsKICAgICAgICB2YWwgc3Vic3RyaW5nID0gU3RyaW5nLnN1YnN0cmluZzsKICAgICAgICBgLHJlcXVpcmVzOlsiQ2hhciIsIkxpc3QiXX19LDY2NzooZmUsdSxLKT0+e09iamVjdC5kZWZpbmVQcm9wZXJ0eSh1LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx1LlZFQ1RPUl9MSUI9dm9pZCAwO3ZhciBtPUsoMzY3KSxnPUsoNjk5KSxzPUsoMTA2KSxxPUsoNzU4KSxCPUsoMTk3KTt1LlZFQ1RPUl9MSUI9e25hdGl2ZTpmdW5jdGlvbihNKXt2YXIgVj1uZXcgbS5EeW5hbWljQmFzaXMoe30se30se30se30se30pLEQ9bmV3IG0uU3RhdGljQmFzaXMoe30se30se30se30se30pLGg9bmV3IGcuQ3VzdG9tVHlwZSgidmVjdG9yIixbbmV3IGcuVHlwZVZhcmlhYmxlKCInYSIpXSksQT1uZXcgZy5DdXN0b21UeXBlKCJsaXN0IixbbmV3IGcuVHlwZVZhcmlhYmxlKCInYSIpXSk7cmV0dXJuIEQuc2V0VHlwZSgidmVjdG9yIixoLFtdLDEsITApLFYuc2V0VHlwZSgidmVjdG9yIixbXSksVi5zZXRWYWx1ZSgiZnJvbUxpc3QiLG5ldyBzLlByZWRlZmluZWRGdW5jdGlvbigiZnJvbUxpc3QiLGZ1bmN0aW9uKEksTyl7dmFyIEU9bmV3IHMuVmVjdG9yVmFsdWUoW10pO2lmKEkgaW5zdGFuY2VvZiBzLkNvbnN0cnVjdGVkVmFsdWUpe2Zvcih2YXIgcj1JO3IuY29uc3RydWN0b3JOYW1lIT09Im5pbCI7KXtpZihyLmNvbnN0cnVjdG9yTmFtZSE9PSI6OiIpdGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpO3ZhciBlPXIuYXJndW1lbnQ7aWYoIShlIGluc3RhbmNlb2Ygcy5SZWNvcmRWYWx1ZSYmZS5lbnRyaWVzLnNpemU9PT0yKSl0aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoInN0ZCB0eXBlIG1pc21hdGNoIik7dmFyIG89ZS5nZXRWYWx1ZSgiMSIpLHk9ZS5nZXRWYWx1ZSgiMiIpO2lmKCEobyBpbnN0YW5jZW9mIHMuVmFsdWUmJnkgaW5zdGFuY2VvZiBzLkNvbnN0cnVjdGVkVmFsdWUpKXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKTtFLmVudHJpZXMucHVzaChvKSxyPXl9cmV0dXJuW0UsITEsW11dfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKX0pLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksRC5zZXRWYWx1ZSgiZnJvbUxpc3QiLG5ldyBnLkZ1bmN0aW9uVHlwZShBLGgpLG0uSWRlbnRpZmllclN0YXR1cy5WQUxVRV9WQVJJQUJMRSksVi5zZXRWYWx1ZSgic3ViIixuZXcgcy5QcmVkZWZpbmVkRnVuY3Rpb24oInN1YiIsZnVuY3Rpb24oSSxPKXtpZihJIGluc3RhbmNlb2Ygcy5SZWNvcmRWYWx1ZSYmSS5lbnRyaWVzLnNpemU9PT0yKXt2YXIgRT1JLmdldFZhbHVlKCIxIikscj1JLmdldFZhbHVlKCIyIik7aWYoRSBpbnN0YW5jZW9mIHMuVmVjdG9yVmFsdWUmJnIgaW5zdGFuY2VvZiBzLkludGVnZXIpe3ZhciBlPXIudmFsdWU7cmV0dXJuIGU8MHx8ZT49RS5lbnRyaWVzLmxlbmd0aD9bQi5zdWJzY3JpcHRFeGNlcHRpb24uY29uc3RydWN0KCksITAsW11dOltFLmVudHJpZXNbZV0sITEsW11dfXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcigic3RkIHR5cGUgbWlzbWF0Y2giKX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoInN0ZCB0eXBlIG1pc21hdGNoIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLEQuc2V0VmFsdWUoInN1YiIsbmV3IGcuRnVuY3Rpb25UeXBlKG5ldyBnLlR1cGxlVHlwZShbaCxCLmludFR5cGVdKS5zaW1wbGlmeSgpLG5ldyBnLlR5cGVWYXJpYWJsZSgiJ2EiKSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxWLnNldFZhbHVlKCJ1cGRhdGUiLG5ldyBzLlByZWRlZmluZWRGdW5jdGlvbigidXBkYXRlIixmdW5jdGlvbihJLE8pe2lmKEkgaW5zdGFuY2VvZiBzLlJlY29yZFZhbHVlJiZJLmVudHJpZXMuc2l6ZT09PTMpe3ZhciBFPUkuZ2V0VmFsdWUoIjEiKSxyPUkuZ2V0VmFsdWUoIjIiKSxlPUkuZ2V0VmFsdWUoIjMiKTtpZihFIGluc3RhbmNlb2Ygcy5WZWN0b3JWYWx1ZSYmciBpbnN0YW5jZW9mIHMuSW50ZWdlcil7dmFyIG89ci52YWx1ZTtpZihvPDB8fG8+PUUuZW50cmllcy5sZW5ndGgpcmV0dXJuW0Iuc3Vic2NyaXB0RXhjZXB0aW9uLmNvbnN0cnVjdCgpLCEwLFtdXTt2YXIgeT1uZXcgcy5WZWN0b3JWYWx1ZShFLmVudHJpZXMuc2xpY2UoKSk7cmV0dXJuIHkuZW50cmllc1tvXT1lLFt5LCExLFtdXX10aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoInN0ZCB0eXBlIG1pc21hdGNoIil9dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCJzdGQgdHlwZSBtaXNtYXRjaCIpfSksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxELnNldFZhbHVlKCJ1cGRhdGUiLG5ldyBnLkZ1bmN0aW9uVHlwZShuZXcgZy5UdXBsZVR5cGUoW2gsQi5pbnRUeXBlLG5ldyBnLlR5cGVWYXJpYWJsZSgiJ2EiKV0pLnNpbXBsaWZ5KCksaCksbS5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKSxWLnNldFZhbHVlKCJsZW5ndGgiLG5ldyBzLlByZWRlZmluZWRGdW5jdGlvbigibGVuZ3RoIixmdW5jdGlvbihJLE8pe2lmKEkgaW5zdGFuY2VvZiBzLlZlY3RvclZhbHVlKXJldHVybltuZXcgcy5JbnRlZ2VyKEkuZW50cmllcy5sZW5ndGgpLCExLFtdXTt0aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoInN0ZCB0eXBlIG1pc21hdGNoIil9KSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLEQuc2V0VmFsdWUoImxlbmd0aCIsbmV3IGcuRnVuY3Rpb25UeXBlKGgsQi5pbnRUeXBlKSxtLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpLE0uc2V0RHluYW1pY1N0cnVjdHVyZSgiVmVjdG9yIixWKSxNLnNldFN0YXRpY1N0cnVjdHVyZSgiVmVjdG9yIixEKSxNfSxjb2RlOmBzdHJ1Y3R1cmUgVmVjdG9yIDo+IHNpZwogICAgICAgICgqIGVxdHlwZSAnYSB2ZWN0b3IgPSAnYSB2ZWN0b3IgKikKICAgICAgICAoKiB2YWwgbWF4TGVuIDogaW50ICopCiAgICAgICAgdmFsIGZyb21MaXN0IDogJ2EgbGlzdCAtPiAnYSB2ZWN0b3IKICAgICAgICB2YWwgdGFidWxhdGUgOiBpbnQgKiAoaW50IC0+ICdhKSAtPiAnYSB2ZWN0b3IKICAgICAgICB2YWwgbGVuZ3RoIDogJ2EgdmVjdG9yIC0+IGludAogICAgICAgIHZhbCBzdWIgOiAnYSB2ZWN0b3IgKiBpbnQgLT4gJ2EKICAgICAgICB2YWwgdXBkYXRlIDogJ2EgdmVjdG9yICogaW50ICogJ2EgLT4gJ2EgdmVjdG9yCiAgICAgICAgdmFsIGNvbmNhdCA6ICdhIHZlY3RvciBsaXN0IC0+ICdhIHZlY3RvcgogICAgICAgIHZhbCBhcHBpIDogKGludCAqICdhIC0+IHVuaXQpIC0+ICdhIHZlY3RvciAtPiB1bml0CiAgICAgICAgdmFsIGFwcCAgOiAoJ2EgLT4gdW5pdCkgLT4gJ2EgdmVjdG9yIC0+IHVuaXQKICAgICAgICB2YWwgbWFwaSA6IChpbnQgKiAnYSAtPiAnYikgLT4gJ2EgdmVjdG9yIC0+ICdiIHZlY3RvcgogICAgICAgIHZhbCBtYXAgIDogKCdhIC0+ICdiKSAtPiAnYSB2ZWN0b3IgLT4gJ2IgdmVjdG9yCiAgICAgICAgdmFsIGZvbGRsaSA6IChpbnQgKiAnYSAqICdiIC0+ICdiKSAtPiAnYiAtPiAnYSB2ZWN0b3IgLT4gJ2IKICAgICAgICB2YWwgZm9sZHJpIDogKGludCAqICdhICogJ2IgLT4gJ2IpIC0+ICdiIC0+ICdhIHZlY3RvciAtPiAnYgogICAgICAgIHZhbCBmb2xkbCAgOiAoJ2EgKiAnYiAtPiAnYikgLT4gJ2IgLT4gJ2EgdmVjdG9yIC0+ICdiCiAgICAgICAgdmFsIGZvbGRyICA6ICgnYSAqICdiIC0+ICdiKSAtPiAnYiAtPiAnYSB2ZWN0b3IgLT4gJ2IKICAgICAgICB2YWwgZmluZGkgOiAoaW50ICogJ2EgLT4gYm9vbCkgLT4gJ2EgdmVjdG9yIC0+IChpbnQgKiAnYSkgb3B0aW9uCiAgICAgICAgdmFsIGZpbmQgIDogKCdhIC0+IGJvb2wpIC0+ICdhIHZlY3RvciAtPiAnYSBvcHRpb24KICAgICAgICB2YWwgZXhpc3RzIDogKCdhIC0+IGJvb2wpIC0+ICdhIHZlY3RvciAtPiBib29sCiAgICAgICAgdmFsIGFsbCA6ICgnYSAtPiBib29sKSAtPiAnYSB2ZWN0b3IgLT4gYm9vbAogICAgICAgIHZhbCBjb2xsYXRlIDogKCdhICogJ2EgLT4gb3JkZXIpIC0+ICdhIHZlY3RvciAqICdhIHZlY3RvciAtPiBvcmRlcgogICAgZW5kID0gc3RydWN0CiAgICAgICAgb3BlbiBWZWN0b3I7CiAgICAgICAgZnVuIHRhYnVsYXRlIChuLCBmKSA9IGZyb21MaXN0IChMaXN0LnRhYnVsYXRlIChuLCBmKSk7CgogICAgICAgIGZ1biBmb2xkbGkgZiBpbml0IHZlYyA9IGxldAogICAgICAgICAgICB2YWwgbGVuID0gbGVuZ3RoIHZlYwogICAgICAgICAgICBmdW4gbG9vcCAoaSwgYikgPQogICAgICAgICAgICAgICAgaWYgaSA9IGxlbiB0aGVuIGIKICAgICAgICAgICAgICAgIGVsc2UgbG9vcCAoaSArIDEsIGYgKGksIHN1YiAodmVjLCBpKSwgYikpCiAgICAgICAgICAgIGluCiAgICAgICAgICAgICAgICBsb29wICgwLCBpbml0KQogICAgICAgICAgICBlbmQ7CiAgICAgICAgZnVuIGZvbGRyaSBmIGluaXQgdmVjID0gbGV0CiAgICAgICAgICAgIHZhbCBsZW4gPSBsZW5ndGggdmVjCiAgICAgICAgICAgIGZ1biBsb29wIChpLCBiKSA9CiAgICAgICAgICAgICAgICBpZiBpID0gfjEgdGhlbiBiCiAgICAgICAgICAgICAgICBlbHNlIGxvb3AgKGkgLSAxLCBmIChpLCBzdWIgKHZlYywgaSksIGIpKQogICAgICAgICAgICBpbgogICAgICAgICAgICAgICAgbG9vcCAobGVuIC0gMSwgaW5pdCkKICAgICAgICAgICAgZW5kOwogICAgICAgIGZ1biBmb2xkbCBmIGluaXQgdmVjID0gZm9sZGxpIChmbiAoXywgYSwgeCkgPT4gZihhLCB4KSkgaW5pdCB2ZWM7CiAgICAgICAgZnVuIGZvbGRyIGYgaW5pdCB2ZWMgPSBmb2xkcmkgKGZuIChfLCBhLCB4KSA9PiBmKGEsIHgpKSBpbml0IHZlYzsKCiAgICAgICAgZnVuIGNvbmNhdCBsID0gZnJvbUxpc3QgKExpc3QuY29uY2F0IChMaXN0Lm1hcCAoZm9sZHIgKGZuIChhLCBiKSA9PiAoYTo6YikpIFtdKSBsKSk7CgogICAgICAgIGZ1biBhcHBpIGYgdmVjID0gTGlzdC5hcHAgZiAoZm9sZHJpIChmbiAoaSxhLGwpID0+IChpLGEpOjpsKSBbXSB2ZWMpOwogICAgICAgIGZ1biBhcHAgIGYgdmVjID0gTGlzdC5hcHAgZiAoZm9sZHIgKGZuIChhLGwpID0+IGE6OmwpIFtdIHZlYyk7CiAgICAgICAgZnVuIG1hcGkgZiB2ZWMgPSBmcm9tTGlzdCAoTGlzdC5tYXAgZiAoZm9sZHJpIChmbiAoaSxhLGwpID0+IChpLGEpOjpsKSBbXSB2ZWMpKTsKICAgICAgICBmdW4gbWFwICBmIHZlYyA9IGZyb21MaXN0IChMaXN0Lm1hcCBmIChmb2xkciAoZm4gKGEsbCkgPT4gYTo6bCkgW10gdmVjKSk7CgogICAgICAgIGZ1biBmaW5kaSBmIHZlYyA9IGxldAogICAgICAgICAgICB2YWwgbGVuID0gbGVuZ3RoIHZlYwogICAgICAgICAgICBmdW4gbG9vcCBpbmRleCA9CiAgICAgICAgICAgICAgICBpZiBpbmRleCA9IFZlY3Rvci5sZW5ndGggdmVjIHRoZW4gTk9ORQogICAgICAgICAgICAgICAgZWxzZSBsZXQKICAgICAgICAgICAgICAgICAgICB2YWwgZWwgPSBzdWIodmVjLCBpbmRleCkKICAgICAgICAgICAgICAgIGluIGlmIGYgKGluZGV4LCBlbCkgdGhlbiBTT01FIChpbmRleCwgZWwpIGVsc2UgbG9vcCAoaW5kZXgrMSkKICAgICAgICAgICAgICAgIGVuZAogICAgICAgICAgICBpbgogICAgICAgICAgICAgICAgbG9vcCAwCiAgICAgICAgICAgIGVuZDsKICAgICAgICBmdW4gZmluZCBmIHZlYyA9IGNhc2UgZmluZGkgKGZuIChfLCB2KSA9PiBmIHYpIHZlYyBvZiBOT05FID0+IE5PTkUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgU09NRSAoXywgdikgPT4gU09NRSB2OwogICAgICAgIGZ1biBleGlzdHMgcCB2ZWMgPSBjYXNlIGZpbmQgcCB2ZWMgb2YgTk9ORSA9PiBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgU09NRSBfID0+IHRydWU7CgogICAgICAgIGZ1biBhbGwgcCB2ZWMgPSBmb2xkbCAoZm4gKHYsIGFjYykgPT4gcCB2IGFuZGFsc28gYWNjKSB0cnVlIHZlYzsKICAgICAgICBmdW4gY29sbGF0ZSBwICh2MSwgdjIpID0gbGV0CiAgICAgICAgICAgIHZhbCBsZW5ndGgxID0gbGVuZ3RoIHYxCiAgICAgICAgICAgIHZhbCBsZW5ndGgyID0gbGVuZ3RoIHYyCiAgICAgICAgICAgIGZ1biBsb29wIGluZGV4ID0KICAgICAgICAgICAgICAgIGlmIGluZGV4ID0gbGVuZ3RoMSBhbmRhbHNvIGluZGV4ID0gbGVuZ3RoMiB0aGVuIEVRVUFMCiAgICAgICAgICAgICAgICBlbHNlIGlmIGluZGV4ID0gbGVuZ3RoMSB0aGVuIExFU1MKICAgICAgICAgICAgICAgIGVsc2UgaWYgaW5kZXggPSBsZW5ndGgyIHRoZW4gR1JFQVRFUgogICAgICAgICAgICAgICAgZWxzZSBjYXNlIHAgKHN1YiAodjEsIGluZGV4KSwgc3ViICh2MiwgaW5kZXgpKSBvZgogICAgICAgICAgICAgICAgICAgIEVRVUFMID0+IGxvb3AgKGluZGV4ICsgMSkKICAgICAgICAgICAgICAgICAgfCBsID0+IGwKICAgICAgICAgICAgaW4gbG9vcCAwCiAgICAgICAgICAgIGVuZDsKICAgIGVuZDsKICAgIHZhbCB2ZWN0b3IgPSBWZWN0b3IuZnJvbUxpc3Q7YCxyZXF1aXJlczpbIk9wdGlvbiIsIkxpc3QiXX19LDUzNDpmdW5jdGlvbihmZSx1KXt2YXIgSyxtPXRoaXMmJnRoaXMuX19leHRlbmRzfHwoSz1mdW5jdGlvbihkLHYpe3JldHVybihLPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8e19fcHJvdG9fXzpbXX1pbnN0YW5jZW9mIEFycmF5JiZmdW5jdGlvbihDLEcpe0MuX19wcm90b19fPUd9fHxmdW5jdGlvbihDLEcpe2Zvcih2YXIgWSBpbiBHKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChHLFkpJiYoQ1tZXT1HW1ldKX0pKGQsdil9LGZ1bmN0aW9uKGQsdil7aWYodHlwZW9mIHYhPSJmdW5jdGlvbiImJnYhPT1udWxsKXRocm93IG5ldyBUeXBlRXJyb3IoIkNsYXNzIGV4dGVuZHMgdmFsdWUgIitTdHJpbmcodikrIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsIik7ZnVuY3Rpb24gQygpe3RoaXMuY29uc3RydWN0b3I9ZH1LKGQsdiksZC5wcm90b3R5cGU9dj09PW51bGw/T2JqZWN0LmNyZWF0ZSh2KTooQy5wcm90b3R5cGU9di5wcm90b3R5cGUsbmV3IEMpfSk7T2JqZWN0LmRlZmluZVByb3BlcnR5KHUsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHUuTG9uZ0lkZW50aWZpZXJUb2tlbj11Lk51bWVyaWNUb2tlbj11LkVxdWFsc1Rva2VuPXUuU3RhclRva2VuPXUuRXF1YWxpdHlUeXBlVmFyaWFibGVUb2tlbj11LlR5cGVWYXJpYWJsZVRva2VuPXUuQWxwaGFudW1lcmljSWRlbnRpZmllclRva2VuPXUuSWRlbnRpZmllclRva2VuPXUuU3RyaW5nQ29uc3RhbnRUb2tlbj11LkNoYXJhY3RlckNvbnN0YW50VG9rZW49dS5Xb3JkQ29uc3RhbnRUb2tlbj11LlJlYWxDb25zdGFudFRva2VuPXUuSW50ZWdlckNvbnN0YW50VG9rZW49dS5Db25zdGFudFRva2VuPXUuS2V5d29yZFRva2VuPXUuQ29tbWVudFRva2VuPXZvaWQgMDt2YXIgZz1mdW5jdGlvbigpe2Z1bmN0aW9uIGQodil7dGhpcy50ZXh0PXZ9cmV0dXJuIGQucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIkNvbW1lbnRUb2tlbiJ9LGQucHJvdG90eXBlLmdldFRleHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50ZXh0fSxkLnByb3RvdHlwZS5pc1ZhbGlkUmVjb3JkTGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4hMX0sZC5wcm90b3R5cGUuaXNWaWQ9ZnVuY3Rpb24oKXtyZXR1cm4hMX0sZH0oKTt1LkNvbW1lbnRUb2tlbj1nO3ZhciBzPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZCh2KXt0aGlzLnRleHQ9dn1yZXR1cm4gZC5wcm90b3R5cGUudHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4iS2V5d29yZFRva2VuIn0sZC5wcm90b3R5cGUuZ2V0VGV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRleHR9LGQucHJvdG90eXBlLmlzVmFsaWRSZWNvcmRMYWJlbD1mdW5jdGlvbigpe3JldHVybiExfSxkLnByb3RvdHlwZS5pc1ZpZD1mdW5jdGlvbigpe3JldHVybiExfSxkfSgpO3UuS2V5d29yZFRva2VuPXM7dmFyIHE9ZnVuY3Rpb24oKXtmdW5jdGlvbiBkKCl7fXJldHVybiBkLnByb3RvdHlwZS50eXBlTmFtZT1mdW5jdGlvbigpe3JldHVybiJDb25zdGFudFRva2VuIn0sZC5wcm90b3R5cGUuaXNWaWQ9ZnVuY3Rpb24oKXtyZXR1cm4hMX0sZH0oKTt1LkNvbnN0YW50VG9rZW49cTt2YXIgQj1mdW5jdGlvbihkKXtmdW5jdGlvbiB2KEMsRyl7dmFyIFk9ZC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBZLnRleHQ9QyxZLnZhbHVlPUcsWX1yZXR1cm4gbSh2LGQpLHYucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIkludGVnZXJDb25zdGFudFRva2VuIn0sdi5wcm90b3R5cGUuZ2V0VGV4dD1mdW5jdGlvbigpe3JldHVybiIiK3RoaXMudmFsdWV9LHYucHJvdG90eXBlLmlzVmFsaWRSZWNvcmRMYWJlbD1mdW5jdGlvbigpe3JldHVybiExfSx2fShxKTt1LkludGVnZXJDb25zdGFudFRva2VuPUI7dmFyIE09ZnVuY3Rpb24oZCl7ZnVuY3Rpb24gdihDLEcpe3ZhciBZPWQuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gWS50ZXh0PUMsWS52YWx1ZT1HLFl9cmV0dXJuIG0odixkKSx2LnByb3RvdHlwZS50eXBlTmFtZT1mdW5jdGlvbigpe3JldHVybiJSZWFsQ29uc3RhbnRUb2tlbiJ9LHYucHJvdG90eXBlLmdldFRleHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50ZXh0fSx2LnByb3RvdHlwZS5pc1ZhbGlkUmVjb3JkTGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4hMX0sdn0ocSk7dS5SZWFsQ29uc3RhbnRUb2tlbj1NO3ZhciBWPWZ1bmN0aW9uKGQpe2Z1bmN0aW9uIHYoQyxHKXt2YXIgWT1kLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIFkudGV4dD1DLFkudmFsdWU9RyxZfXJldHVybiBtKHYsZCksdi5wcm90b3R5cGUudHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4iV29yZENvbnN0YW50VG9rZW4ifSx2LnByb3RvdHlwZS5nZXRUZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIiIrdGhpcy52YWx1ZX0sdi5wcm90b3R5cGUuaXNWYWxpZFJlY29yZExhYmVsPWZ1bmN0aW9uKCl7cmV0dXJuITF9LHZ9KHEpO3UuV29yZENvbnN0YW50VG9rZW49Vjt2YXIgRD1mdW5jdGlvbihkKXtmdW5jdGlvbiB2KEMsRyl7dmFyIFk9ZC5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBZLnRleHQ9QyxZLnZhbHVlPUcsWX1yZXR1cm4gbSh2LGQpLHYucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIkNoYXJhY3RlckNvbnN0YW50VG9rZW4ifSx2LnByb3RvdHlwZS5nZXRUZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIiIrdGhpcy50ZXh0fSx2LnByb3RvdHlwZS5pc1ZhbGlkUmVjb3JkTGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4hMX0sdn0ocSk7dS5DaGFyYWN0ZXJDb25zdGFudFRva2VuPUQ7dmFyIGg9ZnVuY3Rpb24oZCl7ZnVuY3Rpb24gdihDLEcpe3ZhciBZPWQuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gWS50ZXh0PUMsWS52YWx1ZT1HLFl9cmV0dXJuIG0odixkKSx2LnByb3RvdHlwZS50eXBlTmFtZT1mdW5jdGlvbigpe3JldHVybiJTdHJpbmdDb25zdGFudFRva2VuIn0sdi5wcm90b3R5cGUuZ2V0VGV4dD1mdW5jdGlvbigpe3JldHVybiIiK3RoaXMudGV4dH0sdi5wcm90b3R5cGUuaXNWYWxpZFJlY29yZExhYmVsPWZ1bmN0aW9uKCl7cmV0dXJuITF9LHZ9KHEpO3UuU3RyaW5nQ29uc3RhbnRUb2tlbj1oO3ZhciBBPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZCh2KXt0aGlzLnRleHQ9dix0aGlzLm9wUHJlZml4ZWQ9ITF9cmV0dXJuIGQucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIklkZW50aWZpZXJUb2tlbiJ9LGQucHJvdG90eXBlLmdldFRleHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50ZXh0fSxkLnByb3RvdHlwZS5pc1ZhbGlkUmVjb3JkTGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4hMH0sZC5wcm90b3R5cGUuaXNWaWQ9ZnVuY3Rpb24oKXtyZXR1cm4hMH0sZH0oKTt1LklkZW50aWZpZXJUb2tlbj1BO3ZhciBJPWZ1bmN0aW9uKGQpe2Z1bmN0aW9uIHYoQyl7cmV0dXJuIGQuY2FsbCh0aGlzLEMpfHx0aGlzfXJldHVybiBtKHYsZCksdi5wcm90b3R5cGUudHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4iQWxwaGFudW1lcmljSWRlbnRpZmllclRva2VuIn0sdi5wcm90b3R5cGUuZ2V0VGV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRleHR9LHYucHJvdG90eXBlLmlzVmFsaWRSZWNvcmRMYWJlbD1mdW5jdGlvbigpe3JldHVybiEwfSx2fShBKTt1LkFscGhhbnVtZXJpY0lkZW50aWZpZXJUb2tlbj1JO3ZhciBPPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZCh2KXt0aGlzLnRleHQ9dn1yZXR1cm4gZC5wcm90b3R5cGUudHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4iVHlwZVZhcmlhYmxlVG9rZW4ifSxkLnByb3RvdHlwZS5nZXRUZXh0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudGV4dH0sZC5wcm90b3R5cGUuaXNWYWxpZFJlY29yZExhYmVsPWZ1bmN0aW9uKCl7cmV0dXJuITF9LGQucHJvdG90eXBlLmlzVmlkPWZ1bmN0aW9uKCl7cmV0dXJuITF9LGR9KCk7dS5UeXBlVmFyaWFibGVUb2tlbj1PO3ZhciBFPWZ1bmN0aW9uKGQpe2Z1bmN0aW9uIHYoQyl7cmV0dXJuIGQuY2FsbCh0aGlzLEMpfHx0aGlzfXJldHVybiBtKHYsZCksdi5wcm90b3R5cGUudHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4iRXF1YWxpdHlUeXBlVmFyaWFibGVUb2tlbiJ9LHYucHJvdG90eXBlLmdldFRleHQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50ZXh0fSx2LnByb3RvdHlwZS5pc1ZhbGlkUmVjb3JkTGFiZWw9ZnVuY3Rpb24oKXtyZXR1cm4hMX0sdi5wcm90b3R5cGUuaXNWaWQ9ZnVuY3Rpb24oKXtyZXR1cm4hMX0sdn0oTyk7dS5FcXVhbGl0eVR5cGVWYXJpYWJsZVRva2VuPUU7dmFyIHI9ZnVuY3Rpb24oZCl7ZnVuY3Rpb24gdigpe3ZhciBDPWQuY2FsbCh0aGlzLCIqIil8fHRoaXM7cmV0dXJuIEMub3BQcmVmaXhlZD0hMSxDfXJldHVybiBtKHYsZCksdi5wcm90b3R5cGUudHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4iU3RhclRva2VuIn0sdi5wcm90b3R5cGUuZ2V0VGV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRleHR9LHYucHJvdG90eXBlLmlzVmFsaWRSZWNvcmRMYWJlbD1mdW5jdGlvbigpe3JldHVybiEwfSx2LnByb3RvdHlwZS5pc1ZpZD1mdW5jdGlvbigpe3JldHVybiEwfSx2fShzKTt1LlN0YXJUb2tlbj1yO3ZhciBlPWZ1bmN0aW9uKGQpe2Z1bmN0aW9uIHYoKXt2YXIgQz1kLmNhbGwodGhpcywiPSIpfHx0aGlzO3JldHVybiBDLm9wUHJlZml4ZWQ9ITEsQ31yZXR1cm4gbSh2LGQpLHYucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIkVxdWFsc1Rva2VuIn0sdi5wcm90b3R5cGUuZ2V0VGV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRleHR9LHYucHJvdG90eXBlLmlzVmFsaWRSZWNvcmRMYWJlbD1mdW5jdGlvbigpe3JldHVybiExfSx2LnByb3RvdHlwZS5pc1ZpZD1mdW5jdGlvbigpe3JldHVybiEwfSx2fShzKTt1LkVxdWFsc1Rva2VuPWU7dmFyIG89ZnVuY3Rpb24oZCl7ZnVuY3Rpb24gdihDLEcpe3JldHVybiBkLmNhbGwodGhpcyxDLEcpfHx0aGlzfXJldHVybiBtKHYsZCksdi5wcm90b3R5cGUudHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4iTnVtZXJpY1Rva2VuIn0sdi5wcm90b3R5cGUuZ2V0VGV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRleHR9LHYucHJvdG90eXBlLmlzVmFsaWRSZWNvcmRMYWJlbD1mdW5jdGlvbigpe3JldHVybiEwfSx2LnByb3RvdHlwZS5pc1ZpZD1mdW5jdGlvbigpe3JldHVybiExfSx2fShCKTt1Lk51bWVyaWNUb2tlbj1vO3ZhciB5PWZ1bmN0aW9uKCl7ZnVuY3Rpb24gZCh2LEMsRyl7dGhpcy50ZXh0PXYsdGhpcy5xdWFsaWZpZXJzPUMsdGhpcy5pZD1HLHRoaXMub3BQcmVmaXhlZD0hMX1yZXR1cm4gZC5wcm90b3R5cGUudHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4iTG9uZ0lkZW50aWZpZXJUb2tlbiJ9LGQucHJvdG90eXBlLmdldFRleHQ9ZnVuY3Rpb24oKXtmb3IodmFyIHY9IiIsQz0wO0M8dGhpcy5xdWFsaWZpZXJzLmxlbmd0aDsrK0MpQz4wJiYodis9Ii4iKSx2Kz10aGlzLnF1YWxpZmllcnNbQ10uZ2V0VGV4dCgpO3JldHVybiB2KyIuIit0aGlzLmlkLmdldFRleHQoKX0sZC5wcm90b3R5cGUuaXNWYWxpZFJlY29yZExhYmVsPWZ1bmN0aW9uKCl7cmV0dXJuITF9LGQucHJvdG90eXBlLmlzVmlkPWZ1bmN0aW9uKCl7cmV0dXJuITF9LGR9KCk7dS5Mb25nSWRlbnRpZmllclRva2VuPXl9LDY5OTpmdW5jdGlvbihmZSx1LEspe3ZhciBtLGc9dGhpcyYmdGhpcy5fX2V4dGVuZHN8fChtPWZ1bmN0aW9uKEUscil7cmV0dXJuKG09T2JqZWN0LnNldFByb3RvdHlwZU9mfHx7X19wcm90b19fOltdfWluc3RhbmNlb2YgQXJyYXkmJmZ1bmN0aW9uKGUsbyl7ZS5fX3Byb3RvX189b318fGZ1bmN0aW9uKGUsbyl7Zm9yKHZhciB5IGluIG8pT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG8seSkmJihlW3ldPW9beV0pfSkoRSxyKX0sZnVuY3Rpb24oRSxyKXtpZih0eXBlb2YgciE9ImZ1bmN0aW9uIiYmciE9PW51bGwpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSAiK1N0cmluZyhyKSsiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGwiKTtmdW5jdGlvbiBlKCl7dGhpcy5jb25zdHJ1Y3Rvcj1FfW0oRSxyKSxFLnByb3RvdHlwZT1yPT09bnVsbD9PYmplY3QuY3JlYXRlKHIpOihlLnByb3RvdHlwZT1yLnByb3RvdHlwZSxuZXcgZSl9KTtPYmplY3QuZGVmaW5lUHJvcGVydHkodSwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSksdS5UdXBsZVR5cGU9dS5DdXN0b21UeXBlPXUuRnVuY3Rpb25UeXBlPXUuUmVjb3JkVHlwZT11LlR5cGVWYXJpYWJsZT11LlR5cGVWYXJpYWJsZUJpbmQ9dS5BbnlUeXBlPXUuVHlwZT12b2lkIDA7dmFyIHM9Syg3NTgpLHE9bmV3IE1hcChbWyInYSIsIlx1MDNCMSJdLFsiJ2IiLCJcdTAzQjIiXSxbIidjIiwiXHUwM0IzIl0sWyInZCIsIlx1MDNCNCJdLFsiJ2UiLCJcdTAzQjUiXSxbIidmIiwiXHUwM0I2Il0sWyInZyIsIlx1MDNCNyJdLFsiJ2giLCJcdTAzQjgiXSxbIidpIiwiXHUwM0I5Il0sWyInayIsIlx1MDNCQSJdLFsiJ2wiLCJcdTAzQkIiXSxbIidtIiwiXHUwM0JDIl0sWyInbiIsIlx1MDNCRCJdLFsiJ2oiLCJcdTAzQkUiXSxbIidvIiwiXHUwM0JGIl0sWyIncCIsIlx1MDNDMCJdLFsiJ3IiLCJcdTAzQzEiXSxbIidzIiwiXHUwM0MzIl0sWyIndCIsIlx1MDNDNCJdLFsiJ3UiLCJcdTAzQzUiXSxbIid2IiwiXHUwM0M2Il0sWyIneCIsIlx1MDNDNyJdLFsiJ3EiLCJcdTAzQzgiXSxbIid3IiwiXHUwM0M5Il1dKSxCPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gRSgpe31yZXR1cm4gRS5wcm90b3R5cGUuaW5zdGFudGlhdGU9ZnVuY3Rpb24ocixlLG8pe3Rocm93IG5ldyBzLkVsYWJvcmF0aW9uRXJyb3IoIkkgbXVzdG4ndCBydW4gYXdheS4gSSBtdXN0bid0IHJ1biBhd2F5LiBJIG11c3RuJ3QgcnVuIGF3YXkuIil9LEUucHJvdG90eXBlLm1lcmdlPWZ1bmN0aW9uKHIsZSxvKXt0aHJvdyBuZXcgcy5FbGFib3JhdGlvbkVycm9yKCJJIGRvbid0IGtub3cgYW55dGhpbmcuIEJ1dCB5b3Uga25vdyBldmVyeXRoaW5nLiIpfSxFLnByb3RvdHlwZS5tYWtlRXFUeXBlPWZ1bmN0aW9uKHIsZSl7dGhyb3cgbmV3IHMuRWxhYm9yYXRpb25FcnJvcigiSSBkb24ndCBrbm93IGV2ZXJ5dGhpbmcuIEkganVzdCBrbm93IHdoYXQgSSBrbm93LiIpfSxFLnByb3RvdHlwZS5nZXRUeXBlVmFyaWFibGVzPWZ1bmN0aW9uKHIpe3Rocm93IG5ldyBzLkVsYWJvcmF0aW9uRXJyb3IoYFRoaXMgaXMgd3JvbmcuCkkgc2FpZCB3aXRoIGEgcG9zZWQgbG9vay5gKX0sRS5wcm90b3R5cGUuZ2V0T3JkZXJlZFR5cGVWYXJpYWJsZXM9ZnVuY3Rpb24oKXt0aHJvdyBuZXcgcy5FbGFib3JhdGlvbkVycm9yKGBZb3Ugc2VlbSB3ZWxsIHRvZGF5LgpEaWQgc29tZXRoaW5nIG5pY2UgaGFwcGVuP2ApfSxFLnByb3RvdHlwZS5yZXBsYWNlVHlwZVZhcmlhYmxlcz1mdW5jdGlvbihyLGUpe3Rocm93IG5ldyBzLkVsYWJvcmF0aW9uRXJyb3IoIlx1MzA0Mlx1MzA5M1x1MzA1Rlx1MzBEMFx1MzBBQj8iKX0sRS5wcm90b3R5cGUucXVhbGlmeT1mdW5jdGlvbihyLGUpe3JldHVybiB0aGlzfSxFLnByb3RvdHlwZS5wcm9wYWdhdGU9ZnVuY3Rpb24ocil7cmV0dXJuIHRoaXN9LEUucHJvdG90eXBlLm1ha2VGcmVlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LEUucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXN9LEUucHJvdG90eXBlLmlzT3BhcXVlPWZ1bmN0aW9uKCl7cmV0dXJuITF9LEUucHJvdG90eXBlLmdldE9wYXF1ZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4idW5kZWZpbmVkIn0sRS5wcm90b3R5cGUuaXNSZXNvbHZlZD1mdW5jdGlvbigpe3JldHVybiExfSxFLnByb3RvdHlwZS5hZG1pdHNFcXVhbGl0eT1mdW5jdGlvbihyKXtyZXR1cm4hMX0sRS5wcm90b3R5cGUuZmxhdHRlbj1mdW5jdGlvbihyKXtyZXR1cm4gdGhpc30sRS5wcm90b3R5cGUucmVwbGFjZT1mdW5jdGlvbihyLGUpe3JldHVybiByLmVxdWFscyh0aGlzKT9lOnRoaXN9LEUucHJvdG90eXBlLm5vcm1hbGl6ZT1mdW5jdGlvbihyLGUpe3I9PT12b2lkIDAmJihyPTApLGU9PT12b2lkIDAmJihlPXt9KTtmb3IodmFyIG89dGhpcy5nZXRPcmRlcmVkVHlwZVZhcmlhYmxlcygpLHk9dGhpcy5nZXRUeXBlVmFyaWFibGVzKCEwKSxkPW5ldyBNYXAsdj0wLEM9MCxHPW87QzxHLmxlbmd0aDtDKyspe3ZhciBZPUdbQ107aWYoIWQuaGFzKFkpKXt2YXIgSj0iIix6PSsrdjtpZih5LmhhcyhZKSYmKHo9KytyKSx6PD0yNilKPVN0cmluZy5mcm9tQ2hhckNvZGUoImEiLmNoYXJDb2RlQXQoMCkrei0xKTtlbHNlIGZvcig7ej4wOyl7dmFyIHA9LS16JTI2O0o9U3RyaW5nLmZyb21DaGFyQ29kZSgiYSIuY2hhckNvZGVBdCgwKStwKStKLHo9TWF0aC5mbG9vcih6LzI2KX12YXIgYz0iJyI7WS5sZW5ndGg+MiYmWS5jaGFyQXQoMSk9PT0iJyImJihjKz0iJyIpLHkuaGFzKFkpJiYoYys9In4iKSxjKz1KLHkuaGFzKFkpJiYoYz1jLnRvVXBwZXJDYXNlKCkpLGQuc2V0KFksYyl9fXZhciB3PXRoaXMucmVwbGFjZVR5cGVWYXJpYWJsZXMoZCk7cmV0dXJuIGUuc3RyaWN0TW9kZSE9PSExJiYodz13LmZsYXR0ZW4obmV3IE1hcCkpLFt3LHJdfSxFfSgpO3UuVHlwZT1CO3ZhciBNPWZ1bmN0aW9uKEUpe2Z1bmN0aW9uIHIoKXtyZXR1cm4gRS5jYWxsKHRoaXMpfHx0aGlzfXJldHVybiBnKHIsRSksci5wcm90b3R5cGUuaXNSZXNvbHZlZD1mdW5jdGlvbigpe3JldHVybiEwfSxyLnByb3RvdHlwZS50eXBlTmFtZT1mdW5jdGlvbigpe3JldHVybiJBbnlUeXBlIn0sci5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oZSl7cmV0dXJuImFueSJ9LHIucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihlKXtyZXR1cm4hMH0sci5wcm90b3R5cGUuaW5zdGFudGlhdGU9ZnVuY3Rpb24oZSxvLHkpe3JldHVybiB0aGlzfSxyLnByb3RvdHlwZS5tZXJnZT1mdW5jdGlvbihlLG8seSl7cmV0dXJuW3ksb119LHIucHJvdG90eXBlLm1ha2VFcVR5cGU9ZnVuY3Rpb24oZSxvKXtyZXR1cm5bdGhpcyxvXX0sci5wcm90b3R5cGUuZ2V0VHlwZVZhcmlhYmxlcz1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IE1hcH0sci5wcm90b3R5cGUuZ2V0T3JkZXJlZFR5cGVWYXJpYWJsZXM9ZnVuY3Rpb24oKXtyZXR1cm5bXX0sci5wcm90b3R5cGUucmVwbGFjZVR5cGVWYXJpYWJsZXM9ZnVuY3Rpb24oZSxvKXtyZXR1cm4gdGhpc30scn0oQik7dS5BbnlUeXBlPU07dmFyIFY9ZnVuY3Rpb24oRSl7ZnVuY3Rpb24gcihlLG8seSl7eT09PXZvaWQgMCYmKHk9W10pO3ZhciBkPUUuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gZC5uYW1lPWUsZC50eXBlPW8sZC5kb21haW49eSxkLmlzRnJlZT0hMSxkfXJldHVybiBnKHIsRSksci5wcm90b3R5cGUuaXNSZXNvbHZlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnR5cGUuaXNSZXNvbHZlZCgpfSxyLnByb3RvdHlwZS5zaW1wbGlmeT1mdW5jdGlvbigpe3ZhciBlPW5ldyByKHRoaXMubmFtZSx0aGlzLnR5cGUuc2ltcGxpZnkoKSx0aGlzLmRvbWFpbik7cmV0dXJuIGUuaXNGcmVlPXRoaXMuaXNGcmVlLGV9LHIucHJvdG90eXBlLm1ha2VGcmVlPWZ1bmN0aW9uKCl7dmFyIGU9bmV3IHIodGhpcy5uYW1lLHRoaXMudHlwZS5tYWtlRnJlZSgpLHRoaXMuZG9tYWluKTtyZXR1cm4gZS5pc0ZyZWU9ITAsZX0sci5wcm90b3R5cGUuZmxhdHRlbj1mdW5jdGlvbihlKXtpZih0aGlzLmRvbWFpbi5sZW5ndGg+MClyZXR1cm4gZT1lLnNldCh0aGlzLm5hbWUsdGhpcy5kb21haW5bMF0pLHRoaXMudHlwZS5mbGF0dGVuKGUpO3ZhciBvPW5ldyByKHRoaXMubmFtZSx0aGlzLnR5cGUuZmxhdHRlbihlKSx0aGlzLmRvbWFpbik7cmV0dXJuIG8uaXNGcmVlPXRoaXMuaXNGcmVlLG99LHIucHJvdG90eXBlLnF1YWxpZnk9ZnVuY3Rpb24oZSxvKXt2YXIgeT1uZXcgcih0aGlzLm5hbWUsdGhpcy50eXBlLnF1YWxpZnkoZSxvKSx0aGlzLmRvbWFpbik7cmV0dXJuIHkuaXNGcmVlPXRoaXMuaXNGcmVlLHl9LHIucHJvdG90eXBlLnByb3BhZ2F0ZT1mdW5jdGlvbihlKXtlPT09dm9pZCAwJiYoZT1uZXcgTWFwKSx0aGlzLmRvbWFpbi5sZW5ndGg+MCYmKGU9ZS5zZXQodGhpcy5uYW1lLHRoaXMuZG9tYWluKSk7dmFyIG89bmV3IHIodGhpcy5uYW1lLHRoaXMudHlwZS5wcm9wYWdhdGUoZSksdGhpcy5kb21haW4pO3JldHVybiBvLmlzRnJlZT10aGlzLmlzRnJlZSxvfSxyLnByb3RvdHlwZS5pc09wYXF1ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnR5cGUuaXNPcGFxdWUoKX0sci5wcm90b3R5cGUuZ2V0T3BhcXVlTmFtZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnR5cGUuZ2V0T3BhcXVlTmFtZSgpfSxyLnByb3RvdHlwZS5pbnN0YW50aWF0ZT1mdW5jdGlvbihlLG8pe3ZhciB5PW5ldyByKHRoaXMubmFtZSx0aGlzLnR5cGUuaW5zdGFudGlhdGUoZSxvKSx0aGlzLmRvbWFpbik7cmV0dXJuIHkuaXNGcmVlPXRoaXMuaXNGcmVlLHl9LHIucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIlR5cGVWYXJpYWJsZUJpbmQifSxyLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbihlKXtlPT09dm9pZCAwJiYoZT17fSk7Zm9yKHZhciBvPW5ldyBTZXQseT1uZXcgU2V0LGQ9dGhpcztkIGluc3RhbmNlb2YgcjspZC5pc0ZyZWU/bz1vLmFkZChbZC5uYW1lLGQuZG9tYWluXSk6eT15LmFkZChbZC5uYW1lLGQuZG9tYWluXSksZD1kLnR5cGU7dmFyIHY9IiI7cmV0dXJuIHkuc2l6ZT4wJiYodis9Ilx1MjIwMCIseS5mb3JFYWNoKGZ1bmN0aW9uKEMpe2lmKGUuc2hvd1R5cGVWYXJpYWJsZXNBc1VuaWNvZGU9PT0hMCYmcS5oYXMoQ1swXSk/dis9IiAiK3EuZ2V0KENbMF0pOmUuc2hvd1R5cGVWYXJpYWJsZXNBc1VuaWNvZGU9PT0hMCYmcS5oYXMoQ1swXS5zdWJzdHIoMSkpP3YrPSIgJyIrcS5nZXQoQ1swXS5zdWJzdHIoMSkpOnYrPSIgIitDWzBdLENbMV0ubGVuZ3RoPjApe3YrPSIgXHUyMjA4IHsiO2Zvcih2YXIgRz0wO0c8Q1sxXS5sZW5ndGg7KytHKUc+MCYmKHYrPSIsICIpLHYrPUNbMV1bR107dis9In0ifX0pLHYrPSIgLiAiKSx2Kz1kLnRvU3RyaW5nKGUpLG8uc2l6ZT4wJiYodis9IiwiLG8uZm9yRWFjaChmdW5jdGlvbihDKXtpZihlLnNob3dUeXBlVmFyaWFibGVzQXNVbmljb2RlPT09ITAmJnEuaGFzKENbMF0pP3YrPSIgIitxLmdldChDWzBdKTplLnNob3dUeXBlVmFyaWFibGVzQXNVbmljb2RlPT09ITAmJnEuaGFzKENbMF0uc3Vic3RyKDEpKT92Kz0iICciK3EuZ2V0KENbMF0uc3Vic3RyKDEpKTp2Kz0iICIrQ1swXSxDWzFdLmxlbmd0aD4wKXt2Kz0iIFx1MjIwOCB7Ijtmb3IodmFyIEc9MDtHPENbMV0ubGVuZ3RoOysrRylHPjAmJih2Kz0iLCAiKSx2Kz1DWzFdW0ddO3YrPSJ9In19KSx2Kz0iIGZyZWUiKSx2fSxyLnByb3RvdHlwZS5nZXRUeXBlVmFyaWFibGVzPWZ1bmN0aW9uKGUpe3ZhciBvPXRoaXM7ZT09PXZvaWQgMCYmKGU9ITEpO3ZhciB5PXRoaXMudHlwZS5nZXRUeXBlVmFyaWFibGVzKGUpLGQ9bmV3IE1hcDtyZXR1cm4geS5mb3JFYWNoKGZ1bmN0aW9uKHYsQyl7Qz09PW8ubmFtZSYmZSE9PW8uaXNGcmVlfHwoZD1kLmhhcyhDKT9kLnNldChDLEQubWVyZ2VEb21haW4odixkLmdldChDKSkpOmQuc2V0KEMsdikpfSksZSYmdGhpcy5pc0ZyZWUmJiFkLmhhcyh0aGlzLm5hbWUpJiYoZD1kLnNldCh0aGlzLm5hbWUsdGhpcy5kb21haW4pKSxkfSxyLnByb3RvdHlwZS5nZXRPcmRlcmVkVHlwZVZhcmlhYmxlcz1mdW5jdGlvbigpe3JldHVyblt0aGlzLm5hbWVdLmNvbmNhdCh0aGlzLnR5cGUuZ2V0T3JkZXJlZFR5cGVWYXJpYWJsZXMoKSl9LHIucHJvdG90eXBlLnJlcGxhY2VUeXBlVmFyaWFibGVzPWZ1bmN0aW9uKGUsbyl7aWYobz09PXZvaWQgMCYmKG89bmV3IFNldCksZS5oYXModGhpcy5uYW1lKSl7dmFyIHk9bmV3IHIoZS5nZXQodGhpcy5uYW1lKSx0aGlzLnR5cGUucmVwbGFjZVR5cGVWYXJpYWJsZXMoZSxvKSx0aGlzLmRvbWFpbik7cmV0dXJuIG8uaGFzKHRoaXMubmFtZSk/eS5pc0ZyZWU9ITA6eS5pc0ZyZWU9dGhpcy5pc0ZyZWUseX1yZXR1cm4oeT1uZXcgcih0aGlzLm5hbWUsdGhpcy50eXBlLnJlcGxhY2VUeXBlVmFyaWFibGVzKGUsbyksdGhpcy5kb21haW4pKS5pc0ZyZWU9dGhpcy5pc0ZyZWUseX0sci5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKGUpe3JldHVybiBlIGluc3RhbmNlb2YgciYmZS5uYW1lPT09dGhpcy5uYW1lJiZlLnR5cGUuZXF1YWxzKHRoaXMudHlwZSl9LHJ9KEIpO3UuVHlwZVZhcmlhYmxlQmluZD1WO3ZhciBEPWZ1bmN0aW9uKEUpe2Z1bmN0aW9uIHIoZSxvKXtvPT09dm9pZCAwJiYobz1bXSk7dmFyIHk9RS5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiB5Lm5hbWU9ZSx5LmRvbWFpbj1vLHkuaXNGcmVlPSExLHl9cmV0dXJuIGcocixFKSxyLm1lcmdlRG9tYWluPWZ1bmN0aW9uKGUsbyl7aWYoZS5sZW5ndGg9PT0wKXJldHVybiBvO2lmKG8ubGVuZ3RoPT09MClyZXR1cm4gZTtmb3IodmFyIHk9W10sZD0wLHY9ZTtkPHYubGVuZ3RoO2QrKylmb3IodmFyIEM9dltkXSxHPTAsWT1vO0c8WS5sZW5ndGg7RysrKXt2YXIgSj1ZW0ddO0MuZXF1YWxzKEopJiZ5LnB1c2goQyl9cmV0dXJuIHl9LHIuZ2V0VW51c2VkVHlwZVZhcmlhYmxlTmFtZT1mdW5jdGlvbihlLG8seSxkLHYpe289PT12b2lkIDAmJihvPSInKnQwIikseT09PXZvaWQgMCYmKHk9bmV3IFNldCksZD09PXZvaWQgMCYmKGQ9bmV3IE1hcCksdj09PXZvaWQgMCYmKHY9bmV3IFNldCk7Zm9yKHZhciBDPStvLnN1YnN0cmluZygzKSsxOzsrK0MpaWYobz0iJyIrb1sxXStvWzJdK0MsIXYuaGFzKG8pJiYheS5oYXMobykmJiFkLmhhcyhvKSYmZS5nZXRTdGF0aWNWYWx1ZShvKT09PXZvaWQgMClyZXR1cm4gbzt0aHJvdyBuZXcgcy5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIiIpfSxyLnByb3RvdHlwZS5pc1Jlc29sdmVkPWZ1bmN0aW9uKCl7cmV0dXJuITB9LHIucHJvdG90eXBlLm1ha2VGcmVlPWZ1bmN0aW9uKCl7dmFyIGU9bmV3IHIodGhpcy5uYW1lLHRoaXMuZG9tYWluKTtyZXR1cm4gZS5pc0ZyZWU9ITAsZX0sci5wcm90b3R5cGUuZmxhdHRlbj1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5kb21haW4ubGVuZ3RoPjA/KGU9ZS5zZXQodGhpcy5uYW1lLHRoaXMuZG9tYWluWzBdKSx0aGlzLmRvbWFpblswXSk6ZS5oYXModGhpcy5uYW1lKT9lLmdldCh0aGlzLm5hbWUpOnRoaXN9LHIucHJvdG90eXBlLnByb3BhZ2F0ZT1mdW5jdGlvbihlKXtlPT09dm9pZCAwJiYoZT1uZXcgTWFwKTt2YXIgbz1bXTtlLmhhcyh0aGlzLm5hbWUpJiYobz1lLmdldCh0aGlzLm5hbWUpKTt2YXIgeT1uZXcgcih0aGlzLm5hbWUsbyk7cmV0dXJuIHkuaXNGcmVlPXRoaXMuaXNGcmVlLHl9LHIucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIlR5cGVWYXJpYWJsZSJ9LHIucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKGUpe3JldHVybiBlPT09dm9pZCAwJiYoZT17fSksZS5zaG93VHlwZVZhcmlhYmxlc0FzVW5pY29kZT09PSEwJiZxLmhhcyh0aGlzLm5hbWUpP3EuZ2V0KHRoaXMubmFtZSk6ZS5zaG93VHlwZVZhcmlhYmxlc0FzVW5pY29kZT09PSEwJiZxLmhhcyh0aGlzLm5hbWUuc3Vic3RyKDEpKT8iJyIrcS5nZXQodGhpcy5uYW1lLnN1YnN0cigxKSk6dGhpcy5uYW1lfSxyLnByb3RvdHlwZS5pbnN0YW50aWF0ZT1mdW5jdGlvbihlLG8seSl7aWYoeT09PXZvaWQgMCYmKHk9bmV3IFNldCksIW8uaGFzKHRoaXMubmFtZSkpcmV0dXJuIHRoaXM7aWYoeS5oYXModGhpcy5uYW1lKSl0aHJvdyBuZXcgcy5FbGFib3JhdGlvbkVycm9yKCdUeXBlIGNsYXNoLiBBbiBleHByZXNzaW9uIG9mIHR5cGUgIicrdGhpcy5ub3JtYWxpemUoKVswXSsnIiBjYW5ub3QgaGF2ZSB0eXBlICInK28uZ2V0KHRoaXMubmFtZSlbMF0ubm9ybWFsaXplKClbMF0rJyIgYmVjYXVzZSBvZiBjaXJjdWxhcml0eS4nKTt2YXIgZD1uZXcgU2V0O3kuZm9yRWFjaChmdW5jdGlvbihDKXtkLmFkZChDKX0pLGQuYWRkKHRoaXMubmFtZSk7dmFyIHY9by5nZXQodGhpcy5uYW1lKVswXTtyZXR1cm4gdiBpbnN0YW5jZW9mIGgmJiF2LmNvbXBsZXRlJiZ2LnNvdXJjZVR5VmFyPT09dm9pZCAwJiYodi5zb3VyY2VUeVZhcj10aGlzLm5hbWUpLHYuaW5zdGFudGlhdGUoZSxvLGQpfSxyLnByb3RvdHlwZS5tZXJnZT1mdW5jdGlvbihlLG8seSl7aWYoeSBpbnN0YW5jZW9mIE0pcmV0dXJuW3RoaXMsb107dmFyIGQ9dGhpcy5pbnN0YW50aWF0ZShlLG8pO2lmKGQgaW5zdGFuY2VvZiByKXt2YXIgdj15Lmluc3RhbnRpYXRlKGUsbyk7aWYodiBpbnN0YW5jZW9mIHIpe2lmKGQubmFtZT09PXYubmFtZSl7dmFyIEM9ci5tZXJnZURvbWFpbihkLmRvbWFpbix2LmRvbWFpbik7aWYoQy5sZW5ndGg9PT0wJiZkLmRvbWFpbi5sZW5ndGgrdi5kb21haW4ubGVuZ3RoPjApdGhyb3dbJ0Nhbm5vdCBtZXJnZSBkb21haW5zIG9mICInK2Qubm9ybWFsaXplKDAse3N0cmljdE1vZGU6ITF9KVswXSsnIiBhbmQgIicreS5ub3JtYWxpemUoMCx7c3RyaWN0TW9kZTohMX0pWzBdKyciICh7JytkLmRvbWFpbisifSBhbmQgeyIrdi5kb21haW4rIn0pIl07dmFyIEc9bmV3IHIoZC5uYW1lLEMpO3JldHVybiBHLmlzRnJlZT1kLmlzRnJlZSYmdi5pc0ZyZWUsW0csb119dmFyIFk9bmV3IE1hcCxKPWQ7aWYoZC5uYW1lPHYubmFtZT8oZC5kb21haW49ci5tZXJnZURvbWFpbihkLmRvbWFpbix2LmRvbWFpbiksWS5zZXQodi5uYW1lLGQubmFtZSkpOih2LmRvbWFpbj1yLm1lcmdlRG9tYWluKGQuZG9tYWluLHYuZG9tYWluKSxZLnNldChkLm5hbWUsdi5uYW1lKSxKPXYpLEouZG9tYWluLmxlbmd0aD09PTAmJmQuZG9tYWluLmxlbmd0aCt2LmRvbWFpbi5sZW5ndGg+MCl0aHJvd1snQ2Fubm90IG1lcmdlIGRvbWFpbnMgb2YgIicrdGhpcy5ub3JtYWxpemUoMCx7c3RyaWN0TW9kZTohMX0pWzBdKyciIGFuZCAiJyt5Lm5vcm1hbGl6ZSgwLHtzdHJpY3RNb2RlOiExfSlbMF0rJyIuICh7JytkLmRvbWFpbisifSBhbmQgeyIrdi5kb21haW4rIn0pIl07dmFyIHo9bmV3IE1hcDtvLmZvckVhY2goZnVuY3Rpb24odyxUKXt6PXouc2V0KFQsW3dbMF0ucmVwbGFjZVR5cGVWYXJpYWJsZXMoWSksd1sxXV0pfSksSi5pc0ZyZWU9ZC5pc0ZyZWUmJnYuaXNGcmVlLGQubmFtZTx2Lm5hbWU/ei5zZXQodi5uYW1lLFtkLEouaXNGcmVlXSk6ei5zZXQoZC5uYW1lLFt2LEouaXNGcmVlXSk7dmFyIHA9Si5kb21haW47cmV0dXJuIHouaGFzKCIkIitkLm5hbWUpJiYocD1yLm1lcmdlRG9tYWluKHAsei5nZXQoIiQiK2QubmFtZSlbMF0uZG9tYWluKSksei5oYXMoIiQiK3YubmFtZSkmJihwPXIubWVyZ2VEb21haW4ocCx6LmdldCgiJCIrdi5uYW1lKVswXS5kb21haW4pKSx6LnNldCgiJCIrZC5uYW1lLFtuZXcgcihkLm5hbWUscCksSi5pc0ZyZWVdKSx6LnNldCgiJCIrdi5uYW1lLFtuZXcgcih2Lm5hbWUscCksSi5pc0ZyZWVdKSxbSix6XX1pZih2LmdldFR5cGVWYXJpYWJsZXMoKS5oYXMoZC5uYW1lKSl0aHJvdyBuZXcgcy5FbGFib3JhdGlvbkVycm9yKCdUeXBlIGNsYXNoLiBBbiBleHByZXNzaW9uIG9mIHR5cGUgIicrZC5ub3JtYWxpemUoKVswXSsnIiBjYW5ub3QgaGF2ZSB0eXBlICInK3Yubm9ybWFsaXplKClbMF0rJyIgYmVjYXVzZSBvZiBjaXJjdWxhcml0eS4nKTtpZihkLmlzRnJlZSYmKHY9di5tYWtlRnJlZSgpKSxkLmFkbWl0c0VxdWFsaXR5KGUpJiYhdi5hZG1pdHNFcXVhbGl0eShlKSl7dmFyIGM9di5tYWtlRXFUeXBlKGUsbyk7aWYoIWNbMF0uYWRtaXRzRXF1YWxpdHkoZSkpdGhyb3dbJ1R5cGUgIicrdi5ub3JtYWxpemUoKVswXSsnIiBkb2VzIG5vdCBhZG1pdCBlcXVhbGl0eS4nLGQsdl07dj1jWzBdLG89Y1sxXX1pZihkLmRvbWFpbi5sZW5ndGg+MCYmci5tZXJnZURvbWFpbihkLmRvbWFpbixbdl0pLmxlbmd0aD09PTApdGhyb3dbJ1R5cGUgIicrdi5ub3JtYWxpemUoMCx7c3RyaWN0TW9kZTohMX0pWzBdKyciIGlzIG5vdCBwYXJ0IG9mIHRoZSBkb21haW4gb2YgIicrZC5ub3JtYWxpemUoMCx7c3RyaWN0TW9kZTohMX0pWzBdKyciICh7JytkLmRvbWFpbisifSkuIl07cmV0dXJuW3Ysby5zZXQoZC5uYW1lLFt2LGQuaXNGcmVlXSldfXJldHVybiBkLm1lcmdlKGUsbyx5KX0sci5wcm90b3R5cGUubWFrZUVxVHlwZT1mdW5jdGlvbihlLG8pe2lmKHRoaXMuYWRtaXRzRXF1YWxpdHkoZSkpcmV0dXJuW3RoaXMsb107aWYoby5oYXModGhpcy5uYW1lKSl7dmFyIHk9by5nZXQodGhpcy5uYW1lKVswXS5tYWtlRXFUeXBlKGUsbyk7aWYoeVswXWluc3RhbmNlb2YgciYmeVswXS5uYW1lIT09IiciK3RoaXMubmFtZSl7bz15WzFdO3ZhciBkPW5ldyByKCInIit0aGlzLm5hbWUsdGhpcy5kb21haW4pO2QuaXNGcmVlPXRoaXMuaXNGcmVlLG89by5zZXQoZC5uYW1lLFt5WzBdLGQuaXNGcmVlXSl9fXZhciB2PW5ldyByKCInIit0aGlzLm5hbWUsdGhpcy5kb21haW4pO3JldHVyblt2LG8uc2V0KHRoaXMubmFtZSxbdix0aGlzLmlzRnJlZV0pXX0sci5wcm90b3R5cGUuZ2V0VHlwZVZhcmlhYmxlcz1mdW5jdGlvbihlKXtlPT09dm9pZCAwJiYoZT0hMSk7dmFyIG89bmV3IE1hcDtyZXR1cm4gZSYmIXRoaXMuaXNGcmVlfHwobz1vLnNldCh0aGlzLm5hbWUsdGhpcy5kb21haW4pKSxvfSxyLnByb3RvdHlwZS5nZXRPcmRlcmVkVHlwZVZhcmlhYmxlcz1mdW5jdGlvbigpe3JldHVyblt0aGlzLm5hbWVdfSxyLnByb3RvdHlwZS5yZXBsYWNlVHlwZVZhcmlhYmxlcz1mdW5jdGlvbihlLG8pe2lmKG89PT12b2lkIDAmJihvPW5ldyBTZXQpLGUuaGFzKHRoaXMubmFtZSkpe3ZhciB5PW5ldyByKGUuZ2V0KHRoaXMubmFtZSksdGhpcy5kb21haW4pO3JldHVybiBvLmhhcyh0aGlzLm5hbWUpP3kuaXNGcmVlPSEwOnkuaXNGcmVlPXRoaXMuaXNGcmVlLHl9cmV0dXJuIHRoaXN9LHIucHJvdG90eXBlLmFkbWl0c0VxdWFsaXR5PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLm5hbWVbMV09PT0iJyJ9LHIucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIE18fGUgaW5zdGFuY2VvZiByJiZ0aGlzLm5hbWU9PT1lLm5hbWV9LHJ9KEIpO3UuVHlwZVZhcmlhYmxlPUQ7dmFyIGg9ZnVuY3Rpb24oRSl7ZnVuY3Rpb24gcihlLG8seSl7bz09PXZvaWQgMCYmKG89ITApLHk9PT12b2lkIDAmJih5PXZvaWQgMCk7dmFyIGQ9RS5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiBkLmVsZW1lbnRzPWUsZC5jb21wbGV0ZT1vLGQuc291cmNlVHlWYXI9eSxkLnR1cGxlZnkoKSxkLmNvbXBsZXRlJiYoZC5zb3VyY2VUeVZhcj12b2lkIDApLGR9cmV0dXJuIGcocixFKSxyLnByb3RvdHlwZS5pc1Jlc29sdmVkPWZ1bmN0aW9uKCl7aWYoIXRoaXMuY29tcGxldGUpcmV0dXJuITE7dmFyIGU9ITA7cmV0dXJuIHRoaXMuZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbihvLHkpe2U9ZSYmby5pc1Jlc29sdmVkKCl9KSxlfSxyLnByb3RvdHlwZS5tYWtlRnJlZT1mdW5jdGlvbigpe3ZhciBlPW5ldyBNYXA7cmV0dXJuIHRoaXMuZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbihvLHkpe2Uuc2V0KHksby5tYWtlRnJlZSgpKX0pLG5ldyByKGUsdGhpcy5jb21wbGV0ZSx0aGlzLnNvdXJjZVR5VmFyKX0sci5wcm90b3R5cGUucmVwbGFjZT1mdW5jdGlvbihlLG8pe2lmKGUuZXF1YWxzKHRoaXMpKXJldHVybiBvO3ZhciB5PW5ldyBNYXA7cmV0dXJuIHRoaXMuZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbihkLHYpe3kuc2V0KHYsZC5yZXBsYWNlKGUsbykpfSksbmV3IHIoeSx0aGlzLmNvbXBsZXRlLHRoaXMuc291cmNlVHlWYXIpfSxyLnByb3RvdHlwZS5mbGF0dGVuPWZ1bmN0aW9uKGUpe3ZhciBvPW5ldyBNYXA7cmV0dXJuIHRoaXMuZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbih5LGQpe28uc2V0KGQseS5mbGF0dGVuKGUpKX0pLG5ldyByKG8sdGhpcy5jb21wbGV0ZSx0aGlzLnNvdXJjZVR5VmFyKX0sci5wcm90b3R5cGUuaW5zdGFudGlhdGU9ZnVuY3Rpb24oZSxvLHkpe3k9PT12b2lkIDAmJih5PW5ldyBTZXQpO3ZhciBkPW5ldyBNYXA7cmV0dXJuIHRoaXMuZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbih2LEMpe2Quc2V0KEMsdi5pbnN0YW50aWF0ZShlLG8seSkpfSksbmV3IHIoZCx0aGlzLmNvbXBsZXRlLHRoaXMuc291cmNlVHlWYXIpfSxyLnByb3RvdHlwZS5xdWFsaWZ5PWZ1bmN0aW9uKGUsbyl7dmFyIHk9bmV3IE1hcDtyZXR1cm4gdGhpcy5lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uKGQsdil7eS5zZXQodixkLnF1YWxpZnkoZSxvKSl9KSxuZXcgcih5LHRoaXMuY29tcGxldGUsdGhpcy5zb3VyY2VUeVZhcil9LHIucHJvdG90eXBlLnByb3BhZ2F0ZT1mdW5jdGlvbihlKXtlPT09dm9pZCAwJiYoZT1uZXcgTWFwKTt2YXIgbz1uZXcgTWFwO3JldHVybiB0aGlzLmVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24oeSxkKXtvLnNldChkLHkucHJvcGFnYXRlKGUpKX0pLG5ldyByKG8sdGhpcy5jb21wbGV0ZSx0aGlzLnNvdXJjZVR5VmFyKX0sci5wcm90b3R5cGUubWVyZ2U9ZnVuY3Rpb24oZSxvLHkpe3ZhciBkPXRoaXM7aWYoeSBpbnN0YW5jZW9mIER8fHkgaW5zdGFuY2VvZiBNKXJldHVybiB5Lm1lcmdlKGUsbyx0aGlzKTtpZigoeT15Lmluc3RhbnRpYXRlKGUsbykpaW5zdGFuY2VvZiByKXtpZighdGhpcy5jb21wbGV0ZSYmeS5jb21wbGV0ZSlyZXR1cm4geS5tZXJnZShlLG8sdGhpcyk7dmFyIHY9bmV3IE1hcCxDPW87eS5lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uKEoseil7aWYoZC5jb21wbGV0ZSYmIWQuZWxlbWVudHMuaGFzKHopKXRocm93W2BSZWNvcmRzIGRvbid0IGFncmVlIG9uIG1lbWJlcnMgKCJgK3orJyIgb2NjdXJzIG9ubHkgb25jZS4pJyxkLmluc3RhbnRpYXRlKGUsQykseS5pbnN0YW50aWF0ZShlLEMpXTtpZihkLmVsZW1lbnRzLmhhcyh6KSl7dmFyIHA9Si5tZXJnZShlLEMsZC5lbGVtZW50cy5nZXQoeikpO3Y9di5zZXQoeixwWzBdKSxDPXBbMV19ZWxzZSB2PXYuc2V0KHosSi5pbnN0YW50aWF0ZShlLEMpKX0pLHkuY29tcGxldGU/dGhpcy5lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uKEoseil7aWYoIXkuZWxlbWVudHMuaGFzKHopKXRocm93W2BSZWNvcmRzIGRvbid0IGFncmVlIG9uIG1lbWJlcnMgKCJgK3orJyIgb2NjdXJzIG9ubHkgb25jZS4pJyxkLmluc3RhbnRpYXRlKGUsQykseS5pbnN0YW50aWF0ZShlLEMpXX0pOnRoaXMuZWxlbWVudHMuZm9yRWFjaChmdW5jdGlvbihKLHope3Y9di5zZXQoeixKLmluc3RhbnRpYXRlKGUsQykpfSk7dmFyIEc9dGhpcy5jb21wbGV0ZT92b2lkIDA6dGhpcy5zb3VyY2VUeVZhcjtpZihHPT09dm9pZCAwJiYheS5jb21wbGV0ZSYmKEc9eS5zb3VyY2VUeVZhcikhPT12b2lkIDApe3ZhciBZPUMuZ2V0KEcpO1khPT12b2lkIDAmJihDPUMuc2V0KEcsW25ldyByKHYsdGhpcy5jb21wbGV0ZXx8eS5jb21wbGV0ZSxHKSxZWzFdXSkpfXJldHVybltuZXcgcih2LHRoaXMuY29tcGxldGV8fHkuY29tcGxldGUsRyksQ119dGhyb3dbJ0Nhbm5vdCBtZXJnZSAiJyt0aGlzLmluc3RhbnRpYXRlKGUsbykubm9ybWFsaXplKClbMF0rJyIgYW5kICInK3kuaW5zdGFudGlhdGUoZSxvKS5ub3JtYWxpemUoKVswXSsnIi4nLHRoaXMudHlwZU5hbWUoKSx5LnR5cGVOYW1lKCldfSxyLnByb3RvdHlwZS5tYWtlRXFUeXBlPWZ1bmN0aW9uKGUsbyl7dmFyIHk9bmV3IE1hcDtyZXR1cm4gdGhpcy5lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uKGQsdil7dmFyIEM9ZC5tYWtlRXFUeXBlKGUsbyk7eS5zZXQodixDWzBdKSxvPUNbMV19KSxbbmV3IHIoeSx0aGlzLmNvbXBsZXRlLHRoaXMuc291cmNlVHlWYXIpLG9dfSxyLnByb3RvdHlwZS5nZXRUeXBlVmFyaWFibGVzPWZ1bmN0aW9uKGUpe2U9PT12b2lkIDAmJihlPSExKTt2YXIgbz1uZXcgTWFwO3JldHVybiB0aGlzLmVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24oeSl7eS5nZXRUeXBlVmFyaWFibGVzKGUpLmZvckVhY2goZnVuY3Rpb24oZCx2KXtvPW8uaGFzKHYpP28uc2V0KHYsRC5tZXJnZURvbWFpbihkLG8uZ2V0KHYpKSk6by5zZXQodixkKX0pfSksb30sci5wcm90b3R5cGUuZ2V0T3JkZXJlZFR5cGVWYXJpYWJsZXM9ZnVuY3Rpb24oKXt2YXIgZT1bXTtyZXR1cm4gdGhpcy5lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uKG8pe2U9ZS5jb25jYXQoby5nZXRPcmRlcmVkVHlwZVZhcmlhYmxlcygpKX0pLGV9LHIucHJvdG90eXBlLnJlcGxhY2VUeXBlVmFyaWFibGVzPWZ1bmN0aW9uKGUsbyl7bz09PXZvaWQgMCYmKG89bmV3IFNldCk7dmFyIHk9bmV3IE1hcDtyZXR1cm4gdGhpcy5lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uKGQsdil7eT15LnNldCh2LGQucmVwbGFjZVR5cGVWYXJpYWJsZXMoZSxvKSl9KSxuZXcgcih5LHRoaXMuY29tcGxldGUsdGhpcy5zb3VyY2VUeVZhcil9LHIucHJvdG90eXBlLmdldFR5cGU9ZnVuY3Rpb24oZSl7aWYoIXRoaXMuZWxlbWVudHMuaGFzKGUpKXRocm93IG5ldyBzLkVsYWJvcmF0aW9uRXJyb3IoIlRyaWVkIGFjY2Vzc2luZyBub24tZXhpc3RpbmcgcmVjb3JkIHBhcnQuIik7cmV0dXJuIHRoaXMuZWxlbWVudHMuZ2V0KGUpfSxyLnByb3RvdHlwZS5oYXNUeXBlPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmVsZW1lbnRzLmhhcyhlKX0sci5wcm90b3R5cGUuc2V0VHlwZT1mdW5jdGlvbihlLG8pe2lmKHRoaXMuY29tcGxldGUpdGhyb3cgbmV3IHMuRWxhYm9yYXRpb25FcnJvcigiRG9uJ3QgdHJ5IHRvIGNoYW5nZSBhIGNvbXBsZXRlIHJlY29yZC4iKTt0aGlzLmVsZW1lbnRzPXRoaXMuZWxlbWVudHMuc2V0KGUsbyl9LHIucHJvdG90eXBlLmFkbWl0c0VxdWFsaXR5PWZ1bmN0aW9uKGUpe3ZhciBvPSEwO3JldHVybiB0aGlzLmVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24oeSxkKXt5LmFkbWl0c0VxdWFsaXR5KGUpfHwobz0hMSl9KSxvfSxyLnByb3RvdHlwZS50eXBlTmFtZT1mdW5jdGlvbigpe3JldHVybiJSZWNvcmRUeXBlIn0sci5wcm90b3R5cGUuaXNUdXBsZT1mdW5jdGlvbigpe2Zvcih2YXIgZT10aGlzLmVsZW1lbnRzLnNpemUhPT0xLG89MTtvPD10aGlzLmVsZW1lbnRzLnNpemU7KytvKXRoaXMuZWxlbWVudHMuaGFzKCIiK28pfHwoZT0hMSk7cmV0dXJuIGUmJnRoaXMuY29tcGxldGV9LHIucHJvdG90eXBlLnR1cGxlZnk9ZnVuY3Rpb24oKXtpZih0aGlzLmlzVHVwbGUoKSl7Zm9yKHZhciBlPW5ldyBNYXAsbz0xO288PXRoaXMuZWxlbWVudHMuc2l6ZTsrK28pe3ZhciB5PXRoaXMuZWxlbWVudHMuZ2V0KCIiK28pO2U9ZS5zZXQoIiIrbyx5KX10aGlzLmVsZW1lbnRzPWV9fSxyLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbihlKXtpZihlPT09dm9pZCAwJiYoZT17fSksdGhpcy5pc1R1cGxlKCkmJnRoaXMuY29tcGxldGUpe2lmKHRoaXMuZWxlbWVudHMuc2l6ZT09PTApcmV0dXJuInVuaXQiO2Zvcih2YXIgbz0iIix5PTE7eTw9dGhpcy5lbGVtZW50cy5zaXplOysreSl7eT4xJiYobys9IiAqICIpO3ZhciBkPXRoaXMuZWxlbWVudHMuZ2V0KCIiK3kpO2QgaW5zdGFuY2VvZiBBfHxkIGluc3RhbmNlb2YgciYmZC5lbGVtZW50cy5zaXplIT09MD9vKz0iKCIrZC50b1N0cmluZyhlKSsiKSI6bys9ZC50b1N0cmluZyhlKX1yZXR1cm4gbysiIn12YXIgdj0ieyIsQz0hMDtyZXR1cm4gdGhpcy5lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uKEcsWSl7Qz9DPSExOnYrPSIsICIsdis9WSsiOiAiK0cudG9TdHJpbmcoZSl9KSx0aGlzLmNvbXBsZXRlfHwoQ3x8KHYrPSIsICIpLHYrPSIuLi4iKSx2KyJ9In0sci5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXt2YXIgZT1uZXcgTWFwO3JldHVybiB0aGlzLmVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24obyx5KXtlLnNldCh5LG8uc2ltcGxpZnkoKSl9KSxuZXcgcihlLHRoaXMuY29tcGxldGUsdGhpcy5zb3VyY2VUeVZhcil9LHIucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihlKXtpZihlIGluc3RhbmNlb2YgTSlyZXR1cm4hMDtpZighKGUgaW5zdGFuY2VvZiByKXx8dGhpcy5jb21wbGV0ZSE9PWUuY29tcGxldGV8fHRoaXMuZWxlbWVudHMuc2l6ZSE9PWUuZWxlbWVudHMuc2l6ZSlyZXR1cm4hMTt2YXIgbz0hMDtyZXR1cm4gdGhpcy5lbGVtZW50cy5mb3JFYWNoKGZ1bmN0aW9uKHksZCl7eS5lcXVhbHMoZS5lbGVtZW50cy5nZXQoZCkpfHwobz0hMSl9KSxvfSxyfShCKTt1LlJlY29yZFR5cGU9aDt2YXIgQT1mdW5jdGlvbihFKXtmdW5jdGlvbiByKGUsbyl7dmFyIHk9RS5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiB5LnBhcmFtZXRlclR5cGU9ZSx5LnJldHVyblR5cGU9byx5fXJldHVybiBnKHIsRSksci5wcm90b3R5cGUuaXNSZXNvbHZlZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnBhcmFtZXRlclR5cGUuaXNSZXNvbHZlZCgpJiZ0aGlzLnJldHVyblR5cGUuaXNSZXNvbHZlZCgpfSxyLnByb3RvdHlwZS5tYWtlRnJlZT1mdW5jdGlvbigpe3JldHVybiBuZXcgcih0aGlzLnBhcmFtZXRlclR5cGUubWFrZUZyZWUoKSx0aGlzLnJldHVyblR5cGUubWFrZUZyZWUoKSl9LHIucHJvdG90eXBlLmZsYXR0ZW49ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyByKHRoaXMucGFyYW1ldGVyVHlwZS5mbGF0dGVuKGUpLHRoaXMucmV0dXJuVHlwZS5mbGF0dGVuKGUpKX0sci5wcm90b3R5cGUucmVwbGFjZT1mdW5jdGlvbihlLG8pe3JldHVybiB0aGlzLmVxdWFscyhlKT9vOm5ldyByKHRoaXMucGFyYW1ldGVyVHlwZS5yZXBsYWNlKGUsbyksdGhpcy5yZXR1cm5UeXBlLnJlcGxhY2UoZSxvKSl9LHIucHJvdG90eXBlLmluc3RhbnRpYXRlPWZ1bmN0aW9uKGUsbyx5KXtyZXR1cm4geT09PXZvaWQgMCYmKHk9bmV3IFNldCksbmV3IHIodGhpcy5wYXJhbWV0ZXJUeXBlLmluc3RhbnRpYXRlKGUsbyx5KSx0aGlzLnJldHVyblR5cGUuaW5zdGFudGlhdGUoZSxvLHkpKX0sci5wcm90b3R5cGUucXVhbGlmeT1mdW5jdGlvbihlLG8pe3JldHVybiBuZXcgcih0aGlzLnBhcmFtZXRlclR5cGUucXVhbGlmeShlLG8pLHRoaXMucmV0dXJuVHlwZS5xdWFsaWZ5KGUsbykpfSxyLnByb3RvdHlwZS5wcm9wYWdhdGU9ZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT12b2lkIDAmJihlPW5ldyBNYXApLG5ldyByKHRoaXMucGFyYW1ldGVyVHlwZS5wcm9wYWdhdGUoZSksdGhpcy5yZXR1cm5UeXBlLnByb3BhZ2F0ZShlKSl9LHIucHJvdG90eXBlLm1lcmdlPWZ1bmN0aW9uKGUsbyx5KXtpZih5IGluc3RhbmNlb2YgRHx8eSBpbnN0YW5jZW9mIE0pcmV0dXJuIHkubWVyZ2UoZSxvLHRoaXMpO3ZhciBkPXkuaW5zdGFudGlhdGUoZSxvKTtpZihkIGluc3RhbmNlb2Ygcil7dmFyIHY9dGhpcy5wYXJhbWV0ZXJUeXBlLm1lcmdlKGUsbyxkLnBhcmFtZXRlclR5cGUpLEM9dGhpcy5yZXR1cm5UeXBlLm1lcmdlKGUsdlsxXSxkLnJldHVyblR5cGUpO3JldHVybltuZXcgcih2WzBdLENbMF0pLENbMV1dfXRocm93WydDYW5ub3QgbWVyZ2UgIicrdGhpcy5pbnN0YW50aWF0ZShlLG8pLm5vcm1hbGl6ZSgpWzBdKyciIGFuZCAiJyt5Lmluc3RhbnRpYXRlKGUsbykubm9ybWFsaXplKClbMF0rJyIuJyx0aGlzLnR5cGVOYW1lKCkseS50eXBlTmFtZSgpXX0sci5wcm90b3R5cGUubWFrZUVxVHlwZT1mdW5jdGlvbihlLG8pe3JldHVyblt0aGlzLG9dfSxyLnByb3RvdHlwZS5nZXRUeXBlVmFyaWFibGVzPWZ1bmN0aW9uKGUpe2U9PT12b2lkIDAmJihlPSExKTt2YXIgbz1uZXcgTWFwO3JldHVybiB0aGlzLnBhcmFtZXRlclR5cGUuZ2V0VHlwZVZhcmlhYmxlcyhlKS5mb3JFYWNoKGZ1bmN0aW9uKHksZCl7bz1vLmhhcyhkKT9vLnNldChkLEQubWVyZ2VEb21haW4oeSxvLmdldChkKSkpOm8uc2V0KGQseSl9KSx0aGlzLnJldHVyblR5cGUuZ2V0VHlwZVZhcmlhYmxlcyhlKS5mb3JFYWNoKGZ1bmN0aW9uKHksZCl7bz1vLmhhcyhkKT9vLnNldChkLEQubWVyZ2VEb21haW4oeSxvLmdldChkKSkpOm8uc2V0KGQseSl9KSxvfSxyLnByb3RvdHlwZS5nZXRPcmRlcmVkVHlwZVZhcmlhYmxlcz1mdW5jdGlvbigpe3ZhciBlPVtdO3JldHVybihlPWUuY29uY2F0KHRoaXMucGFyYW1ldGVyVHlwZS5nZXRPcmRlcmVkVHlwZVZhcmlhYmxlcygpKSkuY29uY2F0KHRoaXMucmV0dXJuVHlwZS5nZXRPcmRlcmVkVHlwZVZhcmlhYmxlcygpKX0sci5wcm90b3R5cGUucmVwbGFjZVR5cGVWYXJpYWJsZXM9ZnVuY3Rpb24oZSxvKXtyZXR1cm4gbz09PXZvaWQgMCYmKG89bmV3IFNldCksbmV3IHIodGhpcy5wYXJhbWV0ZXJUeXBlLnJlcGxhY2VUeXBlVmFyaWFibGVzKGUsbyksdGhpcy5yZXR1cm5UeXBlLnJlcGxhY2VUeXBlVmFyaWFibGVzKGUsbykpfSxyLnByb3RvdHlwZS5hZG1pdHNFcXVhbGl0eT1mdW5jdGlvbihlKXtyZXR1cm4hMX0sci5wcm90b3R5cGUudHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4iRnVuY3Rpb25UeXBlIn0sci5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT12b2lkIDAmJihlPXt9KSx0aGlzLnBhcmFtZXRlclR5cGUgaW5zdGFuY2VvZiByPyIoIit0aGlzLnBhcmFtZXRlclR5cGUudG9TdHJpbmcoZSkrIikgXHUyMTkyICIrdGhpcy5yZXR1cm5UeXBlLnRvU3RyaW5nKGUpOnRoaXMucGFyYW1ldGVyVHlwZS50b1N0cmluZyhlKSsiIFx1MjE5MiAiK3RoaXMucmV0dXJuVHlwZS50b1N0cmluZyhlKX0sci5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHIodGhpcy5wYXJhbWV0ZXJUeXBlLnNpbXBsaWZ5KCksdGhpcy5yZXR1cm5UeXBlLnNpbXBsaWZ5KCkpfSxyLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBNfHxlIGluc3RhbmNlb2YgciYmdGhpcy5wYXJhbWV0ZXJUeXBlLmVxdWFscyhlLnBhcmFtZXRlclR5cGUpJiZ0aGlzLnJldHVyblR5cGUuZXF1YWxzKGUucmV0dXJuVHlwZSl9LHJ9KEIpO3UuRnVuY3Rpb25UeXBlPUE7dmFyIEk9ZnVuY3Rpb24oRSl7ZnVuY3Rpb24gcihlLG8seSxkLHYpe289PT12b2lkIDAmJihvPVtdKSx5PT09dm9pZCAwJiYoeT12b2lkIDApLGQ9PT12b2lkIDAmJihkPSExKSx2PT09dm9pZCAwJiYodj0wKTt2YXIgQz1FLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIEMubmFtZT1lLEMudHlwZUFyZ3VtZW50cz1vLEMucXVhbGlmaWVkTmFtZT15LEMub3BhcXVlPWQsQy5pZD12LEN9cmV0dXJuIGcocixFKSxyLnByb3RvdHlwZS5pc1Jlc29sdmVkPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPTA7ZTx0aGlzLnR5cGVBcmd1bWVudHMubGVuZ3RoOysrZSlpZighdGhpcy50eXBlQXJndW1lbnRzW2VdLmlzUmVzb2x2ZWQoKSlyZXR1cm4hMTtyZXR1cm4hMH0sci5wcm90b3R5cGUuaXNPcGFxdWU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vcGFxdWV9LHIucHJvdG90eXBlLmdldE9wYXF1ZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc09wYXF1ZSgpP3RoaXMubmFtZToidW5kZWZpbmVkIn0sci5wcm90b3R5cGUubWFrZUZyZWU9ZnVuY3Rpb24oKXtmb3IodmFyIGU9W10sbz0wO288dGhpcy50eXBlQXJndW1lbnRzLmxlbmd0aDsrK28pZS5wdXNoKHRoaXMudHlwZUFyZ3VtZW50c1tvXS5tYWtlRnJlZSgpKTtyZXR1cm4gbmV3IHIodGhpcy5uYW1lLGUsdGhpcy5xdWFsaWZpZWROYW1lLHRoaXMub3BhcXVlLHRoaXMuaWQpfSxyLnByb3RvdHlwZS5yZXBsYWNlPWZ1bmN0aW9uKGUsbyl7aWYodGhpcy5lcXVhbHMoZSkpcmV0dXJuIG87Zm9yKHZhciB5PVtdLGQ9MDtkPHRoaXMudHlwZUFyZ3VtZW50cy5sZW5ndGg7KytkKXkucHVzaCh0aGlzLnR5cGVBcmd1bWVudHNbZF0ucmVwbGFjZShlLG8pKTtyZXR1cm4gbmV3IHIodGhpcy5uYW1lLHksdGhpcy5xdWFsaWZpZWROYW1lLHRoaXMub3BhcXVlLHRoaXMuaWQpfSxyLnByb3RvdHlwZS5mbGF0dGVuPWZ1bmN0aW9uKGUpe2Zvcih2YXIgbz1bXSx5PTA7eTx0aGlzLnR5cGVBcmd1bWVudHMubGVuZ3RoOysreSlvLnB1c2godGhpcy50eXBlQXJndW1lbnRzW3ldLmZsYXR0ZW4oZSkpO3JldHVybiBuZXcgcih0aGlzLm5hbWUsbyx0aGlzLnF1YWxpZmllZE5hbWUsdGhpcy5vcGFxdWUsdGhpcy5pZCl9LHIucHJvdG90eXBlLnF1YWxpZnk9ZnVuY3Rpb24oZSxvKXtmb3IodmFyIHk9W10sZD0wO2Q8dGhpcy50eXBlQXJndW1lbnRzLmxlbmd0aDsrK2QpeS5wdXNoKHRoaXMudHlwZUFyZ3VtZW50c1tkXS5xdWFsaWZ5KGUsbykpO3ZhciB2PW5ldyByKHRoaXMubmFtZSx5LHRoaXMucXVhbGlmaWVkTmFtZSx0aGlzLm9wYXF1ZSx0aGlzLmlkKTtyZXR1cm4gZS5nZXRTdGF0aWNUeXBlKHRoaXMubmFtZSkhPT12b2lkIDAmJih2LnF1YWxpZmllZE5hbWU9byksdn0sci5wcm90b3R5cGUucHJvcGFnYXRlPWZ1bmN0aW9uKGUpe2U9PT12b2lkIDAmJihlPW5ldyBNYXApO2Zvcih2YXIgbz1bXSx5PTA7eTx0aGlzLnR5cGVBcmd1bWVudHMubGVuZ3RoOysreSlvLnB1c2godGhpcy50eXBlQXJndW1lbnRzW3ldLnByb3BhZ2F0ZShlKSk7cmV0dXJuIG5ldyByKHRoaXMubmFtZSxvLHRoaXMucXVhbGlmaWVkTmFtZSx0aGlzLm9wYXF1ZSx0aGlzLmlkKX0sci5wcm90b3R5cGUuaW5zdGFudGlhdGU9ZnVuY3Rpb24oZSxvLHkpe3ZhciBkPXRoaXM7eT09PXZvaWQgMCYmKHk9bmV3IFNldCk7dmFyIHY9ZS5nZXRTdGF0aWNUeXBlKHRoaXMubmFtZSk7aWYodGhpcy5xdWFsaWZpZWROYW1lIT09dm9pZCAwKXt2YXIgQz1lLmdldEFuZFJlc29sdmVTdGF0aWNTdHJ1Y3R1cmUodGhpcy5xdWFsaWZpZWROYW1lKTt2PUMhPT12b2lkIDA/Qy5nZXRUeXBlKHRoaXMubmFtZSk6dm9pZCAwfWlmKHYhPT12b2lkIDAmJnYudHlwZSBpbnN0YW5jZW9mIEEpdHJ5e3ZhciBHPXYudHlwZS5nZXRUeXBlVmFyaWFibGVzKCksWT0xLEo9bmV3IE1hcDtHLmZvckVhY2goZnVuY3Rpb24oTiwkKXtKPUouc2V0KCQsIicqIitkK1kpLCsrWX0pO3ZhciB6PXYudHlwZS5yZXBsYWNlVHlwZVZhcmlhYmxlcyhKKSxwPXRoaXMubWVyZ2UoZSxvLHoucGFyYW1ldGVyVHlwZSwhMCksYz1lLmdldE5lc3RlZFN0YXRlKGUuaWQpO3JldHVybiBjLnNldFN0YXRpY1R5cGUodGhpcy5uYW1lLHoucmV0dXJuVHlwZSxbXSwtMSx2LmFsbG93c0VxdWFsaXR5KSx6LnJldHVyblR5cGUuaW5zdGFudGlhdGUoYyxwWzFdKX1jYXRjaChOKXt0aHJvdyBOIGluc3RhbmNlb2YgQXJyYXk/bmV3IHMuRWxhYm9yYXRpb25FcnJvcignSW5zdGFudGlhdGluZyAiJyt0aGlzLm5vcm1hbGl6ZSgpWzBdKyciIGZhaWxlZDogJytOWzBdKTpOfWVsc2V7aWYodj09PXZvaWQgMCl0aHJvdyB0aGlzLmlkPjA/bmV3IHMuRWxhYm9yYXRpb25FcnJvcignVW5ib3VuZCB0eXBlICInK3RoaXMubmFtZSsiLyIrdGhpcy5pZCsnIi4nKTpuZXcgcy5FbGFib3JhdGlvbkVycm9yKCdVbmJvdW5kIHR5cGUgIicrdGhpcy5uYW1lKyciLicpO2lmKHYhPT12b2lkIDAmJnYudHlwZS5pc09wYXF1ZSgpKXRoaXMub3BhcXVlPSEwO2Vsc2V7aWYoISh2PT09dm9pZCAwfHx2LnR5cGUgaW5zdGFuY2VvZiByJiZ0aGlzLnR5cGVBcmd1bWVudHMubGVuZ3RoPT09di50eXBlLnR5cGVBcmd1bWVudHMubGVuZ3RoKSl0aHJvdyBuZXcgcy5FbGFib3JhdGlvbkVycm9yKCJBcml0eSBtaXNtYXRjaDogIit0aGlzLm5vcm1hbGl6ZSgpWzBdKyIgdnMgIit2LnR5cGUubm9ybWFsaXplKClbMF0rIi4iKTtpZih2IT09dm9pZCAwJiYoISh2LnR5cGUgaW5zdGFuY2VvZiByKXx8dGhpcy5pZD52LnR5cGUuaWQpKXRocm93IHRoaXMuaWQ+MD9uZXcgcy5FbGFib3JhdGlvbkVycm9yKCdVbmJvdW5kIHR5cGUgIicrdGhpcy5uYW1lKyIvIit0aGlzLmlkKyciLicpOm5ldyBzLkVsYWJvcmF0aW9uRXJyb3IoJ1VuYm91bmQgdHlwZSAiJyt0aGlzLm5hbWUrJyIuJyl9fWZvcih2YXIgdz1bXSxUPTA7VDx0aGlzLnR5cGVBcmd1bWVudHMubGVuZ3RoOysrVCl3LnB1c2godGhpcy50eXBlQXJndW1lbnRzW1RdLmluc3RhbnRpYXRlKGUsbyx5KSk7cmV0dXJuIG5ldyByKHRoaXMubmFtZSx3LHRoaXMucXVhbGlmaWVkTmFtZSx0aGlzLm9wYXF1ZSx0aGlzLmlkKX0sci5wcm90b3R5cGUubWVyZ2U9ZnVuY3Rpb24oZSxvLHksZCl7aWYoZD09PXZvaWQgMCYmKGQ9ITEpLHkgaW5zdGFuY2VvZiBEfHx5IGluc3RhbmNlb2YgTSlyZXR1cm4geS5tZXJnZShlLG8sdGhpcyk7dmFyIHY9dGhpcyxDPXk7aWYoIWQpe2lmKCEoKHY9dGhpcy5pbnN0YW50aWF0ZShlLG8pKWluc3RhbmNlb2YgcikpcmV0dXJuIHYubWVyZ2UoZSxvLHkpO0M9eS5pbnN0YW50aWF0ZShlLG8pfXZhciBHPXY7aWYoQyBpbnN0YW5jZW9mIHImJkcubmFtZT09PUMubmFtZSYmRy5pZD09PUMuaWQpe2Zvcih2YXIgWT1bXSxKPW8sej0wO3o8di50eXBlQXJndW1lbnRzLmxlbmd0aDsrK3ope3ZhciBwPXYudHlwZUFyZ3VtZW50c1t6XS5tZXJnZShlLEosQy50eXBlQXJndW1lbnRzW3pdKTtZLnB1c2gocFswXSksSj1wWzFdfXJldHVybltuZXcgcihHLm5hbWUsWSxHLnF1YWxpZmllZE5hbWUsRy5vcGFxdWUsRy5pZCksSl19dGhyb3dbJ0Nhbm5vdCBtZXJnZSAiJyt0aGlzLmluc3RhbnRpYXRlKGUsbykubm9ybWFsaXplKClbMF0rJyIgYW5kICInK3kuaW5zdGFudGlhdGUoZSxvKS5ub3JtYWxpemUoKVswXSsnIi4nLHRoaXMudHlwZU5hbWUoKSx5LnR5cGVOYW1lKCldfSxyLnByb3RvdHlwZS5tYWtlRXFUeXBlPWZ1bmN0aW9uKGUsbyl7dmFyIHk9ZS5nZXRTdGF0aWNUeXBlKHRoaXMubmFtZSk7aWYodGhpcy5xdWFsaWZpZWROYW1lIT09dm9pZCAwKXt2YXIgZD1lLmdldEFuZFJlc29sdmVTdGF0aWNTdHJ1Y3R1cmUodGhpcy5xdWFsaWZpZWROYW1lKTt5PWQhPT12b2lkIDA/ZC5nZXRUeXBlKHRoaXMubmFtZSk6dm9pZCAwfWlmKHkhPT12b2lkIDAmJiF5LmFsbG93c0VxdWFsaXR5KXJldHVyblt0aGlzLG9dO2Zvcih2YXIgdj1bXSxDPTA7Qzx0aGlzLnR5cGVBcmd1bWVudHMubGVuZ3RoOysrQyl7dmFyIEc9dGhpcy50eXBlQXJndW1lbnRzW0NdLm1ha2VFcVR5cGUoZSxvKTt2LnB1c2goR1swXSksbz1HWzFdfXJldHVybltuZXcgcih0aGlzLm5hbWUsdix0aGlzLnF1YWxpZmllZE5hbWUsdGhpcy5vcGFxdWUsdGhpcy5pZCksb119LHIucHJvdG90eXBlLmdldFR5cGVWYXJpYWJsZXM9ZnVuY3Rpb24oZSl7ZT09PXZvaWQgMCYmKGU9ITEpO3ZhciBvPW5ldyBNYXA7aWYodGhpcy50eXBlQXJndW1lbnRzLmxlbmd0aD4wKWZvcih2YXIgeT0wO3k8dGhpcy50eXBlQXJndW1lbnRzLmxlbmd0aDsrK3kpdGhpcy50eXBlQXJndW1lbnRzW3ldLmdldFR5cGVWYXJpYWJsZXMoZSkuZm9yRWFjaChmdW5jdGlvbihkLHYpe289by5oYXModik/by5zZXQodixELm1lcmdlRG9tYWluKGQsby5nZXQodikpKTpvLnNldCh2LGQpfSk7cmV0dXJuIG99LHIucHJvdG90eXBlLmdldE9yZGVyZWRUeXBlVmFyaWFibGVzPWZ1bmN0aW9uKCl7Zm9yKHZhciBlPVtdLG89MDtvPHRoaXMudHlwZUFyZ3VtZW50cy5sZW5ndGg7KytvKWU9ZS5jb25jYXQodGhpcy50eXBlQXJndW1lbnRzW29dLmdldE9yZGVyZWRUeXBlVmFyaWFibGVzKCkpO3JldHVybiBlfSxyLnByb3RvdHlwZS5yZXBsYWNlVHlwZVZhcmlhYmxlcz1mdW5jdGlvbihlLG8pe2Zvcih2YXIgeT1bXSxkPTA7ZDx0aGlzLnR5cGVBcmd1bWVudHMubGVuZ3RoOysrZCl5LnB1c2godGhpcy50eXBlQXJndW1lbnRzW2RdLnJlcGxhY2VUeXBlVmFyaWFibGVzKGUsbykpO3JldHVybiBuZXcgcih0aGlzLm5hbWUseSx0aGlzLnF1YWxpZmllZE5hbWUsdGhpcy5vcGFxdWUsdGhpcy5pZCl9LHIucHJvdG90eXBlLmFkbWl0c0VxdWFsaXR5PWZ1bmN0aW9uKGUpe3ZhciBvPWUuZ2V0U3RhdGljVHlwZSh0aGlzLm5hbWUpO2lmKHRoaXMucXVhbGlmaWVkTmFtZSE9PXZvaWQgMCl7dmFyIHk9ZS5nZXRBbmRSZXNvbHZlU3RhdGljU3RydWN0dXJlKHRoaXMucXVhbGlmaWVkTmFtZSk7bz15IT09dm9pZCAwP3kuZ2V0VHlwZSh0aGlzLm5hbWUpOnZvaWQgMH1pZihvPT09dm9pZCAwKXJldHVybiEwO3ZhciBkPWUuZ2V0TmVzdGVkU3RhdGUoZS5pZCk7ZC5zZXRTdGF0aWNUeXBlKHRoaXMubmFtZSx0aGlzLFtdLHRoaXMudHlwZUFyZ3VtZW50cy5sZW5ndGgsITApO2Zvcih2YXIgdj0wO3Y8dGhpcy50eXBlQXJndW1lbnRzLmxlbmd0aDsrK3YpaWYoIXRoaXMudHlwZUFyZ3VtZW50c1t2XS5hZG1pdHNFcXVhbGl0eShkKSlyZXR1cm4hMTt2YXIgQz1mdW5jdGlvbihZKXt2YXIgSj1lLmdldFN0YXRpY1ZhbHVlKG8uY29uc3RydWN0b3JzW1ldKTtpZihKPT09dm9pZCAwKXJldHVybiJjb250aW51ZSI7Zm9yKHZhciB6PUpbMF07eiBpbnN0YW5jZW9mIFY7KXo9ei50eXBlO2lmKHogaW5zdGFuY2VvZiByKXJldHVybiJjb250aW51ZSI7dmFyIHA9ei5wYXJhbWV0ZXJUeXBlLGM9cC5nZXRUeXBlVmFyaWFibGVzKCksdz1uZXcgTWFwO3JldHVybiBjLmZvckVhY2goZnVuY3Rpb24oVCxOKXtOLnN0YXJ0c1dpdGgoIicnIil8fCh3PXcuc2V0KE4sIiciK04pKX0pLChwPXAucmVwbGFjZVR5cGVWYXJpYWJsZXModykpLmFkbWl0c0VxdWFsaXR5KGQpP3ZvaWQgMDp7dmFsdWU6ITF9fTtmb3Iodj0wO3Y8by5jb25zdHJ1Y3RvcnMubGVuZ3RoOysrdil7dmFyIEc9Qyh2KTtpZih0eXBlb2YgRz09Im9iamVjdCIpcmV0dXJuIEcudmFsdWV9cmV0dXJuIG8uYWxsb3dzRXF1YWxpdHl9LHIucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIkN1c3RvbVR5cGUifSxyLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbihlKXtlPT09dm9pZCAwJiYoZT17fSk7dmFyIG89IiI7KHRoaXMudHlwZUFyZ3VtZW50cy5sZW5ndGg+MXx8dGhpcy50eXBlQXJndW1lbnRzLmxlbmd0aD09PTEmJih0aGlzLnR5cGVBcmd1bWVudHNbMF1pbnN0YW5jZW9mIEF8fHRoaXMudHlwZUFyZ3VtZW50c1swXWluc3RhbmNlb2YgaCYmdGhpcy50eXBlQXJndW1lbnRzWzBdLnRvU3RyaW5nKGUpIT09InVuaXQiKSkmJihvKz0iKCIpO2Zvcih2YXIgeT0wO3k8dGhpcy50eXBlQXJndW1lbnRzLmxlbmd0aDsrK3kpeT4wJiYobys9IiwgIiksbys9dGhpcy50eXBlQXJndW1lbnRzW3ldLnRvU3RyaW5nKGUpO2lmKCh0aGlzLnR5cGVBcmd1bWVudHMubGVuZ3RoPjF8fHRoaXMudHlwZUFyZ3VtZW50cy5sZW5ndGg9PT0xJiYodGhpcy50eXBlQXJndW1lbnRzWzBdaW5zdGFuY2VvZiBBfHx0aGlzLnR5cGVBcmd1bWVudHNbMF1pbnN0YW5jZW9mIGgmJnRoaXMudHlwZUFyZ3VtZW50c1swXS50b1N0cmluZyhlKSE9PSJ1bml0IikpJiYobys9IikiKSx0aGlzLnR5cGVBcmd1bWVudHMubGVuZ3RoPjAmJihvKz0iICIpLHRoaXMucXVhbGlmaWVkTmFtZSE9PXZvaWQgMClmb3IoeT0wO3k8dGhpcy5xdWFsaWZpZWROYW1lLnF1YWxpZmllcnMubGVuZ3RoOysreSlvKz10aGlzLnF1YWxpZmllZE5hbWUucXVhbGlmaWVyc1t5XS5nZXRUZXh0KCkrIi4iO3JldHVybiBvKz10aGlzLm5hbWUsdGhpcy5pZD4wJiYobys9Ii8iK3RoaXMuaWQpLG99LHIucHJvdG90eXBlLnNpbXBsaWZ5PWZ1bmN0aW9uKCl7Zm9yKHZhciBlPVtdLG89MDtvPHRoaXMudHlwZUFyZ3VtZW50cy5sZW5ndGg7KytvKWUucHVzaCh0aGlzLnR5cGVBcmd1bWVudHNbb10uc2ltcGxpZnkoKSk7cmV0dXJuIG5ldyByKHRoaXMubmFtZSxlLHRoaXMucXVhbGlmaWVkTmFtZSx0aGlzLm9wYXF1ZSx0aGlzLmlkKX0sci5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKGUpe2lmKGUgaW5zdGFuY2VvZiBNKXJldHVybiEwO2lmKCEoZSBpbnN0YW5jZW9mIHIpfHx0aGlzLm5hbWUhPT1lLm5hbWV8fHRoaXMuaWQhPT1lLmlkKXJldHVybiExO2Zvcih2YXIgbz0wO288dGhpcy50eXBlQXJndW1lbnRzLmxlbmd0aDsrK28paWYoIXRoaXMudHlwZUFyZ3VtZW50c1tvXS5lcXVhbHMoZS50eXBlQXJndW1lbnRzW29dKSlyZXR1cm4hMTtyZXR1cm4hMH0scn0oQik7dS5DdXN0b21UeXBlPUk7dmFyIE89ZnVuY3Rpb24oRSl7ZnVuY3Rpb24gcihlKXt2YXIgbz1FLmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIG8uZWxlbWVudHM9ZSxvfXJldHVybiBnKHIsRSksci5wcm90b3R5cGUudHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4iVHVwbGVUeXBlIn0sci5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oZSl7ZT09PXZvaWQgMCYmKGU9e30pO2Zvcih2YXIgbz0iKCIseT0wO3k8dGhpcy5lbGVtZW50cy5sZW5ndGg7Kyt5KXk+MCYmKG8rPSIgKiAiKSxvKz10aGlzLmVsZW1lbnRzW3ldLnRvU3RyaW5nKGUpO3JldHVybiBvKyIpIn0sci5wcm90b3R5cGUuc2ltcGxpZnk9ZnVuY3Rpb24oKXtmb3IodmFyIGU9bmV3IE1hcCxvPTA7bzx0aGlzLmVsZW1lbnRzLmxlbmd0aDsrK28pZS5zZXQoIiIrKG8rMSksdGhpcy5lbGVtZW50c1tvXS5zaW1wbGlmeSgpKTtyZXR1cm4gbmV3IGgoZSwhMCl9LHIucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5zaW1wbGlmeSgpLmVxdWFscyhlKX0scn0oQik7dS5UdXBsZVR5cGU9T30sMTA2OmZ1bmN0aW9uKGZlLHUsSyl7dmFyIG0sZz10aGlzJiZ0aGlzLl9fZXh0ZW5kc3x8KG09ZnVuY3Rpb24oeixwKXtyZXR1cm4obT1PYmplY3Quc2V0UHJvdG90eXBlT2Z8fHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheSYmZnVuY3Rpb24oYyx3KXtjLl9fcHJvdG9fXz13fXx8ZnVuY3Rpb24oYyx3KXtmb3IodmFyIFQgaW4gdylPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodyxUKSYmKGNbVF09d1tUXSl9KSh6LHApfSxmdW5jdGlvbih6LHApe2lmKHR5cGVvZiBwIT0iZnVuY3Rpb24iJiZwIT09bnVsbCl0aHJvdyBuZXcgVHlwZUVycm9yKCJDbGFzcyBleHRlbmRzIHZhbHVlICIrU3RyaW5nKHApKyIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbCIpO2Z1bmN0aW9uIGMoKXt0aGlzLmNvbnN0cnVjdG9yPXp9bSh6LHApLHoucHJvdG90eXBlPXA9PT1udWxsP09iamVjdC5jcmVhdGUocCk6KGMucHJvdG90eXBlPXAucHJvdG90eXBlLG5ldyBjKX0pO09iamVjdC5kZWZpbmVQcm9wZXJ0eSh1LCJfX2VzTW9kdWxlIix7dmFsdWU6ITB9KSx1LkV4Y2VwdGlvbkNvbnN0cnVjdG9yPXUuVmFsdWVDb25zdHJ1Y3Rvcj11LlByZWRlZmluZWRGdW5jdGlvbj11LkV4Y2VwdGlvblZhbHVlPXUuQ29uc3RydWN0ZWRWYWx1ZT11LkZ1bmN0aW9uVmFsdWU9dS5SZWNvcmRWYWx1ZT11LlJlYWw9dS5JbnRlZ2VyPXUuV29yZD11LlN0cmluZ1ZhbHVlPXUuQ2hhclZhbHVlPXUuQm9vbFZhbHVlPXUuQXJyYXlWYWx1ZT11LlZlY3RvclZhbHVlPXUuUmVmZXJlbmNlVmFsdWU9dS5WYWx1ZT11LlByaW50Q291bnRlcj11Lk1JTklOVD11Lk1BWElOVD12b2lkIDA7dmFyIHM9SygzNjcpLHE9Syg3NTgpLEI9Syg1MzQpO3UuTUFYSU5UPTEwNzM3NDE4MjMsdS5NSU5JTlQ9LTEwNzM3NDE4MjQ7dmFyIE09ZnVuY3Rpb24oeil7dGhpcy5jaGFyYWN0ZXJzTGVmdD16fTt1LlByaW50Q291bnRlcj1NO3ZhciBWPWZ1bmN0aW9uKCl7ZnVuY3Rpb24geigpe31yZXR1cm4gei5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24ocCxjKXtyZXR1cm4gYz09PXZvaWQgMCYmKGM9MTIwKSx0aGlzLnBjVG9TdHJpbmcocCxuZXcgTShjKSl9LHoucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihwKXt0aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIlRyaWVkIGNvbXBhcmluZyBpbmNvbXBhcmFibGUgdGhpbmdzLiIpfSx6fSgpO3UuVmFsdWU9Vjt2YXIgRD1mdW5jdGlvbih6KXtmdW5jdGlvbiBwKGMpe3ZhciB3PXouY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gdy5hZGRyZXNzPWMsd31yZXR1cm4gZyhwLHopLHAucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5hZGRyZXNzPT09Yy5hZGRyZXNzfSxwLnByb3RvdHlwZS50eXBlTmFtZT1mdW5jdGlvbigpe3JldHVybiJSZWZlcmVuY2VWYWx1ZSJ9LHAucHJvdG90eXBlLnBjVG9TdHJpbmc9ZnVuY3Rpb24oYyx3KXtpZihjPT09dm9pZCAwKXt2YXIgVD0iJCIrdGhpcy5hZGRyZXNzO3JldHVybiB3LmNoYXJhY3RlcnNMZWZ0LT1ULmxlbmd0aCxUfWlmKGMuZ2V0Q2VsbCh0aGlzLmFkZHJlc3MpIT09dm9pZCAwKXJldHVybiB3LmNoYXJhY3RlcnNMZWZ0LT00LCJyZWYgIitjLmdldENlbGwodGhpcy5hZGRyZXNzKS5wY1RvU3RyaW5nKGMsdyk7dGhyb3cgbmV3IHEuRXZhbHVhdGlvbkVycm9yKCdPdWNoLCB5b3UgbWF5IG5vdCBkZS1yZWZlcmVuY2UgIiQnK3RoaXMuYWRkcmVzcysnIi4nKX0scH0oVik7dS5SZWZlcmVuY2VWYWx1ZT1EO3ZhciBoPWZ1bmN0aW9uKHope2Z1bmN0aW9uIHAoYyl7Yz09PXZvaWQgMCYmKGM9W10pO3ZhciB3PXouY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gdy5lbnRyaWVzPWMsd31yZXR1cm4gZyhwLHopLHAucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihjKXtpZih0aGlzLmVudHJpZXMubGVuZ3RoIT09Yy5lbnRyaWVzLmxlbmd0aClyZXR1cm4hMTtmb3IodmFyIHc9MDt3PHRoaXMuZW50cmllcy5sZW5ndGg7Kyt3KWlmKCF0aGlzLmVudHJpZXNbd10uZXF1YWxzKGMuZW50cmllc1t3XSkpcmV0dXJuITE7cmV0dXJuITB9LHAucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIlZlY3RvclZhbHVlIn0scC5wcm90b3R5cGUucGNUb1N0cmluZz1mdW5jdGlvbihjLHcpe3ZhciBUPSIjWyI7dy5jaGFyYWN0ZXJzTGVmdC09Mztmb3IodmFyIE49MDtOPHRoaXMuZW50cmllcy5sZW5ndGg7KytOKXtpZihOPjAmJihUKz0iLCAiLHcuY2hhcmFjdGVyc0xlZnQtPTIpLCEody5jaGFyYWN0ZXJzTGVmdD4wKSl7VCs9Ilx1MjAyNiI7YnJlYWt9dmFyICQ9MDtOPHRoaXMuZW50cmllcy5sZW5ndGgmJigkPU1hdGguZmxvb3Iody5jaGFyYWN0ZXJzTGVmdC8yKSksdy5jaGFyYWN0ZXJzTGVmdC09JCxUKz10aGlzLmVudHJpZXNbTl0ucGNUb1N0cmluZyhjLHcpLHcuY2hhcmFjdGVyc0xlZnQrPSR9cmV0dXJuIFQrIl0ifSxwfShWKTt1LlZlY3RvclZhbHVlPWg7dmFyIEE9ZnVuY3Rpb24oeil7ZnVuY3Rpb24gcChjLHcpe3ZhciBUPXouY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gVC5hZGRyZXNzPWMsVC5sZW5ndGg9dyxUfXJldHVybiBnKHAseikscC5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmFkZHJlc3M9PT1jLmFkZHJlc3N9LHAucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIkFycmF5VmFsdWUifSxwLnByb3RvdHlwZS5wY1RvU3RyaW5nPWZ1bmN0aW9uKGMsdyl7aWYoYz09PXZvaWQgMCl7dmFyIFQ9Ilt8JCIrdGhpcy5hZGRyZXNzKyIuLi4kIisodGhpcy5hZGRyZXNzK3RoaXMubGVuZ3RoLTEpKyJ8XSI7cmV0dXJuIHcuY2hhcmFjdGVyc0xlZnQtPVQubGVuZ3RoLFR9dmFyIE49Ilt8Ijt3LmNoYXJhY3RlcnNMZWZ0LT00O2Zvcih2YXIgJD0wOyQ8dGhpcy5sZW5ndGg7KyskKXtpZigkPjAmJihOKz0iLCAiLHcuY2hhcmFjdGVyc0xlZnQtPTIpLCEody5jaGFyYWN0ZXJzTGVmdD4wKSl7Tis9Ilx1MjAyNiI7YnJlYWt9aWYoYy5nZXRDZWxsKHRoaXMuYWRkcmVzcyskKT09PXZvaWQgMCl0aHJvdyBuZXcgcS5FdmFsdWF0aW9uRXJyb3IoJ091Y2gsIHlvdSBtYXkgbm90IGRlLXJlZmVyZW5jZSAiJCcrKHRoaXMuYWRkcmVzcyskKSsnIi4nKTt2YXIgSD0wOyQ8dGhpcy5sZW5ndGgmJihIPU1hdGguZmxvb3Iody5jaGFyYWN0ZXJzTGVmdC8yKSksdy5jaGFyYWN0ZXJzTGVmdC09SCxOKz1jLmdldENlbGwodGhpcy5hZGRyZXNzKyQpLnBjVG9TdHJpbmcoYyx3KSx3LmNoYXJhY3RlcnNMZWZ0Kz1IfXJldHVybiBOKyJ8XSJ9LHB9KFYpO3UuQXJyYXlWYWx1ZT1BO3ZhciBJPWZ1bmN0aW9uKHope2Z1bmN0aW9uIHAoYyl7dmFyIHc9ei5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiB3LnZhbHVlPWMsd31yZXR1cm4gZyhwLHopLHAucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy52YWx1ZT09PWMudmFsdWV9LHAucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIkJvb2xWYWx1ZSJ9LHAucHJvdG90eXBlLnBjVG9TdHJpbmc9ZnVuY3Rpb24oYyx3KXtyZXR1cm4gdGhpcy52YWx1ZT8ody5jaGFyYWN0ZXJzTGVmdC09NCwidHJ1ZSIpOih3LmNoYXJhY3RlcnNMZWZ0LT01LCJmYWxzZSIpfSxwfShWKTt1LkJvb2xWYWx1ZT1JO3ZhciBPPWZ1bmN0aW9uKHope2Z1bmN0aW9uIHAoYyl7dmFyIHc9ei5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiB3LnZhbHVlPWMsd31yZXR1cm4gZyhwLHopLHAucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIkNoYXJWYWx1ZSJ9LHAucHJvdG90eXBlLnBjVG9TdHJpbmc9ZnVuY3Rpb24oYyx3KXtyZXR1cm4gdy5jaGFyYWN0ZXJzTGVmdC09MSwiIyIrbmV3IEUodGhpcy52YWx1ZSkucGNUb1N0cmluZyhjLHcpfSxwLnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMudmFsdWU8Yy52YWx1ZT8tMTp0aGlzLnZhbHVlPmMudmFsdWU/MTowfSxwLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMudmFsdWU9PT1jLnZhbHVlfSxwfShWKTt1LkNoYXJWYWx1ZT1PO3ZhciBFPWZ1bmN0aW9uKHope2Z1bmN0aW9uIHAoYyl7dmFyIHc9ei5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiB3LnZhbHVlPWMsd31yZXR1cm4gZyhwLHopLHAuaW1wbG9kZT1mdW5jdGlvbihjKXtmb3IodmFyIHc9IiI7Yy5jb25zdHJ1Y3Rvck5hbWUhPT0ibmlsIjspe2lmKGMuY29uc3RydWN0b3JOYW1lIT09Ijo6Iil0aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoYElzIHRoaXMgYSBjaGFyIGxpc3Q/IEkgY2FuJ3QgaW1wbG9kZSAiYCtjLmNvbnN0cnVjdG9yTmFtZSsnIi4nKTt2YXIgVD1jLmFyZ3VtZW50O2lmKCEoVCBpbnN0YW5jZW9mIHkpKXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcihgSXMgdGhpcyBhIGNoYXIgbGlzdD8gSSBjYW4ndCBpbXBsb2RlICJgK2MuY29uc3RydWN0b3JOYW1lKyciLicpO3ZhciBOPVQuZ2V0VmFsdWUoIjEiKSwkPVQuZ2V0VmFsdWUoIjIiKTtpZighKE4gaW5zdGFuY2VvZiBPJiYkIGluc3RhbmNlb2YgdikpdGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKGBJcyB0aGlzIGEgY2hhciBsaXN0PyBJIGNhbid0IGltcGxvZGUgImArYy5jb25zdHJ1Y3Rvck5hbWUrJyIuJyk7dys9Ti52YWx1ZSxjPSR9cmV0dXJuIG5ldyBwKHcpfSxwLnByb3RvdHlwZS50eXBlTmFtZT1mdW5jdGlvbigpe3JldHVybiJTdHJpbmdWYWx1ZSJ9LHAucHJvdG90eXBlLnBjVG9TdHJpbmc9ZnVuY3Rpb24oYyx3KXt2YXIgVD0iIjt3LmNoYXJhY3RlcnNMZWZ0LT0yO2Zvcih2YXIgTj0wLCQ9dGhpcy52YWx1ZTtOPCQubGVuZ3RoO04rKyl7dmFyIEg9JFtOXTtpZih3LmNoYXJhY3RlcnNMZWZ0PDApe1QrPSJcdTIwMjYiO2JyZWFrfXN3aXRjaCh3LmNoYXJhY3RlcnNMZWZ0LT0xLEgpe2Nhc2VgCmA6VCs9IlxcbiI7YnJlYWs7Y2FzZSIJIjpUKz0iXFx0IjticmVhaztjYXNlIlxyIjpUKz0iXFxyIjticmVhaztjYXNlIlx4MDciOlQrPSJcXGEiO2JyZWFrO2Nhc2UiXGIiOlQrPSJcXGIiO2JyZWFrO2Nhc2UiXHYiOlQrPSJcXHYiO2JyZWFrO2Nhc2UiXGYiOlQrPSJcXGYiO2JyZWFrO2Nhc2UiXHg3RiI6VCs9IlxcMTI3IjticmVhaztjYXNlIlx4RkYiOlQrPSJcXDI1NSI7YnJlYWs7ZGVmYXVsdDppZihILmNoYXJDb2RlQXQoMCk8MzIpe3ZhciBQPSJcXF4iK1N0cmluZy5mcm9tQ2hhckNvZGUoSC5jaGFyQ29kZUF0KDApKzY0KTtUKz1QLHcuY2hhcmFjdGVyc0xlZnQtPVAubGVuZ3RoLTF9ZWxzZSBUKz1IfX1yZXR1cm4nIicrVCsnIid9LHAucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy52YWx1ZT09PWMudmFsdWV9LHAucHJvdG90eXBlLmNvbXBhcmVUbz1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy52YWx1ZTxjLnZhbHVlPy0xOnRoaXMudmFsdWU+Yy52YWx1ZT8xOjB9LHAucHJvdG90eXBlLmNvbmNhdD1mdW5jdGlvbihjKXtyZXR1cm4gbmV3IHAodGhpcy52YWx1ZStjLnZhbHVlKX0scC5wcm90b3R5cGUuZXhwbG9kZT1mdW5jdGlvbigpe2Zvcih2YXIgYz1uZXcgdigibmlsIiksdz10aGlzLnZhbHVlLmxlbmd0aC0xO3c+PTA7LS13KWM9bmV3IHYoIjo6IixuZXcgeShuZXcgTWFwKFtbIjEiLG5ldyBPKHRoaXMudmFsdWVbd10pXSxbIjIiLGNdXSkpKTtyZXR1cm4gY30scH0oVik7dS5TdHJpbmdWYWx1ZT1FO3ZhciByPWZ1bmN0aW9uKHope2Z1bmN0aW9uIHAoYyl7dmFyIHc9ei5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiB3LnZhbHVlPWMsd31yZXR1cm4gZyhwLHopLHAucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIldvcmQifSxwLnByb3RvdHlwZS5wY1RvU3RyaW5nPWZ1bmN0aW9uKGMsdyl7dmFyIFQ9IiIrdGhpcy52YWx1ZTtyZXR1cm4gdy5jaGFyYWN0ZXJzTGVmdC09VC5sZW5ndGgsVH0scC5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKGMpe2lmKGMgaW5zdGFuY2VvZiBwKXt2YXIgdz1jLnZhbHVlO3JldHVybiB0aGlzLnZhbHVlPHc/LTE6dGhpcy52YWx1ZT53PzE6MH1yZXR1cm4gMn0scC5wcm90b3R5cGUubmVnYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBwKC10aGlzLnZhbHVlKX0scC5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmNvbXBhcmVUbyhjKT09PTB9LHAucHJvdG90eXBlLmFkZD1mdW5jdGlvbihjKXtyZXR1cm4gbmV3IHAodGhpcy52YWx1ZStjLnZhbHVlKX0scC5wcm90b3R5cGUubXVsdGlwbHk9ZnVuY3Rpb24oYyl7cmV0dXJuIG5ldyBwKHRoaXMudmFsdWUqYy52YWx1ZSl9LHAucHJvdG90eXBlLmRpdmlkZT1mdW5jdGlvbihjKXtyZXR1cm4gbmV3IHAoTWF0aC5mbG9vcih0aGlzLnZhbHVlL2MudmFsdWUpKX0scC5wcm90b3R5cGUubW9kdWxvPWZ1bmN0aW9uKGMpe3JldHVybiBuZXcgcCh0aGlzLnZhbHVlJWMudmFsdWUpfSxwLnByb3RvdHlwZS50b1JlYWw9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG8odGhpcy52YWx1ZSl9LHAucHJvdG90eXBlLmhhc092ZXJmbG93PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFsdWU+dS5NQVhJTlR8fHRoaXMudmFsdWU8dS5NSU5JTlR9LHB9KFYpO3UuV29yZD1yO3ZhciBlPWZ1bmN0aW9uKHope2Z1bmN0aW9uIHAoYyl7dmFyIHc9ei5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiB3LnZhbHVlPWMsd31yZXR1cm4gZyhwLHopLHAucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIkludGVnZXIifSxwLnByb3RvdHlwZS5wY1RvU3RyaW5nPWZ1bmN0aW9uKGMsdyl7dmFyIFQ9IiIrdGhpcy52YWx1ZTtyZXR1cm4gdy5jaGFyYWN0ZXJzTGVmdC09VC5sZW5ndGgsVC5yZXBsYWNlKC8tLywifiIpfSxwLnByb3RvdHlwZS5jb21wYXJlVG89ZnVuY3Rpb24oYyl7aWYoYyBpbnN0YW5jZW9mIHApe3ZhciB3PWMudmFsdWU7cmV0dXJuIHRoaXMudmFsdWU8dz8tMTp0aGlzLnZhbHVlPnc/MTowfXJldHVybiExfSxwLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24oYyl7cmV0dXJuIHRoaXMuY29tcGFyZVRvKGMpPT09MH0scC5wcm90b3R5cGUubmVnYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBwKC10aGlzLnZhbHVlKX0scC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKGMpe3JldHVybiBuZXcgcCh0aGlzLnZhbHVlK2MudmFsdWUpfSxwLnByb3RvdHlwZS5tdWx0aXBseT1mdW5jdGlvbihjKXtyZXR1cm4gbmV3IHAodGhpcy52YWx1ZSpjLnZhbHVlKX0scC5wcm90b3R5cGUuZGl2aWRlPWZ1bmN0aW9uKGMpe3JldHVybiBuZXcgcChNYXRoLmZsb29yKHRoaXMudmFsdWUvYy52YWx1ZSkpfSxwLnByb3RvdHlwZS5tb2R1bG89ZnVuY3Rpb24oYyl7cmV0dXJuIG5ldyBwKHRoaXMudmFsdWUtTWF0aC5mbG9vcih0aGlzLnZhbHVlL2MudmFsdWUpKmMudmFsdWUpfSxwLnByb3RvdHlwZS50b1JlYWw9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG8odGhpcy52YWx1ZSl9LHAucHJvdG90eXBlLmhhc092ZXJmbG93PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMudmFsdWU+dS5NQVhJTlR8fHRoaXMudmFsdWU8dS5NSU5JTlR9LHB9KFYpO3UuSW50ZWdlcj1lO3ZhciBvPWZ1bmN0aW9uKHope2Z1bmN0aW9uIHAoYyl7dmFyIHc9ei5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiB3LnZhbHVlPWMsd31yZXR1cm4gZyhwLHopLHAucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIlJlYWwifSxwLnByb3RvdHlwZS5wY1RvU3RyaW5nPWZ1bmN0aW9uKGMsdyl7dmFyIFQ9IiIrdGhpcy52YWx1ZTtyZXR1cm4gVC5zZWFyY2goL1wuLyk9PT0tMSYmKFQrPSIuMCIpLHcuY2hhcmFjdGVyc0xlZnQtPVQubGVuZ3RoLFQucmVwbGFjZSgvLS8sIn4iKX0scC5wcm90b3R5cGUuY29tcGFyZVRvPWZ1bmN0aW9uKGMpe2lmKGMgaW5zdGFuY2VvZiBwKXt2YXIgdz1jLnZhbHVlO3JldHVybiB0aGlzLnZhbHVlPHc/LTE6dGhpcy52YWx1ZT53PzE6MH1yZXR1cm4hMX0scC5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKGMpe3JldHVybiB0aGlzLmNvbXBhcmVUbyhjKT09PTB9LHAucHJvdG90eXBlLm5lZ2F0ZT1mdW5jdGlvbigpe3JldHVybiBuZXcgcCgtdGhpcy52YWx1ZSl9LHAucHJvdG90eXBlLmFkZD1mdW5jdGlvbihjKXtyZXR1cm4gbmV3IHAodGhpcy52YWx1ZStjLnZhbHVlKX0scC5wcm90b3R5cGUubXVsdGlwbHk9ZnVuY3Rpb24oYyl7cmV0dXJuIG5ldyBwKHRoaXMudmFsdWUqYy52YWx1ZSl9LHAucHJvdG90eXBlLmRpdmlkZT1mdW5jdGlvbihjKXtyZXR1cm4gbmV3IHAodGhpcy52YWx1ZS9jLnZhbHVlKX0scC5wcm90b3R5cGUudG9JbnRlZ2VyPWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBlKE1hdGguZmxvb3IodGhpcy52YWx1ZSkpfSxwLnByb3RvdHlwZS5oYXNPdmVyZmxvdz1mdW5jdGlvbigpe3JldHVybiExfSxwfShWKTt1LlJlYWw9bzt2YXIgeT1mdW5jdGlvbih6KXtmdW5jdGlvbiBwKGMpe2M9PT12b2lkIDAmJihjPW5ldyBNYXApO3ZhciB3PXouY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gdy5lbnRyaWVzPWMsd31yZXR1cm4gZyhwLHopLHAucHJvdG90eXBlLnR5cGVOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIlJlY29yZFZhbHVlIn0scC5wcm90b3R5cGUucGNUb1N0cmluZz1mdW5jdGlvbihjLHcpe2Zvcih2YXIgVD10aGlzLE49dGhpcy5lbnRyaWVzLnNpemUhPT0xLCQ9MTskPD10aGlzLmVudHJpZXMuc2l6ZTsrKyQpdGhpcy5lbnRyaWVzLmhhcygiIiskKXx8KE49ITEpO2lmKE4pe3ZhciBIPSIoIjtmb3Iody5jaGFyYWN0ZXJzTGVmdC09MiwkPTE7JDw9dGhpcy5lbnRyaWVzLnNpemU7KyskKXskPjEmJihIKz0iLCAiLHcuY2hhcmFjdGVyc0xlZnQtPTIpO3ZhciBQPXRoaXMuZW50cmllcy5nZXQoIiIrJCk7aWYoUD09PXZvaWQgMCl0aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoIkhvdyBkaWQgd2UgbG9vc2UgdGhpcyB2YWx1ZT8gSXQgd2FzIHRoZXJlIGJlZm9yZS4gSSBwcm9taXNlXHUyMDI2Iik7aWYoISh3LmNoYXJhY3RlcnNMZWZ0PjApKXtIKz0iXHUyMDI2IjticmVha312YXIgeD0wOyQ8dGhpcy5lbnRyaWVzLnNpemUmJih4PU1hdGguZmxvb3Iody5jaGFyYWN0ZXJzTGVmdC8yKSksdy5jaGFyYWN0ZXJzTGVmdC09eCxIKz1QLnBjVG9TdHJpbmcoYyx3KSx3LmNoYXJhY3RlcnNMZWZ0Kz14fXJldHVybiBIKyIpIn12YXIgUj0ieyI7dy5jaGFyYWN0ZXJzTGVmdC09Mjt2YXIgXz0hMCxXPSExLFE9MDtyZXR1cm4gdGhpcy5lbnRyaWVzLmZvckVhY2goZnVuY3Rpb24obmUsRil7aWYoIVcpe2lmKF8/Xz0hMTooUis9IiwgIix3LmNoYXJhY3RlcnNMZWZ0LT0yKSx3LmNoYXJhY3RlcnNMZWZ0PjApe3ZhciBiPTA7UTxULmVudHJpZXMuc2l6ZSYmKGI9TWF0aC5mbG9vcih3LmNoYXJhY3RlcnNMZWZ0LzIpKSx3LmNoYXJhY3RlcnNMZWZ0LT1iLFIrPUYrIiA9ICIrbmUucGNUb1N0cmluZyhjLHcpLHcuY2hhcmFjdGVyc0xlZnQrPWJ9ZWxzZSBSKz0iXHUyMDI2IixXPSEwOysrUX19KSxSKyJ9In0scC5wcm90b3R5cGUuZ2V0VmFsdWU9ZnVuY3Rpb24oYyl7aWYoIXRoaXMuZW50cmllcy5oYXMoYykpdGhyb3cgbmV3IHEuRXZhbHVhdGlvbkVycm9yKCJUcmllZCBhY2Nlc3Npbmcgbm9uLWV4aXN0aW5nIHJlY29yZCBwYXJ0LiIpO3JldHVybiB0aGlzLmVudHJpZXMuZ2V0KGMpfSxwLnByb3RvdHlwZS5oYXNWYWx1ZT1mdW5jdGlvbihjKXtyZXR1cm4gdGhpcy5lbnRyaWVzLmhhcyhjKX0scC5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKGMpe3ZhciB3PXRoaXM7aWYoIShjIGluc3RhbmNlb2YgcCkpcmV0dXJuITE7dmFyIFQ9ITE7cmV0dXJuIHRoaXMuZW50cmllcy5mb3JFYWNoKGZ1bmN0aW9uKE4sJCl7Yy5lbnRyaWVzLmhhcygkKXx8KFQ9ITApLE4uZXF1YWxzKGMuZW50cmllcy5nZXQoJCkpfHwoVD0hMCl9KSwhVCYmKGMuZW50cmllcy5mb3JFYWNoKGZ1bmN0aW9uKE4sJCl7dy5lbnRyaWVzLmhhcygkKXx8KFQ9ITApLE4uZXF1YWxzKGMuZW50cmllcy5nZXQoJCkpfHwoVD0hMCl9KSwhVCl9LHB9KFYpO3UuUmVjb3JkVmFsdWU9eTt2YXIgZD1mdW5jdGlvbih6KXtmdW5jdGlvbiBwKGMsdyxUKXt2YXIgTj16LmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIE4uc3RhdGU9YyxOLnJlY3Vyc2l2ZXM9dyxOLmJvZHk9VCxOfXJldHVybiBnKHAseikscC5wcm90b3R5cGUudHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4iRnVuY3Rpb25WYWx1ZSJ9LHAucHJvdG90eXBlLnBjVG9TdHJpbmc9ZnVuY3Rpb24oYyx3KXtyZXR1cm4gdy5jaGFyYWN0ZXJzTGVmdC09MiwiZm4ifSxwLnByb3RvdHlwZS5jb21wdXRlPWZ1bmN0aW9uKGMsdyxUKXtmb3IodmFyIE49dGhpcy5zdGF0ZS5nZXROZXN0ZWRTdGF0ZSh0aGlzLnN0YXRlLmlkKSwkPTA7JDx0aGlzLnJlY3Vyc2l2ZXMubGVuZ3RoOysrJCl0aGlzLnJlY3Vyc2l2ZXNbJF1bMV1pbnN0YW5jZW9mIHA/Ti5zZXREeW5hbWljVmFsdWUodGhpcy5yZWN1cnNpdmVzWyRdWzBdLG5ldyBwKHRoaXMuc3RhdGUsdGhpcy5yZWN1cnNpdmVzLHRoaXMucmVjdXJzaXZlc1skXVsxXS5ib2R5KSxzLklkZW50aWZpZXJTdGF0dXMuVkFMVUVfVkFSSUFCTEUpOk4uc2V0RHluYW1pY1ZhbHVlKHRoaXMucmVjdXJzaXZlc1skXVswXSx0aGlzLnJlY3Vyc2l2ZXNbJF1bMV0scy5JZGVudGlmaWVyU3RhdHVzLlZBTFVFX1ZBUklBQkxFKTtjLnB1c2goe25leHQ6dGhpcy5ib2R5LHBhcmFtczp7c3RhdGU6TixyZWNSZXN1bHQ6dm9pZCAwLG1vZGlmaWFibGU6VCx2YWx1ZTp3fX0pfSxwLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24oYyl7dGhyb3cgbmV3IHEuSW50ZXJuYWxJbnRlcnByZXRlckVycm9yKCdZb3Ugc2ltcGx5IGNhbm5vdCBjb21wYXJlICInK3RoaXMucGNUb1N0cmluZyh2b2lkIDAsbmV3IE0oMjApKSsnIiBhbmQgIicrYy5wY1RvU3RyaW5nKHZvaWQgMCxuZXcgTSgyMCkpKyciLicpfSxwfShWKTt1LkZ1bmN0aW9uVmFsdWU9ZDt2YXIgdj1mdW5jdGlvbih6KXtmdW5jdGlvbiBwKGMsdyxUKXt3PT09dm9pZCAwJiYodz12b2lkIDApLFQ9PT12b2lkIDAmJihUPTApO3ZhciBOPXouY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gTi5jb25zdHJ1Y3Rvck5hbWU9YyxOLmFyZ3VtZW50PXcsTi5pZD1ULE59cmV0dXJuIGcocCx6KSxwLnByb3RvdHlwZS50eXBlTmFtZT1mdW5jdGlvbigpe3JldHVybiJDb25zdHJ1Y3RlZFZhbHVlIn0scC5wcm90b3R5cGUucGNUb1N0cmluZz1mdW5jdGlvbihjLHcpe2lmKHRoaXMuY29uc3RydWN0b3JOYW1lPT09Ijo6Iil7dmFyIFQ9IlsiO3cuY2hhcmFjdGVyc0xlZnQtPTI7Zm9yKHZhciBOPXRoaXM7Ti5jb25zdHJ1Y3Rvck5hbWUhPT0ibmlsIjspe2lmKE4uY29uc3RydWN0b3JOYW1lIT09Ijo6Iil0aHJvdyBuZXcgcS5JbnRlcm5hbEludGVycHJldGVyRXJyb3IoJ0lzIHRoaXMgZXZlbiBhIGxpc3Q/IDEgIicrTi5jb25zdHJ1Y3Rvck5hbWUrJyIuJyk7dmFyICQ9Ti5hcmd1bWVudDtpZighKCQgaW5zdGFuY2VvZiB5JiYkLmVudHJpZXMuc2l6ZT09PTIpKXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignSXMgdGhpcyBldmVuIGEgbGlzdD8gMyAiJytOLmNvbnN0cnVjdG9yTmFtZSsnIi4nKTt2YXIgSD0kLmdldFZhbHVlKCIxIiksUD0kLmdldFZhbHVlKCIyIik7aWYoIShIIGluc3RhbmNlb2YgViYmUCBpbnN0YW5jZW9mIHApKXRocm93IG5ldyBxLkludGVybmFsSW50ZXJwcmV0ZXJFcnJvcignSXMgdGhpcyBldmVuIGEgbGlzdD8gMiAiJytOLmNvbnN0cnVjdG9yTmFtZSsnIi4nKTtpZihOIT09dGhpcyYmKFQrPSIsICIsdy5jaGFyYWN0ZXJzTGVmdC09MiksISh3LmNoYXJhY3RlcnNMZWZ0PjApKXtUKz0iXHUyMDI2IjticmVha312YXIgeD0wO1AuY29uc3RydWN0b3JOYW1lIT09Im5pbCImJih4PU1hdGguZmxvb3Iody5jaGFyYWN0ZXJzTGVmdC8yKSksdy5jaGFyYWN0ZXJzTGVmdC09eCxUKz1ILnBjVG9TdHJpbmcoYyx3KSx3LmNoYXJhY3RlcnNMZWZ0Kz14LE49UH1yZXR1cm4gVCsiXSJ9aWYodGhpcy5jb25zdHJ1Y3Rvck5hbWU9PT0ibmlsIilyZXR1cm4gdy5jaGFyYWN0ZXJzTGVmdC09MiwiW10iO2lmKGMhPT12b2lkIDApe3ZhciBSPWMuZ2V0SW5maXhTdGF0dXMobmV3IEIuSWRlbnRpZmllclRva2VuKHRoaXMuY29uc3RydWN0b3JOYW1lKSk7aWYoUiE9PXZvaWQgMCYmUi5pbmZpeCYmdGhpcy5hcmd1bWVudCBpbnN0YW5jZW9mIHkmJnRoaXMuYXJndW1lbnQuZW50cmllcy5zaXplPT09Mil7dmFyIF89dGhpcy5hcmd1bWVudC5nZXRWYWx1ZSgiMSIpLFc9dGhpcy5hcmd1bWVudC5nZXRWYWx1ZSgiMiIpO2lmKF8gaW5zdGFuY2VvZiBWJiZXIGluc3RhbmNlb2YgVilyZXR1cm4gdy5jaGFyYWN0ZXJzTGVmdC09NCt0aGlzLmNvbnN0cnVjdG9yTmFtZS5sZW5ndGgseD1NYXRoLmZsb29yKHcuY2hhcmFjdGVyc0xlZnQvMiksdy5jaGFyYWN0ZXJzTGVmdC09eCxUPSIoIix3LmNoYXJhY3RlcnNMZWZ0PjA/VCs9Xy5wY1RvU3RyaW5nKGMsdyk6VCs9Ilx1MjAyNiIsdy5jaGFyYWN0ZXJzTGVmdCs9eCxUKz0iICIrdGhpcy5jb25zdHJ1Y3Rvck5hbWUsdGhpcy5pZD4wJiYoVCs9UT0iLyIrdGhpcy5pZCx3LmNoYXJhY3RlcnNMZWZ0LT1RLmxlbmd0aCksdy5jaGFyYWN0ZXJzTGVmdD4wP1QrPSIgIitXLnBjVG9TdHJpbmcoYyx3KTpUKz0iIFx1MjAyNiIsVCsiKSJ9fXZhciBRLG5lPSIiO3JldHVybiBuZSs9dGhpcy5jb25zdHJ1Y3Rvck5hbWUsdy5jaGFyYWN0ZXJzTGVmdC09dGhpcy5jb25zdHJ1Y3Rvck5hbWUubGVuZ3RoKzEsdGhpcy5pZD4wJiYobmUrPVE9Ii8iK3RoaXMuaWQsdy5jaGFyYWN0ZXJzTGVmdC09US5sZW5ndGgpLHRoaXMuYXJndW1lbnQmJih3LmNoYXJhY3RlcnNMZWZ0PjA/KG5lKz0iICIsKHRoaXMuYXJndW1lbnQgaW5zdGFuY2VvZiBwJiZ0aGlzLmFyZ3VtZW50LmFyZ3VtZW50fHx0aGlzLmFyZ3VtZW50IGluc3RhbmNlb2YgQyYmdGhpcy5hcmd1bWVudC5hcmd1bWVudCkmJihuZSs9IigiKSxuZSs9dGhpcy5hcmd1bWVudC5wY1RvU3RyaW5nKGMsdyksKHRoaXMuYXJndW1lbnQgaW5zdGFuY2VvZiBwJiZ0aGlzLmFyZ3VtZW50LmFyZ3VtZW50fHx0aGlzLmFyZ3VtZW50IGluc3RhbmNlb2YgQyYmdGhpcy5hcmd1bWVudC5hcmd1bWVudCkmJihuZSs9IikiKSk6bmUrPSIgXHUyMDI2IiksbmV9LHAucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihjKXtyZXR1cm4gYyBpbnN0YW5jZW9mIFkmJihjPWMuY29uc3RydWN0KCkpLGMgaW5zdGFuY2VvZiBwJiZ0aGlzLmNvbnN0cnVjdG9yTmFtZT09PWMuY29uc3RydWN0b3JOYW1lJiZ0aGlzLmlkPT09Yy5pZCYmKHRoaXMuYXJndW1lbnQhPT12b2lkIDA/Yy5hcmd1bWVudD09PXZvaWQgMHx8dGhpcy5hcmd1bWVudC5lcXVhbHMoYy5hcmd1bWVudCk6Yy5hcmd1bWVudD09PXZvaWQgMCl9LHB9KFYpO3UuQ29uc3RydWN0ZWRWYWx1ZT12O3ZhciBDPWZ1bmN0aW9uKHope2Z1bmN0aW9uIHAoYyx3LFQsTil7dz09PXZvaWQgMCYmKHc9dm9pZCAwKSxUPT09dm9pZCAwJiYoVD0wKSxOPT09dm9pZCAwJiYoTj0wKTt2YXIgJD16LmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuICQuY29uc3RydWN0b3JOYW1lPWMsJC5hcmd1bWVudD13LCQuaWQ9VCwkLmV2YWxJZD1OLCR9cmV0dXJuIGcocCx6KSxwLnByb3RvdHlwZS50eXBlTmFtZT1mdW5jdGlvbigpe3JldHVybiJFeGNlcHRpb25WYWx1ZSJ9LHAucHJvdG90eXBlLnBjVG9TdHJpbmc9ZnVuY3Rpb24oYyx3KXt2YXIgVD10aGlzLmNvbnN0cnVjdG9yTmFtZTtpZih3LmNoYXJhY3RlcnNMZWZ0LT10aGlzLmNvbnN0cnVjdG9yTmFtZS5sZW5ndGgrMSx0aGlzLmlkPjApe3ZhciBOPSIvIit0aGlzLmlkO1QrPU4sdy5jaGFyYWN0ZXJzTGVmdC09Ti5sZW5ndGh9cmV0dXJuIHRoaXMuYXJndW1lbnQmJih3LmNoYXJhY3RlcnNMZWZ0PjA/VCs9IiAiK3RoaXMuYXJndW1lbnQucGNUb1N0cmluZyhjLHcpOlQrPSIgXHUyMDI2IiksVH0scC5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKGMpe3JldHVybiBjIGluc3RhbmNlb2YgSiYmKGM9Yy5jb25zdHJ1Y3QoKSksYyBpbnN0YW5jZW9mIHAmJnRoaXMuY29uc3RydWN0b3JOYW1lPT09Yy5jb25zdHJ1Y3Rvck5hbWUmJnRoaXMuaWQ9PT1jLmlkJiZ0aGlzLmV2YWxJZD09PWMuZXZhbElkJiYodGhpcy5hcmd1bWVudCE9PXZvaWQgMD9jLmFyZ3VtZW50PT09dm9pZCAwfHx0aGlzLmFyZ3VtZW50LmVxdWFscyhjLmFyZ3VtZW50KTpjLmFyZ3VtZW50PT09dm9pZCAwKX0scH0oVik7dS5FeGNlcHRpb25WYWx1ZT1DO3ZhciBHPWZ1bmN0aW9uKHope2Z1bmN0aW9uIHAoYyx3KXt2YXIgVD16LmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIFQubmFtZT1jLFQuYXBwbHk9dyxUfXJldHVybiBnKHAseikscC5wcm90b3R5cGUudHlwZU5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4iUHJlZGVmaW5lZEZ1bmN0aW9uIn0scC5wcm90b3R5cGUucGNUb1N0cmluZz1mdW5jdGlvbihjLHcpe3JldHVybiB3LmNoYXJhY3RlcnNMZWZ0LT0yLCJmbiJ9LHAucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihjKXtyZXR1cm4gYyBpbnN0YW5jZW9mIHAmJnRoaXMubmFtZT09PWMubmFtZX0scH0oVik7dS5QcmVkZWZpbmVkRnVuY3Rpb249Rzt2YXIgWT1mdW5jdGlvbih6KXtmdW5jdGlvbiBwKGMsdyxUKXt3PT09dm9pZCAwJiYodz0wKSxUPT09dm9pZCAwJiYoVD0wKTt2YXIgTj16LmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuIE4uY29uc3RydWN0b3JOYW1lPWMsTi5udW1BcmdzPXcsTi5pZD1ULE59cmV0dXJuIGcocCx6KSxwLnByb3RvdHlwZS50eXBlTmFtZT1mdW5jdGlvbigpe3JldHVybiJWYWx1ZUNvbnN0cnVjdG9yIn0scC5wcm90b3R5cGUuZXF1YWxzPWZ1bmN0aW9uKGMpe3JldHVybiBjIGluc3RhbmNlb2YgcCYmdGhpcy5jb25zdHJ1Y3Rvck5hbWU9PT1jLmNvbnN0cnVjdG9yTmFtZSYmdGhpcy5pZD09PWMuaWR9LHAucHJvdG90eXBlLmNvbnN0cnVjdD1mdW5jdGlvbihjKXtyZXR1cm4gYz09PXZvaWQgMCYmKGM9dm9pZCAwKSxuZXcgdih0aGlzLmNvbnN0cnVjdG9yTmFtZSxjLHRoaXMuaWQpfSxwLnByb3RvdHlwZS5wY1RvU3RyaW5nPWZ1bmN0aW9uKGMsdyl7dmFyIFQ9dGhpcy5jb25zdHJ1Y3Rvck5hbWU7aWYody5jaGFyYWN0ZXJzTGVmdC09dGhpcy5jb25zdHJ1Y3Rvck5hbWUubGVuZ3RoLHRoaXMuaWQ+MCl7dmFyIE49Ii8iK3RoaXMuaWQ7VCs9Tix3LmNoYXJhY3RlcnNMZWZ0LT1OLmxlbmd0aH1yZXR1cm4gVH0scH0oVik7dS5WYWx1ZUNvbnN0cnVjdG9yPVk7dmFyIEo9ZnVuY3Rpb24oeil7ZnVuY3Rpb24gcChjLHcsVCxOKXt3PT09dm9pZCAwJiYodz0wKSxUPT09dm9pZCAwJiYoVD0wKSxOPT09dm9pZCAwJiYoTj0wKTt2YXIgJD16LmNhbGwodGhpcyl8fHRoaXM7cmV0dXJuICQuZXhjZXB0aW9uTmFtZT1jLCQubnVtQXJncz13LCQuaWQ9VCwkLmV2YWxJZD1OLCR9cmV0dXJuIGcocCx6KSxwLnByb3RvdHlwZS50eXBlTmFtZT1mdW5jdGlvbigpe3JldHVybiJFeGNlcHRpb25Db25zdHJ1Y3RvciJ9LHAucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihjKXtyZXR1cm4gYyBpbnN0YW5jZW9mIHAmJnRoaXMuZXhjZXB0aW9uTmFtZT09PWMuZXhjZXB0aW9uTmFtZSYmdGhpcy5pZD09PWMuaWQmJnRoaXMuZXZhbElkPT09Yy5ldmFsSWR9LHAucHJvdG90eXBlLmNvbnN0cnVjdD1mdW5jdGlvbihjKXtyZXR1cm4gYz09PXZvaWQgMCYmKGM9dm9pZCAwKSxuZXcgQyh0aGlzLmV4Y2VwdGlvbk5hbWUsYyx0aGlzLmlkLHRoaXMuZXZhbElkKX0scC5wcm90b3R5cGUucGNUb1N0cmluZz1mdW5jdGlvbihjLHcpe3ZhciBUPXRoaXMuZXhjZXB0aW9uTmFtZTtpZih3LmNoYXJhY3RlcnNMZWZ0LT10aGlzLmV4Y2VwdGlvbk5hbWUubGVuZ3RoLHRoaXMuaWQ+MCl7dmFyIE49Ii8iK3RoaXMuaWQ7VCs9Tix3LmNoYXJhY3RlcnNMZWZ0LT1OLmxlbmd0aH1yZXR1cm4gVH0scH0oVik7dS5FeGNlcHRpb25Db25zdHJ1Y3Rvcj1KfSw0MTI6KGZlLHUpPT57T2JqZWN0LmRlZmluZVByb3BlcnR5KHUsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pLHUuQ09NTUlUX01FU1NBR0U9dS5CVUlMRF9EQVRFPXUuQ09NTUlUX0hBU0g9dS5CUkFOQ0hfTkFNRT11LlZFUlNJT049dm9pZCAwLHUuVkVSU0lPTj0iMS42LjEwIix1LkJSQU5DSF9OQU1FPSJtYWluIix1LkNPTU1JVF9IQVNIPSI3YmE2YjIzIix1LkJVSUxEX0RBVEU9IldlZCBKdWwgMTQgMTI6NDk6MzkgUE0gVVRDIDIwMjEiLHUuQ09NTUlUX01FU1NBR0U9InVwZGF0ZSBjbGkifX0sU2U9e307cmV0dXJuIGZ1bmN0aW9uIGZlKHUpe3ZhciBLPVNlW3VdO2lmKEshPT12b2lkIDApcmV0dXJuIEsuZXhwb3J0czt2YXIgbT1TZVt1XT17ZXhwb3J0czp7fX07cmV0dXJuIFRlW3VdLmNhbGwobS5leHBvcnRzLG0sbS5leHBvcnRzLGZlKSxtLmV4cG9ydHN9KDUxOSl9KSgpfSl9KShrZSk7ZnVuY3Rpb24gUGUoYmUsSWUpe2xldCBUZTt0cnl7VGU9a2UuZXhwb3J0cy5pbnRlcnByZXQoSWUrIjsiLGJlKX1jYXRjaChTZSl7cmV0dXJuIFNlIGluc3RhbmNlb2Yga2UuZXhwb3J0cy5FcnJvcnMuSW5jb21wbGV0ZUVycm9yP3tzdGF0ZTpudWxsLHJlc3VsdDoxLGVycm9yOlNlLHdhcm5pbmdzOltdfTp7c3RhdGU6bnVsbCxyZXN1bHQ6MixlcnJvcjpTZSx3YXJuaW5nczpbXX19cmV0dXJuIFRlLmV2YWx1YXRpb25FcnJvcmVkP3tzdGF0ZTpUZS5zdGF0ZSxyZXN1bHQ6MyxlcnJvcjpUZS5lcnJvcix3YXJuaW5nczpUZS53YXJuaW5nc306e3N0YXRlOlRlLnN0YXRlLHJlc3VsdDowLGVycm9yOm51bGwsd2FybmluZ3M6VGUud2FybmluZ3N9fW9ubWVzc2FnZT1hc3luYyBiZT0+e3RyeXtsZXQgSWUsVGU9IiI7Y29uc3QgU2U9a2UuZXhwb3J0cy5nZXRGaXJzdFN0YXRlKCk7SWU9a2UuZXhwb3J0cy5pbnRlcnByZXQoImZ1biB0cnVuYyB4ID0gaWYgeCA+PSAwLjAgdGhlbiBmbG9vciB4IGVsc2UgY2VpbCB4OyIsU2UpO2NvbnN0IGZlPWJlLmRhdGEuc2NyaXB0LnNwbGl0KCI7Iik7Zm9yKGxldCB1PTA7dTxmZS5sZW5ndGgtMTt1Kyspe2ZlW3VdKz0iOyI7Y29uc3QgSz1QZShJZS5zdGF0ZSxmZVt1XSk7aWYoSy5yZXN1bHQ9PTApe0llPUs7bGV0IG09IiI7Zm9yKGxldCBnPTA7ZzxLLndhcm5pbmdzLmxlbmd0aDtnKyspbSs9Sy53YXJuaW5nc1tnXS50b1N0cmluZygpLnJlcGxhY2UoIldhcm5pbmc6ICIsIiIpO1RlKz1tK0suc3RhdGUudG9TdHJpbmcoe3N0b3BJZDpLLnN0YXRlLmlkfSl9ZWxzZSBpZih1PGZlLmxlbmd0aC0yJiZLLnJlc3VsdCE9MylmZVt1KzFdPWZlW3VdK2ZlW3UrMV07ZWxzZSB0aHJvdyBuZXcgRXJyb3IoSy5yZXN1bHQ9PTM/IkV4Y2VwdGlvbi0gIitLLmVycm9yKyIgcmFpc2VkIjpLLmVycm9yKX1wb3N0TWVzc2FnZSh7ZGVidWc6VGV9KX1jYXRjaChJZSl7Y29uc29sZS5sb2coSWUpLHBvc3RNZXNzYWdlKHtlcnJvcjpJZX0pfX19KSgpOwo=",Ou=typeof window<"u"&&window.Blob&&new Blob([atob(Du)],{type:"text/javascript;charset=utf-8"});function qu(){const l=Ou&&(window.URL||window.webkitURL).createObjectURL(Ou);try{return l?new Worker(l):new Worker("data:application/javascript;base64,"+Du)}finally{l&&(window.URL||window.webkitURL).revokeObjectURL(l)}}function Ds(l){var t={as:"keyword",do:"keyword",else:"keyword",end:"keyword",exception:"keyword",fun:"keyword",functor:"keyword",if:"keyword",in:"keyword",include:"keyword",let:"keyword",of:"keyword",open:"keyword",rec:"keyword",struct:"keyword",then:"keyword",type:"keyword",val:"keyword",while:"keyword",with:"keyword"},e=l.extraWords||{};for(var i in e)e.hasOwnProperty(i)&&(t[i]=l.extraWords[i]);var n=[];for(var c in t)n.push(c);function s(h,u){var m=h.next();if(m==='"')return u.tokenize=d,u.tokenize(h,u);if(m==="{"&&h.eat("|"))return u.longString=!0,u.tokenize=a,u.tokenize(h,u);if(m==="("&&h.match(/^\*(?!\))/))return u.commentLevel++,u.tokenize=o,u.tokenize(h,u);if(m==="~"||m==="?")return h.eatWhile(/\w/),"variableName.special";if(m==="`")return h.eatWhile(/\w/),"quote";if(m==="/"&&l.slashComments&&h.eat("/"))return h.skipToEnd(),"comment";if(/\d/.test(m))return m==="0"&&h.eat(/[bB]/)&&h.eatWhile(/[01]/),m==="0"&&h.eat(/[xX]/)&&h.eatWhile(/[0-9a-fA-F]/),m==="0"&&h.eat(/[oO]/)?h.eatWhile(/[0-7]/):(h.eatWhile(/[\d_]/),h.eat(".")&&h.eatWhile(/[\d]/),h.eat(/[eE]/)&&h.eatWhile(/[\d\-+]/)),"number";if(/[+\-*&%=<>!?|@\.~:]/.test(m))return"operator";if(/[\w\xa1-\uffff]/.test(m)){h.eatWhile(/[\w\xa1-\uffff]/);var r=h.current();return t.hasOwnProperty(r)?t[r]:"variable"}return null}function d(h,u){for(var m,r=!1,b=!1;(m=h.next())!=null;){if(m==='"'&&!b){r=!0;break}b=!b&&m==="\\"}return r&&!b&&(u.tokenize=s),"string"}function o(h,u){for(var m,r;u.commentLevel>0&&(r=h.next())!=null;)m==="("&&r==="*"&&u.commentLevel++,m==="*"&&r===")"&&u.commentLevel--,m=r;return u.commentLevel<=0&&(u.tokenize=s),"comment"}function a(h,u){for(var m,r;u.longString&&(r=h.next())!=null;)m==="|"&&r==="}"&&(u.longString=!1),m=r;return u.longString||(u.tokenize=s),"string"}return{startState:function(){return{tokenize:s,commentLevel:0,longString:!1}},token:function(h,u){return h.eatSpace()?null:u.tokenize(h,u)},languageData:{autocomplete:n,commentTokens:{line:l.slashComments?"//":void 0,block:{open:"(*",close:"*)"}}}}}Ds({name:"ocaml",extraWords:{and:"keyword",assert:"keyword",begin:"keyword",class:"keyword",constraint:"keyword",done:"keyword",downto:"keyword",external:"keyword",function:"keyword",initializer:"keyword",lazy:"keyword",match:"keyword",method:"keyword",module:"keyword",mutable:"keyword",new:"keyword",nonrec:"keyword",object:"keyword",private:"keyword",sig:"keyword",to:"keyword",try:"keyword",value:"keyword",virtual:"keyword",when:"keyword",raise:"builtin",failwith:"builtin",true:"builtin",false:"builtin",asr:"builtin",land:"builtin",lor:"builtin",lsl:"builtin",lsr:"builtin",lxor:"builtin",mod:"builtin",or:"builtin",raise_notrace:"builtin",trace:"builtin",exit:"builtin",print_string:"builtin",print_endline:"builtin",int:"type",float:"type",bool:"type",char:"type",string:"type",unit:"type",List:"builtin"}}),Ds({name:"fsharp",extraWords:{abstract:"keyword",assert:"keyword",base:"keyword",begin:"keyword",class:"keyword",default:"keyword",delegate:"keyword","do!":"keyword",done:"keyword",downcast:"keyword",downto:"keyword",elif:"keyword",extern:"keyword",finally:"keyword",for:"keyword",function:"keyword",global:"keyword",inherit:"keyword",inline:"keyword",interface:"keyword",internal:"keyword",lazy:"keyword","let!":"keyword",match:"keyword",member:"keyword",module:"keyword",mutable:"keyword",namespace:"keyword",new:"keyword",null:"keyword",override:"keyword",private:"keyword",public:"keyword","return!":"keyword",return:"keyword",select:"keyword",static:"keyword",to:"keyword",try:"keyword",upcast:"keyword","use!":"keyword",use:"keyword",void:"keyword",when:"keyword","yield!":"keyword",yield:"keyword",atomic:"keyword",break:"keyword",checked:"keyword",component:"keyword",const:"keyword",constraint:"keyword",constructor:"keyword",continue:"keyword",eager:"keyword",event:"keyword",external:"keyword",fixed:"keyword",method:"keyword",mixin:"keyword",object:"keyword",parallel:"keyword",process:"keyword",protected:"keyword",pure:"keyword",sealed:"keyword",tailcall:"keyword",trait:"keyword",virtual:"keyword",volatile:"keyword",List:"builtin",Seq:"builtin",Map:"builtin",Set:"builtin",Option:"builtin",int:"builtin",string:"builtin",not:"builtin",true:"builtin",false:"builtin",raise:"builtin",failwith:"builtin"},slashComments:!0});const SG=Ds({name:"sml",extraWords:{abstype:"keyword",and:"keyword",andalso:"keyword",case:"keyword",datatype:"keyword",fn:"keyword",handle:"keyword",infix:"keyword",infixr:"keyword",local:"keyword",nonfix:"keyword",op:"keyword",orelse:"keyword",raise:"keyword",withtype:"keyword",eqtype:"keyword",sharing:"keyword",sig:"keyword",signature:"keyword",structure:"keyword",where:"keyword",true:"keyword",false:"keyword",int:"builtin",real:"builtin",string:"builtin",char:"builtin",bool:"builtin"},slashComments:!0});function LG(l){let t,e,i,n,c;return{c(){t=Q("base-editor"),this.c=tt,L(t,"syntax",bs.define(SG)),L(t,"type",l[0]),L(t,"theme",e=localStorage.getItem("icp-default-theme")||l[1]),L(t,"code",l[2]),L(t,"webworker",l[6]),L(t,"id",l[3]),L(t,"downloadable",l[5]),L(t,"save",i=l[4]&&l[3]!=""),L(t,"language","ml")},m(s,d){et(s,t,d),n||(c=$t(t,"recreateworker",l[7]),n=!0)},p(s,[d]){d&1&&L(t,"type",s[0]),d&2&&e!==(e=localStorage.getItem("icp-default-theme")||s[1])&&L(t,"theme",e),d&4&&L(t,"code",s[2]),d&64&&L(t,"webworker",s[6]),d&8&&L(t,"id",s[3]),d&32&&L(t,"downloadable",s[5]),d&24&&i!==(i=s[4]&&s[3]!="")&&L(t,"save",i)},i:tt,o:tt,d(s){s&&Zt(t),n=!1,c()}}}function JG(l,t,e){let{type:i="normal"}=t,{theme:n="light"}=t,{code:c=""}=t,{id:s=""}=t,{save:d=!1}=t,{downloadable:o=!1}=t,a;wl(()=>{e(6,a=new qu)});const h=u=>{e(6,a=new qu)};return l.$$set=u=>{"type"in u&&e(0,i=u.type),"theme"in u&&e(1,n=u.theme),"code"in u&&e(2,c=u.code),"id"in u&&e(3,s=u.id),"save"in u&&e(4,d=u.save),"downloadable"in u&&e(5,o=u.downloadable)},[i,n,c,s,d,o,a,h]}class FG extends Ce{constructor(t){super(),Fe(this,{target:this.shadowRoot,props:Je(this.attributes),customElement:!0},JG,LG,fe,{type:0,theme:1,code:2,id:3,save:4,downloadable:5},null),t&&(t.target&&et(t.target,this,t.anchor),t.props&&(this.$set(t.props),v()))}static get observedAttributes(){return["type","theme","code","id","save","downloadable"]}get type(){return this.$$.ctx[0]}set type(t){this.$$set({type:t}),v()}get theme(){return this.$$.ctx[1]}set theme(t){this.$$set({theme:t}),v()}get code(){return this.$$.ctx[2]}set code(t){this.$$set({code:t}),v()}get id(){return this.$$.ctx[3]}set id(t){this.$$set({id:t}),v()}get save(){return this.$$.ctx[4]}set save(t){this.$$set({save:t}),v()}get downloadable(){return this.$$.ctx[5]}set downloadable(t){this.$$set({downloadable:t}),v()}}customElements.define("standardml-editor",FG)})();
